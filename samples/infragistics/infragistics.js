/* English, US */

/*global jQuery */
(function ($) {
    $.ig = $.ig || {};
    $.ig.regional = $.ig.regional || {};
    $.ig.regional['en-US'] = {
	    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
	    monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
	    dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
	    dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
	    am: 'AM',
	    pm: 'PM',
	    datePattern: 'M/d/yyyy',
	    dateLongPattern: 'dddd, MMMM dd, yyyy',
	    dateTimePattern: 'M/d/yyyy h:mm tt',
	    timePattern: 'h:mm tt',
	    timeLongPattern: 'h:mm:ss tt',
	    negativeSign: '-',
	    numericNegativePattern: '-$n',
	    numericDecimalSeparator: '.',
	    numericGroupSeparator: ',',
	    numericGroups: [3],
	    numericMaxDecimals: 2,
	    numericMinDecimals: 0,
	    currencyPositivePattern: '$n',
	    currencyNegativePattern: '-$n',
	    currencySymbol: '$',
	    currencyDecimalSeparator: '.',
	    currencyGroupSeparator: ',',
	    currencyGroups: [3],
	    currencyMaxDecimals: 2,
	    currencyMinDecimals: 2,
	    percentPositivePattern: 'n$',
	    percentNegativePattern: '-n$',
	    percentSymbol: '%',
	    percentDecimalSeparator: '.',
	    percentGroupSeparator: ',',
	    percentGroups: [3],
	    percentDisplayFactor: 100,
	    percentMaxDecimals: 2,
	    percentMinDecimals: 2
    };
    if ($.ig.setRegionalDefault) {
	    $.ig.setRegionalDefault('en-US');
    }
})(jQuery);/*!@license
* Infragistics.Web.ClientUI common utilities localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.util){$.ig.util={};$.extend($.ig.util,{locale:{unsupportedBrowser:"The current browser does not support HTML5 canvas element. <br/>Try upgrading to any of the following versions:",currentBrowser:"Current browser: {0}",ie9:"Microsoft Internet Explorer V 9+",chrome8:"Google Chrome V 8+",firefox36:"Mozilla Firefox V 3.6+",safari5:"Apple Safari V 5+",opera11:"Opera V 11+",ieDownload:"http://www.microsoft.com/windows/internet-explorer/default.aspx",operaDownload:"http://www.opera.com/download/",chromeDownload:"http://www.google.com/chrome",firefoxDownload:"http://www.mozilla.com/",safariDownload:"http://www.apple.com/safari/download/"}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Util functions 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 * 
 * util functions that extend the jQuery  namespace 
 * if something is not already available in jQuery, please add it here. 
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.4.js
 * modernizr.js (Optional)
 *
 */
(function($){var initializing=false,fnTest=/xyz/.test(function(){xyz()})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(prop,doAugment){var doSuper=true,_super=this.prototype,prototype,name;if(doAugment){doSuper=false}initializing=true;prototype=new this;initializing=false;function makeFn(name,fn){return function(){var tmp=this._super,ret;this._super=_super[name];ret=fn.apply(this,arguments);this._super=tmp;return ret}}if(doAugment){prototype.getType=function(){return this.$type};prototype.getHashCode=function(){if(this.$hashCode!==undefined){return this.$hashCode}this.$hashCode=$.ig.nextHashCode++;return this.$hashCode}}for(name in prop){if(prop.hasOwnProperty(name)){prototype[name]=doSuper&&typeof prop[name]==="function"&&typeof _super[name]==="function"&&fnTest.test(prop[name])?makeFn(name,prop[name]):prop[name]}}var isForIntellisense=window.intellisense&&window.intellisense.annotate;function Class(){if(!initializing&&this.init){if(!isForIntellisense||Class===$.ig.Type){this.init.apply(this,arguments)}}}if(prop.$type){prop.$type.InstanceConstructor=Class}Class.prototype=prototype;Class.constructor=Class;Class.extend=this.extend;if(doAugment){Class.typeName=function(){return this.prototype.$type};Class.baseType=function(){return this.$type.baseType}}return Class};if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.util",[],function(){return Class})}if(!window.console){window.console={log:function(){}}}})(jQuery);(function($){$.fn.startsWith=function(str){return this[0].innerHTML.indexOf(str)===0};$.ig=$.ig||{_isNamespace:true};$.ig.util=$.ig.util||{};$.ig.util.browserVersion="";$.ig.util.isIE=window.navigator.userAgent.indexOf("MSIE")>-1||!!window.navigator.userAgent.match(/trident/i);$.ig.util.isIEOld=$.ig.util.isIE&&!window.HTMLElement?true:false;if($.ig.util.isIE){$.ig.util.browserVersion=document.documentMode;$.ig.util.isIE7=$.ig.util.browserVersion<=7;$.ig.util.isIE8=$.ig.util.browserVersion===8;$.ig.util.isIE9=$.ig.util.browserVersion===9;$.ig.util.isIE10=$.ig.util.browserVersion===10;$.ig.util.isIE11=$.ig.util.browserVersion>=11}$.ig.util.isChrome=window.chrome;$.ig.util.isFF=window.mozInnerScreenX!==undefined;$.ig.util.isOpera=!!window.opera;$.ig.util.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0?true:false;$.ig.util.isWebKit=!!window.webkitURL;$.ig.util.isEdge=window.navigator.userAgent.indexOf("Edge")>-1;$.ajaxQueue=function(queueName,options){var callback;if(typeof document.ajaxQueue==="undefined"){document.ajaxQueue={queue:{}}}if(typeof document.ajaxQueue.queue[queueName]==="undefined"){document.ajaxQueue.queue[queueName]=[]}if(typeof options==="undefined"){return}callback=options.complete;options.complete=function(request,status){document.ajaxQueue.queue[queueName].shift();if(typeof callback!=="undefined"){callback(request,status)}if(document.ajaxQueue.queue[queueName].length>0){$.ajax(document.ajaxQueue.queue[queueName][0])}};document.ajaxQueue.queue[queueName].push(options);if(document.ajaxQueue.queue[queueName].length===1){$.ajax(document.ajaxQueue.queue[queueName][0])}};if(typeof $.ig.useDefineProperty==="undefined"){$.ig.useDefineProperty=true}$.ig.util.isModernizrAvailable=typeof Modernizr==="object";$.ig.util.isTouch=$.ig.util.isModernizrAvailable&&(Modernizr.touch===true||Modernizr.touchevents===true||Modernizr.pointerevents===true);$.ig.util.isTouchDevice=function(){return"ontouchstart"in window||window.navigator.msMaxTouchPoints>0};$.ig.extendNativePrototype=function(proto,propName,val){if($.ig.useDefineProperty){try{Object.defineProperty(proto,propName,{value:val,enumerable:false,configurable:true,writable:true})}catch(e){proto[propName]=val}}else{proto[propName]=val}};$.ig.util.stackPeek=function(array){return array[array.length-1]};$.ig.util.stackContains=function(array,item){for(var i=0;i<array.length;i++){if($.ig.Object.prototype.equalsStatic(array[i],item)){return true}}return false};$.ig.util.createString1=function(charArray){return charArray.join("")};$.ig.util.createString2=function(c,count){var ret="";for(var i=0;i<count;i++){ret=ret+c}return ret};$.ig.util.createString3=function(charArray,start,length){var ret="";for(var i=0;i<length;i++){ret=ret+charArray[start+i]}return ret};String.prototype.copyTo=function(sourceIndex,destination,destinationIndex,count){for(var i=destinationIndex;i<destinationIndex+count;i++){destination[i]=this.charAt(sourceIndex+i-destinationIndex)}};Date.prototype.stdTimezoneOffset=function(){var jan,jul,janOffset,julOffset;jan=new Date(this.getFullYear(),0,1);jul=new Date(this.getFullYear(),6,1);julOffset=jul.getTimezoneOffset();janOffset=jan.getTimezoneOffset();return Math.max(janOffset,julOffset)};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};if(!Object.keys){Object.keys=function(){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===null)){throw new TypeError("Object.keys called on non-object")}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}()}$.ig.findPath=function(dsObj,resKey){var resPath,ds=dsObj;resPath=resKey.split(".");if(resPath.length>0){for(var i=0;i<resPath.length;i++){if(ds){ds=ds[resPath[i]]}else{break}}}return ds};$.ig.checkboxMarkupClasses="";$.ig.formatter=function(val,type,format,notTemplate,enableUTCDates,displayStyle,labelText,tabIndex){var min,y,h,m,s,ms,am,e,day,pattern,len,n,dot,gr,gr0,grps,curS,percS,cur,perc,prefix,i,d=val&&val.getTime,reg=$.ig.regional.defaults,pow,display=displayStyle||"inline-block";if(format==="checkbox"&&notTemplate){s='<span class="ui-igcheckbox-container" style="display:'+display+';" role="checkbox" aria-disabled="true" aria-checked="'+val+'" aria-label="'+labelText+'" tabindex="'+tabIndex+'">';s+='<span class="'+$.ig.checkboxMarkupClasses+'" style="display:inline-block">';s+='<span style="display:block" class="'+(val?"":"ui-igcheckbox-small-off ");return s+'ui-icon ui-icon-check ui-igcheckbox-small-on"></span></span></span>'}if(!val&&val!==0&&val!==false){return"&nbsp;"}if(type==="date"||d){if(!val){return"&nbsp;"}if(!d){return val}pattern=reg[format&&format!=="null"&&format!=="undefined"?format+"Pattern":"datePattern"]||format;if(enableUTCDates){y=val.getUTCFullYear();m=val.getUTCMonth()+1;d=val.getUTCDate();h=val.getUTCHours();min=val.getUTCMinutes();s=val.getUTCSeconds();ms=val.getUTCMilliseconds();day=val.getUTCDay()}else{y=val.getFullYear();m=val.getMonth()+1;d=val.getDate();h=val.getHours();min=val.getMinutes();s=val.getSeconds();ms=val.getMilliseconds();day=val.getDay()}pattern=pattern.replace(/\\d/g,"").replace(/\\y/g,"").replace(/\\M/g,"\b").replace(/\\m/g,"	").replace(/\\t/g,"\n").replace(/\\s/g,"").replace(/\\f/g,"\f").replace(/\\h/g,"\r").replace(/\\H/g,"");pattern=pattern.replace("MMMM","").replace("MMM","").replace("dddd","").replace("ddd","");if(pattern.indexOf("t")>=0){am=h>=12?reg.pm:reg.am;am=am||" ";if(pattern.indexOf("tt")>=0){pattern=pattern.replace("tt","t")}else if(am.length>1){am=am.substring(0,1)}pattern=pattern.replace("t","")}if(pattern.indexOf("h")>=0){if(h>12){h-=12}if(h===0){h=12}}pattern=pattern.replace(/H/g,"h");pattern=pattern.replace("yyyy",y<10?"000"+y:y<100?"00"+y:y<1e3?"0"+y:y).replace("yy",(y=y%100)<10?"0"+y:y).replace("y",y%100).replace("MM",m<10?"0"+m:m).replace("M",m);pattern=pattern.replace("dd",d<10?"0"+d:d).replace("d",d);pattern=pattern.replace("hh",h<10?"0"+h:h).replace("h",h).replace("mm",min<10?"0"+min:min).replace("m",min).replace("ss",s<10?"0"+s:s).replace("s",s);pattern=pattern.replace("fff",ms<10?"00"+ms:ms<100?"0"+ms:ms).replace("ff",(ms=Math.round(ms/10))<10?"0"+ms:ms).replace("f",Math.round(ms/100));pattern=pattern.replace("",reg.monthNames[m-1]).replace("",reg.monthNamesShort[m-1]).replace("",am);pattern=pattern.replace("",reg.dayNames[day]).replace("",reg.dayNamesShort[day]);pattern=pattern.replace(/\x06/g,"d").replace(/\x07/g,"y").replace(/\x08/g,"M").replace(/\x09/g,"m").replace(/\x0A/g,"t").replace(/\x0B/g,"s").replace(/\x0C/g,"f").replace("\r","h").replace("","H");return pattern}d=format==="double";if(!d){cur=format===(curS="currency");if(!cur){perc=format===(percS="percent");if(!perc){i=format==="int"}}}n=typeof val==="number";if(d||n||i||cur||perc||type==="number"){if(!n){val=parseFloat(val.replace("(","-").replace(new RegExp("[^0-9\\-eE\\"+reg.numericDecimalSeparator+"\\+]","gm"),"").replace(reg.numericDecimalSeparator,"."))}if(isNaN(val)){return"&nbsp;"}if(perc){val*=100}prefix=cur?curS:perc?percS:"numeric";pattern=reg[prefix+(val<0?"Negative":"Positive")+"Pattern"]||"n";len=format?format.length:0;if(len>0&&((s=format.charAt(0))==="0"||s==="#")){min=m=0;dot=format.indexOf(".");if(dot>0){m=len-1-dot;while(++dot<len){if(format.charAt(dot)!=="0"){break}min++}}}else{min=reg[prefix+"MinDecimals"]||0;if(d){m=999}else{m=reg[prefix+"MaxDecimals"];m=m&&!i?m:0}}if(val<0){val=-val}if(m===999){val=val.toString(10)}else{if($.ig.util.isIE&&$.ig.util.browserVersion<=8){pow=Math.pow(10,m);val=(Math.round(pow*val)/pow).toFixed(m)}else{val=val.toFixed(m)}}if((i=val.indexOf("E"))<0){i=val.indexOf("e")}e="";if(i>0){e=val.substring(i);val=val.substring(0,i)}dot=val.indexOf(".");len=val.length;i=0;while(dot>0&&m>min+i&&val.charAt(len-1-i)==="0"){i++}if(i>0){val=val.substring(0,len-=i)}if(dot===len-1){val=val.substring(0,dot)}if(dot>0){len=dot}s=reg[prefix+"DecimalSeparator"];if(s){val=val.replace(".",s)}s=reg[prefix+"GroupSeparator"];grps=s?reg[prefix+"Groups"]:"";gr=gr0=grps.length>0?grps[i=0]:0;while(gr>0&&--len>0){if(--gr===0){val=val.substring(0,len)+s+val.substring(len);gr=grps[++i];if(!gr||gr<1){gr=gr0}else{gr0=gr}}}s=reg[prefix+"Symbol"]||"";return pattern.replace("-",reg.negativeSign).replace("n",val+e).replace("$",s)}if(format){if(format.indexOf(s="{0}")>=0){return format.replace(s,val)}if(format.indexOf(s="[0]")>=0){return format.replace(s,val)}}return val||val===0?val:"&nbsp;"};$.ig._regional={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],am:"AM",pm:"PM",datePattern:"M/d/yyyy",dateLongPattern:"dddd, MMMM dd, yyyy",dateTimePattern:"M/d/yyyy h:mm tt",timePattern:"h:mm tt",timeLongPattern:"h:mm:ss tt",negativeSign:"-",numericNegativePattern:"-$n",numericDecimalSeparator:".",numericGroupSeparator:",",numericGroups:[3],numericMaxDecimals:2,numericMinDecimals:0,currencyPositivePattern:"$n",currencyNegativePattern:"-$n",currencySymbol:"$",currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroups:[3],currencyMaxDecimals:2,currencyMinDecimals:2,percentPositivePattern:"n$",percentNegativePattern:"-n$",percentSymbol:"%",percentDecimalSeparator:".",percentGroupSeparator:",",percentGroups:[3],percentDisplayFactor:100,percentMaxDecimals:2,percentMinDecimals:2};$.ig.regional=$.ig.regional||{};$.ig.regional.defaults=$.ig._regional;$.ig.setRegionalDefault=function(regional){if($.ui&&$.ui.igEditor){$.ui.igEditor.setDefaultCulture(regional)}else{$.ig.regional.defaults=$.extend($.ig._regional,typeof regional==="string"?$.ig.regional[regional]:regional)}};$.ig.calcSummaries=function(summaryFunction,data,caller,dataType){var sum=function(data){var sum=0,i;for(i=0;i<data.length;i++){sum+=data[i]}return sum};summaryFunction=summaryFunction.toLowerCase();if(summaryFunction.startsWith("custom")){summaryFunction="custom"}switch(summaryFunction){case"min":if(data.length===0){if(dataType==="date"){return null}return 0}return Math.min.apply(Math,data);case"max":if(data.length===0){if(dataType==="date"){return null}return 0}return Math.max.apply(Math,data);case"sum":return sum(data);case"avg":if(data.length===0){return 0}return sum(data)/data.length;case"count":return data.length;case"custom":if(caller!==undefined&&caller!==null){if($.type(caller)==="function"){return caller(data)}if($.type(caller)==="string"){caller=eval(caller);return caller(data)}}else{return null}break}};$.ig.getMaxZIndex=function(id){var maxZ=1e4,thisZ;$(".ui-dialog").each(function(){if(!id||$(this)[0].id!==id){thisZ=$(this).css("z-index");if(!isNaN(thisZ)){maxZ=Math.max(maxZ,thisZ)}}});return maxZ};$.ig.uid=function(){return((1+Math.random())*parseInt("10000",16)).toString(16).substring(1,5)};$.ig.nextHashCode=0;$.ig.util.ensureUniqueId=function(obj){if(!obj.getHashCode){var code=$.ig.nextHashCode++;obj.getHashCode=function(){return code}}};$.ig.getColType=function(o){var t=typeof o;if(t==="undefined"){return"string"}else if(o&&o.getTime&&!isNaN(o.getTime())&&Object.prototype.toString.call(o)==="[object Date]"){return"date"}else if(t==="boolean"){return"bool"}else if(t==="number"){return t}else if(t==="object"){return"object"}else{return"string"}};$.ig.typeIdentifierCache={};$.ig.nextTypeIdentifier=0;$.ig.Type=Class.extend({init:function(identifier,baseType,interfaces,staticInitializer){this.specializationCache={};this._staticInitializer=staticInitializer;this._fullName=identifier;this.name=identifier;var lastDotIndex=this.name.lastIndexOf(".");if(lastDotIndex>=0){this.name=this.name.substr(lastDotIndex+1)}this.typeArguments=null;this.baseType=null;this.interfaces=null;if(baseType){this.baseType=baseType}if(interfaces){this.interfaces=interfaces}if($.ig.typeIdentifierCache[identifier]){this.identifier=$.ig.typeIdentifierCache[identifier]}else{this.identifier=$.ig.nextTypeIdentifier++;$.ig.typeIdentifierCache[identifier]=this.identifier}},typeName:function(){return this.name},fullName:function(){return this._fullName},getSpecId:function(types){if(types.length===1){if(!types[0]){return"undef"}else if(!types[0].typeName){return types[0].toString()}else if(types[0].stringId){return types[0].stringId}else{return types[0].identifier.toString()}}var ret="";for(var i=0;i<types.length;i++){var type=types[i];if(!type){ret+="undef"}else if(!type.typeName){ret+=type.toString()}else if(type.stringId){ret+=type.stringId}else{ret+=type.identifier.toString()}}return ret},_isGenericType:null,isGenericType:function(){if(this._isGenericType===null){this._isGenericType=this.name.indexOf("$")>=0}return this._isGenericType},isGenericTypeDefinition:function(){return this.typeArguments===null&&this.isGenericType()},genericTypeArguments:function(){return this.typeArguments},_staticInitializer:null,_staticFields:null,getStaticFields:function(type){if(type===undefined)type=this;var t=this;while(t!=null){if(t===type||t._fullName==type._fullName){if(t._staticFields==null&&t._staticInitializer){t._staticFields={};t._staticInitializer.apply(t._staticFields,t.typeArguments)}return t._staticFields}t=t.baseType}return null},specializationCache:null,initSelfReferences:function(replacement){var i,j;if(replacement){if(this.typeArguments){for(j=0;j<this.typeArguments.length;j++){var typeArg=this.typeArguments[j];if(typeArg==-1)this.typeArguments[j]=replacement;else if(typeArg&&typeArg.initSelfReferences)typeArg.initSelfReferences(replacement)}}}else{if(this.baseType)this.baseType.initSelfReferences(this);if(this.interfaces){for(i=0;i<this.interfaces.length;i++)this.interfaces[i].initSelfReferences(this)}}},specialize:function(){var i;if(!this.isGenericType()){return this}var specId=this.getSpecId(arguments);var ret=this.specializationCache[specId];if(ret){return ret}ret=new $.ig.Type(this._fullName,this.baseType,this.interfaces,this._staticInitializer);var placeholders=this.typeArguments;var hasPlaceholders=false;if(placeholders&&placeholders.length&&isFinite(placeholders[0])){hasPlaceholders=true}ret.typeArguments=[];if(hasPlaceholders){for(i=0;i<placeholders.length;i++){ret.typeArguments[i]=arguments[placeholders[i]]}}else{for(i=0;i<arguments.length;i++){ret.typeArguments[i]=arguments[i]}}if(this.baseType&&this.baseType.typeArguments){ret.baseType=this.specialize.apply(this.baseType,arguments)}if(this.interfaces){ret.interfaces=[];for(i=0;i<this.interfaces.length;i++){ret.interfaces[i]=this.specialize.apply(this.interfaces[i],arguments)}}this.specializationCache[specId]=ret;ret.stringId=ret.generateString();var _self=this;ret.InstanceConstructor=function(){_self.InstanceConstructor.apply(this,ret.typeArguments.concat(Array.prototype.slice.call(arguments,0)));return this};ret.InstanceConstructor.prototype=this.InstanceConstructor.prototype;return ret},equals:function(other){if(!(other instanceof $.ig.Type)){return false}if(this.identifier!==other.identifier){return false}if(this.typeArguments===null&&other.typeArguments===null){return true}if(this.typeArguments===null&&other.typeArguments!==null){return false}if(this.typeArguments!==null&&other.typeArguments===null){return false}if(this.typeArguments.length!==other.typeArguments.length){return false}for(var i=0;i<this.typeArguments.length;i++){if(!$.ig.Type.prototype.checkEquals(this.typeArguments[i],other.typeArguments[i])){return false}}return true},checkEquals:function(type1,type2){if(type1 instanceof $.ig.Type){return type1.equals(type2)}else if(type2 instanceof $.ig.Type){return type2.equals(type1)}else{return type1===type2}},op_Equality:function(type1,type2){return type1.equals(type2)},op_Inequality:function(type1,type2){return!type1.equals(type2)},generateString:function(){if(!this.typeArguments||!this.typeArguments.length){return this.identifier.toString()}else{var ret=this.identifier.toString()+"[";var first=true;for(var i=0;i<this.typeArguments.length;i++){if(this.typeArguments[i]==undefined){continue}if(first){first=false}else{ret+=","}if(this.typeArguments[i].toString){ret+=this.typeArguments[i].toString()}else{ret+=this.typeArguments[i].identifier.toString()}}ret+="]";return ret}},isEnum:function(){return this.baseType===$.ig.Enum.prototype.$type},isValueType:function(){return this.baseType===$.ig.ValueType.prototype.$type},isAssignableFrom:function(tOther){if(this===tOther){return true}if(tOther.baseType&&this.isAssignableFrom(tOther.baseType)){return true}if(tOther.interfaces){for(var i=0;i<tOther.interfaces.length;i++){if(this.isAssignableFrom(tOther.interfaces[i])){return true}}}return false},isInstanceOfType:function(value){return $.ig.util.cast(this,value)!==null},isPrimitive:function(){return this===$.ig.Number.prototype.$type||this===$.ig.Boolean.prototype.$type}},true);$.ig.Object=Class.extend({init:function(){},equals:function(other){return this===other},equalsStatic:function(a,b){var aIsNull=a==null||!!a.isNullable&&!a.hasValue();var bIsNull=b==null||!!b.isNullable&&!b.hasValue();if(aIsNull||bIsNull){return aIsNull&&bIsNull}if(a.equals){return a.equals(b)}if(b.equals){return b.equals(a)}if($.ig.util.isNaN(a)&&$.ig.util.isNaN(b)){return true}return a==b&&typeof a==typeof b},memberwiseClone:function(){function Cons(){}Cons.prototype=this.$type.InstanceConstructor.prototype;var clone=new Cons;for(var prop in this){if(this.hasOwnProperty(prop)){clone[prop]=this[prop]}}return clone},referenceEquals:function(a,b){return a===b||a==null&&b==null},$type:new $.ig.Type("Object")},true);$.ig.$o=$.ig.Object;$.ig.$op=$.ig.Object.prototype;$.ig.$ot=$.ig.Object.prototype.$type;$.ig.Type.prototype.$type=new $.ig.Type("Type",$.ig.Object.prototype.$type);$.ig.IConvertible=Class.extend({$type:new $.ig.Type("IConvertible")},true);$.ig.IComparable=Class.extend({$type:new $.ig.Type("IComparable")},true);$.ig.IComparable$1=Class.extend({$type:new $.ig.Type("IComparable$1")},true);$.ig.IEquatable$1=Class.extend({$type:new $.ig.Type("IEquatable$1")},true);$.ig.Enum=Class.extend({parse:function(enumType,value,ignoreCase){var info=$.ig.util.getDefinedNameAndNamespace(enumType.fullName());if($.ig.util.canAssign(this.$type,enumType)){var p=info.namespace[info.name].prototype;var values=p.$type.InstanceConstructor._isEnum?p.$type.InstanceConstructor:p;if(values.hasOwnProperty(value)){return p.getBox(values[value])}else if(ignoreCase){var upper=value.toUpperCase();for(var x in values){if(x.toUpperCase()===upper){return p.getBox(values[x])}}}else{var firstChar=value.charAt(0);value=firstChar.toLowerCase()+value.substr(1);if(values.hasOwnProperty(value)){return p.getBox(values[value])}}}throw new Error("Invalid "+info.name+" value: "+value)},getBox:function(v){if(!this._boxes){this._boxes={}}if(!this._boxes[v]){this._boxes[v]=new this.$type.InstanceConstructor(v)}return this._boxes[v]},toString:function(){return this.$type.InstanceConstructor.prototype.$getName(this._v)},getFlaggedName:function(v,getName){var names=[];var original=v;var zeroValueName;var value;var values=[];for(var p in this){if(this.hasOwnProperty(p)){value=this[p];if(typeof this[p]=="number"){values.push(p)}}}values.sort(function(a,b){return this[a]-this[b]});for(var i=values.length-1;i>=0;i--){value=this[values[i]];if(value===0){zeroValueName=getName(0)}else if((v&value)===value){v-=value;names.unshift(getName(value))}}if(v!==0){return original.toString()}if(original!==0){return names.join(", ")}return zeroValueName||"0"},getValues:function($t){var result=[];var p=$t.InstanceConstructor._isEnum?$t.InstanceConstructor:$t.InstanceConstructor.prototype;for(var member in p){if(p.hasOwnProperty(member)){if(typeof p[member]==="number"){result.push(p[member])}}}return result},getNames:function($t){var result=[];var p=$t.InstanceConstructor._isEnum?$t.InstanceConstructor:$t.InstanceConstructor.prototype;for(var member in p){if(p.hasOwnProperty(member)){if(typeof p[member]==="number"){result.push(member)}}}return result},isDefined:function($t,value){value=$.ig.util.getValue(value);var p=$t.InstanceConstructor._isEnum?$t.InstanceConstructor:$t.InstanceConstructor.prototype;for(var member in p){if(p.hasOwnProperty(member)){if(p[member]===value){return true}}}return false},toDouble:function(provider){return this.$value()},toObject:function($t,value){return value},tryParse$1:function($tEnum,value,ignoreCase,result){try{return{ret:true,p2:this.parse($tEnum,value,ignoreCase).$value()}}catch(e){result=$.ig.util.createInstance($tEnum);return{ret:false,p2:result}}},$type:new $.ig.Type("Enum",$.ig.Object.prototype.$type,[$.ig.IConvertible.prototype.$type])},true);$.ig.$e=$.ig.Enum;$.ig.$ep=$.ig.Enum.prototype;$.ig.$et=$.ig.Enum.prototype.$type;$.ig.ValueType=Class.extend({init:function(){},$type:new $.ig.Type("ValueType",$.ig.Object.prototype.$type)},true);$.ig.INotifyPropertyChanged=Class.extend({init:function(){},_PropertyChanged:function(){},$type:new $.ig.Type("INotifyPropertyChanged")},true);$.ig.PropertyChangedEventArgs=$.ig.Object.extend({init:function(propertyName){this._propertyName=propertyName},_propertyName:null,propertyName:function(value){if(arguments.length===0){return this._propertyName}else{this._propertyName=value}},$type:new $.ig.Type("PropertyChangedEventArgs",$.ig.Object.$type)},true);$.ig.XmlNodeType=Class.extend({_None:0,_Attribute:2,_CDATA:4,_Comment:8,_Document:9,_DocumentFragment:11,_DocumentType:10,_Element:1,_EndElement:15,_EndEntity:16,_Entity:6,_EntityReference:5,_Notation:12,_ProcessingInstruction:7,_SignificantWhitespace:14,_Text:3,_Whitespace:13,_XmlDeclaration:17,none:0,element:1,attribute:2,text:3,cDATA:4,entityReference:5,entity:6,processingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12,whitespace:13,significantWhitespace:14,endElement:15,endEntity:16,xmlDeclaration:17},true);$.ig.XmlDocumentParser=Class.extend({parse:function(markup){if(!window.DOMParser){var parsers=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];for(var i=0;i<parsers.length;i++){try{var xmlDOM=new ActiveXObject(parsers[i]);xmlDOM.async=false;xmlDOM.loadXML(markup);xmlDOM.setProperty("SelectionLanguage","XPath");return xmlDOM}catch(ex){}}}else{try{var domParser=new DOMParser;return domParser.parseFromString(markup,"text/xml")}catch(ex){}}return null}},true);$.ig.Array=Array;$.ig.extendNativePrototype(Array.prototype,"add",function(item){this[this.length]=item});$.ig.addToArray=function(arr,item){arr[arr.length]=item};$.ig.indexInArray=function(arr,item){for(var i=0;i<arr.length;i++){if(arr[i]==item){return i}}return-1};$.ig.arrayContains=function(arr,item){var index=arr.indexOf(item);return index>=0};if(!Array.prototype.indexOf){$.ig.extendNativePrototype(Array.prototype,"indexOf",function(item){for(var i=0;i<this.length;i++){if(this[i]==item){return i}}return-1})}if(!Array.prototype.lastIndexOf){$.ig.extendNativePrototype(Array.prototype,"lastIndexOf",function(item){for(var i=this.length-1;i>=0;i--){if(this[i]==item){return i}}return-1})}$.ig.extendNativePrototype(Array.prototype,"copy",function(source,sourceIndex,dest,destIndex,count){for(var i=0;i<count;i++){dest[destIndex+i]=source[sourceIndex+i]}});$.ig.removeFromArray=function(arr,from,to){var rest=arr.slice((to||from)+1||arr.length);arr.length=from<0?arr.length+from:from;return arr.push.apply(arr,rest)};$.ig.extendNativePrototype(Array.prototype,"contains",function(item){var index=this.indexOf(item);return index>=0});$.ig.extendNativePrototype(Array.prototype,"insert",function(index,item){this.splice(index,0,item)});$.ig.extendNativePrototype(Array.prototype,"removeAt",function(i){this.splice(i,1)});$.ig.extendNativePrototype(Array.prototype,"removeItem",function(item){var index=this.indexOf(item);if(index>=0){this.splice(index,1);return true}return false});$.ig.extendNativePrototype(Array.prototype,"getEnumerator",function(){return new $.ig.ArrayEnumerator(this)});$.ig.extendNativePrototype(Array.prototype,"count",function(){return this.length});$.ig.extendNativePrototype(Array.prototype,"item",function(index,value){if(arguments.length===2){this[index]=value;return value}else{return this[index]}});$.ig.extendNativePrototype(Array.prototype,"getLength",function(dimension){var array=this;var dim=dimension;while(array){if(dim===0){return array.length}dim--;array=array[0]}return this.dimensionLength[dimension-1]});$.ig.extendNativePrototype(Array.prototype,"resize",function(){this.length=0});$.ig.ArrayEnumerator=Class.extend({init:function(array){this._array=array;this._index=-1},current:function(){return this._array[this._index]},moveNext:function(){this._index++;return this._index<this._array.length},reset:function(){this._index=-1},dispose:function(){}},true);$.ig.Date=Class.extend({init:function(){return new Date},fromOADate:function(value){var result=new Date(+new Date(1899,11,30)+Math.round(value*864e5));if(result.dst&&result.dst()){return $.ig.Date.prototype.addHours(result,-1)}return result},fromValues:function(year,month,day,hour,minute,second,millisecond){return new Date(year,month-1,day,hour,minute,second,millisecond)},fromTicks:function(ticks){return new Date(ticks)},addSeconds:function(value,seconds){return $.ig.Date.prototype.addDays(value,seconds/86400)},addMinutes:function(value,minutes){return $.ig.Date.prototype.addDays(value,minutes/1440)},addHours:function(value,hours){return $.ig.Date.prototype.addDays(value,hours/24)},addDays:function(value,days){var result=new Date(+value+days*864e5);if(value.dst){if(!value.dst()){if(result.dst()){result=new Date(+result-36e5)}}else{if(!result.dst()){result=new Date(+result+36e5)}}}return result},addMonths:function(value,num){var result=new Date(value.getTime());var currentMonth=result.getMonth()+result.getFullYear()*12;result.setMonth(result.getMonth()+num);var diff=result.getMonth()+result.getFullYear()*12-currentMonth;if(diff!=num){result.setDate(0)}return result},addYears:function(value,num){var result=new Date(value.getTime());result.setFullYear(result.getFullYear()+num);return result},daysInMonth:function(year,month){switch(month){case 1:return 31;case 2:return $.ig.Date.prototype.isLeapYear(year)?29:28;case 3:return 31;case 4:return 30;case 5:return 31;case 6:return 30;case 7:return 31;case 8:return 31;case 9:return 30;case 10:return 31;case 11:return 30;case 12:return 31}return 0},isLeapYear:function(year){return year%4===0&&year%100!==0},toFileTime:function(value){return(value-new Date(1600,11,31,19,0,0,0))*1e4},fromFileTime:function(value){return value/1e4+new Date(1600,11,31,19,0,0,0)},tryParse:function(s){var date=new Date(s);if(date==null||$.ig.util.isNaN(+date)){var r=/(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2}))?/.exec(s);if(r){if(r[4]){return{p1:new Date(+r[1],+r[2]-1,+r[3],+r[4],+r[5],+r[6]),ret:true}}else{return{p1:new Date(+r[1],+r[2]-1,+r[3]),ret:true}}}return{p1:null,ret:false}}if(date.getFullYear()<1930&&/\d+\/\d+\/\d\d(?!\d)/.test(s)){date.setFullYear(date.getFullYear()+100)}return{p1:date,ret:true}},parseExact:function(s,format,provider){var r=$.ig.Date.prototype.tryParse(s);if(!r.ret){throw new $.ig.FormatException("Unknown date format")}return r.p1},toLocalTime:function(value){return value},toUniversalTime:function(value){return value},getMonth:function(value){return value.getMonth()+1},today:function(value){var r=new Date;r.setHours(0,0,0,0);return r},getTimeOfDay:function(value){return value.getHours()*36e5+value.getMinutes()*6e4+value.getSeconds()*1e3+value.getMilliseconds()},getDate:function(value){return new Date(value-$.ig.Date.prototype.getTimeOfDay(value))},_requiresISOCorrection:!isNaN(+new Date("2000-01-01T00:00:00"))&&new Date("2000-01-01T00:00:00").getHours()!==0,_requiresISODateCorrection:!isNaN(new Date("2000-01-01"))&&new Date("2000-01-01").getHours()!==0,parse:function(s,provider){provider=provider||$.ig.CultureInfo.prototype.currentCulture();var result;var isoTest=/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(?:\.| )?(\d*)?/.exec(s);if(isoTest){result=$.ig.Date.prototype.parseExact(isoTest[1]);if(isoTest[2]){var ms=Number("0."+isoTest[2])*1e3;result=new Date(+result+ms)}if(!$.ig.Date.prototype._requiresISOCorrection){return result}}else{result=$.ig.Date.prototype.parseExact(s);if(!$.ig.Date.prototype._requiresISODateCorrection){return result}}return new Date(result.getUTCFullYear(),result.getUTCMonth(),result.getUTCDate(),result.getUTCHours(),result.getUTCMinutes(),result.getUTCSeconds(),result.getUTCMilliseconds())},_longDateFormatOptions:{weekday:"long",year:"numeric",month:"long",day:"numeric"},toLongDateString:function(value){return value.toLocaleString($.ig.CultureInfo.prototype.currentCulture().name(),this._longDateFormatOptions).replace(/\u200E/g,"")},_longTimeFormatOptions:{hour:"numeric",minute:"numeric",second:"numeric"},toLongTimeString:function(value){return value.toLocaleString($.ig.CultureInfo.prototype.currentCulture().name(),this._longTimeFormatOptions).replace(/\u200E/g,"")},$type:new $.ig.Type("Date",$.ig.Object.$type)},true);$.ig.extendNativePrototype(Date.prototype,"toOADate",function(){var result=(this-new Date(1899,11,30))/864e5;if(this.dst&&this.dst()){return result+1/24}return result});$.ig.extendNativePrototype(Date.prototype,"kind",function(){return $.ig.DateTimeKind.prototype.local});$.ig.Date.prototype.now=function(){return new Date};$.ig.Date.prototype.minValue=function(){return new Date(1,1,1,0,0,0,0)};$.ig.Date.prototype.maxValue=function(){return new Date(9999,12,31,23,59,59,.9999999)};$.ig.Date.prototype.fromMilliseconds=function(value){return value};$.ig.Date.prototype.toString=function(value,provider){return $.ig.Date.prototype.toStringFormat(value,"s",provider)};if(!Date.prototype.toISOString){if(!Date.prototype.toJSON){Date.prototype.toJSON=function(key){function f(n){return n<10?"0"+n:n}return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"}}Date.prototype.toISOString=Date.prototype.toJSON}$.ig.Date.prototype.toStringFormat=function(value,format,provider){var result;
provider=provider||$.ig.CultureInfo.prototype.currentCulture();switch(format){case"s":{var s=new Date(Date.UTC(value.getFullYear(),value.getMonth(),value.getDate(),value.getHours(),value.getMinutes(),value.getSeconds())).toISOString();var d=s.lastIndexOf(".");if(d<0){return s}return s.slice(0,d)}case"MMM":{var cultureName=provider.name();if(cultureName=="ja-JP"){result=value.toLocaleString("en-US",{month:"numeric"}).replace(/\u200E/g,"")}else{result=value.toLocaleString(provider.name(),{month:"short"}).replace(/\u200E/g,"")}if(result.contains(" ")){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][value.getMonth()]}return result}case"MMMM":return value.toLocaleString(provider.name(),{month:"long"}).replace(/\u200E/g,"");case"ddd":return value.toLocaleString(provider.name(),{weekday:"short"}).replace(/\u200E/g,"");case"dddd":{result=value.toLocaleString(provider.name(),{weekday:"long"}).replace(/\u200E/g,"");if(result.contains(" ")){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][value.getDay()]}return result}case"tt":return value.getHours()<=11?"AM":"PM";case"%t":return value.getHours()<=11?"A":"P"}throw new $.ig.FormatException(1,"Unknown Date format: "+format)};$.ig.util.canAssign=function(targetType,type){if(targetType.name==="Nullable$1"&&type.name!=="Nullable$1"){targetType=$.ig.Nullable.prototype.getUnderlyingType(targetType)}return $.ig.util.canAssignSimple(targetType,type)};$.ig.util.canAssignSimple=function(targetType,type){if(targetType===type||$.ig.Type.prototype.checkEquals(targetType,type)){return true}if(type.interfaces){for(var i=0;i<type.interfaces.length;i++){if($.ig.util.canAssignSimple(targetType,type.interfaces[i])){return true}}}if(type.baseType){return $.ig.util.canAssignSimple(targetType,type.baseType)}return false};$.ig.util.cast=function(targetType,obj){if(obj===undefined||obj===null){return null}if(targetType===Array){return obj instanceof Array?obj:null}if(targetType===String){targetType=$.ig.String.prototype.$type}var type=obj;if(obj.$type){type=obj.$type}else if(typeof obj==="number"){type=targetType===Number?Number:$.ig.Number.prototype.$type}else if(typeof obj==="string"){type=$.ig.String.prototype.$type}else if(typeof obj==="boolean"){type=$.ig.Boolean.prototype.$type}else if(obj instanceof Date){type=$.ig.Date.prototype.$type}if($.ig.util.canAssignSimple(targetType,type)){return obj}if(targetType.name==="Nullable$1"&&type.name!=="Nullable$1"){targetType=$.ig.Nullable.prototype.getUnderlyingType(targetType);if($.ig.util.canAssignSimple(targetType,type)){return $.ig.util.toNullable(targetType,obj)}return $.ig.util.toNullable(targetType,null)}return null};$.ig.Dictionary=Class.extend({init:function(){this.proxy={};this.keysHolder=this.proxy;this._count=0},$type:new $.ig.Type("Dictionary",$.ig.Object.prototype.$type),proxy:null},true);$.ig.Dictionary.prototype.getDictionary=function(o){var dict=new $.ig.Dictionary;dict.proxy=o;dict.keysHolder=o;return dict};$.ig.Dictionary.prototype.containsKey=function(key){return this.proxy[key]!==undefined};$.ig.Dictionary.prototype.count=function(){return this._count};$.ig.Dictionary.prototype.item=function(key,value){if(arguments.length===1){return this.proxy[key]}else{if(!this.proxy[key]){this._count++}this.proxy[key]=value}};$.ig.Dictionary.prototype.add=function(key,value){if(!this.proxy[key]){this._count++}this.proxy[key]=value};$.ig.Dictionary.prototype.remove=function(key){delete this.proxy[key];this._count--};$.ig.Dictionary.prototype.keys=function(){return new $.ig.KeyEnumerator(this)};$.ig.Dictionary.prototype.values=function(){return new $.ig.ValueEnumerator(this)};$.ig.Dictionary.prototype.clear=function(){this.proxy={};this.keysHolder=this.proxy;this._count=0};$.ig.EventArgs=$.ig.Object.extend({init:function(){}},true);$.ig.String=Class.extend({$type:new $.ig.Type("String",$.ig.Object.prototype.$type,[$.ig.IConvertible.prototype.$type,$.ig.IComparable.prototype.$type])},true);$.ig.String.prototype.isDigit=function(str,index){index=index||0;var ch=str.charAt(index);if(ch>="0"&&ch<="9"){return true}return false};$.ig.String.prototype.charMaxValue=function(s){return"￿"};$.ig.String.prototype.charMinValue=function(s){return"\0"};$.ig.Boolean=Class.extend({tryParse:function(value){value=value.toLowerCase();if(value=="true"){return{p1:true,ret:true}}else if(value=="false"){return{p1:false,ret:true}}return{p1:false,ret:false}},$type:new $.ig.Type("Boolean",$.ig.Object.prototype.$type,[$.ig.IConvertible.prototype.$type,$.ig.IComparable.prototype.$type])},true);$.ig.Number=Class.extend({$type:new $.ig.Type("Number",$.ig.Object.prototype.$type,[$.ig.IConvertible.prototype.$type,$.ig.IComparable.prototype.$type])},true);$.ig.Number.prototype.parseInt=function(a,b){return parseInt(a,b)};$.ig.Number.prototype.log10=function(x){return Math.log(x)/Math.log(10)};if(!Number.isPrimitive){Number.isPrimitive=function(){return true}}if(!String.isPrimitive){String.isPrimitive=function(){return false}}$.ig.extendNativePrototype(String.prototype,"toDateTime",function(provider){var result=new Date(this);if(!isNaN(+result)){return result}if(/^((([0-9]{1,4})\s*(\s+((a|p)m?)\s*))|(([0-9]{1,4})\s*:\s*([0-9]?[0-9])\s*(:\s*([0-9]?[0-9])\s*(.\s*([0-9]{0,4})[0-9]*\s*)?)?(\s+((a|p)m?)\s*)?)|(\s*([0-9]?[0-9])\s*:\s*([0-9]?[0-9])\s*.\s*([0-9]{0,4})[0-9]*\s*(\s+((a|p)m?)\s*)?))$/i.test(this)){return new Date((new Date).toDateString()+" "+this)}throw new $.ig.FormatException(1,"The string cannot be converted to a date")});$.ig.extendNativePrototype(String.prototype,"toDecimal",function(provider){var result=+this;if($.ig.util.isNaN(result)){throw new $.ig.FormatException(1,"The string cannot be converted to a number")}return result});$.ig.extendNativePrototype(String.prototype,"toString1",function(provider){return this.toString()});String.isInstanceOfType=function(value){return typeof value=="string"};$.ig.extendNativePrototype(Number.prototype,"toDecimal",function(provider){return+this});$.ig.extendNativePrototype(Number.prototype,"toDouble",function(provider){return+this});$.ig.extendNativePrototype(Number.prototype,"toString1",function(provider){return this.toLocaleString(provider.name(),{useGrouping:false})});$.ig.extendNativePrototype(Date.prototype,"getType",function(provider){return $.ig.Date.prototype.$type});$.ig.extendNativePrototype(Date.prototype,"equals",function(other){return other instanceof Date&&+this===+other});$.ig.extendNativePrototype(Boolean.prototype,"getHashCode",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toByte",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toSByte",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toInt16",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toUInt16",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toInt32",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toUInt32",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toInt64",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toUInt64",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toSingle",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toDouble",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toDecimal",function(provider){return+this});$.ig.extendNativePrototype(Boolean.prototype,"toBoolean",function(provider){return!!+this});$.ig.extendNativePrototype(Boolean.prototype,"toString1",function(provider){return this.toString()});$.ig.extendNativePrototype(Boolean.prototype,"compareTo",function(other){return $.ig.util.boolCompare(this,other)});$.ig.extendNativePrototype(Number.prototype,"compareTo",function(other){return $.ig.util.compareSimple(+this,other)});$.ig.Single=Class.extend({},true);$.ig.Single.prototype.parseFloat=function(s){return parseFloat(s)};$.ig.Single.prototype.isInfinity=function(s){return s===Infinity||s===-Infinity};$.ig.Int32=Class.extend({$type:new $.ig.Type("Int32",$.ig.Object.prototype.$type,[$.ig.IComparable.prototype.$type,$.ig.IComparable$1.prototype.$type.specialize(-1),$.ig.IEquatable$1.prototype.$type.specialize(-1)])},true);$.ig.Int32.prototype.$type.initSelfReferences();$.ig.Double=Class.extend({$type:new $.ig.Type("Double",$.ig.Object.prototype.$type)},true);$.ig.Delegate=Class.extend({$type:new $.ig.Type("Delegate",$.ig.Object.prototype.$type)},true);$.ig.Delegate.prototype.combine=function(del1,del2){if(!del1){return del2}if(!del2){return del1}var ret=function(){del1.apply(null,arguments);return del2.apply(null,arguments)};ret.enumerate=function(arr){if(del1){if(del1.enumerate){del1.enumerate(arr)}else{arr.push(del1)}}if(del2){if(del2.enumerate){del2.enumerate(arr)}else{arr.push(del2)}}};return ret};$.ig.Delegate.prototype.remove=function(del1,del2){if(!del1){return null}if(!del2){return del1}var arr=[];var del=null;if(del1.enumerate){del1.enumerate(arr)}else{arr.push(del1)}for(var i=0;i<arr.length;i++){if(del2.original){if(arr[i].original==del2.original&&arr[i].target==del2.target){continue}}if(arr[i]==del2){continue}del=$.ig.Delegate.prototype.combine(del,arr[i])}return del};$.ig.ReflectionUtil=Class.extend({$type:new $.ig.Type("ReflectionUtil",$.ig.Object.prototype.$type)},true);$.ig.ReflectionUtil.prototype.getPropertyGetter=function(type,propertyName){if(typeof type.prototype[propertyName]==="function"){return function(instance){return type.prototype[propertyName].apply(instance,arguments)}}return function(instance){return instance[propertyName]}};$.ig.IEnumerable=Class.extend({$type:new $.ig.Type("IEnumerable",null)},true);$.ig.IEnumerator=Class.extend({$type:new $.ig.Type("IEnumerator",null)},true);$.ig.IEqualityComparer$1=Class.extend({$type:new $.ig.Type("IEqualityComparer",$.ig.Object.prototype.$type)},true);$.ig.IList=Class.extend({$type:new $.ig.Type("IList",null,[$.ig.IEnumerable.prototype.$type])},true);$.ig.IEnumerable$1=Class.extend({$type:new $.ig.Type("IEnumerable$1",null,[$.ig.IEnumerable.prototype.$type])},true);$.ig.ICollection$1=Class.extend({$type:new $.ig.Type("ICollection$1",null,[$.ig.IEnumerable$1.prototype.$type.specialize(0),$.ig.IEnumerable.prototype.$type])},true);$.ig.IList$1=Class.extend({$type:new $.ig.Type("IList$1",null,[$.ig.ICollection$1.prototype.$type.specialize(0),$.ig.IEnumerable$1.prototype.$type.specialize(0),$.ig.IEnumerable.prototype.$type])},true);$.ig.IEnumerator$1=Class.extend({$type:new $.ig.Type("IEnumerator$1",null,[$.ig.IEnumerator.prototype.$type])},true);$.ig.Error=Class.extend({init:function(initNumber){if(initNumber>0){switch(initNumber){case 1:this.init1.apply(this,arguments);break;case 2:this.init2.apply(this,arguments);break}return}this.__message=null;this.__innerException=null},init1:function(initNumber,message){this.__message=message},init2:function(initNumber,message,innerException){this.__message=message;this.__innerException=innerException},toString:function(){return this.message()},$type:new $.ig.Type("Error",$.ig.Object.prototype.$type)},true);$.ig.Error.prototype.message=function(){return this.__message};$.ig.Error.prototype.innerException=function(){return this.__innerException};$.ig.IDictionary=Class.extend({$type:new $.ig.Type("IDictionary",null)},true);$.ig.ValueEnumerator=Class.extend({init:function(dict){this._dict=dict;this._index=-1;this._count=0;this._values=[];for(var item in this._dict.proxy){if(this._dict.proxy.hasOwnProperty(item)){this._values[this._count]=this._dict.proxy[item];this._count++}}},current:function(){return this._values[this._index]},dispose:function(){},moveNext:function(){this._index++;return this._index<this._count},reset:function(){this._index=-1},getEnumerator:function(){this.reset();return this},$type:new $.ig.Type("ValueEnumerator",$.ig.Object.prototype.$type,[$.ig.IEnumerable.prototype.$type])},true);$.ig.KeyEnumerator=Class.extend({init:function(dict){this._dict=dict;this._index=-1;this._count=0;this._keys=[];for(var item in this._dict.proxy){if(this._dict.proxy.hasOwnProperty(item)){this._keys[this._count]=item;this._count++}}},current:function(){return this._keys[this._index]},moveNext:function(){this._index++;return this._index<this._count},reset:function(){this._index=-1},getEnumerator:function(){this.reset();return this},$type:new $.ig.Type("KeyEnumerator",$.ig.Object.prototype.$type,[$.ig.IEnumerable.prototype.$type])},true);$.ig.truncate=function(val){if(val>=0){return Math.floor(val)}else{return Math.ceil(val)}};$.ig.intDivide=function(int1,int2){var result=int1/int2;return $.ig.truncate(result)};$.ig.Nullable=Class.extend({getUnderlyingType:function(nullableType){if(nullableType.isGenericType!==undefined&&nullableType.isGenericType()&&!nullableType.isGenericTypeDefinition()&&$.ig.Nullable$1.prototype.$type.typeName()==nullableType.typeName()){return nullableType.genericTypeArguments()[0]}return null},$type:new $.ig.Type("Nullable",$.ig.Object.prototype.$type)},true);$.ig.Nullable$1=Class.extend({$t:null,init:function($t,value){this.$t=$t;this.$type=this.$type.specialize(this.$t);$.ig.Object.prototype.init.call(this);if(value!==undefined){this._value=value}},equals:function(value){return $.ig.util.nullableEquals(this,value)},getHashCode:function(){return this._value===null?0:this._value.getHashCode()},hasValue:function(){return this._value!==null},toString:function(){return this._value===null?"":this._value.toString()},_value:null,value:function(value){if(arguments.length===1){this._value=value;return value}else{return this._value}},getValueOrDefault:function(){if(this.hasValue()){return this._value}else{return this.getDefaultValue()}},getDefaultValue:function(){if($.ig.util.canAssign($.ig.Number.prototype.$type,this.$t)){return 0}else if($.ig.util.canAssign($.ig.Boolean.prototype.$type,this.$t)){return false}else if(this.$t.baseType==$.ig.ValueType.prototype.$type){return $.ig.util.createInstance(this.$t)}else{return null}},getValueOrDefault1:function(defaultValue){if(this.hasValue()){return this._value}else{return defaultValue}},preIncrement:function(){if(!this.hasValue()){return this}this._value++;return this},preDecrement:function(){if(!this.hasValue()){return this}this._value--;return this},postIncrement:function(){if(!this.hasValue()){return this}var originalValue=this._value;this._value++;return new $.ig.Nullable$1(this.$t,originalValue)},postDecrement:function(){if(!this.hasValue()){return this}var originalValue=this._value;this._value--;return new $.ig.Nullable$1(this.$t,originalValue)},isNullable:true,$type:new $.ig.Type("Nullable$1",$.ig.Object.prototype.$type)},true);$.ig.util.toNullable=function(t,value){if(value==null){return t._$nullNullable||(t._$nullNullable=new $.ig.Nullable$1(t,value))}else if(value.isNullable){return value}return new $.ig.Nullable$1(t,value)};$.ig.util.toLowerCase=function(c){return c.toLowerCase()};$.ig.util.isLower=function(c){return c===c.toLowerCase()};$.ig.util.isLetterOrDigit=function(c){var charCode=c.charCodeAt(0);if(97<=charCode&&charCode<=122){return true}if(65<=charCode&&charCode<=90){return true}if(48<=charCode&&charCode<=57){return true}if(charCode<=127){return false}return $.ig.unicode_hack("(\\p{L}|\\p{Nd})").test(c)};$.ig.util.isLetter=function(c){var charCode=c.charCodeAt(0);if(97<=charCode&&charCode<=122){return true}if(65<=charCode&&charCode<=90){return true}if(charCode<=127){return false}return $.ig.unicode_hack("\\p{L}").test(c)};$.ig.util.isDigit1=function(c,index){return $.ig.util.isDigit(c[index])};$.ig.util.isDigit=function(c){var charCode=c.charCodeAt(0);if(48<=charCode&&charCode<=57){return true}if(charCode<=127){return false}return $.ig.unicode_hack("\\p{Nd}").test(c)};$.ig.util.isNumber=function(c){var charCode=c.charCodeAt(0);if(48<=charCode&&charCode<=57){return true}if(charCode<=127){return false}return $.ig.unicode_hack("\\p{N}").test(c)};$.ig.util.toUpperCase=function(c){return c.toUpperCase()};$.ig.util.concat=function(v1,v2){if(v1==null){v1=""}else if(!!v1.isNullable){v1=v1.getValueOrDefault1("")}if(v2==null){v2=""}else if(!!v2.isNullable){v2=v2.getValueOrDefault1("")}return v1.toString()+v2.toString()};$.ig.util.nullableAdd=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return null}if(v2.isNullable&&!v2.hasValue()){return null}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,val1+val2)};$.ig.util.nullableSubtract=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return null}if(v2.isNullable&&!v2.hasValue()){return null}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,val1-val2)};$.ig.util.nullableMultiply=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return null}if(v2.isNullable&&!v2.hasValue()){return null}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,val1*val2)};$.ig.util.nullableDivide=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return null}if(v2.isNullable&&!v2.hasValue()){return null}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,val1/val2)};$.ig.util.nullableModulus=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return null}if(v2.isNullable&&!v2.hasValue()){return null}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,val1%val2)};$.ig.util.nullableGreaterThan=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return false}if(v2.isNullable&&!v2.hasValue()){return false}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return val1>val2};$.ig.util.nullableGreaterThanOrEqual=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return false}if(v2.isNullable&&!v2.hasValue()){return false}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return val1>=val2};$.ig.util.nullableLessThan=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return false}if(v2.isNullable&&!v2.hasValue()){return false}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return val1<val2};$.ig.util.nullableLessThanOrEqual=function(v1,v2){if(v1.isNullable&&!v1.hasValue()){return false}if(v2.isNullable&&!v2.hasValue()){return false}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return val1<=val2};$.ig.util.nullableIsNull=function(v){return v==null||!!v.isNullable&&!v.hasValue()};$.ig.util.nullableEquals=function(v1,v2){var v1IsNull=v1==null||!!v1.isNullable&&!v1.hasValue();var v2IsNull=v2==null||!!v2.isNullable&&!v2.hasValue();if(v1IsNull&&v2IsNull){return true}if(v1IsNull!=v2IsNull){return false}var val1=v1;var val2=v2;if(v1.isNullable){val1=v1.value()}if(v2.isNullable){val2=v2.value()}return val1==val2};$.ig.util.nullableNotEquals=function(v1,v2){return!$.ig.util.nullableEquals(v1,v2)};$.ig.util.unwrapNullable=function(v){if(v==null||!v.isNullable){return v}if(!v.hasValue()){return null}return v.value()};$.ig.util.wrapNullable=function($t,v){if(v!=null&&v.isNullable){return v}return $.ig.util.toNullable($t,v)};$.ig.util.getColorStringSafe=function(v){return v==null?null:v.colorString()};$.ig.util.wellKnownColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};$.ig.util.stringToColor=function(str){var ret={a:255,r:0,g:0,b:0};var asColorName=str.replace(" ","").toLowerCase();if(asColorName==="transparent"){return{a:0,r:0,g:0,b:0}}if($.ig.util.wellKnownColors[asColorName]!==undefined){str=$.ig.util.wellKnownColors[asColorName]}var parts;if(str.lastIndexOf("rgba",0)===0){str=str.replace("rgba","").replace(" ","").replace("(","").replace(")","");parts=str.split(",");ret.r=parseInt(parts[0],10);ret.g=parseInt(parts[1],10);ret.b=parseInt(parts[2],10);ret.a=parseFloat(parts[3])*255}else if(str.lastIndexOf("rgb",0)===0){str=str.replace("rgb","").replace(" ","").replace("(","").replace(")","");parts=str.split(",");ret.r=parseInt(parts[0],10);ret.g=parseInt(parts[1],10);ret.b=parseInt(parts[2],10)}else{str=str.replace("#","").replace(" ","");if(str.length===6){ret.r=parseInt(str.substr(0,2),16);ret.g=parseInt(str.substr(2,2),16);ret.b=parseInt(str.substr(4,2),16)}else if(str.length===3){ret.r=parseInt(str.substr(0,1)+str.substr(0,1),16);ret.g=parseInt(str.substr(1,1)+str.substr(1,1),16);ret.b=parseInt(str.substr(2,1)+str.substr(2,1),16)}}return ret};$.ig.util.isResponseTypeSupported=function(responseType){var xhr=null;try{xhr=new XMLHttpRequest;xhr.open("GET","/");xhr.responseType=responseType}catch(e){return false}if(xhr===null){return false}return xhr.responseType===responseType};$.ig.util.getBinary=function(url,callback,error){var data,ret,req,useVbArray=false,arrayBufferSupported=$.ig.util.isResponseTypeSupported("arraybuffer")&&typeof Uint8Array!="undefined";if(typeof XMLHttpRequest=="undefined"){try{req=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{req=new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}req=new ActiveXObject("Microsoft.XMLHTTP")}else{req=new XMLHttpRequest}if(!arrayBufferSupported){if(req.overrideMimeType){req.overrideMimeType("text/plain; charset=x-user-defined")}}if(typeof VBArray!="undefined"){useVbArray=true}req.onreadystatechange=function(){if(req.readyState==4){if(req.status==200){if(arrayBufferSupported&&typeof this.response!="undefined"){callback(new Uint8Array(this.response))}else{if(useVbArray){data=new VBArray(req.responseBody).toArray();for(var i=0;i<data.length;i++){data[i]=String.fromCharCode(data[i])}ret=data.join("");callback(ret)}else{callback(req.responseText)}}}else{error(req.error)}}};req.open("GET",url,true);if(arrayBufferSupported){req.responseType="arraybuffer"}req.send(null)};$.ig.util.extCopy=function(source,bindings){var i,j,k;if(typeof source=="undefined"||!source){return}for(j=0;j<bindings.length;j++){var dests=bindings[j][0];var meths=bindings[j][1];for(k=0;k<dests.length;k++){for(i=0;i<meths.length;i++){if(typeof dests[k]=="undefined"||!dests[k]||typeof meths[i]=="undefined"||!meths[i]){continue}$.ig.extendNativePrototype(dests[k].prototype,meths[i],source.prototype[meths[i]])}}}};$.ig.$currDefinitions=null;$.ig.$allDefinitions=[];$.ig.util.getDefinedNameAndNamespace=function(name){var ns=$.ig;var nParts=name.split(".");if(nParts.length!=1){for(var i=0;i<nParts.length-1;i++){var nsName=nParts[i];if(!ns[nsName]){ns[nsName]={}}ns=ns[nsName]}name=nParts[nParts.length-1]}return{name:name,namespace:ns}};$.ig.util.bulkDefine=function(toDefine){var i=0,curr=null,els=null;for(i=0;i<toDefine.length;i++){curr=toDefine[i];els=curr.split(":");curr=els[0];var info=$.ig.util.getDefinedNameAndNamespace(curr);info.namespace[info.name]=info.namespace[info.name]||Class.extend({$type:new $.ig.Type(curr,$.ig.Object.prototype.$type),$placeholder:true},true);if(els.length>1&&$.ig.$currDefinitions){$.ig.$currDefinitions[els[1]]=info.namespace[info.name];$.ig.$currDefinitions["$"+els[1]]=info.namespace[info.name].prototype;$.ig.$currDefinitions["$_"+curr]=els[1]}if($.ig.$allDefinitions&&$.ig.$allDefinitions.indexOf($.ig.$currDefinitions)<0){$.ig.$allDefinitions.push($.ig.$currDefinitions)}}};$.ig.util.defType=function(name,baseName,definition){var els=null,i,currDefs,shortName;els=name.split(":");name=els[0];var info=$.ig.util.getDefinedNameAndNamespace(name);var result=info.namespace[info.name];if(!result||result.prototype.$placeholder){var baseInfo=$.ig.util.getDefinedNameAndNamespace(baseName);result=baseInfo.namespace[baseInfo.name].extend(definition);info.namespace[info.name]=result}if(els.length>1&&$.ig.$currDefinitions){$.ig.$currDefinitions[els[1]]=result;$.ig.$currDefinitions["$"+els[1]]=result.prototype;$.ig.$currDefinitions["$_"+name]=els[1];if($.ig.$allDefinitions){for(i=0;i<$.ig.$allDefinitions.length;i++){currDefs=$.ig.$allDefinitions[i];if(currDefs["$_"+name]!==undefined){shortName=currDefs["$_"+name];currDefs[shortName]=result;currDefs["$"+shortName]=result.prototype}}}}return result};$.ig.util.getClassCount=function(classNamePrefix,isPrefix){var styleSheets=document.styleSheets,numFound=0,count=0,currSheet,rules,currSelector,currVal;classNamePrefix=classNamePrefix.toLowerCase();if(!styleSheets){return 0}for(var i=0;i<styleSheets.length;i++){try{currSheet=styleSheets[i];rules=currSheet.rules?currSheet.rules:currSheet.cssRules;if(!rules){continue}for(var j=0;j<rules.length;j++){currSelector=rules[j].selectorText;if(currSelector){currSelector=currSelector.toLowerCase();if(isPrefix){if(currSelector.indexOf(classNamePrefix)===0){currVal=parseInt(currSelector.replace(classNamePrefix,""),10);if(isNaN(currVal)){count++}else{numFound=Math.max(numFound,currVal)}}}else{if(currSelector==classNamePrefix){numFound++}}}}}catch(e){}}return Math.max(numFound,count)};$.ig.util._isCanvasSupported=function(){var canvas=document.createElement("canvas");return!!(canvas.getContext&&canvas.getContext("2d"))};$.ig.util._renderUnsupportedBrowser=function(widget,locale){if(!widget.events||!widget.events.browserNotSupported||widget._trigger(widget.events.browserNotSupported)){var elem=widget.element,o=widget.options,container=$("<div></div>").css("overflow","auto").addClass(widget.css.unsupportedBrowserClass).appendTo(elem),ul,browserUnsupported;locale=locale||$.ig.util.locale;if($.ig.util.isIE){browserUnsupported="Internet Explorer "+$.ig.util.browserVersion}else if($.ig.util.isOpera){browserUnsupported="Opera "+$.ig.util.browserVersion}else if($.ig.util.isWebKit){browserUnsupported="Webkit "+$.ig.util.browserVersion}else if($.ig.util.isFF){browserUnsupported="Mozilla Firefox "+$.ig.util.browserVersion}else{browserUnsupported=$.ig.util.browserVersion}$("<div></div>").addClass("ui-html5-current-browser-label").html(locale.currentBrowser.replace("{0}",browserUnsupported)).appendTo(container);$("<div></div>").addClass("ui-html5-non-html5-text").html(locale.unsupportedBrowser).appendTo(container);ul=$("<ul></ul>").addClass("ui-html5-browsers-list").appendTo(container);$("<a></a>").attr("href",locale.chromeDownload).attr("target","_blank").addClass("ui-html5-chrome-icon").html(locale.chrome8).appendTo($("<li></li>").addClass("ui-corner-all").appendTo(ul));$("<a></a>").attr("href",locale.firefoxDownload).attr("target","_blank").addClass("ui-html5-firefox-icon").html(locale.firefox36).appendTo($("<li></li>").addClass("ui-corner-all").appendTo(ul));$("<a></a>").attr("href",locale.operaDownload).attr("target","_blank").addClass("ui-html5-Opera-icon").html(locale.opera11).appendTo($("<li></li>").addClass("ui-corner-all").appendTo(ul));$("<a></a>").attr("href",locale.safariDownload).attr("target","_blank").addClass("ui-html5-safari-icon").html(locale.safari5).appendTo($("<li></li>").addClass("ui-corner-all").appendTo(ul));$("<a></a>").attr("href",locale.ieDownload).attr("target","_blank").addClass("ui-html5-ie-icon").html(locale.ie9).appendTo($("<li></li>").addClass("ui-corner-all").appendTo(ul));if(widget.css.unsupportedBrowserClass.indexOf(" ui-html5-non-html5")===-1){elem.addClass("ui-html5-non-html5")}if(o.width){elem.css("width",o.width)}if(o.height){elem.css("height",o.height)}}};$.ig.CultureInfo=Class.extend({_name:null,_isInvariant:false,init:function(name){this._name=name},clone:function(){var copy=new $.ig.CultureInfo(this._name);for(var attr in this){if(this.hasOwnProperty(attr)){copy[attr]=this[attr]}}if(copy._dateTimeFormat){copy._dateTimeFormat=copy._dateTimeFormat.clone()}if(copy._numberFormat){copy._numberFormat=copy._numberFormat.clone()}return copy},compareInfo:function(){return new $.ig.CompareInfo},getFormat:function($t){if($t===$.ig.NumberFormatInfo.prototype.$type){return this.numberFormat()}if($t===$.ig.DateTimeFormat.prototype.$type){return this.dateTimeFormat()}throw new Error("Unknown format type")},name:function(){return this._name},calendar:function(){return new $.ig.Calendar},dateTimeFormat:function(value){if(arguments.length===1){this._dateTimeFormat=value}if(!this._dateTimeFormat){this._dateTimeFormat=new $.ig.DateTimeFormat(this._name,this._isInvariant)}return this._dateTimeFormat},numberFormat:function(value){if(arguments.length===1){this._numberFormat=value}if(!this._numberFormat){this._numberFormat=new $.ig.NumberFormatInfo(this._name,this._isInvariant)}return this._numberFormat},twoLetterISOLanguageName:function(){if(this._name.length>2&&this._name[2]=="-")return this._name.substr(0,2);return""},getCultureInfo:function(lcid){var name=globalInfo[lcid];if(name){if(name==="invariant"){return $.ig.CultureInfo.prototype.invariantCulture()}return new $.ig.CultureInfo(name)}return $.ig.CultureInfo.prototype.invariantCulture()},$type:new $.ig.Type("CultureInfo",$.ig.Object.prototype.$type)},true);$.ig.CultureInfo.prototype.currentCulture=function(){return $.ig.Thread.prototype.currentThread().currentCulture()};$.ig.CultureInfo.prototype.invariantCulture=function(){if(this._cachedInvariant){return this._cachedInvariant}this._cachedInvariant=new $.ig.CultureInfo("en-US");this._cachedInvariant._isInvariant=true;return this._cachedInvariant};$.ig.Calendar=Class.extend({init:function(){},eras:function(){return[1]
},getEra:function(time){return 1},getDayOfMonth:function(time){return time.getDate()},getDaysInMonth:function(year,month,era){return $.ig.Date.prototype.daysInMonth(year,month)},getDaysInYear:function(year,era){return $.ig.Date.prototype.isLeapYear(year)?366:365},getMonth:function(time){return $.ig.Date.prototype.getMonth(time)},getYear:function(time){return time.getFullYear()},toDateTime:function(year,month,day,hour,minute,second,millisecond,era){return $.ig.Date.prototype.fromValues(year,month,day,hour,minute,second,millisecond)},$type:new $.ig.Type("Calendar",$.ig.Object.prototype.$type)},true);$.ig.util.defType("CompareInfo","Object",{init:function(){},compare1:function(string1,offset1,length1,string2,offset2,length2,options){var v1=string1.substr(offset1,length1);var v2=string2.substr(offset2,length2);if((options&$.ig.CompareOptions.prototype.ignoreCase)!==0){v1=v1.toLowerCase();v2=v2.toLowerCase()}return $.ig.util.compare(v1,v2)},compare4:function(string1,string2){return this.compare5(string1,string2,$.ig.CompareOptions.prototype.none)},compare5:function(string1,string2,options){return this.compare1(string1,0,string1.length,string2,0,string2.length,options)},indexOf1:function(source,value){return this.indexOf6(source,value,0,$.ig.CompareOptions.prototype.none)},indexOf3:function(source,value,options){return this.indexOf6(source,value,0,options)},indexOf6:function(source,value,startIndex,options){if((options&$.ig.CompareOptions.prototype.ignoreCase)!==0){source=source.toLowerCase();value=value.toLowerCase()}return source.indexOf(value,startIndex)},indexOf5:function(source,value,options){return source.indexOf(value)},referenceEquals:function(a,b){return a===b},$type:new $.ig.Type("CompareInfo",$.ig.Object.prototype.$type)},true);$.ig.DateTimeFormat=Class.extend({init:function(cultureName,isInvariant){this._cultureName=cultureName;this._isInvariant=isInvariant},clone:function(){var copy=new $.ig.DateTimeFormat(this._cultureName,this._isInvariant);for(var attr in this){if(this.hasOwnProperty(attr)){copy[attr]=this[attr]}}return copy},dateSeparator:function(value){if(arguments.length===1){this._dateSeparator=value}if(!this._dateSeparator){this._dateSeparator="/"}return this._dateSeparator},timeSeparator:function(value){if(arguments.length===1){this._timeSeparator=value}if(!this._timeSeparator){this._timeSeparator=":"}return this._timeSeparator},longDatePattern:function(value){if(arguments.length===1){this._longDatePattern=value}if(!this._longDatePattern){this._longDatePattern="dddd, MMMM d, yyyy"}return this._longDatePattern},shortDatePattern:function(value){if(arguments.length===1){this._shortDatePattern=value}if(!this._shortDatePattern){var g=globalInfo[this._isInvariant?"invariant":this._cultureName];if(g){this._shortDatePattern=g.d}else{this._shortDatePattern="M/d/yyyy"}}return this._shortDatePattern},shortTimePattern:function(value){if(arguments.length===1){this._shortTimePattern=value}if(!this._shortTimePattern){this._shortTimePattern="h:mm tt"}return this._shortTimePattern},$type:new $.ig.Type("DateTimeFormat",$.ig.Object.prototype.$type)},true);var globalInfo={invariant:{c:"¤",d:"MM/dd/yyyy"},127:"invariant",af:{c:"R",d:"yyyy/MM/dd"},54:"af","af-ZA":{c:"R",d:"yyyy/MM/dd"},1078:"af-ZA",am:{c:"ETB",d:"d/M/yyyy"},94:"am","am-ET":{c:"ETB",d:"d/M/yyyy"},1118:"am-ET",ar:{c:"ر.س.‏",d:"dd/MM/yy",n:"٠١٢٣٤٥٦٧٨٩"},1:"ar","ar-AE":{c:"د.إ.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},14337:"ar-AE","ar-BH":{c:"د.ب.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},15361:"ar-BH","ar-DZ":{c:"د.ج.‏",d:"dd-MM-yyyy"},5121:"ar-DZ","ar-EG":{c:"ج.م.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},3073:"ar-EG","ar-IQ":{c:"د.ع.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},2049:"ar-IQ","ar-JO":{c:"د.ا.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},11265:"ar-JO","ar-KW":{c:"د.ك.‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},13313:"ar-KW","ar-LB":{c:"ل.ل.‏‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},12289:"ar-LB","ar-LY":{c:"د.ل.‏‏",d:"dd/MM/yyyy"},4097:"ar-LY","ar-MA":{c:"د.م.‏‏",d:"dd-MM-yyyy"},6145:"ar-MA",arn:{c:"$",d:"dd-MM-yyyy"},122:"arn","arn-CL":{c:"$",d:"dd-MM-yyyy"},1146:"arn-CL","ar-OM":{c:"ر.ع.‏‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},8193:"ar-OM","ar-QA":{c:"ر.ق.‏‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},16385:"ar-QA","ar-SA":{c:"ر.س.‏",d:"dd/MM/yy",n:"٠١٢٣٤٥٦٧٨٩"},1025:"ar-SA","ar-SY":{c:"ل.س.‏‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},10241:"ar-SY","ar-TN":{c:"د.ت.‏‏",d:"dd-MM-yyyy"},7169:"ar-TN","ar-YE":{c:"ر.ي.‏‏",d:"dd/MM/yyyy",n:"٠١٢٣٤٥٦٧٨٩"},9217:"ar-YE",as:{c:"₹",d:"dd-MM-yyyy",n:"০১২৩৪৫৬৭৮৯"},77:"as","as-IN":{c:"₹",d:"dd-MM-yyyy",n:"০১২৩৪৫৬৭৮৯"},1101:"as-IN",az:{c:"man.",d:"dd.MM.yyyy"},44:"az","az-Cyrl":{c:"ман.",d:"dd.MM.yyyy"},29740:"az-Cyrl","az-Cyrl-AZ":{c:"ман.",d:"dd.MM.yyyy"},2092:"az-Cyrl-AZ","az-Latn":{c:"man.",d:"dd.MM.yyyy"},30764:"az-Latn","az-Latn-AZ":{c:"man.",d:"dd.MM.yyyy"},1068:"az-Latn-AZ",ba:{c:"₽",d:"dd.MM.yy"},109:"ba","ba-RU":{c:"₽",d:"dd.MM.yy"},1133:"ba-RU",be:{c:"Br",d:"dd.MM.yy"},35:"be","be-BY":{c:"Br",d:"dd.MM.yy"},1059:"be-BY",bg:{c:"лв.",d:"d.M.yyyy 'г.'"},2:"bg","bg-BG":{c:"лв.",d:"d.M.yyyy 'г.'"},1026:"bg-BG",bn:{c:"₹",d:"dd-MM-yy",n:"০১২৩৪৫৬৭৮৯"},69:"bn","bn-BD":{c:"৳",d:"dd-MM-yy",n:"০১২৩৪৫৬৭৮৯"},2117:"bn-BD","bn-IN":{c:"₹",d:"dd-MM-yy",n:"০১২৩৪৫৬৭৮৯"},1093:"bn-IN",bo:{c:"¥",d:"yyyy/M/d",n:"༠༡༢༣༤༥༦༧༨༩"},81:"bo","bo-CN":{c:"¥",d:"yyyy/M/d",n:"༠༡༢༣༤༥༦༧༨༩"},1105:"bo-CN",br:{c:"€",d:"dd/MM/yyyy"},126:"br","br-FR":{c:"€",d:"dd/MM/yyyy"},1150:"br-FR",bs:{c:"KM",d:"d.M.yyyy"},30746:"bs","bs-Cyrl":{c:"КМ",d:"d.M.yyyy"},25626:"bs-Cyrl","bs-Cyrl-BA":{c:"КМ",d:"d.M.yyyy"},8218:"bs-Cyrl-BA","bs-Latn":{c:"KM",d:"d.M.yyyy"},26650:"bs-Latn","bs-Latn-BA":{c:"KM",d:"d.M.yyyy"},5146:"bs-Latn-BA",ca:{c:"€",d:"dd/MM/yyyy"},3:"ca","ca-ES":{c:"€",d:"dd/MM/yyyy"},1027:"ca-ES","ca-ES-valencia":{c:"€",d:"dd/MM/yy"},2051:"ca-ES-valencia",chr:{c:"$",d:"M/d/yyyy"},92:"chr","chr-Cher":{c:"$",d:"M/d/yyyy"},31836:"chr-Cher","chr-Cher-US":{c:"$",d:"M/d/yyyy"},1116:"chr-Cher-US",co:{c:"€",d:"dd/MM/yyyy"},131:"co","co-FR":{c:"€",d:"dd/MM/yyyy"},1155:"co-FR",cs:{c:"Kč",d:"d. M. yyyy"},5:"cs","cs-CZ":{c:"Kč",d:"d. M. yyyy"},1029:"cs-CZ",cy:{c:"£",d:"dd/MM/yy"},82:"cy","cy-GB":{c:"£",d:"dd/MM/yy"},1106:"cy-GB",da:{c:"kr.",d:"dd-MM-yyyy"},6:"da","da-DK":{c:"kr.",d:"dd-MM-yyyy"},1030:"da-DK",de:{c:"€",d:"dd.MM.yyyy"},7:"de","de-AT":{c:"€",d:"dd.MM.yyyy"},3079:"de-AT","de-CH":{c:"Fr.",d:"dd.MM.yyyy"},2055:"de-CH","de-DE":{c:"€",d:"dd.MM.yyyy"},1031:"de-DE","de-LI":{c:"CHF",d:"dd.MM.yyyy"},5127:"de-LI","de-LU":{c:"€",d:"dd.MM.yyyy"},4103:"de-LU",dsb:{c:"€",d:"d. M. yyyy"},31790:"dsb","dsb-DE":{c:"€",d:"d. M. yyyy"},2094:"dsb-DE",dv:{c:"ރ.",d:"dd/MM/yy"},101:"dv","dv-MV":{c:"ރ.",d:"dd/MM/yy"},1125:"dv-MV",el:{c:"€",d:"d/M/yyyy"},8:"el","el-GR":{c:"€",d:"d/M/yyyy"},1032:"el-GR",en:{c:"$",d:"M/d/yyyy"},9:"en","en-029":{c:"EC$",d:"dd/MM/yyyy"},9225:"en-029","en-AU":{c:"$",d:"d/MM/yyyy"},3081:"en-AU","en-BZ":{c:"BZ$",d:"dd/MM/yyyy"},10249:"en-BZ","en-CA":{c:"$",d:"yyyy-MM-dd"},4105:"en-CA","en-GB":{c:"£",d:"dd/MM/yyyy"},2057:"en-GB","en-HK":{c:"$",d:"d/M/yy"},15369:"en-HK","en-IE":{c:"€",d:"dd/MM/yyyy"},6153:"en-IE","en-IN":{c:"₹",d:"dd-MM-yyyy"},16393:"en-IN","en-JM":{c:"J$",d:"dd/MM/yyyy"},8201:"en-JM","en-MY":{c:"RM",d:"d/M/yyyy"},17417:"en-MY","en-NZ":{c:"$",d:"d/MM/yyyy"},5129:"en-NZ","en-PH":{c:"₱",d:"M/d/yyyy"},13321:"en-PH","en-SG":{c:"$",d:"d/M/yyyy"},18441:"en-SG","en-TT":{c:"TT$",d:"dd/MM/yyyy"},11273:"en-TT","en-US":{c:"$",d:"M/d/yyyy"},1033:"en-US","en-ZA":{c:"R",d:"yyyy-MM-dd"},7177:"en-ZA","en-ZW":{c:"$",d:"dd/MM/yyyy"},12297:"en-ZW",es:{c:"€",d:"dd/MM/yyyy"},10:"es","es-419":{c:"US$",d:"dd/MM/yy"},22538:"es-419","es-AR":{c:"$",d:"dd/MM/yyyy"},11274:"es-AR","es-BO":{c:"Bs.",d:"dd/MM/yyyy"},16394:"es-BO","es-CL":{c:"$",d:"dd-MM-yyyy"},13322:"es-CL","es-CO":{c:"$",d:"dd/MM/yyyy"},9226:"es-CO","es-CR":{c:"₡",d:"dd/MM/yyyy"},5130:"es-CR","es-DO":{c:"RD$",d:"d/M/yy"},7178:"es-DO","es-EC":{c:"$",d:"dd/MM/yyyy"},12298:"es-EC","es-ES":{c:"€",d:"dd/MM/yyyy"},3082:"es-ES","es-GT":{c:"Q",d:"dd/MM/yyyy"},4106:"es-GT","es-HN":{c:"L.",d:"dd/MM/yyyy"},18442:"es-HN","es-MX":{c:"$",d:"dd/MM/yyyy"},2058:"es-MX","es-NI":{c:"C$",d:"dd/MM/yyyy"},19466:"es-NI","es-PA":{c:"B/.",d:"d/M/yy"},6154:"es-PA","es-PE":{c:"S/.",d:"dd/MM/yyyy"},10250:"es-PE","es-PR":{c:"$",d:"dd/MM/yyyy"},20490:"es-PR","es-PY":{c:"₲",d:"dd/MM/yyyy"},15370:"es-PY","es-SV":{c:"$",d:"dd/MM/yyyy"},17418:"es-SV","es-US":{c:"$",d:"M/d/yyyy"},21514:"es-US","es-UY":{c:"$U",d:"dd/MM/yyyy"},14346:"es-UY","es-VE":{c:"Bs.F.",d:"dd-MM-yyyy"},8202:"es-VE",et:{c:"€",d:"d.MM.yyyy"},37:"et","et-EE":{c:"€",d:"d.MM.yyyy"},1061:"et-EE",eu:{c:"€",d:"yyyy/MM/dd"},45:"eu","eu-ES":{c:"€",d:"yyyy/MM/dd"},1069:"eu-ES",fa:{c:"ريال",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},41:"fa","fa-IR":{c:"ريال",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},1065:"fa-IR",ff:{c:"CFA",d:"dd/MM/yyyy"},103:"ff","ff-Latn":{c:"CFA",d:"dd/MM/yyyy"},31847:"ff-Latn","ff-Latn-SN":{c:"CFA",d:"dd/MM/yyyy"},2151:"ff-Latn-SN",fi:{c:"€",d:"d.M.yyyy"},11:"fi","fi-FI":{c:"€",d:"d.M.yyyy"},1035:"fi-FI",fil:{c:"₱",d:"M/d/yyyy"},100:"fil","fil-PH":{c:"₱",d:"M/d/yyyy"},1124:"fil-PH",fo:{c:"kr.",d:"dd-MM-yyyy"},56:"fo","fo-FO":{c:"kr.",d:"dd-MM-yyyy"},1080:"fo-FO",fr:{c:"€",d:"dd/MM/yyyy"},12:"fr","fr-BE":{c:"€",d:"dd-MM-yy"},2060:"fr-BE","fr-CA":{c:"$",d:"yyyy-MM-dd"},3084:"fr-CA","fr-CD":{c:"FC",d:"dd/MM/yyyy"},9228:"fr-CD","fr-CH":{c:"fr.",d:"dd.MM.yyyy"},4108:"fr-CH","fr-CI":{c:"CFA",d:"dd/MM/yyyy"},12300:"fr-CI","fr-CM":{c:"FCFA",d:"dd/MM/yyyy"},11276:"fr-CM","fr-FR":{c:"€",d:"dd/MM/yyyy"},1036:"fr-FR","fr-HT":{c:"G",d:"dd/MM/yyyy"},15372:"fr-HT","fr-LU":{c:"€",d:"dd/MM/yyyy"},5132:"fr-LU","fr-MA":{c:"DH",d:"dd/MM/yyyy"},14348:"fr-MA","fr-MC":{c:"€",d:"dd/MM/yyyy"},6156:"fr-MC","fr-ML":{c:"CFA",d:"dd/MM/yyyy"},13324:"fr-ML","fr-RE":{c:"€",d:"dd/MM/yyyy"},8204:"fr-RE","fr-SN":{c:"CFA",d:"dd/MM/yyyy"},10252:"fr-SN",fy:{c:"€",d:"d-M-yyyy"},98:"fy","fy-NL":{c:"€",d:"d-M-yyyy"},1122:"fy-NL",ga:{c:"€",d:"dd/MM/yyyy"},60:"ga","ga-IE":{c:"€",d:"dd/MM/yyyy"},2108:"ga-IE",gd:{c:"£",d:"dd/MM/yyyy"},145:"gd","gd-GB":{c:"£",d:"dd/MM/yyyy"},1169:"gd-GB",gl:{c:"€",d:"dd/MM/yyyy"},86:"gl","gl-ES":{c:"€",d:"dd/MM/yyyy"},1110:"gl-ES",gn:{c:"₲",d:"dd/MM/yyyy"},116:"gn","gn-PY":{c:"₲",d:"dd/MM/yyyy"},1140:"gn-PY",gsw:{c:"€",d:"dd/MM/yyyy"},132:"gsw","gsw-FR":{c:"€",d:"dd/MM/yyyy"},1156:"gsw-FR",gu:{c:"₹",d:"dd-MM-yy",n:"૦૧૨૩૪૫૬૭૮૯"},71:"gu","gu-IN":{c:"₹",d:"dd-MM-yy",n:"૦૧૨૩૪૫૬૭૮૯"},1095:"gu-IN",ha:{c:"₦",d:"d/M/yyyy"},104:"ha","ha-Latn":{c:"₦",d:"d/M/yyyy"},31848:"ha-Latn","ha-Latn-NG":{c:"₦",d:"d/M/yyyy"},1128:"ha-Latn-NG",haw:{c:"$",d:"M/d/yyyy"},117:"haw","haw-US":{c:"$",d:"M/d/yyyy"},1141:"haw-US",he:{c:"₪",d:"dd/MM/yyyy"},13:"he","he-IL":{c:"₪",d:"dd/MM/yyyy"},1037:"he-IL",hi:{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},57:"hi","hi-IN":{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},1081:"hi-IN",hr:{c:"kn",d:"d.M.yyyy."},26:"hr","hr-BA":{c:"KM",d:"d.M.yyyy."},4122:"hr-BA","hr-HR":{c:"kn",d:"d.M.yyyy."},1050:"hr-HR",hsb:{c:"€",d:"d. M. yyyy"},46:"hsb","hsb-DE":{c:"€",d:"d. M. yyyy"},1070:"hsb-DE",hu:{c:"Ft",d:"yyyy.MM.dd."},14:"hu","hu-HU":{c:"Ft",d:"yyyy.MM.dd."},1038:"hu-HU",hy:{c:"֏",d:"dd.MM.yyyy"},43:"hy","hy-AM":{c:"֏",d:"dd.MM.yyyy"},1067:"hy-AM",id:{c:"Rp",d:"dd/MM/yyyy"},33:"id","id-ID":{c:"Rp",d:"dd/MM/yyyy"},1057:"id-ID",ig:{c:"₦",d:"d/M/yyyy"},112:"ig","ig-NG":{c:"₦",d:"d/M/yyyy"},1136:"ig-NG",ii:{c:"¥",d:"yyyy/M/d"},120:"ii","ii-CN":{c:"¥",d:"yyyy/M/d"},1144:"ii-CN",is:{c:"kr.",d:"d.M.yyyy"},15:"is","is-IS":{c:"kr.",d:"d.M.yyyy"},1039:"is-IS",it:{c:"€",d:"dd/MM/yyyy"},16:"it","it-CH":{c:"fr.",d:"dd.MM.yyyy"},2064:"it-CH","it-IT":{c:"€",d:"dd/MM/yyyy"},1040:"it-IT",iu:{c:"$",d:"d/MM/yyyy"},93:"iu","iu-Cans":{c:"$",d:"d/M/yyyy"},30813:"iu-Cans","iu-Cans-CA":{c:"$",d:"d/M/yyyy"},1117:"iu-Cans-CA","iu-Latn":{c:"$",d:"d/MM/yyyy"},31837:"iu-Latn","iu-Latn-CA":{c:"$",d:"d/MM/yyyy"},2141:"iu-Latn-CA",ja:{c:"¥",d:"yyyy/MM/dd"},17:"ja","ja-JP":{c:"¥",d:"yyyy/MM/dd"},1041:"ja-JP",jv:{c:"Rp",d:"dd/MM/yyyy"},4096:"jv","jv-Latn":{c:"Rp",d:"dd/MM/yyyy"},"jv-Latn-ID":{c:"Rp",d:"dd/MM/yyyy"},ka:{c:"ლ.",d:"dd.MM.yyyy"},55:"ka","ka-GE":{c:"ლ.",d:"dd.MM.yyyy"},1079:"ka-GE",kk:{c:"₸",d:"d-MMM-yy"},63:"kk","kk-KZ":{c:"₸",d:"d-MMM-yy"},1087:"kk-KZ",kl:{c:"kr.",d:"dd-MM-yyyy"},111:"kl","kl-GL":{c:"kr.",d:"dd-MM-yyyy"},1135:"kl-GL",km:{c:"៛",d:"dd/MM/yy",n:"០១២៣៤៥៦៧៨៩"},83:"km","km-KH":{c:"៛",d:"dd/MM/yy",n:"០១២៣៤៥៦៧៨៩"},1107:"km-KH",kn:{c:"₹",d:"dd-MM-yy",n:"೦೧೨೩೪೫೬೭೮೯"},75:"kn","kn-IN":{c:"₹",d:"dd-MM-yy",n:"೦೧೨೩೪೫೬೭೮೯"},1099:"kn-IN",ko:{c:"₩",d:"yyyy-MM-dd"},18:"ko",kok:{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},87:"kok","kok-IN":{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},1111:"kok-IN","ko-KR":{c:"₩",d:"yyyy-MM-dd"},1042:"ko-KR",ku:{c:"د.ع.‏",d:"yyyy/MM/dd",n:"٠١٢٣٤٥٦٧٨٩"},146:"ku","ku-Arab":{c:"د.ع.‏",d:"yyyy/MM/dd",n:"٠١٢٣٤٥٦٧٨٩"},31890:"ku-Arab","ku-Arab-IQ":{c:"د.ع.‏",d:"yyyy/MM/dd",n:"٠١٢٣٤٥٦٧٨٩"},1170:"ku-Arab-IQ",ky:{c:"сом",d:"d-MMM yy"},64:"ky","ky-KG":{c:"сом",d:"d-MMM yy"},1088:"ky-KG",lb:{c:"€",d:"dd.MM.yy"},110:"lb","lb-LU":{c:"€",d:"dd.MM.yy"},1134:"lb-LU",lo:{c:"₭",d:"dd/MM/yyyy",n:"໐໑໒໓໔໕໖໗໘໙"},84:"lo","lo-LA":{c:"₭",d:"dd/MM/yyyy",n:"໐໑໒໓໔໕໖໗໘໙"},1108:"lo-LA",lt:{c:"Lt",d:"yyyy-MM-dd"},39:"lt","lt-LT":{c:"Lt",d:"yyyy-MM-dd"},1063:"lt-LT",lv:{c:"€",d:"dd.MM.yyyy."},38:"lv","lv-LV":{c:"€",d:"dd.MM.yyyy."},1062:"lv-LV",mg:{c:"Ar",d:"d/M/yyyy"},"mg-MG":{c:"Ar",d:"d/M/yyyy"},mi:{c:"$",d:"dd/MM/yyyy"},129:"mi","mi-NZ":{c:"$",d:"dd/MM/yyyy"},1153:"mi-NZ",mk:{c:"ден.",d:"dd.MM.yyyy"},47:"mk","mk-MK":{c:"ден.",d:"dd.MM.yyyy"},1071:"mk-MK",ml:{c:"₹",d:"dd-MM-yy",n:"൦൧൨൩൪൫൬൭൮൯"},76:"ml","ml-IN":{c:"₹",d:"dd-MM-yy",n:"൦൧൨൩൪൫൬൭൮൯"},1100:"ml-IN",mn:{c:"₮",d:"yyyy-MM-dd"},80:"mn","mn-Cyrl":{c:"₮",d:"yyyy-MM-dd"},30800:"mn-Cyrl","mn-MN":{c:"₮",d:"yyyy-MM-dd"},1104:"mn-MN","mn-Mong":{c:"¥",d:"yyyy/M/d"},31824:"mn-Mong","mn-Mong-CN":{c:"¥",d:"yyyy/M/d"},2128:"mn-Mong-CN","mn-Mong-MN":{c:"₮",d:"yyyy/M/d"},3152:"mn-Mong-MN",moh:{c:"$",d:"M/d/yyyy"},124:"moh","moh-CA":{c:"$",d:"M/d/yyyy"},1148:"moh-CA",mr:{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},78:"mr","mr-IN":{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},1102:"mr-IN",ms:{c:"RM",d:"dd/MM/yyyy"},62:"ms","ms-BN":{c:"$",d:"dd/MM/yyyy"},2110:"ms-BN","ms-MY":{c:"RM",d:"dd/MM/yyyy"},1086:"ms-MY",mt:{c:"€",d:"dd/MM/yyyy"},58:"mt","mt-MT":{c:"€",d:"dd/MM/yyyy"},1082:"mt-MT",my:{c:"K",d:"dd-MM-yyyy",n:"၀၁၂၃၄၅၆၇၈၉"},85:"my","my-MM":{c:"K",d:"dd-MM-yyyy",n:"၀၁၂၃၄၅၆၇၈၉"},1109:"my-MM",nb:{c:"kr",d:"dd.MM.yyyy"},31764:"nb","nb-NO":{c:"kr",d:"dd.MM.yyyy"},1044:"nb-NO",ne:{c:"रु",d:"M/d/yyyy",n:"०१२३४५६७८९"},97:"ne","ne-IN":{c:"₹",d:"yyyy-MM-dd",n:"०१२३४५६७८९"},2145:"ne-IN","ne-NP":{c:"रु",d:"M/d/yyyy",n:"०१२३४५६७८९"},1121:"ne-NP",nl:{c:"€",d:"d-M-yyyy"},19:"nl","nl-BE":{c:"€",d:"d/MM/yyyy"},2067:"nl-BE","nl-NL":{c:"€",d:"d-M-yyyy"},1043:"nl-NL",nn:{c:"kr",d:"dd.MM.yyyy"},30740:"nn","nn-NO":{c:"kr",d:"dd.MM.yyyy"},2068:"nn-NO",no:{c:"kr",d:"dd.MM.yyyy"},20:"no",nqo:{c:"ߖߕ.",d:"dd/MM/yyyy",n:"߀߁߂߃߄߅߆߇߈߉"},"nqo-GN":{c:"ߖߕ.",d:"dd/MM/yyyy",n:"߀߁߂߃߄߅߆߇߈߉"},nso:{c:"R",d:"dd/MM/yy"},108:"nso","nso-ZA":{c:"R",d:"dd/MM/yy"},1132:"nso-ZA",oc:{c:"€",d:"dd/MM/yyyy"},130:"oc","oc-FR":{c:"€",d:"dd/MM/yyyy"},1154:"oc-FR",om:{c:"Br",d:"dd/MM/yy"},114:"om","om-ET":{c:"Br",d:"dd/MM/yy"},1138:"om-ET",or:{c:"₹",d:"dd-MM-yy",n:"୦୧୨୩୪୫୬୭୮୯"},72:"or","or-IN":{c:"₹",d:"dd-MM-yy",n:"୦୧୨୩୪୫୬୭୮୯"},1096:"or-IN",pa:{c:"₹",d:"dd-MM-yy",n:"੦੧੨੩੪੫੬੭੮੯"},70:"pa","pa-Arab":{c:"Rs",d:"dd-MM-yy",n:"۰۱۲۳۴۵۶۷۸۹"},31814:"pa-Arab","pa-Arab-PK":{c:"Rs",d:"dd-MM-yy",n:"۰۱۲۳۴۵۶۷۸۹"},2118:"pa-Arab-PK","pa-IN":{c:"₹",d:"dd-MM-yy",n:"੦੧੨੩੪੫੬੭੮੯"},1094:"pa-IN",pl:{c:"zł",d:"yyyy-MM-dd"},21:"pl","pl-PL":{c:"zł",d:"yyyy-MM-dd"},1045:"pl-PL",prs:{c:"؋",d:"yyyy/M/d",n:"٠١٢٣٤٥٦٧٨٩"},140:"prs","prs-AF":{c:"؋",d:"yyyy/M/d",n:"٠١٢٣٤٥٦٧٨٩"},1164:"prs-AF",ps:{c:"؋",d:"yyyy/M/d",n:"٠١٢٣٤٥٦٧٨٩"},99:"ps","ps-AF":{c:"؋",d:"yyyy/M/d",n:"٠١٢٣٤٥٦٧٨٩"},1123:"ps-AF",pt:{c:"R$",d:"dd/MM/yyyy"},22:"pt","pt-AO":{c:"Kz",d:"dd/MM/yy"},"pt-BR":{c:"R$",d:"dd/MM/yyyy"},1046:"pt-BR","pt-PT":{c:"€",d:"dd/MM/yyyy"},2070:"pt-PT",qut:{c:"Q",d:"dd/MM/yyyy"},134:"qut","qut-GT":{c:"Q",d:"dd/MM/yyyy"},1158:"qut-GT",quz:{c:"Bs.",d:"dd/MM/yyyy"},107:"quz","quz-BO":{c:"Bs.",d:"dd/MM/yyyy"},1131:"quz-BO","quz-EC":{c:"$",d:"dd/MM/yyyy"},2155:"quz-EC","quz-PE":{c:"S/.",d:"dd/MM/yyyy"},3179:"quz-PE",rm:{c:"fr.",d:"dd-MM-yyyy"},23:"rm","rm-CH":{c:"fr.",d:"dd-MM-yyyy"},1047:"rm-CH",ro:{c:"lei",d:"dd.MM.yyyy"},24:"ro","ro-MD":{c:"L",d:"dd.MM.yyyy"},2072:"ro-MD","ro-RO":{c:"lei",d:"dd.MM.yyyy"},1048:"ro-RO",ru:{c:"₽",d:"dd.MM.yyyy"},25:"ru","ru-RU":{c:"₽",d:"dd.MM.yyyy"},1049:"ru-RU",rw:{c:"RWF",d:"d/MM/yyyy"},135:"rw","rw-RW":{c:"RWF",d:"d/MM/yyyy"},1159:"rw-RW",sa:{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},79:"sa",sah:{c:"₽",d:"dd.MM.yyyy"},133:"sah","sah-RU":{c:"₽",d:"dd.MM.yyyy"},1157:"sah-RU","sa-IN":{c:"₹",d:"dd-MM-yyyy",n:"०१२३४५६७८९"},1103:"sa-IN",sd:{c:"Rs",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},89:"sd","sd-Arab":{c:"Rs",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},31833:"sd-Arab","sd-Arab-PK":{c:"Rs",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},2137:"sd-Arab-PK",se:{c:"kr",d:"dd.MM.yyyy"},59:"se","se-FI":{c:"€",d:"d.M.yyyy"},3131:"se-FI","se-NO":{c:"kr",d:"dd.MM.yyyy"},1083:"se-NO","se-SE":{c:"kr",d:"yyyy-MM-dd"},2107:"se-SE",si:{c:"රු.",d:"yyyy-MM-dd"},91:"si","si-LK":{c:"රු.",d:"yyyy-MM-dd"},1115:"si-LK",sk:{c:"EUR",d:"d.M.yyyy"},27:"sk","sk-SK":{c:"EUR",d:"d.M.yyyy"},1051:"sk-SK",sl:{c:"€",d:"d.M.yyyy"},36:"sl","sl-SI":{c:"€",d:"d.M.yyyy"},1060:"sl-SI",sma:{c:"kr",d:"yyyy-MM-dd"},30779:"sma","sma-NO":{c:"kr",d:"dd.MM.yyyy"},6203:"sma-NO","sma-SE":{c:"kr",d:"yyyy-MM-dd"},7227:"sma-SE",smj:{c:"kr",d:"yyyy-MM-dd"},31803:"smj","smj-NO":{c:"kr",d:"dd.MM.yyyy"},4155:"smj-NO","smj-SE":{c:"kr",d:"yyyy-MM-dd"},5179:"smj-SE",smn:{c:"€",d:"d.M.yyyy"},28731:"smn","smn-FI":{c:"€",d:"d.M.yyyy"},9275:"smn-FI",sms:{c:"€",d:"d.M.yyyy"},29755:"sms","sms-FI":{c:"€",d:"d.M.yyyy"},8251:"sms-FI",sn:{c:"US$",d:"dd/MM/yyyy"},"sn-Latn":{c:"US$",d:"dd/MM/yyyy"},"sn-Latn-ZW":{c:"US$",d:"dd/MM/yyyy"},so:{c:"S",d:"dd/MM/yy"},119:"so","so-SO":{c:"S",d:"dd/MM/yy"},1143:"so-SO",sq:{c:"Lek",d:"d.M.yyyy"},28:"sq","sq-AL":{c:"Lek",d:"d.M.yyyy"},1052:"sq-AL",sr:{c:"din.",d:"d.M.yyyy."},31770:"sr","sr-Cyrl":{c:"дин.",d:"d.M.yyyy."},27674:"sr-Cyrl","sr-Cyrl-BA":{c:"КМ",d:"d.M.yyyy."},7194:"sr-Cyrl-BA","sr-Cyrl-CS":{c:"дин.",d:"d.M.yyyy."},3098:"sr-Cyrl-CS","sr-Cyrl-ME":{c:"€",d:"d.M.yyyy."},12314:"sr-Cyrl-ME","sr-Cyrl-RS":{c:"дин.",d:"d.M.yyyy."},10266:"sr-Cyrl-RS","sr-Latn":{c:"din.",d:"d.M.yyyy."},28698:"sr-Latn","sr-Latn-BA":{c:"KM",d:"d.M.yyyy."},6170:"sr-Latn-BA","sr-Latn-CS":{c:"din.",d:"d.M.yyyy."},2074:"sr-Latn-CS","sr-Latn-ME":{c:"€",d:"d.M.yyyy."},11290:"sr-Latn-ME","sr-Latn-RS":{c:"din.",d:"d.M.yyyy."},9242:"sr-Latn-RS",st:{c:"R",d:"yyyy-MM-dd"},48:"st","st-ZA":{c:"R",d:"yyyy-MM-dd"},1072:"st-ZA",sv:{c:"kr",d:"yyyy-MM-dd"},29:"sv","sv-FI":{c:"€",d:"d.M.yyyy"},2077:"sv-FI","sv-SE":{c:"kr",d:"yyyy-MM-dd"},1053:"sv-SE",sw:{c:"KSh",d:"M/d/yyyy"},65:"sw","sw-KE":{c:"KSh",d:"M/d/yyyy"},1089:"sw-KE",syr:{c:"ܠ.ܣ.‏",d:"dd/MM/yyyy"},90:"syr","syr-SY":{c:"ܠ.ܣ.‏",d:"dd/MM/yyyy"},1114:"syr-SY",ta:{c:"₹",d:"dd-MM-yyyy",n:"௦௧௨௩௪௫௬௭௮௯"},73:"ta","ta-IN":{c:"₹",d:"dd-MM-yyyy",n:"௦௧௨௩௪௫௬௭௮௯"},1097:"ta-IN","ta-LK":{c:"Rs",d:"dd-MM-yyyy",n:"௦௧௨௩௪௫௬௭௮௯"},2121:"ta-LK",te:{c:"₹",d:"dd-MM-yy",n:"౦౧౨౩౪౫౬౭౮౯"},74:"te","te-IN":{c:"₹",d:"dd-MM-yy",n:"౦౧౨౩౪౫౬౭౮౯"},1098:"te-IN",tg:{c:"смн",d:"dd.MM.yyyy"},40:"tg","tg-Cyrl":{c:"смн",d:"dd.MM.yyyy"},31784:"tg-Cyrl","tg-Cyrl-TJ":{c:"смн",d:"dd.MM.yyyy"},1064:"tg-Cyrl-TJ",th:{c:"฿",d:"d/M/yyyy",n:"๐๑๒๓๔๕๖๗๘๙"},30:"th","th-TH":{c:"฿",d:"d/M/yyyy",n:"๐๑๒๓๔๕๖๗๘๙"},1054:"th-TH",ti:{c:"ERN",d:"d/M/yyyy"},115:"ti","ti-ER":{c:"ERN",d:"d/M/yyyy"},2163:"ti-ER","ti-ET":{c:"ብር",d:"d/M/yyyy"},1139:"ti-ET",tk:{c:"m.",d:"dd.MM.yy 'ý.'"},66:"tk","tk-TM":{c:"m.",d:"dd.MM.yy 'ý.'"},1090:"tk-TM",tn:{c:"R",d:"dd/MM/yy"},50:"tn","tn-BW":{c:"P",d:"dd/MM/yy"},2098:"tn-BW","tn-ZA":{c:"R",d:"dd/MM/yy"},1074:"tn-ZA",tr:{c:"₺",d:"d.M.yyyy"},31:"tr","tr-TR":{c:"₺",d:"d.M.yyyy"},1055:"tr-TR",ts:{c:"R",d:"yyyy-MM-dd"},49:"ts","ts-ZA":{c:"R",d:"yyyy-MM-dd"},1073:"ts-ZA",tt:{c:"₽",d:"dd.MM.yyyy"},68:"tt","tt-RU":{c:"₽",d:"dd.MM.yyyy"},1092:"tt-RU",tzm:{c:"DA",d:"dd-MM-yyyy"},95:"tzm","tzm-Latn":{c:"DA",d:"dd-MM-yyyy"},31839:"tzm-Latn","tzm-Latn-DZ":{c:"DA",d:"dd-MM-yyyy"},2143:"tzm-Latn-DZ","tzm-Tfng":{c:"ⴷⵔ",d:"dd-MM-yyyy"},30815:"tzm-Tfng","tzm-Tfng-MA":{c:"ⴷⵔ",d:"dd-MM-yyyy"},4191:"tzm-Tfng-MA",ug:{c:"¥",d:"yyyy-M-d"},128:"ug","ug-CN":{c:"¥",d:"yyyy-M-d"},1152:"ug-CN",uk:{c:"₴",d:"dd.MM.yyyy"},34:"uk","uk-UA":{c:"₴",d:"dd.MM.yyyy"},1058:"uk-UA",ur:{c:"Rs",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},32:"ur","ur-IN":{c:"₹",d:"d/M/yy",n:"۰۱۲۳۴۵۶۷۸۹"},2080:"ur-IN","ur-PK":{c:"Rs",d:"dd/MM/yyyy",n:"۰۱۲۳۴۵۶۷۸۹"},1056:"ur-PK",uz:{c:"so'm",d:"dd.MM.yyyy"},67:"uz","uz-Cyrl":{c:"сўм",d:"dd.MM.yyyy"},30787:"uz-Cyrl","uz-Cyrl-UZ":{c:"сўм",d:"dd.MM.yyyy"},2115:"uz-Cyrl-UZ","uz-Latn":{c:"so'm",d:"dd.MM.yyyy"},31811:"uz-Latn","uz-Latn-UZ":{c:"so'm",d:"dd.MM.yyyy"},1091:"uz-Latn-UZ",vi:{c:"₫",d:"dd/MM/yyyy"},42:"vi","vi-VN":{c:"₫",d:"dd/MM/yyyy"},1066:"vi-VN",wo:{c:"CFA",d:"dd/MM/yyyy"},136:"wo","wo-SN":{c:"CFA",d:"dd/MM/yyyy"},1160:"wo-SN",xh:{c:"R",d:"yyyy/MM/dd"},52:"xh","xh-ZA":{c:"R",d:"yyyy/MM/dd"},1076:"xh-ZA",yo:{c:"₦",d:"d/M/yyyy"},106:"yo","yo-NG":{c:"₦",d:"d/M/yyyy"},1130:"yo-NG",zgh:{c:"ⴷⵔⵎ",d:"dd-MM-yyyy"},"zgh-Tfng":{c:"ⴷⵔⵎ",d:"dd-MM-yyyy"},"zgh-Tfng-MA":{c:"ⴷⵔⵎ",d:"dd-MM-yyyy"},zh:{c:"¥",d:"yyyy/M/d"},30724:"zh","zh-CHS":{c:"¥",d:"yyyy/M/d"},4:"zh-CHS","zh-CHT":{c:"HK$",d:"d/M/yyyy"},31748:"zh-CHT","zh-CN":{c:"¥",d:"yyyy/M/d"},2052:"zh-CN","zh-Hans":{c:"¥",d:"yyyy/M/d"},"zh-Hant":{c:"HK$",d:"d/M/yyyy"},"zh-HK":{c:"HK$",d:"d/M/yyyy"},3076:"zh-HK","zh-MO":{c:"MOP",d:"d/M/yyyy"},5124:"zh-MO","zh-SG":{c:"$",d:"d/M/yyyy"},4100:"zh-SG","zh-TW":{c:"NT$",d:"yyyy/M/d"},1028:"zh-TW",zu:{c:"R",d:"dd-MM-yyyy"},53:"zu","zu-ZA":{c:"R",d:"dd-MM-yyyy"},1077:"zu-ZA"};$.ig.NumberFormatInfo=Class.extend({init:function(cultureName,isInvariant){this._cultureName=cultureName;this._isInvariant=isInvariant},clone:function(){var copy=new $.ig.NumberFormatInfo(this._cultureName,this._isInvariant);for(var attr in this){if(this.hasOwnProperty(attr)){copy[attr]=this[attr]}}return copy},currencySymbol:function(value){if(arguments.length===1){this._currencySymbol=value}if(!this._currencySymbol){var g=globalInfo[this._isInvariant?"invariant":this._cultureName];if(g){this._currencySymbol=g.c}else{this._currencySymbol="$"}}return this._currencySymbol},nativeDigits:function(){if(!this._nativeDigits){var g=globalInfo[this._isInvariant?"invariant":this._cultureName];if(g&&g.n){this._nativeDigits=g.n}else{this._nativeDigits="0123456789"}}return this._nativeDigits},negativeSign:function(value){if(arguments.length===1){this._negativeSign=value}if(!this._negativeSign){this._negativeSign="-"}return this._negativeSign},percentSymbol:function(value){if(arguments.length===1){this._percentSymbol=value}if(!this._percentSymbol){var temp=1..toLocaleString(this._cultureName,{style:"percent"});this._percentSymbol=temp[temp.length-1]}return this._percentSymbol},positiveSign:function(value){if(arguments.length===1){this._positiveSign=value}if(!this._positiveSign){this._positiveSign="+"}return this._positiveSign},numberDecimalSeparator:function(value){if(arguments.length===1){this._numberDecimalSeparator=value}if(!this._numberDecimalSeparator){this._numberDecimalSeparator=1.1.toLocaleString(this._cultureName).substring(1,2)}return this._numberDecimalSeparator},numberGroupSeparator:function(value){if(arguments.length===1){this._numberGroupSeparator=value}if(!this._numberGroupSeparator){var s=123456789..toLocaleString(this._cultureName);var result=/\D/.exec(s);if(result===null||result.length===0){this._numberGroupSeparator=","}else{this._numberGroupSeparator=result[0]}}return this._numberGroupSeparator},numberGroupSizes:function(value){if(arguments.length===1){this._numberGroupSizes=value}if(!this._numberGroupSizes){var s=123456789..toLocaleString(this._cultureName);var result=/\D(\d+)\D/.exec(s);if(result===null||result.length===0){this._numberGroupSizes=[3]}else{this._numberGroupSizes=[result[1].length]}}return this._numberGroupSizes},$type:new $.ig.Type("NumberFormatInfo",$.ig.Object.prototype.$type)},true);$.ig.util.defType("Thread","Object",{init:function(){},currentThread:function(){if(!this._currentThread){this._currentThread=new $.ig.Thread}return this._currentThread},currentCulture:function(value){if(arguments.length===1){this._currentCulture=value}if(!this._currentCulture){var currentLocale=navigator.language||navigator.userLanguage;this._currentCulture=new $.ig.CultureInfo(currentLocale)}return this._currentCulture},$type:new $.ig.Type("Thread",$.ig.Object.prototype.$type)},true);$.ig.util.defType("Stream","Object",{init:function(){},close:function(){this.disposeCore(true)},dispose:function(){this.close()},disposeCore:function(disposing){},flush:function(){},readByte:function(){var bytes=[0];var count=this.read(bytes,0,1);if(count===0){return-1}return bytes[0]},writeByte:function(value){this.write([value],0,1)},$type:new $.ig.Type("Stream",$.ig.Object.prototype.$type)},true);(function($){$.ig.util.profiler={};var methods={};$.ig.util.profiler.recordTime=function(methodName,time){var key="meth: "+methodName;if(!methods[key]){methods[key]=[]}methods[key][methods[key].length]=time};$.ig.util.profiler.reset=function(){methods={}};$.ig.util.profiler.logReport=function(){var meths=[];var j=0;var sum=0;var avg=0;for(var prop in methods){if(prop.indexOf("meth:")===0){var meth={};meth.name=prop.substr(5);sum=0;for(var i=0;i<methods[prop].length;i++){sum=sum+methods[prop][i]}avg=sum/methods[prop].length;meth.avg=avg;meth.callCount=methods[prop].length;meths[j]=meth;j++}}meths.sort(function(m1,m2){if(m1.avg<m2.avg){return 1}if(m1.avg>m2.avg){return-1}if(m1.avg==m2.avg){return 0}});for(var k=0;k<Math.min(200,meths.length);k++){console.log(meths[k].name+" avg: "+meths[k].avg+" callCount: "+meths[k].callCount)}}})(jQuery);$.ig.extendNativePrototype(Function.prototype,"invoke",function(){return this.apply(null,arguments)});$.ig.extendNativePrototype(Function.prototype,"runOn",function(target){var self=this;var ret=function(){return self.apply(target,arguments)};ret.original=this;ret.target=target;return ret});String.prototype.startsWith=function(s){return this.indexOf(s)===0};String.prototype.startsWith1=function(s,comparisonType){if(this.length<s.length){return false}return $.ig.util.stringCompare1(this.slice(0,s.length),s,comparisonType||0)===0};String.prototype.endsWith=function(s,comparisonType){if(this.length<s.length){return false}return $.ig.util.stringCompare1(this.slice(-s.length),s,comparisonType||0)===0};String.prototype.remove=function(index,count){if(!count||index+count>this.length){return this.substr(0,index)}return this.substr(0,index)+this.substr(index+count)};String.prototype.compareTo=function(other){if(this==other){return 0}if(this<other){return-1}return 1};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}if(!String.prototype.getHashCode){String.prototype.getHashCode=function(){var hash=0,i,chr,len;if(this.length===0){return hash}for(i=0,len=this.length;i<len;i++){chr=this.charCodeAt(i);hash=(hash<<5)-hash+chr;hash|=0}return hash}}String.prototype.fullTrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")};String.prototype.trimStart=function(){var args=[" "];if(arguments.length>0){args=Array.prototype.slice.call(arguments);if(args.length===1&&$.isArray(args[0])){args=args[0]}}if(this.length===0){return this}var i=0;for(;i<this.length&&args.indexOf(this.charAt(i))>-1;i++);return this.substring(i)};String.prototype.trimEnd=function(){var args=[" "];if(arguments.length>0){args=Array.prototype.slice.call(arguments);if(args.length===1&&$.isArray(args[0])){args=args[0]}}var i=this.length-1;for(;i>=0&&args.indexOf(this.charAt(i))>-1;i--);return this.substring(0,i+1)};String.getHashCode=function(){return this};String.isNullOrEmpty=function(s){return!s||s.length<1};String.isNullOrWhiteSpace=function(s){return!s||s.trim().length<1};String.empty=function(){return""};String.concat=function(){return[].join.call(arguments,"")};String.concat1=function(o1,o2){return[].join.call(arguments,"")};String.concat2=function(s1,s2){return[].join.call(arguments,"")};String.concat3=function(){return[].join.call(arguments,"")};String.concat4=function(o1,o2,o3){return[].join.call(arguments,"")};String.concat5=function(s1,s2,s3){return[].join.call(arguments,"")};String.concat6=function(o1,o2,o3,o4){return[].join.call(arguments,"")};String.concat7=function(s1,s2,s3,s4){return[].join.call(arguments,"")};String.equalsStatic=$.ig.Object.prototype.equalsStatic;String.prototype.equals=function(other){return this==other};String.prototype.contains=function(s){return this.indexOf(s)>-1};String.prototype.padLeft=function(len,c){var s=this;c=c||" ";while(s.length<len){s=c+s}return s};String.prototype.padRight=function(len,c){var s=this;c=c||" ";while(s.length<len){s+=c}return s};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};if(!String.prototype.indexOfAny){String.prototype.indexOfAny=function(chars){var s=this.toString();for(var i=0;i<s.length;i++){if(chars.contains(s[i])){return i}}return-1}}if(!String.prototype.lastIndexOfAny){String.prototype.lastIndexOfAny=function(chars){var s=this.toString();for(var i=s.length-1;i>=0;i--){if(chars.contains(s[i])){return i}}return-1}}if(!Array.prototype.filter){Array.prototype.filter=function(fun){var t,len,res,thisp,val,i;if(this===undefined||this===null){throw new TypeError}t=Object(this);len=t.length>>>0;if(typeof fun!="function"){throw new TypeError}res=[];thisp=arguments[1];for(i=0;i<len;i++){if(i in t){val=t[i];if(fun.call(thisp,val,i,t)){res.push(val)}}}return res}}$.ig.extendNativePrototype(Array.prototype,"insertRange",function(index,items){var i=0;if(this.length===0){for(i=0;i<items.length;i++){this[index++]=items[i]}}else{for(i=0;i<items.length;i++){this.splice(index++,0,items[i])}}});$.ig.extendNativePrototype(Array.prototype,"insertRange1",function(index,items){var i=0;if(this.length===0){for(i=0;i<items.length;i++){this[index++]=items[i]}}else{for(i=0;i<items.length;i++){this.splice(index++,0,items[i])}}});$.ig.extendNativePrototype(Array.prototype,"clone",function(){return $.extend(true,[],this)});$.ig.extendNativePrototype(Array.prototype,"clear",function(){this.length=0});Math.log10=function(n){return Math.log(n)/Math.log(10)};Math.logBase=function(n,n2){return Math.log(n)/Math.log(n2)};Math.sign=function(n){if(n<0){return-1}else if(n>0){return 1}else{return 0}};if(!Math.cosh){Math.cosh=function(x){var y=Math.exp(x);return(y+1/y)/2}}if(!Math.sinh){Math.sinh=function(x){var y=Math.exp(x);return(y-1/y)/2}}if(!Math.tanh){Math.tanh=function(x){if(x===Infinity){return 1}else if(x===-Infinity){return-1}else{var y=Math.exp(2*x);return(y-1)/(y+1)}}}if(!Math.ieeeRemainder){Math.ieeeRemainder=function(a,b){var r=Math.abs(a%b);if(isNaN(r)||r==b||r<=Math.abs(b)/2){return r}else{return Math.signum(a)*(r-b)}}}Number.getHashCode=function(){return this};Number.isInfinity=function(n){return n===Infinity||n===-Infinity};if(!Number.prototype.getHashCode){Number.prototype.getHashCode=function(){return this}}Boolean.prototype.getType=function(){return jQuery.ig.Boolean.prototype.$type};Number.prototype.getType=function(){return Number};String.prototype.getType=function(){return String};window.toStaticHTML=window.toStaticHTML||function(s){return s};window.MSApp=window.MSApp||{};window.MSApp.execUnsafeLocalFunction=window.MSApp.execUnsafeLocalFunction||function(fn){fn.apply()};$.ig.util.jQueryUIMainVersion=$.ui&&$.ui.version&&$.ui.version.length>0?parseInt($.ui.version.split(".",1)[0],10):null;$.ig.util.jQueryUISubVersion=$.ui&&$.ui.version&&$.ui.version.length>0?parseInt($.ui.version.split(".",2)[1],10):null;$.ig.util.jQueryMainVersion=$.fn.jquery&&$.fn.jquery.length?parseInt($.fn.jquery.split(".",1)[0],10):null;$.ig.util.jQuerySubVersion=$.fn.jquery&&$.fn.jquery.length?parseInt($.fn.jquery.split(".",2)[1],10):null;$.ig.util.jqueryFlagsCache={};
$.ig.util.jqueryCreateFlags=function(flags){var object=$.ig.util.jqueryFlagsCache[flags]={},i,length;flags=flags.split(/\s+/);for(i=0,length=flags.length;i<length;i++){object[flags[i]]=true}return object};$.ig.util.jqueryCallbacks=function(flags){flags=flags?$.ig.util.jqueryFlagsCache[flags]||$.ig.util.jqueryCreateFlags(flags):{};var list=[],stack=[],memory,fired,firing,firingStart,firingLength,firingIndex,add=function(args){var i,length,elem,type,actual;for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array"){add(elem)}else if(type==="function"){if(!flags.unique||!self.has(elem)){list.push(elem)}}}},fire=function(context,args){args=args||[];memory=!flags.memory||[context,args];fired=true;firing=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(context,args)===false&&flags.stopOnFalse){memory=true;break}}firing=false;if(list){if(!flags.once){if(stack&&stack.length){memory=stack.shift();self.fireWith(memory[0],memory[1])}}else if(memory===true){self.disable()}else{list=[]}}},self={add:function(){if(list){var length=list.length;add(arguments);if(firing){firingLength=list.length}else if(memory&&memory!==true){firingStart=length;fire(memory[0],memory[1])}}return this},remove:function(){if(list){var args=arguments,argIndex=0,argLength=args.length;for(;argIndex<argLength;argIndex++){for(var i=0;i<list.length;i++){if(args[argIndex]===list[i]){if(firing){if(i<=firingLength){firingLength--;if(i<=firingIndex){firingIndex--}}}list.splice(i--,1);if(flags.unique){break}}}}}return this},has:function(fn){if(list){var i=0,length=list.length;for(;i<length;i++){if(fn===list[i]){return true}}}return false},empty:function(){list=[];return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory||memory===true){self.disable()}return this},locked:function(){return!stack},fireWith:function(context,args){if(stack){if(firing){if(!flags.once){stack.push([context,args])}}else if(!(flags.once&&memory)){fire(context,args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};$.ig.util.jqueryDeferred=function(func){var doneList=$.ig.util.jqueryCallbacks("once memory"),failList=$.ig.util.jqueryCallbacks("once memory"),progressList=$.ig.util.jqueryCallbacks("memory"),state="pending",lists={resolve:doneList,reject:failList,notify:progressList},promise={done:doneList.add,fail:failList.add,progress:progressList.add,state:function(){return state},isResolved:doneList.fired,isRejected:failList.fired,then:function(doneCallbacks,failCallbacks,progressCallbacks){deferred.done(doneCallbacks).fail(failCallbacks).progress(progressCallbacks);return this},always:function(){deferred.done.apply(deferred,arguments).fail.apply(deferred,arguments);return this},pipe:function(fnDone,fnFail,fnProgress){return $.ig.util.jqueryDeferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"],progress:[fnProgress,"notify"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn)){deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().then(newDefer.resolve,newDefer.reject,newDefer.notify)}else{newDefer[action+"With"](this===deferred?newDefer:this,[returned])}})}else{deferred[handler](newDefer[action])}})}).promise()},promise:function(obj){if(obj===undefined||obj===null){obj=promise}else{for(var key in promise){obj[key]=promise[key]}}return obj}},deferred=promise.promise({}),key;for(key in lists){deferred[key]=lists[key].fire;deferred[key+"With"]=lists[key].fireWith}deferred.done(function(){state="resolved"},failList.disable,progressList.lock).fail(function(){state="rejected"},doneList.disable,progressList.lock);if(func){func.call(deferred,deferred)}return deferred};$.ig.util.checkDeferred=function(){$.ig.util.deferredDefined=!!($.Deferred!==undefined&&$.Deferred().state)};$.ig.util.deferred=function(){if($.ig.util.deferredDefined===undefined){$.ig.util.checkDeferred()}if($.ig.util.deferredDefined){return $.Deferred()}else{return $.ig.util.jqueryDeferred()}};$.ig.util.ajax=function(url,contentType,data,method,requestOptions){var deferred=$.ig.util.deferred();var isCrossDomain;if(requestOptions&&"isCrossDomain"in requestOptions){isCrossDomain=requestOptions.isCrossDomain}else{isCrossDomain=$.support.cors}var xhrObj=function(rOptions){var xhr=new XMLHttpRequest;if(isCrossDomain&&!("withCredentials"in xhr||rOptions&&"withCredentials"in rOptions&&rOptions.withCredentials)&&typeof XDomainRequest!="undefined"){xhr=new XDomainRequest;xhr.getResponseHeader=function(){return null};xhr.setRequestHeader=function(){xhr.status=200};xhr.getAllResponseHeaders=function(){return null};xhr.onload=function(){xhr.readyState=4;xhr.status=200;xhr.statusText="success";xhr.getAllResponseHeaders=function(){};xhr.onreadystatechange()};xhr.onerror=function(){xhr.readyState=4;xhr.status=0;xhr.statusText="error";xhr.getAllResponseHeaders=function(){};xhr.onreadystatechange()};xhr.ontimeout=function(){xhr.readyState=4;xhr.status=0;xhr.statusText="timeout";xhr.getAllResponseHeaders=function(){};xhr.onreadystatechange()};xhr.onprogress=function(){}}return xhr}(requestOptions);var xhrFields;if("withCredentials"in xhrObj&&requestOptions&&"withCredentials"in requestOptions&&requestOptions.withCredentials){xhrFields={withCredentials:true}}var beforeSend=function(jqXHR,options){if(requestOptions){if($.isFunction(requestOptions.beforeSend)){jqXHR.setRequestHeader("Content-Type",contentType);requestOptions.beforeSend.call(this,jqXHR,options,requestOptions)}}};$.ajax({crossDomain:isCrossDomain?true:false,isLocal:false,url:url,contentType:contentType,data:data,type:method,dataType:"text",xhrFields:xhrFields,beforeSend:beforeSend,xhr:function(){return xhrObj},success:function(responce,textStatus,jqXHR){deferred.resolve(responce)},error:function(jqXHR,textStatus,errorThrown){deferred.reject(errorThrown)}});return deferred.promise()};$.ig.util.offset=function(e,xy){var doc=e?e[0].ownerDocument:document,windowBorderWidth=8,zoom=(window.outerWidth-windowBorderWidth*2)/window.innerWidth;xy=xy||e.offset();if(zoom&&zoom>1&&($.ig.util.isIE10||$.ig.util.isIE11||$.ig.util.isEdge)){if($.ig.util.isIE){xy.documentScrollLeft=doc.documentElement.scrollLeft;xy.documentScrollTop=doc.documentElement.scrollTop}else if($.ig.util.isEdge){xy.documentScrollLeft=doc.body.scrollLeft;xy.documentScrollTop=doc.body.scrollTop}xy.left+=xy.documentScrollLeft-window.pageXOffset;xy.top+=xy.documentScrollTop-window.pageYOffset}return xy};$.ig.util.getRelativeOffset=function(e){var elem=e.parent(),o={left:0,top:0},position;while(elem[0]!==null&&elem[0]!==undefined&&elem[0].nodeName!=="#document"){position=elem.css("position");if(position!=="static"&&position!==""){o.left=elem.offset().left-elem.scrollLeft();o.top=elem.offset().top-elem.scrollTop();break}elem=elem.parent()}return o};$.ig.util.setSize=function(elem,prop,val,chart,notifyResized){if(!elem||!elem[0]){return}var timer,px,obj=elem[0]._w_s_f=elem[0]._w_s_f||{},perc=obj.perc;if(!prop){if(obj.tickID){obj.onTick(true)}delete obj.elem;delete obj.chart;elem[0]._w_s_f=null;return}if(!val){val=elem[prop]()}if(perc&&perc.indexOf(prop)>=0){perc=perc.replace(prop,"")}if(val){elem[prop](val);if(typeof val!=="number"){val=val.toString();if(val.indexOf("%")>0){perc=perc||"";if(perc.indexOf(prop)<0){timer=perc+=prop}}px=val.indexOf("px");if(px>0){val=val.substring(0,px)}px=parseFloat(val);if(px.toString()===val){val=px}else{val=elem[prop]();if(!val){obj.wait=obj.wait||"";if(obj.wait.indexOf(prop)<0){obj.wait+=prop}timer=prop}}}obj.perc=perc;if(val&&chart){if(chart[prop]){chart[prop](val)}if(notifyResized){chart[notifyResized]()}}}if(!timer&&!elem[0].offsetWidth){timer=obj.wait="width"}if(timer){obj.elem=elem;obj.chart=chart;obj.notify=notifyResized;obj.onTick=obj.onTick||function(stop){var resize,obj=this,chart=obj.chart,elem=obj.elem,perc=obj.perc||"",wait=obj.wait||"",width=stop||elem[0].offsetWidth,height=stop||elem[0].offsetHeight,oldWidth=obj.oldWidth||0,oldHeight=obj.oldHeight||0;stop=stop===true||!perc&&!wait;if(stop){if(obj.tickID){clearInterval(obj.tickID)}delete obj.tickID;return}if(!obj.tickID&&(!width||!height||perc)){obj.tickID=setInterval(function(){obj.onTick()},200)}if(!width||!height){return}delete obj.wait;obj.oldWidth=width;obj.oldHeight=height;if(!chart){return}if(chart.width&&(perc.indexOf("width")>=0&&width!==oldWidth||wait.indexOf("width")>=0)){chart.width(resize=width)}if(chart.height&&(perc.indexOf("height")>=0&&height!==oldHeight||wait.indexOf("height")>=0)){chart.height(resize=height)}if(resize&&obj.notify){chart[obj.notify]()}};obj.onTick()}};$.ig.util.getEasingFunction=function(easingValue){if(easingValue===null||easingValue=="null"||easingValue=="linear"){return null}switch(easingValue){case"cubic":return $.ig.EasingFunctions.prototype.cubicEase}return easingValue};$.ig.util.hasVerticalScroll=function(elem){var overflow=$(elem).css("overflow-y");return overflow==="scroll"||overflow==="auto"&&elem[0].scrollHeight>elem[0].clientHeight};$.ig.util.hasHorizontalScroll=function(elem){var overflow=$(elem).css("overflow-x");return overflow==="scroll"||overflow==="auto"&&elem[0].scrollWidth>elem[0].clientWidth};$.ig.util.getScrollWidth=function(){var el=$('<div style="width: 100px; height: 100px; position: absolute; top: -10000px; left: -10000px; overflow: scroll"></div>').appendTo($(document.body)),scrollWidth;scrollWidth=el[0].offsetWidth-el[0].clientWidth;el.remove();return scrollWidth};$.ig.util.getScrollHeight=function(){var el=$('<div style="width: 100px; height: 100px; position: absolute; top: -10000px; left: -10000px; overflow: scroll"></div>').appendTo($(document.body)),scrollHeight;scrollHeight=el[0].offsetHeight-el[0].clientHeight;el.remove();return scrollHeight};$.ig.util.isDomElement=function(o){return typeof HTMLElement==="object"?o instanceof HTMLElement:o&&typeof o==="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName==="string"};$.ig.util.isJsonpUrl=function(url){var isJSONPExpr=/(=)\?(?=&|$)|\?\?/;return isJSONPExpr.test(url)};$.ig.util.evtButton=function(e){e=e?e.button:null;if(e===1){e=this._ie_8;if(!e){var v;e=window.navigator.userAgent;if(e){v=e.toLowerCase().indexOf("msie ");if(v>0){v=parseFloat(e.substring(v+5));if(v>8){v=parseFloat(document.documentMode)}}}this._ie_8=e=v&&!isNaN(v)&&v>5&&v<9?1:-1}e=e<0?1:0}return e===2?2:e?1:0};$.fn.animateRotate=function(startAngle,endAngle,duration,easing,complete){return this.each(function(){var elem=$(this);$({deg:startAngle}).animate({deg:endAngle},{duration:duration,easing:easing,step:function(now){elem.css({"-moz-transform":"rotate("+now+"deg)","-webkit-transform":"rotate("+now+"deg)","-o-transform":"rotate("+now+"deg)","-ms-transform":"rotate("+now+"deg)",transform:"rotate("+now+"deg)"})},complete:complete||$.noop})})};$.ig.util.dateFromISO=function(obj){var regexIso8601=/^(\d{4}|\+\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2})(?::(\d{2})(?::(\d{2})(?:\.(\d{1,7})(?:Z|([\-+])(\d{2}):(\d{2}))?)?)?)?)?)?)?$/,m=regexIso8601.exec(obj);if(m){return new Date(Date.UTC(m[1],(m[2]||1)-1,m[3]||1,m[4]-(m[8]?m[8]+m[9]:0)||0,m[5]-(m[8]?m[8]+m[10]:0)||0,m[6]||0,((m[7]||0)+"00").substr(0,3)))}return obj};$.ig.util.defaultDVDateParse=function(obj){return new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10))};$.ig.util.makeCRCTable=function(){var c,n,k,crcTable=[];for(n=0;n<256;n++){c=n;for(k=0;k<8;k++){c=c&1?3988292384^c>>>1:c>>>1}crcTable[n]=c}return crcTable};$.ig.util.crc32=function(str){var crcTable=$.ig.util.crcTable||($.ig.util.crcTable=$.ig.util.makeCRCTable()),crc=0^-1,i;str=unescape(encodeURIComponent(str));for(i=0;i<str.length;i++){crc=crc>>>8^crcTable[(crc^str.charCodeAt(i))&255]}return(crc^-1)>>>0};$.ig.util.getCheckSumForObject=function(obj){var str="",key;for(key in obj){if(obj.hasOwnProperty(key)&&typeof obj[key]!=="object"){str+=obj[key]}}return $.ig.util.crc32(str)};$.ig.util.createGuid=function(){function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}return(S4()+S4()+"-"+S4()+"-4"+S4().substr(0,3)+"-"+S4()+"-"+S4()+S4()+S4()).toLowerCase()};$.ig.util.escapeRegExp=function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};$.ig.util.escapeStr=function(str){return str.replace(/([ !"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~])/g,"\\$1")};$.ig.util.replace=function(str,oldValue,newValue){return str.replace(new RegExp($.ig.util.escapeRegExp(oldValue),"g"),newValue)};$.ig.util.stringFormat=function(format){return $.ig.util.stringFormat1(format,Array.prototype.slice.call(arguments,1))};$.ig.util.stringFormat1=function(format,args){return $.ig.util.stringFormat2($.ig.CultureInfo.prototype.currentCulture(),format,args)};$.ig.util.stringFormat2=function(provider,format,args){return format.replace(/{(\d+)(?::)?([^}]*)?}/g,function(match,number,format){var arg=args[number];if(arg===void 0)return match;if(arg===null)return"";if(format){if(format[0]==="X"){return $.ig.util.intToString1(arg,format,provider)}else{return $.ig.util.numberToString1(arg,format,provider)}}return arg})};$.ig.util.createInstance=function($t){if($t===Number||$t==$.ig.Number.prototype.$type||$t.baseType===$.ig.Enum.prototype.$type){return 0}if($t==Boolean||$t==$.ig.Boolean.prototype.$type){return false}if($t.InstanceConstructor){var result;if(typeof Object.create==="function"){result=Object.create($t.InstanceConstructor.prototype)}else{var Cons=function(){};Cons.prototype=$t.InstanceConstructor.prototype;result=new Cons}$t.InstanceConstructor.apply(result,Array.prototype.slice.call(arguments,1));return result}throw new Error("Cannot find instance constructor for the type parameter")};$.ig.util.getDefaultValue=function($t){if($t===Number||$t==$.ig.Number.prototype.$type||$t.baseType===$.ig.Enum.prototype.$type){return 0}if($t==Boolean||$t==$.ig.Boolean.prototype.$type){return false}if($t.baseType===$.ig.ValueType.prototype.$type){return $.ig.util.createInstance($t)}return null};$.ig.util.equalsSimple=function(item1,item2){return item1==item2};$.ig.util.compareSimple=function(item1,item2){if(item1==item2){return 0}if(item1<item2){return-1}return 1};$.ig.util.compare=function(item1,item2){if(item1===item2){return 0}var xComparable=$.ig.util.cast($.ig.IComparable.prototype.$type,item1);if(xComparable!==null){return xComparable.compareTo(item2)}var yComparable=$.ig.util.cast($.ig.IComparable.prototype.$type,item2);if(yComparable!==null){return-yComparable.compareTo(item1)}return $.ig.util.compareSimple(item1,item2)};$.ig.util.boolCompare=function(item1,item2){if(item1==item2){return 0}return item1?1:-1};$.ig.util.sleep=function(milliseconds){var start=(new Date).getTime();for(var i=0;i<1e7;i++){if((new Date).getTime()-start>milliseconds){break}}};$.ig.util.toCharArray=function(string){{return string.split("")}};$.ig.util.IMEtoENNumbersMapping=function(){return{"１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","０":"0"}};$.ig.util.IMEtoNumberString=function(stringValue,mapping){if(mapping===undefined){return stringValue}if(stringValue){stringValue=stringValue.toString();$.each(mapping,function(jpVal,engVal){stringValue=stringValue.replace(new RegExp(jpVal,"g"),engVal)})}return stringValue};$.ig.util.stringCompare1=function(strA,strB,comparisonType){if(!strA){return!strB?0:-1}else if(!strB){return 1}switch(comparisonType){case $.ig.StringComparison.prototype.currentCulture:return $.ig.CultureInfo.prototype.currentCulture().compareInfo().compare4(strA,strB);case $.ig.StringComparison.prototype.currentCultureIgnoreCase:return $.ig.CultureInfo.prototype.currentCulture().compareInfo().compare4(strA.toLowerCase(),strB.toLowerCase());case $.ig.StringComparison.prototype.invariantCulture:case $.ig.StringComparison.prototype.ordinal:return strA.compareTo(strB);case $.ig.StringComparison.prototype.invariantCultureIgnoreCase:case $.ig.StringComparison.prototype.ordinalIgnoreCase:return strA.toLowerCase().compareTo(strB.toLowerCase());default:break}return 0};$.ig.util.stringCompare2=function(strA,strB,culture,options){return culture.compareInfo().compare5(strA,strB,options)};$.ig.util.stringCompare3=function(strA,indexA,strB,indexB,length){var v1=strA.substr(indexA,length);var v2=strB.substr(indexB,length);return $.ig.util.stringCompare1(v1,v2,$.ig.StringComparison.prototype.currentCulture)};$.ig.util.tryParseNumber=function(s){var value=Number(s);if(value!==null&&isFinite(value)&&s.trim().length!==0){return{p1:value,ret:true}}else{return{p1:0,ret:false}}};$.ig.util.tryParseNumber1=function(s,style,provider){var value,i,currentCharCode;provider=provider||$.ig.CultureInfo.prototype.currentCulture();if(style&$.ig.NumberStyles.prototype.allowLeadingWhite){s=s.trimStart()}if(style&$.ig.NumberStyles.prototype.allowTrailingWhite){s=s.trimEnd()}if(s.length!=s.trim().length){return{p3:0,ret:false}}var numberFormat=provider.numberFormat();if(style&$.ig.NumberStyles.prototype.allowCurrencySymbol){if(s[0]=="$"){s=s.slice(1)}}var multiplier=1;var hadParentheses=false;if(style&$.ig.NumberStyles.prototype.allowParentheses){if(s[0]=="("&&s[s.length-1]==")"){hadParentheses=true;multiplier*=-1;s=s.slice(1,-1)}}if(style&$.ig.NumberStyles.prototype.allowCurrencySymbol){if(s[0]=="$"){s=s.slice(1)}}if(style&$.ig.NumberStyles.prototype.allowLeadingSign){var positiveSign=numberFormat.positiveSign();var negativeSign=numberFormat.negativeSign();if(s[0]==positiveSign||s[0]==negativeSign){if(hadParentheses){return{p3:0,ret:false}}if(s[0]==negativeSign){multiplier*=-1}s=s.slice(1)}}if(style&$.ig.NumberStyles.prototype.allowTrailingSign){}if(style&$.ig.NumberStyles.prototype.allowDecimalPoint){if(style&$.ig.NumberStyles.prototype.allowExponent){}if(style&$.ig.NumberStyles.prototype.allowThousands){var decimalSeparator=numberFormat.numberDecimalSeparator();var groupSeparator=numberFormat.numberGroupSeparator();var hitDecimalSeparator=false;for(i=0;i<s.length;i++){switch(s[i]){case groupSeparator:if(hitDecimalSeparator){return{p3:0,ret:false}}s=s.slice(0,i)+s.slice(i+1);i--;break;case decimalSeparator:hitDecimalSeparator=true;if(decimalSeparator!="."){s=s.slice(0,i)+"."+s.slice(i+1)}break}}}value=Number(s);if(value!==null&&isFinite(value)&&s.trim().length!==0){return{p3:value*multiplier,ret:true}}}else{var zeroCharCode="0".charCodeAt(0);var nineCharCode="9".charCodeAt(0);value=0;if(style&$.ig.NumberStyles.prototype.allowHexSpecifier){var aCharCode="a".charCodeAt(0);var fCharCode="f".charCodeAt(0);var ACharCode="A".charCodeAt(0);var FCharCode="F".charCodeAt(0);for(i=0;i<s.length;i++){value*=16;currentCharCode=s[i].charCodeAt(0);if(zeroCharCode<=currentCharCode&&currentCharCode<=nineCharCode){value+=currentCharCode-zeroCharCode}else if(aCharCode<=currentCharCode&&currentCharCode<=fCharCode){value+=currentCharCode-aCharCode+10}else if(ACharCode<=currentCharCode&&currentCharCode<=FCharCode){value+=currentCharCode-ACharCode+10}else{return{p3:0,ret:false}}}}else{for(i=0;i<s.length;i++){value*=10;currentCharCode=s[i].charCodeAt(0);if(zeroCharCode<=currentCharCode&&currentCharCode<=nineCharCode){value+=currentCharCode-zeroCharCode}else{return{p3:0,ret:false}}}}return{p3:value*multiplier,ret:true}}return{p3:0,ret:false}};$.ig.util.parseNumber=function(s,provider){var r=$.ig.util.tryParseNumber1(s,231,provider);if(!r.ret){throw new $.ig.FormatException(1,"Incorrect number format")}return r.p3};$.ig.util.isNegativeInfinity=function(v){return v==Number.NEGATIVE_INFINITY};$.ig.util.isPositiveInfinity=function(v){return v==Number.POSITIVE_INFINITY};$.ig.util.parseInt8_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,-128,127)};$.ig.util.parseInt8_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,-128,127,style)};$.ig.util.parseInt16_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,-32768,32767)};$.ig.util.parseInt16_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,-32768,32767,style)};$.ig.util.parseInt32_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,-2147483648,2147483647)};$.ig.util.parseInt32_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,-2147483648,2147483647,style)};$.ig.util.parseInt64_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,-0x8000000000000000,0x8000000000000000)};$.ig.util.parseInt64_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,-0x8000000000000000,0x8000000000000000,style)};$.ig.util.parseUInt8_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,0,255)};$.ig.util.parseUInt8_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,0,255,style)};$.ig.util.parseUInt16_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,0,65535)};$.ig.util.parseUInt16_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,0,65535,style)};$.ig.util.parseUInt32_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,0,4294967295)};$.ig.util.parseUInt32_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,0,4294967295,style)};$.ig.util.parseUInt64_1=function(s,provider){return $.ig.util.parseIntCore(s,provider,0,0x10000000000000000)};$.ig.util.parseUInt64_2=function(s,style,provider){return $.ig.util.parseIntCore(s,provider,0,0x10000000000000000,style)};$.ig.util.parseIntCore=function(s,provider,min,max,style){var r=$.ig.util.tryParseIntCore(s,provider,min,max,style);if(!r.ret){throw new $.ig.FormatException(1,"Incorrect number format")}return r.p3};$.ig.util.tryParseInt8_1=function(s){return $.ig.util.tryParseIntCore(s,null,-128,127)};$.ig.util.tryParseInt8_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,-128,127,style)};$.ig.util.tryParseInt16_1=function(s){return $.ig.util.tryParseIntCore(s,null,-32768,32767)};$.ig.util.tryParseInt16_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,-32768,32767,style)};$.ig.util.tryParseInt32_1=function(s){return $.ig.util.tryParseIntCore(s,null,-2147483648,2147483647)};$.ig.util.tryParseInt32_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,-2147483648,2147483647,style)};$.ig.util.tryParseInt64_1=function(s){return $.ig.util.tryParseIntCore(s,null,-0x8000000000000000,0x8000000000000000)};$.ig.util.tryParseInt64_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,-0x8000000000000000,0x8000000000000000,style)};$.ig.util.tryParseUInt8_1=function(s){return $.ig.util.tryParseIntCore(s,null,0,255)};$.ig.util.tryParseUInt8_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,0,255,style)};$.ig.util.tryParseUInt16_1=function(s){return $.ig.util.tryParseIntCore(s,null,0,65535)};$.ig.util.tryParseUInt16_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,0,65535,style)};$.ig.util.tryParseUInt32_1=function(s){return $.ig.util.tryParseIntCore(s,null,0,4294967295)};$.ig.util.tryParseUInt32_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,0,4294967295,style)};$.ig.util.tryParseUInt64_1=function(s){return $.ig.util.tryParseIntCore(s,null,0,0x10000000000000000)};$.ig.util.tryParseUInt64_2=function(s,style,provider){return $.ig.util.tryParseIntCore(s,provider,0,0x10000000000000000,style)};$.ig.util.tryParseIntCore=function(s,provider,min,max,style){style=style!=null?style:$.ig.NumberStyles.prototype.integer;provider=provider||$.ig.CultureInfo.prototype.currentCulture();var r=$.ig.util.tryParseNumber1(s,style,provider);if(style&$.ig.NumberStyles.prototype.allowHexSpecifier&&max<r.p3){r.p3-=-min*2}if(!r.ret||r.p3<min||max<r.p3||r.p3%1!==0){return{p1:0,p3:0,ret:false}}r.p1=r.p3;return r};$.ig.util.parseBool=function(s){var r=$.ig.util.tryParseBool(s);if(!r.ret){throw new $.ig.FormatException(1,"Incorrect boolean format")}return r.p1};$.ig.util.tryParseBool=function(s){switch(s==null?"":s.trim().toLowerCase()){case"true":return{p1:true,ret:true};case"false":return{p1:false,ret:true};default:return{p1:false,ret:false}}};$.ig.util.arrayClear1=function(array,index,length){for(var i=index;i<index+length;i++){array[i]=null}};$.ig.util.arrayCopy1=function(source,sourceIndex,dest,destIndex,count){for(var i=0;i<count;i++){dest[i+destIndex]=source[i+sourceIndex]}};$.ig.util.arrayCopy2=function(source,dest,count){for(var i=0;i<count;i++){dest[i]=source[i]}};$.ig.util.arrayCopyTo=function(source,dest,index){for(var i=0;i<source.length;i++){dest[index++]=source[i]}};$.ig.util.arrayIndexOf1=function($t,array,value){return array.indexOf(value)};$.ig.util.isNaN=function(v){return v!==v};$.ig.util.numberToString=function(number,provider){return $.ig.util.numberToString1(number,"G",provider)};var gFormatOptions={useGrouping:false,maximumSignificantDigits:15};var zeroFormatOptions={useGrouping:false,maximumSignificantDigits:15,maximumFractionDigits:0};$.ig.util.numberToString1=function(number,format,provider){provider=provider||$.ig.CultureInfo.prototype.currentCulture();switch(format){case"G":return number.toLocaleString(provider.name(),gFormatOptions);case"R":case"r":return number.toString().replace(".",provider.numberFormat().numberDecimalSeparator())}if(format.startsWith("0")){var integerDigitsRequired=0;var isValid=true;for(var i=0;i<format.length;i++){if(format[i]==="0"){integerDigitsRequired++}else{isValid=false;break}}if(isValid){var result=number.toLocaleString(provider.name(),zeroFormatOptions);while(result.length<integerDigitsRequired){result="0"+result}return result}}throw new $.ig.FormatException(1,"Unsupported format code: "+format)};$.ig.util.intToString=function(number,provider){return $.ig.util.intToString1(number,"G",provider)};$.ig.util.intToString1=function(number,format,provider){provider=provider||$.ig.CultureInfo.prototype.currentCulture();if(format&&format.length){if(format[0]=="X"){number=$.ig.util.intSToU(number);var result=number.toString(16).toUpperCase();if(format.length!==1){var digits=+format.substr(1);if(!isFinite(digits)){throw new Error("Unsupported format code: "+format)}while(result.length<digits){result="0"+result}}return result}}switch(format){case"G":return number.toLocaleString(provider.name(),gFormatOptions)}throw new Error("Unsupported format code: "+format)};$.ig.util.intSToU=function(number){if(number<0){number=number+1+4294967295}return number};$.ig.util.enumHasFlag=function(value,flag){return(value&flag)===flag};$.ig.util.boolToString=function(value,provider){return value.toString()};$.ig.util.getArrayOfValues=function(obj){var result=[];for(var i in obj){if(obj.hasOwnProperty(i)){result.push(obj[i])}}return result};$.ig.util.getArrayOfProperties=function(obj){var result=[];for(var i in obj){if(obj.hasOwnProperty(i)){result.push(i)}}return result};$.ig.util.stringInsert=function(str,index,value){return str.substr(0,index)+value+str.substr(index)};$.ig.util.b64toUint8Array=function(b64Data,nBlocksSize){function b64ToUint6(nChr){return nChr>64&&nChr<91?nChr-65:nChr>96&&nChr<123?nChr-71:nChr>47&&nChr<58?nChr+4:nChr===43?62:nChr===47?63:0}var sB64Enc=b64Data.replace(/[^A-Za-z0-9\+\/]/g,""),nInLen=sB64Enc.length,nOutLen=nBlocksSize?Math.ceil((nInLen*3+1>>2)/nBlocksSize)*nBlocksSize:nInLen*3+1>>2,taBytes;if(typeof window.Uint8Array==="function"){taBytes=new Uint8Array(nOutLen)}else{taBytes=new Array(nOutLen)}for(var nMod3,nMod4,nUint24=0,nOutIdx=0,nInIdx=0;nInIdx<nInLen;nInIdx++){nMod4=nInIdx&3;nUint24|=b64ToUint6(sB64Enc.charCodeAt(nInIdx))<<18-6*nMod4;if(nMod4===3||nInLen-nInIdx===1){for(nMod3=0;nMod3<3&&nOutIdx<nOutLen;nMod3++,nOutIdx++){taBytes[nOutIdx]=nUint24>>>(16>>>nMod3&24)&255}nUint24=0}}return taBytes};$.ig.util.uint8ArraytoB64=function(aBytes){function uint6ToB64(nUint6){return nUint6<26?nUint6+65:nUint6<52?nUint6+71:nUint6<62?nUint6-4:nUint6===62?43:nUint6===63?47:65}var nMod3=2,sB64Enc="";for(var nLen=aBytes.length,nUint24=0,nIdx=0;nIdx<nLen;nIdx++){nMod3=nIdx%3;if(nIdx>0&&nIdx*4/3%76===0){sB64Enc+="\r\n"}nUint24|=aBytes[nIdx]<<(16>>>nMod3&24);if(nMod3===2||aBytes.length-nIdx===1){sB64Enc+=String.fromCharCode(uint6ToB64(nUint24>>>18&63),uint6ToB64(nUint24>>>12&63),uint6ToB64(nUint24>>>6&63),uint6ToB64(nUint24&63));nUint24=0}}return sB64Enc.substr(0,sB64Enc.length-2+nMod3)+(nMod3===2?"":nMod3===1?"=":"==")};$.ig.util.stringSplit=function(value,separators,options){var r="",i;for(i=0;i<separators.length;i++){if(i!==0){r+="|"}r+=separators[i]}var result=value.split(new RegExp(r));for(i=result.length-1;i>=0;i--){if(result[i].length===0&&options&$.ig.StringSplitOptions.prototype.removeEmptyEntries||separators.contains(result[i])){result.splice(i,1)}}return result};$.ig.util.stringJoin=function(sep,vals){return vals.join(sep)};$.ig.util.stringJoin1=function($t,sep,vals){var result;var en=vals.getEnumerator();while(en.moveNext()){var v=en.current().toString();if(result===undefined){result=v}else{result+=sep+v}}return result};$.ig.util.toString$1=function($t,v){if(v!==null&&$t){if($t.name=="Nullable$1"&&$t.typeArguments.length===1){$t=$t.typeArguments[0]}if(typeof $t.isEnum==="function"&&$t.isEnum()){return $t.InstanceConstructor.prototype.$getName(v)}}return v.toString()};$.ig.util.castObjTo$t=function($t,v){var shouldWrap=false;if($t.name=="Nullable$1"&&$t.typeArguments.length===1){$t=$t.typeArguments[0];shouldWrap=true}if(v!==null&&typeof $t.isEnum==="function"&&$t.isEnum()){v=v.$value()}return shouldWrap?$.ig.util.toNullable($t,v):v};$.ig.util.getBoxIfEnum=function($t,v){if(v!==null&&$t){if($t.name=="Nullable$1"&&$t.typeArguments.length===1){$t=$t.typeArguments[0]}if(typeof $t.isEnum==="function"&&$t.isEnum()){return $t.InstanceConstructor.prototype.getBox(v)}}return v};$.ig.util.getValue=function(v){if(v!==null&&v.$type&&v.$type.isEnum&&v.$type.isEnum()){return v.$value()}return v};$.ig.util.getEnumValue=function(v){if(v!==null){if(typeof v==="number"){return v}else{return v.$value()}}return 0};$.ig.util.netRegexToJS=function(netPattern){var jsPattern="";var nextNETGroupIndex=1;var nextJSGroupIndex=1;var namedGroups=[];var nameToJSGroupIndexMap={};var netToJSGroupIndexMap=[[0]];var matchMustStartAtCurrentPosition=false;var name;var i=0;if(netPattern.startsWith("\\G")){i+=2;matchMustStartAtCurrentPosition=true}var isInClass=false;for(;i<netPattern.length;i++){var current=netPattern.charAt(i);switch(current){case"\\":switch(netPattern.charAt(i+1)){case"A":jsPattern=jsPattern.concat("^");i++;break;case"z":case"Z":jsPattern=jsPattern.concat("$");i++;break;case"G":throw new Error("\\G .NET Regex escape is only supported at the start of the pattern.");case"p":if(netPattern.charAt(i+2)!=="{"){throw new Error("\\p should be followed by braces.")}var endBraceIndex=netPattern.indexOf("}",i+3);if(endBraceIndex<0){throw new Error("Could not find the close brace of the \\p pattern.")}var pattern=netPattern.substring(i+3,endBraceIndex);i=endBraceIndex;var content=unicodeCategories[pattern];if(content===void 0){throw new Error("Unknown \\p pattern: "+pattern)}if(isInClass){jsPattern=jsPattern.concat(content.substr(1,content.length-2))}else{jsPattern=jsPattern.concat(content)}break;default:jsPattern=jsPattern.concat(netPattern.substr(i,2));i++;break}break;case"/":jsPattern=jsPattern.concat("\\/");break;case"[":isInClass=true;jsPattern=jsPattern.concat("[");break;case"]":isInClass=false;jsPattern=jsPattern.concat("]");break;case"(":jsPattern=jsPattern.concat("(");var next=netPattern[i+1];name="";if(next==="?"){i++;next=netPattern[i+1];if(next==="<"||next==="'"){if(netPattern[i+2]==="="||netPattern[i+2]==="!"){throw new Error("Lookbehind assertions are not supported in JavaScript: "+pattern)}i++;var end=next==="<"?">":"'";var start=++i;for(;i<netPattern.length&&netPattern[i]!=end;i++){}name=netPattern.slice(start,i)}else{jsPattern=jsPattern.concat("?");if(next===":"){continue}}}var currentJSGroupIndex=nextJSGroupIndex++;if(name.length!==0){if(!namedGroups.contains(name))namedGroups.push(name);var jsGroups=nameToJSGroupIndexMap[name];
if(!jsGroups){nameToJSGroupIndexMap[name]=jsGroups=[]}jsGroups.push(currentJSGroupIndex)}else{netToJSGroupIndexMap[nextNETGroupIndex++]=[currentJSGroupIndex]}break;default:jsPattern=jsPattern.concat(netPattern.substr(i,1));break}}var nameToNetGroupIndexMap={};for(i=0;i<namedGroups.length;i++){var currentNETGroupIndex=nextNETGroupIndex++;name=namedGroups[i];netToJSGroupIndexMap[currentNETGroupIndex]=nameToJSGroupIndexMap[name];nameToNetGroupIndexMap[name]=currentNETGroupIndex}return{pattern:jsPattern,nameToNetGroupIndexMap:nameToNetGroupIndexMap,netToJSGroupIndexMap:netToJSGroupIndexMap,matchMustStartAtCurrentPosition:matchMustStartAtCurrentPosition}};$.ig.util.timeSpanInit1=function(h,m,s){return h*36e5+m*6e4+s*1e3};$.ig.util.timeSpanInit2=function(d,h,m,s,ms){return d*864e5+h*36e5+m*6e4+s*1e3+ms};$.ig.util.timeSpanInit3=function(d,h,m,s){return d*864e5+h*36e5+m*6e4+s*1e3};$.ig.util.timeSpanTotalDays=function(t){return t/864e5};$.ig.util.timeSpanTotalHours=function(t){return t/36e5};$.ig.util.timeSpanTotalMilliseconds=function(t){return t};$.ig.util.timeSpanTotalMinutes=function(t){return t/6e4};$.ig.util.timeSpanTotalSeconds=function(t){return t/1e3};$.ig.util.timeSpanFromDays=function(v){return v*864e5};$.ig.util.timeSpanFromHours=function(v){return v*36e5};$.ig.util.timeSpanFromMilliseconds=function(v){return v};$.ig.util.timeSpanFromMinutes=function(v){return v*6e4};$.ig.util.timeSpanFromSeconds=function(v){return v*1e3};$.ig.util.timeSpanFromTicks=function(v){return v/1e4};$.ig.util.timeSpanDays=function(t){return $.ig.truncate(t/864e5)};$.ig.util.timeSpanHours=function(t){return $.ig.truncate(t/36e5%24)};$.ig.util.timeSpanMilliseconds=function(t){return t%1e3};$.ig.util.timeSpanMinutes=function(t){return $.ig.truncate(t/6e4%60)};$.ig.util.timeSpanSeconds=function(t){return $.ig.truncate(t/1e3%60)};$.ig.util.timeSpanTicks=function(t){return $.ig.truncate(t*1e4)};$.ig.util.timeSpanNegate=function(t){return-t};$.ig.util.dateAdd=function(d,t){return new Date(+d+t)};$.ig.util.dateSubtract=function(d,t){return new Date(+d-t)};$.ig.util.u32BitwiseAnd=function(a,b){var r=a&b;if(r<0)r+=4294967296;return r};$.ig.util.u32BitwiseOr=function(a,b){var r=a|b;if(r<0)r+=4294967296;return r};$.ig.util.u32BitwiseXor=function(a,b){var r=a^b;if(r<0)r+=4294967296;return r};$.ig.util.u32LS=function(a,b){var r=a<<b;if(r<0)r+=4294967296;return r};$.ig.util.invokeCallback=function(callback,args){if(callback){if($.type(callback)==="string"&&window[callback]&&$.type(window[callback])==="function"){callback=window[callback]}if($.type(callback)==="function"){callback.apply(window,args)}}};if($.Widget){(function(createWidget){$.Widget.prototype._createWidget=function(options,element){var el=$(element||this.defaultElement||this)[0];if(el!==this){$.data(el,this.widgetName,this)}return createWidget.apply(this,arguments)}})($.Widget.prototype._createWidget);(function(destroy){$.Widget.prototype.destroy=function(){var ret=destroy.apply(this,arguments);if(this.widgetName&&this.element){this.element.removeData(this.widgetName)}return ret}})($.Widget.prototype.destroy)}$.ig.util.defType("SystemException","Error",{init:function(initNumber){if(initNumber>0){switch(initNumber){case 1:this.init1.apply(this,arguments);break;case 2:this.init2.apply(this,arguments);break}return}$.ig.Error.prototype.init.call(this,0)},init1:function(initNumber,message){$.ig.Error.prototype.init1.call(this,1,message)},init2:function(initNumber,message,innerException){$.ig.Error.prototype.init2.call(this,2,message,innerException)},$type:new $.ig.Type("SystemException",$.ig.Error.prototype.$type)},true);$.ig.util.defType("FormatException","SystemException",{init:function(initNumber){if(initNumber>0){switch(initNumber){case 1:this.init1.apply(this,arguments);break;case 2:this.init2.apply(this,arguments);break}return}$.ig.SystemException.prototype.init.call(this,0)},init1:function(initNumber,message){$.ig.SystemException.prototype.init1.call(this,1,message)},init2:function(initNumber,message,innerException){$.ig.SystemException.prototype.init2.call(this,2,message,innerException)},$type:new $.ig.Type("FormatException",$.ig.SystemException.prototype.$type)},true);$.ig.util.defType("NumberStyles","Enum",{init:function(v){this._v=v},$getName:function(){function getNameSingle(v){switch(v){case 0:return"None";case 1:return"AllowLeadingWhite";case 2:return"AllowTrailingWhite";case 4:return"AllowLeadingSign";case 7:return"Integer";case 8:return"AllowTrailingSign";case 16:return"AllowParentheses";case 32:return"AllowDecimalPoint";case 64:return"AllowThousands";case 111:return"Number";case 128:return"AllowExponent";case 167:return"Float";case 256:return"AllowCurrencySymbol";case 383:return"Currency";case 511:return"Any";case 512:return"AllowHexSpecifier";case 515:return"HexNumber";default:return v.toString()}}return function(v){return this.getFlaggedName(v,getNameSingle)}}(),$value:function(){return this._v},$type:new $.ig.Type("NumberStyles",$.ig.Enum.prototype.$type)},true);$.ig.NumberStyles.prototype.none=0;$.ig.NumberStyles.prototype.allowLeadingWhite=1;$.ig.NumberStyles.prototype.allowTrailingWhite=2;$.ig.NumberStyles.prototype.allowLeadingSign=4;$.ig.NumberStyles.prototype.integer=7;$.ig.NumberStyles.prototype.allowTrailingSign=8;$.ig.NumberStyles.prototype.allowParentheses=16;$.ig.NumberStyles.prototype.allowDecimalPoint=32;$.ig.NumberStyles.prototype.allowThousands=64;$.ig.NumberStyles.prototype.number=111;$.ig.NumberStyles.prototype.allowExponent=128;$.ig.NumberStyles.prototype.floatNumber=167;$.ig.NumberStyles.prototype.allowCurrencySymbol=256;$.ig.NumberStyles.prototype.currency=383;$.ig.NumberStyles.prototype.any=511;$.ig.NumberStyles.prototype.allowHexSpecifier=512;$.ig.NumberStyles.prototype.hexNumber=515;$.ig.util.defType("CompareOptions","Enum",{init:function(v){this._v=v},$getName:function(){function getNameSingle(v){switch(v){case 0:return"None";case 1:return"IgnoreCase";case 2:return"IgnoreNonSpace";case 4:return"IgnoreSymbols";case 8:return"IgnoreKanaType";case 16:return"IgnoreWidth";case 268435456:return"OrdinalIgnoreCase";case 536870912:return"StringSort";case 1073741824:return"Ordinal";default:return v.toString()}}return function(v){return this.getFlaggedName(v,getNameSingle)}}(),$value:function(){return this._v},$type:new $.ig.Type("CompareOptions",$.ig.Enum.prototype.$type)},true);$.ig.CompareOptions.prototype.none=0;$.ig.CompareOptions.prototype.ignoreCase=1;$.ig.CompareOptions.prototype.ignoreNonSpace=2;$.ig.CompareOptions.prototype.ignoreSymbols=4;$.ig.CompareOptions.prototype.ignoreKanaType=8;$.ig.CompareOptions.prototype.ignoreWidth=16;$.ig.CompareOptions.prototype.ordinalIgnoreCase=268435456;$.ig.CompareOptions.prototype.stringSort=536870912;$.ig.CompareOptions.prototype.ordinal=1073741824;$.ig.util.defType("StringComparison","Enum",{init:function(v){this._v=v},$getName:function(v){switch(v){case 0:return"CurrentCulture";case 1:return"CurrentCultureIgnoreCase";case 2:return"InvariantCulture";case 3:return"InvariantCultureIgnoreCase";case 4:return"Ordinal";case 5:return"OrdinalIgnoreCase";default:return v.toString()}},$value:function(){return this._v},$type:new $.ig.Type("StringComparison",$.ig.Enum.prototype.$type)},true);$.ig.StringComparison.prototype.currentCulture=0;$.ig.StringComparison.prototype.currentCultureIgnoreCase=1;$.ig.StringComparison.prototype.invariantCulture=2;$.ig.StringComparison.prototype.invariantCultureIgnoreCase=3;$.ig.StringComparison.prototype.ordinal=4;$.ig.StringComparison.prototype.ordinalIgnoreCase=5;$.ig.util.defType("DateTimeKind","Enum",{init:function(v){this._v=v},$getName:function(v){switch(v){case 0:return"Unspecified";case 1:return"Utc";case 2:return"Local";default:return v.toString()}},$value:function(){return this._v},$type:new $.ig.Type("DateTimeKind",$.ig.Enum.prototype.$type)},true);$.ig.DateTimeKind.prototype.unspecified=0;$.ig.DateTimeKind.prototype.utc=1;$.ig.DateTimeKind.prototype.local=2;$.ig.util.defType("SeekOrigin","Enum",{init:function(v){this._v=v},$getName:function(v){switch(v){case 0:return"Begin";case 1:return"Current";case 2:return"End";default:return v.toString()}},$value:function(){return this._v},$type:new $.ig.Type("SeekOrigin",$.ig.Enum.prototype.$type)},true);$.ig.SeekOrigin.prototype.begin=0;$.ig.SeekOrigin.prototype.current=1;$.ig.SeekOrigin.prototype.end=2;$.ig.util.defType("StringSplitOptions","Enum",{init:function(v){this._v=v},$getName:function(v){switch(v){case 0:return"None";case 1:return"RemoveEmptyEntries";default:return v.toString()}},$value:function(){return this._v},$type:new $.ig.Type("StringSplitOptions",$.ig.Enum.prototype.$type)},true);$.ig.StringSplitOptions.prototype.none=0;$.ig.StringSplitOptions.prototype.removeEmptyEntries=1;$.ig.util.defType("DayOfWeek","Enum",{init:function(v){this._v=v},$getName:function(v){switch(v){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return v.toString()}},$value:function(){return this._v},$type:new $.ig.Type("DayOfWeek",$.ig.Enum.prototype.$type)},true);$.ig.DayOfWeek.prototype.sunday=0;$.ig.DayOfWeek.prototype.monday=1;$.ig.DayOfWeek.prototype.tuesday=2;$.ig.DayOfWeek.prototype.wednesday=3;$.ig.DayOfWeek.prototype.thursday=4;$.ig.DayOfWeek.prototype.friday=5;$.ig.DayOfWeek.prototype.saturday=6;function decimalAdjust(type,value,exp){if(typeof exp==="undefined"||+exp===0){return Math[type](value)}value=+value;exp=+exp;if(isNaN(value)||!(typeof exp==="number"&&exp%1===0)){return NaN}value=value.toString().split("e");value=Math[type](+(value[0]+"e"+(value[1]?+value[1]-exp:-exp)));value=value.toString().split("e");return+(value[0]+"e"+(value[1]?+value[1]+exp:exp))}if(!Math.round10){Math.round10=function(value,exp){return decimalAdjust("round",value,exp)}}if(!Math.round10N){Math.round10N=function(value,exp){return decimalAdjust("round",value,-exp)}}if(!Math.floor10){Math.floor10=function(value,exp){return decimalAdjust("floor",value,exp)}}if(!Math.ceil10){Math.ceil10=function(value,exp){return decimalAdjust("ceil",value,exp)}}$.ig.util.isPoint=function(p){if(p==null){return false}if($.ig.util.cast($.ig.Point.prototype.$type,p)!=null){return true}if(typeof p.x==="number"&&typeof p.y==="number"){return true}return false};$.ig.util.pointFromLiteral=function(p){if(p==null){return new $.ig.Point(1,0,0)}var cast=$.ig.util.cast($.ig.Point.prototype.$type,p);if(cast!=null){return cast}return new $.ig.Point(1,p.x,p.y)};$.ig.util.pointToLiteral=function(p){var cast=$.ig.util.cast($.ig.Point.prototype.$type,p);if(cast==null){return null}return{x:cast.x(),y:cast.y()}};$.ig.util.isSize=function(s){if(s==null){return false}if($.ig.util.cast($.ig.Size.prototype.$type,s)!=null){return true}if(typeof s.width==="number"&&typeof s.height==="number"){return true}return false};$.ig.util.sizeFromLiteral=function(s){if(s==null){return new $.ig.Size(1,0,0)}var cast=$.ig.util.cast($.ig.Size.prototype.$type,s);if(cast!=null){return cast}return new $.ig.Size(1,s.width,s.height)};$.ig.util.sizeToLiteral=function(s){var cast=$.ig.util.cast($.ig.Size.prototype.$type,s);if(cast==null){return null}return{width:cast.width(),height:cast.height()}};$.ig.util.isRect=function(r){if(r==null){return false}if($.ig.util.cast($.ig.Rect.prototype.$type,r)!=null){return true}if(typeof r.x==="number"&&typeof r.y==="number"&&typeof r.width==="number"&&typeof r.height==="number"){return true}if(typeof r.left==="number"&&typeof r.top==="number"&&typeof r.right==="number"&&typeof r.bottom==="number"){return true}return false};$.ig.util.rectFromLiteral=function(r){if(r==null){return new $.ig.Rect(0,0,0,0,0)}var cast=$.ig.util.cast($.ig.Rect.prototype.$type,r);if(cast!=null){return cast}if(typeof r.x==="number"&&typeof r.y==="number"&&typeof r.width==="number"&&typeof r.height==="number"){return new $.ig.Rect(0,r.x,r.y,r.width,r.height)}return new $.ig.Rect(0,r.left,r.top,r.right-r.left,r.bottom-r.top)};$.ig.util.rectToLiteral=function(r){var cast=$.ig.util.cast($.ig.Rect.prototype.$type,r);if(cast==null){return null}return{x:cast.x(),y:cast.y(),width:cast.width(),height:cast.height(),left:cast.left(),top:cast.top(),right:cast.right(),bottom:cast.bottom()}};var unicodeCategories={Cn:"[͸͹Ϳ-΃΋΍΢Ԩ-԰՗՘ՠֈ֋-֐׈-׏׫-ׯ׵-׿؄؅؜؝܎݋݌޲-޿߻-߿࠮࠯࠿࡜࡝࡟-ࣿॸঀ঄঍঎঑঒঩঱঳-঵঺঻৅৆৉৊৏-৖৘-৛৞৤৥ৼ-਀਄਋-਎਑਒਩਱਴਷਺਻਽੃-੆੉੊੎-੐੒-੘੝੟-੥੶-઀઄઎઒઩઱઴઺઻૆૊૎૏૑-૟૤૥૰૲-଀଄଍଎଑଒଩଱଴଺଻୅୆୉୊୎-୕୘-୛୞୤୥୸-஁஄஋-஍஑஖-஘஛஝஠-஢஥-஧஫-஭஺-஽௃-௅௉௎௏௑-௖௘-௥௻-ఀఄ఍఑఩ఴ఺-఼౅౉౎-౔౗ౚ-౟౤౥౰-౷ಀಁ಄಍಑಩಴಺಻೅೉೎-೔೗-ೝ೟೤೥೰ೳ-ഁഄ഍഑഻഼൅൉൏-ൖ൘-ൟ൤൥൶-൸඀ඁ඄඗-඙඲඼඾඿෇-෉෋-෎෕෗෠-෱෵-฀฻-฾๜-຀຃຅ຆຉ຋ຌຎ-ຓຘຠ຤຦ຨຩຬ຺຾຿໅໇໎໏໚໛ໞ-໿཈཭-཰྘྽࿍࿛-࿿჆-჏ჽ-ჿ቉቎቏቗቙቞቟኉኎኏኱኶኷኿዁዆዇዗጑጖጗፛፜፽-፿᎚-᎟Ᏽ-᏿᚝-᚟ᛱ-᛿ᜍ᜕-ᜟ᜷-᜿᝔-᝟᝭᝱᝴-᝿៞៟៪-៯៺-៿᠏᠚-᠟ᡸ-᡿᢫-᢯᣶-᣿ᤝ-᤟᤬-᤯᤼-᤿᥁-᥃᥮᥯᥵-᥿᦬-᦯᧊-᧏᧛-᧝᨜᨝᩟᩽᩾᪊-᪏᪚-᪟᪮-᫿ᭌ-᭏᭽-᭿᮫-ᮭᮺ-ᮿ᯴-᯻᰸-᰺᱊-᱌ᲀ-᳏ᳳ-᳿ᷧ-᷻἖἗἞἟὆὇὎὏὘὚὜὞὾὿᾵῅῔῕῜῰῱῵῿⁥-⁩⁲⁳₏₝-₟₺-⃏⃱-⃿↊-↏⏴-⏿␧-␿⑋-⑟✀⟋⟍⭍-⭏⭚-⯿ⰯⱟⳲ-⳸⴦-⴯ⵦ-⵮⵱-⵾⶗-⶟⶧⶯⶷⶿⷇⷏⷗⷟⸲-⹿⺚⻴-⻿⿖-⿯⿼-⿿぀゗゘㄀-㄄ㄮ-㄰㆏ㆻ-ㆿ㇤-㇯㈟㋿䶶-䶿鿌-鿿꒍-꒏꓇-꓏꘬-꘿ꙴ-ꙻꚘ-ꚟ꛸-꛿ꞏꞒ-ꞟꞪ-ꟹ꠬-꠯꠺-꠿꡸-꡿ꣅ-꣍꣚-꣟꣼-ꣿ꥔-꥞꥽-꥿꧎꧚-꧝ꧠ-꧿꨷-꨿꩎꩏꩚꩛ꩼ-ꩿ꫃-꫚ꫠ-꬀꬇꬈꬏꬐꬗-꬟꬧꬯-ꮿ꯮꯯꯺-꯿힤-힯퟇-퟊퟼-퟿郞隷﩮﩯﫚-﫿﬇-﬒﬘-﬜﬷﬽﬿﭂﭅﯂-﯒﵀-﵏﶐﶑﷈-﷯﷾﷿︚-︟︧-︯﹓﹧﹬-﹯﹵﻽﻾＀﾿-￁￈￉￐￑￘￙￝-￟￧￯-￸￾￿]",Lu:"[A-ZÀ-ÖØ-ÞĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮİĲĴĶĹĻĽĿŁŃŅŇŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŸŹŻŽƁƂƄƆƇƉ-ƋƎ-ƑƓƔƖ-ƘƜƝƟƠƢƤƦƧƩƬƮƯƱ-ƳƵƷƸƼǄǇǊǍǏǑǓǕǗǙǛǞǠǢǤǦǨǪǬǮǱǴǶ-ǸǺǼǾȀȂȄȆȈȊȌȎȐȒȔȖȘȚȜȞȠȢȤȦȨȪȬȮȰȲȺȻȽȾɁɃ-ɆɈɊɌɎͰͲͶΆΈ-ΊΌΎΏΑ-ΡΣ-ΫϏϒ-ϔϘϚϜϞϠϢϤϦϨϪϬϮϴϷϹϺϽ-ЯѠѢѤѦѨѪѬѮѰѲѴѶѸѺѼѾҀҊҌҎҐҒҔҖҘҚҜҞҠҢҤҦҨҪҬҮҰҲҴҶҸҺҼҾӀӁӃӅӇӉӋӍӐӒӔӖӘӚӜӞӠӢӤӦӨӪӬӮӰӲӴӶӸӺӼӾԀԂԄԆԈԊԌԎԐԒԔԖԘԚԜԞԠԢԤԦԱ-ՖႠ-ჅḀḂḄḆḈḊḌḎḐḒḔḖḘḚḜḞḠḢḤḦḨḪḬḮḰḲḴḶḸḺḼḾṀṂṄṆṈṊṌṎṐṒṔṖṘṚṜṞṠṢṤṦṨṪṬṮṰṲṴṶṸṺṼṾẀẂẄẆẈẊẌẎẐẒẔẞẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼẾỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪỬỮỰỲỴỶỸỺỼỾἈ-ἏἘ-ἝἨ-ἯἸ-ἿὈ-ὍὙὛὝὟὨ-ὯᾸ-ΆῈ-ΉῘ-ΊῨ-ῬῸ-Ώℂℇℋ-ℍℐ-ℒℕℙ-ℝℤΩℨK-ℭℰ-ℳℾℿⅅↃⰀ-ⰮⱠⱢ-ⱤⱧⱩⱫⱭ-ⱰⱲⱵⱾ-ⲀⲂⲄⲆⲈⲊⲌⲎⲐⲒⲔⲖⲘⲚⲜⲞⲠⲢⲤⲦⲨⲪⲬⲮⲰⲲⲴⲶⲸⲺⲼⲾⳀⳂⳄⳆⳈⳊⳌⳎⳐⳒⳔⳖⳘⳚⳜⳞⳠⳢⳫⳭꙀꙂꙄꙆꙈꙊꙌꙎꙐꙒꙔꙖꙘꙚꙜꙞꙠꙢꙤꙦꙨꙪꙬꚀꚂꚄꚆꚈꚊꚌꚎꚐꚒꚔꚖꜢꜤꜦꜨꜪꜬꜮꜲꜴꜶꜸꜺꜼꜾꝀꝂꝄꝆꝈꝊꝌꝎꝐꝒꝔꝖꝘꝚꝜꝞꝠꝢꝤꝦꝨꝪꝬꝮꝹꝻꝽꝾꞀꞂꞄꞆꞋꞍꞐꞠꞢꞤꞦꞨＡ-Ｚ]",Ll:"[a-zªµºß-öø-ÿāăąćĉċčďđēĕėęěĝğġģĥħĩīĭįıĳĵķĸĺļľŀłńņňŉŋōŏőœŕŗřśŝşšţťŧũūŭůűųŵŷźżž-ƀƃƅƈƌƍƒƕƙ-ƛƞơƣƥƨƪƫƭưƴƶƹƺƽ-ƿǆǉǌǎǐǒǔǖǘǚǜǝǟǡǣǥǧǩǫǭǯǰǳǵǹǻǽǿȁȃȅȇȉȋȍȏȑȓȕȗșțȝȟȡȣȥȧȩȫȭȯȱȳ-ȹȼȿɀɂɇɉɋɍɏ-ʓʕ-ʯͱͳͷͻ-ͽΐά-ώϐϑϕ-ϗϙϛϝϟϡϣϥϧϩϫϭϯ-ϳϵϸϻϼа-џѡѣѥѧѩѫѭѯѱѳѵѷѹѻѽѿҁҋҍҏґғҕҗҙқҝҟҡңҥҧҩҫҭүұҳҵҷҹһҽҿӂӄӆӈӊӌӎӏӑӓӕӗәӛӝӟӡӣӥӧөӫӭӯӱӳӵӷӹӻӽӿԁԃԅԇԉԋԍԏԑԓԕԗԙԛԝԟԡԣԥԧա-ևᴀ-ᴫᵢ-ᵷᵹ-ᶚḁḃḅḇḉḋḍḏḑḓḕḗḙḛḝḟḡḣḥḧḩḫḭḯḱḳḵḷḹḻḽḿṁṃṅṇṉṋṍṏṑṓṕṗṙṛṝṟṡṣṥṧṩṫṭṯṱṳṵṷṹṻṽṿẁẃẅẇẉẋẍẏẑẓẕ-ẝẟạảấầẩẫậắằẳẵặẹẻẽếềểễệỉịọỏốồổỗộớờởỡợụủứừửữựỳỵỷỹỻỽỿ-ἇἐ-ἕἠ-ἧἰ-ἷὀ-ὅὐ-ὗὠ-ὧὰ-ώᾀ-ᾇᾐ-ᾗᾠ-ᾧᾰ-ᾴᾶᾷιῂ-ῄῆῇῐ-ΐῖῗῠ-ῧῲ-ῴῶῷℊℎℏℓℯℴℹℼℽⅆ-ⅉⅎↄⰰ-ⱞⱡⱥⱦⱨⱪⱬⱱⱳⱴⱶ-ⱼⲁⲃⲅⲇⲉⲋⲍⲏⲑⲓⲕⲗⲙⲛⲝⲟⲡⲣⲥⲧⲩⲫⲭⲯⲱⲳⲵⲷⲹⲻⲽⲿⳁⳃⳅⳇⳉⳋⳍⳏⳑⳓⳕⳗⳙⳛⳝⳟⳡⳣⳤⳬⳮⴀ-ⴥꙁꙃꙅꙇꙉꙋꙍꙏꙑꙓꙕꙗꙙꙛꙝꙟꙡꙣꙥꙧꙩꙫꙭꚁꚃꚅꚇꚉꚋꚍꚏꚑꚓꚕꚗꜣꜥꜧꜩꜫꜭꜯ-ꜱꜳꜵꜷꜹꜻꜽꜿꝁꝃꝅꝇꝉꝋꝍꝏꝑꝓꝕꝗꝙꝛꝝꝟꝡꝣꝥꝧꝩꝫꝭꝯꝱ-ꝸꝺꝼꝿꞁꞃꞅꞇꞌꞎꞑꞡꞣꞥꞧꞩꟺﬀ-ﬆﬓ-ﬗａ-ｚ]",Lt:"[ǅǈǋǲᾈ-ᾏᾘ-ᾟᾨ-ᾯᾼῌῼ]",Lm:"[ʰ-ˁˆ-ˑˠ-ˤˬˮʹͺՙـۥۦߴߵߺࠚࠤࠨॱๆໆჼៗᡃᪧᱸ-ᱽᴬ-ᵡᵸᶛ-ᶿⁱⁿₐ-ₜⱽⵯⸯ々〱-〵〻ゝゞー-ヾꀕꓸ-ꓽꘌꙿꜗ-ꜟꝰꞈꧏꩰꫝｰﾞﾟ]",Lo:"[ƻǀ-ǃʔא-תװ-ײؠ-ؿف-يٮٯٱ-ۓەۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪࠀ-ࠕࡀ-ࡘऄ-हऽॐक़-ॡॲ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๅກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໜໝༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎა-ჺᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៜᠠ-ᡂᡄ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᯀ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱷᳩ-ᳬᳮ-ᳱℵ-ℸⴰ-ⵥⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ〆〼ぁ-ゖゟァ-ヺヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿋ꀀ-ꀔꀖ-ꒌꓐ-ꓷꔀ-ꘋꘐ-ꘟꘪꘫꙮꚠ-ꛥꟻ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩯꩱ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛꫜꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-鶴侮-舘並-龎יִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼｦ-ｯｱ-ﾝﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]",Mn:"[̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ऀ-ंऺ़ु-ै्॑-ॗॢॣঁ়ু-ৄ্ৢৣਁਂ਼ੁੂੇੈੋ-੍ੑੰੱੵઁં઼ુ-ૅેૈ્ૢૣଁ଼ିୁ-ୄ୍ୖୢୣஂீ்ా-ీె-ైొ-్ౕౖౢౣ಼ಿೆೌ್ೢೣു-ൄ്ൢൣ්ි-ුූัิ-ฺ็-๎ັິ-ູົຼ່-ໍཱ༹༘༙༵༷-ཾྀ-྄྆྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္်ွှၘၙၞ-ၠၱ-ၴႂႅႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧᤨᤲ᤹-᤻ᨘᨗᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀᮁᮢ-ᮥᮨᮩ᯦ᯨᯩᯭᯯ-ᯱᰬ-ᰳᰶ᰷᳐-᳔᳒-᳢᳠-᳨᳭᷀-ᷦ᷼-᷿⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯꙼꙽꛰꛱ꠂ꠆ꠋꠥꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꨩ-ꨮꨱꨲꨵꨶꩃꩌꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꯥꯨ꯭ﬞ︀-️︠-︦]",Me:"[҈҉⃝-⃠⃢-⃤꙰-꙲]",Mc:"[ःऻा-ीॉ-ौॎॏংঃা-ীেৈোৌৗਃਾ-ੀઃા-ીૉોૌଂଃାୀେୈୋୌୗாிுூெ-ைொ-ௌௗఁ-ఃు-ౄಂಃಾೀ-ೄೇೈೊೋೕೖംഃാ-ീെ-ൈൊ-ൌൗංඃා-ෑෘ-ෟෲෳ༾༿ཿါာေးျြၖၗၢ-ၤၧ-ၭႃႄႇ-ႌႏႚ-ႜាើ-ៅះៈᤣ-ᤦᤩ-ᤫᤰᤱᤳ-ᤸᦰ-ᧀᧈᧉᨙ-ᨛᩕᩗᩡᩣᩤᩭ-ᩲᬄᬵᬻᬽ-ᭁᭃ᭄ᮂᮡᮦᮧ᮪ᯧᯪ-ᯬᯮ᯲᯳ᰤ-ᰫᰴᰵ᳡ᳲꠣꠤꠧꢀꢁꢴ-ꣃꥒ꥓ꦃꦴꦵꦺꦻꦽ-꧀ꨯꨰꨳꨴꩍꩻꯣꯤꯦꯧꯩꯪ꯬]",Nd:"[0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꩐-꩙꯰-꯹０-９]",Nl:"[ᛮ-ᛰⅠ-ↂↅ-ↈ〇〡-〩〸-〺ꛦ-ꛯ]",No:"[²³¹¼-¾৴-৹୲-୷௰-௲౸-౾൰-൵༪-༳፩-፼៰-៹᧚⁰⁴-⁹₀-₉⅐-⅟↉①-⒛⓪-⓿❶-➓⳽㆒-㆕㈠-㈩㉑-㉟㊀-㊉㊱-㊿꠰-꠵]",Zs:"[   ᠎ -   　]",Zl:"[\u2028]",Zp:"[\u2029]",Cc:"[\0--]",Cf:"[­؀-؃۝܏឴឵​-‏‪-‮⁠-⁤⁪-⁯﻿￹-￻]",Cs:"[�-�]",Co:"[-]",Ps:"[([{༺༼᚛‚„⁅⁽₍〈❨❪❬❮❰❲❴⟅⟦⟨⟪⟬⟮⦃⦅⦇⦉⦋⦍⦏⦑⦓⦕⦗⧘⧚⧼⸢⸤⸦⸨〈《「『【〔〖〘〚〝﴾︗︵︷︹︻︽︿﹁﹃﹇﹙﹛﹝（［｛｟｢]",Pd:"[-֊־᐀᠆‐-―⸗⸚〜〰゠︱︲﹘﹣－]",Pc:"[_‿⁀⁔︳︴﹍-﹏＿]",Pe:"[)\\]}༻༽᚜⁆⁾₎〉❩❫❭❯❱❳❵⟆⟧⟩⟫⟭⟯⦄⦆⦈⦊⦌⦎⦐⦒⦔⦖⦘⧙⧛⧽⸣⸥⸧⸩〉》」』】〕〗〙〛〞〟﴿︘︶︸︺︼︾﹀﹂﹄﹈﹚﹜﹞）］｝｠｣]",Sm:"[+<->|~¬±×÷϶؆-؈⁄⁒⁺-⁼₊-₌℘⅀-⅄⅋←-↔↚↛↠↣↦↮⇎⇏⇒⇔⇴-⋿⌈-⌋⌠⌡⍼⎛-⎳⏜-⏡▷◁◸-◿♯⟀-⟄⟇-⟊⟌⟎-⟥⟰-⟿⤀-⦂⦙-⧗⧜-⧻⧾-⫿⬰-⭄⭇-⭌﬩﹢﹤-﹦＋＜-＞｜～￢￩-￬]",Po:"[!-#%-'*,./:;?@\\¡·¿;·՚-՟։׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒྅࿐-࿔࿙࿚၊-၏჻፡-፨᙭᙮᛫-᛭᜵᜶។-៖៘-៚᠀-᠅᠇-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‖‗†-‧‰-‸※-‾⁁-⁃⁇-⁑⁓⁕-⁞⳹-⳼⳾⳿⵰⸀⸁⸆-⸈⸋⸎-⸖⸘⸙⸛⸞⸟⸪-⸮⸰⸱、-〃〽・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫︐-︖︙︰﹅﹆﹉-﹌﹐-﹒﹔-﹗﹟-﹡﹨﹪﹫！-＃％-＇＊，．／：；？＠＼｡､･]",Sk:"[^`¨¯´¸˂-˅˒-˟˥-˫˭˯-˿͵΄΅᾽᾿-῁῍-῏῝-῟῭-`´῾゛゜꜀-꜖꜠꜡꞉꞊﮲-﯁＾｀￣]",Sc:"[$¢-¥؋৲৳৻૱௹฿៛₠-₹꠸﷼﹩＄￠￡￥￦]",Pi:"[«‘‛“‟‹⸂⸄⸉⸌⸜⸠]",So:"[¦§©®°¶҂؎؏۞۩۽۾߶৺୰௳-௸௺౿൹༁-༃༓-༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏࿕-࿘႞႟፠᎐-᎙᥀᧞-᧿᭡-᭪᭴-᭼℀℁℃-℆℈℉℔№℗℞-℣℥℧℩℮℺℻⅊⅌⅍⅏↕-↙↜-↟↡↢↤↥↧-↭↯-⇍⇐⇑⇓⇕-⇳⌀-⌇⌌-⌟⌢-⌨⌫-⍻⍽-⎚⎴-⏛⏢-⏳␀-␦⑀-⑊⒜-ⓩ─-▶▸-◀◂-◷☀-♮♰-⛿✁-❧➔-➿⠀-⣿⬀-⬯⭅⭆⭐-⭙⳥-⳪⺀-⺙⺛-⻳⼀-⿕⿰-⿻〄〒〓〠〶〷〾〿㆐㆑㆖-㆟㇀-㇣㈀-㈞㈪-㉐㉠-㉿㊊-㊰㋀-㋾㌀-㏿䷀-䷿꒐-꓆꠨-꠫꠶꠷꠹꩷-꩹﷽￤￨￭￮￼�]",Pf:"[»’”›⸃⸅⸊⸍⸝⸡]"};$.ig.unicode_hack=function(){var firstLetters={},p;for(p in unicodeCategories){if(firstLetters[p[0]])firstLetters[p[0]]=unicodeCategories[p].substring(0,unicodeCategories[p].length-1)+firstLetters[p[0]].substring(1);else firstLetters[p[0]]=unicodeCategories[p]}for(p in firstLetters)unicodeCategories[p]=firstLetters[p];return function(regexpString){var modifiers="";if(regexpString instanceof RegExp){modifiers=(regexpString.global?"g":"")+(regexpString.ignoreCase?"i":"")+(regexpString.multiline?"m":"");regexpString=regexpString.source}regexpString=regexpString.replace(/\\p\{(..?)\}/g,function(match,group){return unicodeCategories[group]||match});return new RegExp(regexpString,modifiers)}}()})(jQuery);/*!@license
* Infragistics.Web.ClientUI data source localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.DataSourceLocale){$.ig.DataSourceLocale={};$.extend($.ig.DataSourceLocale,{locale:{invalidDataSource:"The supplied data source is invalid. It happens to be a scalar.",unknownDataSource:"Cannot determine the data source type. Please specify if it is JSON or XML data.",errorParsingArrays:"There was an error parsing the array data and applying the defined data schema: ",errorParsingJson:"There was an error parsing the JSON data and applying the defined data schema: ",errorParsingXml:"There was an error parsing the XML data and applying the defined data schema: ",errorParsingHtmlTable:"There was an error extracting the data from the HTML Table and applying the schema : ",errorExpectedTbodyParameter:"Expected a tbody or a table as a parameter.",errorTableWithIdNotFound:"The HTML Table with the following ID was not found: ",errorParsingHtmlTableNoSchema:"There was an error parsing the Table DOM: ",errorParsingJsonNoSchema:"There was an error parsing/evaluating the JSON string: ",errorParsingXmlNoSchema:"There was an error parsing the XML string: ",errorXmlSourceWithoutSchema:"The supplied data source is an xml document, but there is no defined data schema ($.IgDataSchema) ",errorUnrecognizedFilterCondition:" The filter condition that was passed was not recognized: ",errorRemoteRequest:"The remote request to fetch data has failed: ",errorSchemaMismatch:"The input data doesn't match the schema, the following field couldn't be mapped: ",errorSchemaFieldCountMismatch:"The input data doesn't match the schema in terms of number of fields. ",errorUnrecognizedResponseType:"The response type was either not set correctly, or it was not possible to detect it automatically. Please set settings.responseDataType and/or settings.responseContentType.",hierarchicalTablesNotSupported:"Tables are not supported for HierarchicalSchema",cannotBuildTemplate:"The jQuery template could not be built. There are no records present in the data source, and no columns defined.",unrecognizedCondition:"Unrecognized filtering condition in the following expression: ",fieldMismatch:"The following expression contains an invalid field or filtering condition: ",noSortingFields:"There are no fields specified. You need to specify at least one field to sort by, when calling sort().",filteringNoSchema:"There is no schema / fields specified. You need to specify a schema with field definitions and types to be able to filter the data source.",noSaveChanges:"Saving changes was not successful. Server did not return Success object or returned Success:false.",errorUnexpectedCustomFilterFunction:"An unexpected value was provided for a custom filtering function. A function or string is expected."}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Data Binding Plugin 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 * 
 * igDataSource provides the following functionality:
 * - read and parse local XML , JSON , and HTML data
 * - normalize / transform the above data according to a schema
 * - data type conversion (date, string, number, etc.)
 * - define relationships between two and more flat data sources - with primary/foreign keys, etc
 * - build URL params for requests that get remote data 
 * - in case of scenarios such as paging, understand and prase the response - expect that it's in a predefined format that can be additionall configured by the developer
 * - get data from WCF services  
 * - ability to combine local with remote functionality  
 * - queueing AJAX requests
 *	paging,filtering (searching), and sorting functionality that are control-independent are also implemented here
 *	the idea of this code is to serve as a data-source abstraction layer (client-side data source control)
 *	that may well be used by all other client-side controls , such as dropdown, tree, menu, etc. 
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	infragistics.util.js
 *
 */
(function($){$.ig=$.ig||{};if(!window.Infragistics){window.Infragistics=$.ig}$.ig.DataSource=$.ig.DataSource||Class.extend({settings:{id:"ds",outputResultsName:null,callback:null,callee:null,data:[],dataSource:null,dataBinding:null,dataBound:null,requestType:"GET",type:"unknown",schema:null,primaryKey:null,responseTotalRecCountKey:null,responseDataKey:null,responseDataType:null,responseContentType:null,localSchemaTransform:true,urlParamsEncoding:null,urlParamsEncoded:null,paging:{enabled:false,type:"remote",pageSize:5,pageSizeUrlKey:null,pageIndexUrlKey:null,pageIndex:0,appendPage:false},filtering:{type:"remote",caseSensitive:false,applyToAllData:true,customFunc:null,filterExprUrlKey:null,filterLogicUrlKey:"filterLogic",defaultFields:[],expressions:[],exprString:"",customConditions:null},sorting:{defaultDirection:"none",defaultFields:[],applyToAllData:true,customFunc:null,compareFunc:null,customConvertFunc:null,type:"remote",caseSensitive:false,sortUrlKey:null,sortUrlAscValueKey:null,sortUrlDescValueKey:null,expressions:[],exprString:""},summaries:{type:"remote",summaryExprUrlKey:"summaries",summariesResponseKey:"summaries",summaryExecution:"afterfilteringandpaging",columnSettings:[]},fields:[],serializeTransactionLog:true,aggregateTransactions:false,autoCommit:false,updateUrl:null,rowAdded:null,rowUpdated:null,rowInserted:null,rowDeleted:null},init:function(options){var tempSource,tempCallee,arrayAlready=false,metadata;if(options){tempSource=options.dataSource;if(tempSource&&($.type(tempSource)==="array"||$.type(tempSource)==="object")){if($.type(tempSource)==="object"&&options.responseDataKey&&options.type!=="json"){metadata=tempSource.Metadata;options.dataSource=$.ig.findPath(tempSource,options.responseDataKey);if(metadata&&options.dataSource.Metadata===undefined){options.dataSource.Metadata=metadata}arrayAlready=true}else{options.dataSource=null}}if(options.callee){tempCallee=options.callee;options.callee=null}this.settings=$.extend(true,{},$.ig.DataSource.prototype.settings,options);if(arrayAlready){this.settings.type="array"}else if(tempSource&&($.type(tempSource)==="array"||$.type(tempSource)==="object")){options.dataSource=tempSource;this.settings.dataSource=tempSource}if(tempCallee){this.settings.callee=tempCallee;tempCallee=null}}this.settings.paging.pageIndex=0;this._isBound=false;this._url=null;this._dsCallback=null;this._data=[];this._dataView=[];if(this.settings.type==="unknown"){this._runtimeType=this.analyzeDataSource()}else{this._runtimeType=this.settings.type}this._parser=new $.ig.TypeParser;this._schema=null;this._isSortingReq=false;this._isFilteringReq=false;this._isPagingReq=false;this._isSummariesReq=false;this._dataSummaries=[];this._recCount=0;this._hasCount=false;this._initSchema();this._transactionLog=[];this._accumulatedTransactionLog=[];return this},_initSchema:function(){var i;if(this.settings.schema){if(this.settings.schema instanceof $.ig.DataSchema){this._schema=this.settings.schema}else{if(this.settings.type!=="unknown"){this._schema=new $.ig.DataSchema(this.settings.type,this.settings.schema)}else{this._schema=new $.ig.DataSchema(this._runtimeType,this.settings.schema)}this._schema._pk=this.settings.primaryKey}this._fields={};for(i=0;i<this._schema.fields().length;i++){if(typeof this._schema.fields()[i].mapper==="function"){this._hasMapper=true}this._fields[this._schema.fields()[i].name]=this._schema.fields()[i]}}},fields:function(fields){if(fields===undefined||fields===null){return this.settings.fields}this.settings.fields=fields;return this},analyzeDataSource:function(){var ds=this.dataSource(),dc,$dsObj;if(ds===undefined||ds===null){return"empty"}if($.type(ds)==="function"){return"function"}if($.type(ds)==="array"){return"array"}if($.type(ds)==="number"||$.type(ds)==="boolean"||$.type(ds)==="date"){return"invalid"}if($.type(ds)==="string"){ds=$.trim(ds);if(ds.startsWith("/")){return"remoteUrl"}if($("#"+this.settings.id).length>0&&ds.toLowerCase().startsWith("<table")){return"htmlTableString"}if(ds.toLowerCase().startsWith("<table")){dc="<div id='"+this.settings.id+"' style='display:none;visibility:hidden;'>"+ds+"</div>";$(dc).appendTo($("body"));return"htmlTableString"}if(!ds.startsWith("[")&&!ds.startsWith("{")&&!ds.startsWith("<")){if(!ds.startsWith("http://")&&!ds.startsWith("https://")){try{$dsObj=$("#"+ds);if($dsObj.length>0&&$dsObj[0].nodeName.toLowerCase()==="table"){return"htmlTableId"}}catch(e){}}this._url=ds;return"remoteUrl"}return"unknown"}if(ds.nodeName&&ds.nodeName.toLowerCase()==="table"){return"htmlTableDom"}if(ds.nodeName&&(ds.nodeName.toLowerCase()==="ul"||ds.nodeName.toLowerCase()==="ol")){return"htmlListDom"}if(ds.nodeName&&ds.nodeName.toLowerCase()==="select"){return"htmlSelectDom"}return"unknown"},dataView:function(){return this._dataView},data:function(){return this._data},transformedData:function(transformedExecution){var data;switch(transformedExecution){case"priortofilteringandpaging":data=this._data;break;case"afterfilteringbeforepaging":if(this._transformedData!==undefined){data=this._transformedData}else{data=this._data}break;case"afterfilteringandpaging":data=this.dataView();break;default:data=this._dataView;break}return data},dataSummaries:function(){var s=this.settings.summaries,type=s.type;if(type==="local"){this._dataSummaries=this.transformedData(s.summaryExecution)}return this._dataSummaries},schema:function(s,t){if(s===undefined||s===null){return this._schema}if(s instanceof $.ig.DataSchema){this._schema=s}else{if(t===null||t===undefined){this._schema=new $.ig.DataSchema(s.type,s)}else{this._schema=new $.ig.DataSchema(t,s)}this._schema._pk=this.settings.primaryKey}return this},pagingSettings:function(p){if(p===undefined||p===null){return this.settings.paging}this.settings.paging=p;return this},filterSettings:function(f){if(f===undefined||f===null){return this.settings.filtering}this.settings.filtering=f;return this},sortSettings:function(s){if(s===undefined||s===null){return this.settings.sorting}this.settings.sorting=s;return this},summariesSettings:function(s){if(s===undefined||s===null){return this.settings.summaries}this.settings.summaries=s;return this},dataSource:function(ds){if(ds===undefined||ds===null){return this.settings.dataSource}this.settings.dataSource=ds;this.analyzeDataSource();return this},type:function(t){if(t===undefined||t===null){return this._runtimeType}this.settings.type=t;return this},findRecordByKey:function(key,ds,objPath){var i,data=ds||this._data,len=data?data.length:0,search=len>0&&$.isArray(data[0])?this._lookupPkIndex():this.settings.primaryKey;for(i=0;i<len;i++){if(data[i][search]===key){return data[i]}}return null},removeRecordByKey:function(key,origDs){var i,len,data,count=0,all=[this._data,this._dataView,this._filteredData,origDs],prime=this.settings.primaryKey,primeIdx=this._lookupPkIndex(),search;while(count<all.length){data=all[count++];len=data?data.length:0;search=len>0&&$.isArray(data[0])?primeIdx:prime;for(i=0;i<len;i++){if(data[i]&&data[i][search]===key){$.ig.removeFromArray(data,i);break}}if(data===all[count]){count++}}},removeRecordByIndex:function(index,origDs){var i,len,record,data=this._data,view=this._dataView,filter=this._filteredData;if(!data||isNaN(index)||index<0||index>=data.length){return}record=data[index];$.ig.removeFromArray(data,index);if(origDs){$.ig.removeFromArray(origDs,index)}data=data===view?filter:view;while(record){len=data?data.length:0;for(i=0;i<len;i++){if(data[i]===record){$.ig.removeFromArray(data,i);break}}if(data===filter){return}data=filter}},setCellValue:function(rowId,colId,val,autoCommit){var t=this._createCellTransaction(rowId,colId,val);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}return t},updateRow:function(rowId,rowObject,autoCommit){var t=this._createRowTransaction(rowId,rowObject),oldRow=this.settings.primaryKey===null?this._data[parseInt(rowId,10)]:this.findRecordByKey(rowId),rowIndex=this.settings.primaryKey===null?rowId:$.ig.indexInArray(this._data,oldRow);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowUpdated)==="function"){if(this.settings.callee){this.settings.rowUpdated.apply(this.settings.callee,[{rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this])}else{this.settings.rowUpdated({rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this)}}return t},addRow:function(rowId,rowObject,autoCommit){var t=this._createNewRowTransaction(rowId,rowObject);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowAdded)==="function"){if(this.settings.callee){this.settings.rowAdded.apply(this.settings.callee,[{rowId:rowId,row:rowObject},this])}else{this.settings.rowAdded({rowId:rowId,row:rowObject},this)}}return t},insertRow:function(rowId,rowObject,rowIndex,autoCommit,parentRowId){var t=this._createInsertRowTransaction(rowId,rowObject,rowIndex);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowInserted)==="function"){if(this.settings.callee){this.settings.rowInserted.apply(this.settings.callee,[{rowId:rowId,row:rowObject,rowIndex:rowIndex},this])}else{this.settings.rowInserted({rowId:rowId,row:rowObject,rowIndex:rowIndex},this)}}return t},deleteRow:function(rowId,autoCommit){var t=this._createDeleteRowTransaction(rowId),row=this.settings.primaryKey===null?this._data[parseInt(rowId,10)]:this.findRecordByKey(rowId),rowIndex=this.settings.primaryKey===null?rowId:$.ig.indexInArray(this._data,row),isNewRow=false,i,j;for(i=0;this.settings.aggregateTransactions&&i<this._transactionLog.length;i++){if(this._transactionLog[i].type==="newrow"&&this._transactionLog[i].rowId===rowId){isNewRow=true;rowId=this._transactionLog[i].rowId;this._removeTransactionByTransactionId(this._transactionLog[i].tid);for(j=0;j<this._accumulatedTransactionLog.length;j++){if(this._accumulatedTransactionLog[j].rowId===rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,j)}}break}}if(!(this.settings.aggregateTransactions&&isNewRow)){this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowDeleted)==="function"){if(this.settings.callee){this.settings.rowDeleted.apply(this.settings.callee,[{rowId:rowId,row:row,rowIndex:rowIndex},this])}else{this.settings.rowDeleted({rowId:rowId,row:row,rowIndex:rowIndex},this)}}}return t},addNode:function(data){var t=this._createAddNodeTransaction(data);this._addTransaction(t)},removeNode:function(data){var t=this._createRemoveNodeTransaction(data);this._addTransaction(t)},getDetachedRecord:function(t){var o=$.type(this._data[0])==="array"?[]:{},i,originalRec;if(this.settings.primaryKey===null){originalRec=this._data[parseInt(t.rowId,10)]}else{originalRec=this.findRecordByKey(t.rowId)}if(this._data[0]!=="array"){for(i in originalRec){if(originalRec.hasOwnProperty(i)){o[i]=originalRec[i]}}}else{for(i=0;i<originalRec.length;i++){o[i]=originalRec[i]}}if(t.type==="cell"){o[t.col]=t.value;return o}if(o!=="array"){for(i in t.row){if(t.row.hasOwnProperty(i)){o[i]=t.row[i]}}}else{for(i=0;i<t.row.length;i++){o[i]=t.row[i]}}return o},commit:function(id){if(id!==null&&id!==undefined){this._commitTransactionsByRowId(id)}else{this._transactionLog.reverse();while(this._transactionLog.length>0){this._commitTransaction(this._transactionLog.pop())}}},rollback:function(id){var i,trans;if(id!==null&&id!==undefined){trans=this._rollbackTransactionsByRowId(id)}else{i=this._transactionLog.length;while(i-->0){this._rollbackTransaction(this._transactionLog[i])}}return trans},pendingTransactions:function(){return this._transactionLog},allTransactions:function(){return this._accumulatedTransactionLog},_createCellTransaction:function(rowId,colId,val){return{type:"cell",rowId:rowId,tid:this._generateTransactionId(),col:colId,value:val}},_createRowTransaction:function(rowId,rowObject){return{type:"row",tid:this._generateTransactionId(),row:rowObject,rowId:rowId}},_createNewRowTransaction:function(rowId,rowObject){return{type:"newrow",tid:this._generateTransactionId(),row:rowObject,rowId:rowId}},_createInsertRowTransaction:function(rowId,rowObject,rowIndex){return{type:"insertrow",tid:this._generateTransactionId(),row:rowObject,rowId:rowId,rowIndex:rowIndex}},_createDeleteRowTransaction:function(rowId){return{type:"deleterow",tid:this._generateTransactionId(),rowId:rowId}},_createAddNodeTransaction:function(data){return{type:"addnode",tid:this._generateTransactionId(),tdata:data}},_createRemoveNodeTransaction:function(data){return{type:"removenode",tid:this._generateTransactionId(),tdata:data}},_addTransaction:function(t){var exists=false,i=0,prop,globalt,j,dirty=true,k;if(t.type==="cell"){for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===t.rowId&&this._transactionLog[i].col===t.col){exists=true;if(this.settings.autoCommit===false&&this.settings.aggregateTransactions===true){for(j=0;j<this.dataView().length;j++){if(this.dataView()[j][this.settings.primaryKey]===t.rowId&&this.dataView()[j][t.col]===t.value){for(k=0;k<this._accumulatedTransactionLog.length;k++){if(this._accumulatedTransactionLog[k].rowId===this._transactionLog[i].rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,k)}}this._removeTransactionByTransactionId(this._transactionLog[i].tid);dirty=false}}}if(dirty){this._transactionLog[i].value=t.value;this._syncGlobalTransaction(this._transactionLog[i])}}}for(j=0;j<this._transactionLog.length;j++){if(this._transactionLog[j].type==="newrow"&&this._transactionLog[j].rowId===t.rowId){if(t.type==="row"){this._transactionLog[j].value=t.value}else{this._transactionLog[j].row[t.col]=t.value}this._syncGlobalTransaction(this._transactionLog[j]);return}}}else if(t.type==="row"){for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===t.rowId&&this._transactionLog[i].type!=="cell"){exists=true;if(this.settings.autoCommit===false&&this.settings.aggregateTransactions===true){dirty=false;for(j=0;j<this.dataView().length;j++){if(this.dataView()[j][this.settings.primaryKey]===t.rowId){for(prop in t.row){if(t.row.hasOwnProperty(prop)&&t.row[prop]!==this.dataView()[j][prop]){dirty=true;break}}break}}for(j=0,!dirty;j<this._transactionLog.length;j++){if(this._transactionLog[j].type==="newrow"&&this._transactionLog[j].rowId===t.rowId){this._transactionLog[j].row=t.row;this._syncGlobalTransaction(this._transactionLog[j]);return}}}if(dirty){this._transactionLog[i].row=t.row;this._syncGlobalTransaction(this._transactionLog[i])}else{for(k=0;k<this._accumulatedTransactionLog.length;k++){if(this._accumulatedTransactionLog[k].rowId===this._transactionLog[i].rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,k)}}this._removeTransactionByTransactionId(this._transactionLog[i].tid)}}}}else if(t.type==="addnode"||t.type==="removenode"){this._transactionLog.push(t);this._accumulatedTransactionLog.push(t);return}if(!exists){this._transactionLog.push(t);globalt=$.extend(true,{},t);if(globalt.type==="cell"&&$.type(globalt.value)==="date"){globalt.value="/Date("+globalt.value.getTime()+")/"}else if(globalt.type==="row"||globalt.type==="insertrow"||globalt.type==="newrow"||globalt.type==="insertnode"){for(prop in globalt.row){if(globalt.row.hasOwnProperty(prop)&&$.type(globalt.row[prop])==="date"){globalt.row[prop]="/Date("+globalt.row[prop].getTime()+")/"}}}this._accumulatedTransactionLog.push(globalt)}},_syncGlobalTransaction:function(t){var i,prop;if(!t){return}if(t.type==="cell"){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].rowId===t.rowId&&this._accumulatedTransactionLog[i].col===t.col){if($.type(t.value)==="date"){this._accumulatedTransactionLog[i].value="/Date("+t.value.getTime()+")/"}else{this._accumulatedTransactionLog[i].value=t.value}break}}}else if(t.type==="row"||t.type==="insertrow"||t.type==="newrow"){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].rowId===t.rowId&&this._accumulatedTransactionLog[i].type!=="cell"){for(prop in t.row){if(t.row.hasOwnProperty(prop)){if($.type(t.row[prop])==="date"){this._accumulatedTransactionLog[i].row[prop]="/Date("+t.row[prop].getTime()+")/"}else{this._accumulatedTransactionLog[i].row[prop]=t.row[prop]}}}}}}},_removeTransactionByTransactionId:function(tid,removeFromAll){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].tid===tid){$.ig.removeFromArray(this._transactionLog,i);break}}if(removeFromAll===true){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].tid===tid){$.ig.removeFromArray(this._accumulatedTransactionLog,i);break}}}},_removeTransactionsByRecordId:function(id){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===id){$.ig.removeFromArray(this._transactionLog,i);break}}},_addRow:function(row,index,origDs){var data,key,count=0,schema=this.settings.schema,layouts=schema?schema.layouts:null,lo,pdata,all=[this._data],newRow;if(this._data!==this._dataView){all.push(this._dataView)}if(this._data!==origDs){all.push(origDs)}if(this._filter&&this._filteredData&&this.settings.paging.enabled&&this.settings.paging.type==="local"){all.push(this._filteredData)}if(layouts){for(key in layouts){if(layouts.hasOwnProperty(key)){if((key.match(/\//g)||[]).length!==1){continue}if(layouts[key].key&&!row.hasOwnProperty(layouts[key].key)){if(layouts[key].responseDataKey){lo={};lo[layouts[key].responseDataKey]=[]}else{lo=[]}row[layouts[key].key]=lo}}}}while(count<all.length){data=all[count++];if(this._preprocessAddRow){pdata=this._preprocessAddRow.apply(this,Array.prototype.slice.call(arguments).concat([data]));data=pdata.layoutData}if(data){newRow=row;if(data!==origDs&&$.type(row)==="object"){newRow=$.extend(true,{},row)}if(index>=0&&index<data.length){data.splice(index,0,newRow)}else{data.push(newRow)}if(this._postprocessAddRow&&pdata){pdata.newData=data;this._postprocessAddRow.apply(this,Array.prototype.slice.call(arguments).concat(pdata));data=pdata.cashedData}}if(data===all[count]){count++}}},_updateRecOnCommit:function(t,records){var i,j,rec,prop;if(t.type==="cell"){for(j=0;j<records.length;j++){rec=records[j];if(rec){rec[t.col]=t.value}}}else if(t.type==="row"){if($.type(t.row)==="array"){for(j=0;j<records.length;j++){rec=records[j];if(rec){for(i=0;i<t.row.length;i++){rec[i]=t.row[i]}}}}else{for(j=0;j<records.length;j++){rec=records[j];if(rec){for(prop in t.row){if(t.row.hasOwnProperty(prop)){rec[prop]=t.row[prop]}}}}}}},_commitTransaction:function(t){var rec,origRec,origDs=this.settings.localSchemaTransform?this._origDs:null;if(origDs===this._data){origDs=null}if(this.settings.primaryKey===null){rec=this._data[parseInt(t.rowId,10)];if(origDs){origRec=origDs[parseInt(t.rowId,10)]}}else{rec=this.findRecordByKey(t.rowId);if(origDs){origRec=this.findRecordByKey(t.rowId,origDs)}}if(t.type==="cell"||t.type==="row"){this._updateRecOnCommit(t,[rec,origRec])}else if(t.type==="deleterow"){if(this.settings.primaryKey===null){this.removeRecordByIndex(parseInt(t.rowId,10),origDs)}else{this.removeRecordByKey(t.rowId,origDs)}}else if(t.type==="newrow"){this._addRow(t.row,-1,origDs)}else if(t.type==="insertrow"){this._addRow(t.row,t.rowIndex,origDs)}this._removeTransactionByTransactionId(t.tid)},_rollbackTransaction:function(t){this._removeTransactionByTransactionId(t.tid,true)},_commitTransactionsByRowId:function(id){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===id){this._commitTransaction(this._transactionLog[i])}}},_rollbackTransactionsByRowId:function(id){var i,trans=[];i=this._transactionLog.length;while(i-->0){if(this._transactionLog[i].rowId===id){trans.push(this._transactionLog[i]);this._rollbackTransaction(this._transactionLog[i])}}return trans},transactionsAsString:function(){return JSON.stringify(this._accumulatedTransactionLog)},_generateTransactionId:function(){return((1+Math.random())*parseInt("10000",16)).toString(16).substring(1,5)},_lookupPkIndex:function(){var i;if(this._pkIndex!==undefined){return this._pkIndex}if(typeof this.settings.primaryKey==="string"){if(this.schema()&&this.schema().fields()&&this.schema().fields().length>0){for(i=0;i<this.schema().fields().length;i++){if(this.schema().fields()[i].name===this.settings.primaryKey){this._pkIndex=i;return i}}}}this._pkIndex=this.settings.primaryKey;return this.settings.primaryKey},saveChanges:function(success,error){if(this.settings.updateUrl!==null){var me=this,opts;opts={type:"POST",url:this.settings.updateUrl,data:{ig_transactions:JSON.stringify(this._accumulatedTransactionLog)},success:function(data,textStatus,jqXHR){if(data.Success){me._saveChangesSuccess(data,textStatus,jqXHR);if(success){success(data,textStatus,jqXHR)}}else{me._saveChangesError(jqXHR,textStatus,$.ig.DataSourceLocale.locale.noSaveChanges);if(error){error(jqXHR,textStatus,$.ig.DataSourceLocale.locale.noSaveChanges)}}},error:function(jqXHR,textStatus,errorThrown){me._saveChangesError(jqXHR,textStatus,errorThrown);if(error){error(jqXHR,textStatus,errorThrown)}}};this._ajaxRequest=$.ajax(opts)}},_saveChangesSuccess:function(data,textStatus,jqXHR){var schs,sche,i;if(data.Success){this.commit();this._transactionLog=[];this._accumulatedTransactionLog=[];schs=this._saveChangesHandlers;i=schs?schs.length:0;while(i-->0){schs[i](data,textStatus,jqXHR)}}else{sche=this._saveChangesErrorHandlers;i=sche?sche.length:0;while(i-->0){sche[i](jqXHR,textStatus,$.ig.DataSourceLocale.locale.noSaveChanges)}}},_saveChangesError:function(jqXHR,textStatus,errorThrown){var sche=this._saveChangesErrorHandlers,i=sche?sche.length:0;while(i-->0){sche[i](jqXHR,textStatus,errorThrown)}},_addChangesSuccessHandler:function(functionDelegate){if(this._saveChangesHandlers===undefined){this._saveChangesHandlers=[]}this._saveChangesHandlers[this._saveChangesHandlers.length]=functionDelegate},_removeChangesSuccessHandler:function(functionDelegate){if(this._saveChangesHandlers!==undefined){var index=$.ig.indexInArray(this._saveChangesHandlers,functionDelegate);if(index>-1){this._saveChangesHandlers=this._saveChangesHandlers.slice(0,index).concat(this._saveChangesHandlers.slice(index+1,this._saveChangesHandlers.length))}}},_addChangesErrorHandler:function(functionDelegate){if(this._saveChangesErrorHandlers===undefined){this._saveChangesErrorHandlers=[]}this._saveChangesErrorHandlers[this._saveChangesErrorHandlers.length]=functionDelegate},_removeChangesErrorHandler:function(functionDelegate){if(this._saveChangesErrorHandlers!==undefined){var index=$.ig.indexInArray(this._saveChangesErrorHandlers,functionDelegate);if(index>-1){this._saveChangesErrorHandlers=this._saveChangesErrorHandlers.slice(0,index).concat(this._saveChangesErrorHandlers.slice(index+1,this._saveChangesErrorHandlers.length))}}},dataBind:function(callback,callee){var table,tableObj,dsObj,ds,s,p=this.settings,args,resKey,noCancel=true,callDataBound=true,f;this._transactionLog=[];this._accumulatedTransactionLog=[];if(!callback){callback=p.callback}args={cancel:false};if($.isFunction(p.dataBinding)){noCancel=p.dataBinding(this,args);if(noCancel===undefined){noCancel=true}}if(noCancel){if(this.settings.type==="unknown"&&(this._runtimeType===null||this._runtimeType===undefined)){this._runtimeType=this.analyzeDataSource()}else if(this._runtimeType==="json"){ds=this.dataSource();if($.type(ds)==="string"){ds=$.trim(ds);if(ds.startsWith("/")||ds.startsWith("http://")||ds.startsWith("https://")){this._runtimeType="remoteUrl"}}}switch(this._runtimeType){case"function":this._data=p.dataSource();if(this.schema()&&this.settings.localSchemaTransform){this._data=this.schema().transform(this._data)}break;case"array":if(this.schema()&&this.settings.localSchemaTransform){this._data=this.schema().transform(this.dataSource());if(this.dataSource().Metadata){this._metadata=this.dataSource().Metadata;this.summariesResponse(this.settings.summaries.summariesResponseKey,this.dataSource())}this._origDs=this.dataSource()}else{this._data=this.dataSource()}break;case"htmlTableDom":case"htmlTableId":case"htmlTableString":if(this._tableBound){break}this._runtimeType=this.analyzeDataSource();if(this._runtimeType==="htmlTableId"){tableObj=$("#"+this.dataSource());table=this._validateTable(tableObj)}else if(this._runtimeType==="htmlTableString"){tableObj=$("#"+this.settings.id+" > table");table=this._validateTable(tableObj)}else{table=this.dataSource()}if(this.schema()&&this.settings.localSchemaTransform){this._data=this.schema().transform(table)}else{this._data=this.tableToObject(table)}this._tableBound=true;break;case"htmlListDom":this._data=this.schema().transform(this.dataSource());break;case"htmlSelectDom":this._data=this.schema().transform(this.dataSource());break;case"invalid":throw new Error($.ig.DataSourceLocale.locale.invalidDataSource);case"unknown":case"json":case"xml":if(this.settings.type!=="json"&&p.type!=="xml"){throw new Error($.ig.DataSourceLocale.locale.unknownDataSource)}else{resKey=this.settings.responseDataKey;if($.type(this.dataSource())==="string"){if(p.type==="json"){dsObj=this.stringToJSONObject(this.dataSource())}else{dsObj=this.stringToXmlObject(this.dataSource())}}else{dsObj=this.dataSource()}if(this.schema()&&this.settings.localSchemaTransform===true){this._data=this.schema().transform(dsObj);if(resKey!==null&&resKey!==undefined){this._origDs=$.ig.findPath(dsObj,resKey)}else{this._origDs=dsObj}}else if((!this.schema()||this.settings.localSchemaTransform===false)&&p.type==="json"){if(resKey!==null&&resKey!==undefined){this._data=this._origDs=$.ig.findPath(dsObj,resKey)}else{this._data=dsObj}this._origDs=dsObj}else if(!this.schema()&&p.type==="xml"){throw new Error($.ig.DataSourceLocale.locale.errorXmlSourceWithoutSchema)}this.totalRecordsCount(null,this.settings.responseTotalRecCountKey,dsObj,this);if(dsObj&&dsObj.Metadata){this._metadata=dsObj.Metadata}this.summariesResponse(this.settings.summaries.summariesResponseKey,dsObj)}break;case"remoteUrl":callDataBound=false;this._remoteData(callback,callee);break;case"empty":this._data=[];this._dataView=[];this._dataSummaries=[];break;default:break}this._dataView=this._data;this._filter=false;s=p.sorting;if(s.type==="local"&&this._runtimeType!=="remoteUrl"&&s.defaultFields.length>0){this.sort(s.defaultFields,s.defaultDirection);s.sortingApplied=true}f=p.filtering;if(f.type==="local"&&this._runtimeType!=="remoteUrl"&&f.defaultFields.length>0){this.filter(f.defaultFields)}if(p.paging.enabled&&p.paging.type==="local"&&this._runtimeType!=="remoteUrl"){this._page()}if(!this._filter||!this._transformedData){this._populateTransformedData()}if(s.sortingApplied){s.sortingApplied=false}if(this._runtimeType!=="remoteUrl"){this._invokeCallback(callee,callback)}this._internalDataBound(!args.cancel&&callDataBound)}return this},getCellValue:function(fieldName,record){var field,result;if(!this._hasMapper||!this._fields||this._fields[fieldName]===undefined||this._fields[fieldName].type!=="object"||!record[fieldName]){return record[fieldName]}field=this._fields[fieldName];if(field&&typeof field.mapper==="function"){result=field.mapper(record)}else{result=record[fieldName]}return result},_getFieldTypeFromSchema:function(fieldName){var field=this._fields[fieldName],type,ds=this.dataSource();if(this.settings.responseDataKey!==null){ds=ds[this.settings.responseDataKey]}if(!field){return undefined}if(typeof field.mapper==="function"&&ds.length>0){type=$.type(field.mapper(ds[0]))}else{type=field.type}return type},_internalDataBound:function(callDatabound){if(callDatabound&&$.isFunction(this.settings.dataBound)){this.settings.dataBound(this)}},summariesResponse:function(key,dsObj){var rec,resPath,i,schema,func,offsets,offset,obj;if(key!==null&&key!==""){rec=dsObj;resPath=key.split(".");if(key.length>0){for(i=0;i<resPath.length;i++){if(rec===null||rec===undefined){break}rec=rec[resPath[i]]}this._dataSummaries=rec}else{this._dataSummaries=dsObj}if(this._dataSummaries===undefined||this._dataSummaries===null){this._dataSummaries=[]}if(this.settings.localSchemaTransform===true&&this.schema()&&dsObj&&dsObj.Metadata&&dsObj.Metadata.timezoneOffsetsSummaries){offsets=dsObj.Metadata.timezoneOffsetsSummaries;this._dataSummaries._serverOffsetsSummaries=offsets;schema=this.schema().schema;if(schema&&schema.fields){for(i=0;i<schema.fields.length;i++){if(schema.fields[i].type==="date"&&offsets[schema.fields[i].name]!==undefined){key=schema.fields[i].name;for(func in offsets[key]){if(offsets[key].hasOwnProperty(key)){offset=offsets[key][func];obj=this._dataSummaries[key][func];if($.type(obj)==="string"&&obj.indexOf("/Date(")!==-1){this._dataSummaries[key][func]=new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10)+offset)}}}}}}}}},_populateTransformedData:function(data){if(data!==null&&data!==undefined){this._transformedData=data}else{this._transformedData=this._data}},_invokeCallback:function(callee,callback){var cbResolved,calleeResolved;cbResolved=callback||this.settings.callback;calleeResolved=callee||this.settings.callee;if(cbResolved){if(calleeResolved){cbResolved.apply(calleeResolved,[true,"",this])}else{cbResolved(true,"",this)}}},_remoteData:function(callback,callee){var params,url=this.settings.dataSource,dataType=this.settings.responseDataType,contentType=this.settings.responseContentType,options,verb=this.settings.requestType;params=this._encodeUrl();if(callback){this._customCallback=callback}else{this._customCallback=null}this._callee=callee;options={url:url,data:verb==="GET"?params:JSON.stringify(params),type:verb,dataType:dataType,async:true,context:this,contentType:contentType,cache:false,dataFilter:this._dataFilter,success:this._successCallback,complete:this._completeCallback,converters:{"text json":function(value){return value}},error:this._errorCallback};this._processRequest(options)},_dataFilter:function(data,type){var ds,schema=this.context.schema(),rawData,t=this.context.settings.type,ver,returnString=false;if(type===undefined||type===null){if(typeof data==="object"&&data&&typeof data.charAt!=="function"){if($.isXMLDoc(data)){type="xml"}else{type="json"}}else{type="text"}}if(type==="xml"){schema._type="xml";ds=this.context._processXmlResponse(data,true,this.context)}else if(type==="json"){if(schema){schema._type="json"}if($.type(data)==="string"){rawData=JSON.parse(data)}else{rawData=data}returnString=true;ds=this.context._processJsonResponse(rawData,this.context)}else{if(jQuery.fn.jquery){ver=jQuery.fn.jquery.split(".")}if(ver&&ver.length>=2){if(parseInt(ver[1],10)>4||parseInt(ver[0],10)>1){this.dataTypes=[];this.dataTypes.push("text");returnString=true}}data=$.type(data)==="string"?$.trim(data):data;if(data&&$.type(data)==="string"&&(data.startsWith("<?xml")||data.startsWith("<"))||t==="xml"){if(schema){schema._type="xml"}ds=this.context._processXmlResponse(this.context.stringToXmlObject(data),false,this.context)}else if(data&&$.type(data)==="string"&&data.startsWith("[")||t==="json"||t==="array"){if(schema){schema._type="json"}ds=this.context._processJsonResponse(JSON.parse(data),this.context)}else if(data&&$.type(data)==="string"&&data.startsWith("{")||t==="json"){if(schema){schema._type="json"}ds=this.context._processJsonResponse(JSON.parse(data),this.context)}else if($.isXMLDoc(data)){if(schema){schema._type="xml"}ds=this.context._processXmlResponse(data,true,this.context)}else if(data!==""&&data!==null){throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedResponseType)}}if(returnString){if(!(this.context.settings.paging&&this.context.settings.paging.enabled&&this.context.settings.paging.appendPage)){this.context._data=ds}this.context._alreadySet=true}return ds},_successCallback:function(data){var x,len=data?data.length:0;if((data===undefined||data===null)&&!this._alreadySet){this._data=[];this._dataView=[]}else{if(this._data.length>=0&&this.settings.paging&&this.settings.paging.enabled&&this.settings.paging.appendPage){for(x=0;x<len;++x){this._data[this._data.length]=data[x]}}else{if(this._alreadySet){this._dataView=this._data}else{this._data=data;this._dataView=data}}}this._alreadySet=false;
this._populateTransformedData();this._isPagingReq=false;this._isFilteringReq=false;this._isSortingReq=false;this._isSummariesReq=false},_errorCallback:function(req,status,error){var f=this._customCallback||this.settings.callback,errmsg,statusMsg;this._isPagingReq=false;this._isFilteringReq=false;this._isSortingReq=false;this._isSummariesReq=false;if(req&&req.status&&req.statusText){statusMsg=" ( "+req.status+" "+req.statusText+" ) ";if(req.status===200&&error!==undefined){statusMsg=" ( "+(error.message||error)+" ) "}}else if(status!==null){statusMsg=" ( "+status+" ) "}else if(error!==undefined){statusMsg=" ( "+(error.message||error)+" ) "}errmsg=$.ig.DataSourceLocale.locale.errorRemoteRequest+statusMsg;if(f&&this._callee){f.apply(this._callee,[false,errmsg,req,this])}else if(f){f(false,errmsg,req,this)}},_completeCallback:function(){var f,callee,s=this.settings.sorting,p=this.settings.paging,filtering=this.settings.filtering;if(filtering.type==="local"&&filtering.defaultFields.length>0){this.filter(filtering.defaultFields)}if(s.type==="local"&&s.defaultFields.length>0){this.sort(s.defaultFields,s.defaultDirection)}if(p.enabled&&p.type==="local"){this._page()}this._internalDataBound(true);f=this._customCallback||this.settings.callback;callee=this._callee||this.settings.callee;if(f&&callee){f.apply(callee,[true,"",this])}else if(f){f(true,"",this)}},_processRequest:function(options){var o,s;if(this.settings.responseDataType==="jsonp"){o={dataType:"jsonp",type:"GET",url:options.url,data:options.data,success:$.proxy(this._jsonpFilter,this),error:$.proxy(this._errorCallback,this)};s=this.settings;if(s.jsonp!==undefined&&s.jsonp!==null){o.jsonp=this.settings.jsonp}if(s.jsonpCallback!==undefined){o.jsonpCallback=this.settings.jsonpCallback}this._ajaxRequest=$.ajax(o)}else{this._ajaxRequest=$.ajax(options)}},_jsonpFilter:function(data){var resp,x;this.context=this;resp=this._dataFilter(data,"json");if(!resp.length&&$.type(resp)==="object"){resp=[resp]}if(this._data.length>=0&&this.settings.paging&&this.settings.paging.enabled&&this.settings.paging.appendPage){for(x=0;x<resp.length;++x){this._data[this._data.length]=resp[x]}}else{this._data=resp;this._dataView=resp}this._populateTransformedData();this._completeCallback()},_processJsonResponse:function(data,context){var ds,schema=context.schema(),resKey,resPath,i;if(this._responseData){this._responseData(data)}if(data.Metadata){this._metadata=data.Metadata}if(schema&&schema.fields&&schema.fields().length>0&&this.settings.localSchemaTransform){ds=schema.transform(data)}else{resKey=context.settings.responseDataKey;if(resKey!==null&&resKey!==undefined){resPath=resKey.split(".");if(resPath.length>0){ds=data;for(i=0;i<resPath.length;i++){ds=ds[resPath[i]]}if(typeof ds==="string"){ds=JSON.parse(ds)}}else{ds=data}}else{ds=data}}if(context._isPagingReq||context._isFilteringReq){this.totalRecordsCount(null,this.settings.responseTotalRecCountKey,data,context)}this.summariesResponse(this.settings.summaries.summariesResponseKey,data);return ds},_processXmlResponse:function(data,isParsed,context){var ds,schema=context.schema(),tmpSchema,resKey;if(schema&&schema.fields&&schema.fields().length>0){ds=this.settings.localSchemaTransform?schema.transform(data):data}else{resKey=context.settings.responseDataKey;if(resKey&&resKey!==""){tmpSchema=new $.ig.DataSchema;ds=context._xmlToArray(tmpSchema._findXmlRecordsRoot(data,resKey))}else{ds=context._xmlToArray(data)}}return ds},_xmlToArray:function(data){var ds=[],root=data,i,r,j,name,val,o;o=window.ActiveXObject;if(data&&data.childNodes&&data.childNodes.length===1){root=data.childNodes[0]}for(i=0;i<root.childNodes.length;i++){r=root.childNodes[i];ds[i]=[];for(j=0;j<r.childNodes.length;j++){name=o===undefined?r.childNodes[j].localName:r.childNodes[j].baseName;val=o===undefined?r.childNodes[j].textContent:r.childNodes[j].text;ds[i][name]=val}}return ds},_encodeUrl:function(){var props=this.settings,sParams={},fParams={},pParams={},params,selParams={},sumParams={},extraParams={},pkParams={},noCancel=true;params={sortingParams:sParams,filteringParams:fParams,pagingParams:pParams,selectParams:selParams,summariesParams:sumParams,extraParams:extraParams,pkParams:pkParams};if($.isFunction(props.urlParamsEncoding)){noCancel=props.urlParamsEncoding(this,params)}if(noCancel){this._encodeSelectParams(params);this._encodeSortingParams(params);this._encodeFilteringParams(params);this._encodePagingParams(params);this._encodeSummariesParams(params);this._encodePkParams(params);if($.isFunction(this.settings.encodeExtraParams)){this.settings.encodeExtraParams(this,params)}if($.isFunction(props.urlParamsEncoded)){props.urlParamsEncoded(this,params)}}return $.extend(true,{},params.sortingParams,params.filteringParams,params.pagingParams,params.selectParams,params.summariesParams,params.extraParams,params.pkParams)},_encodePkParams:function(params){var p=this.settings.paging,s=this.settings.sorting,f=this.settings.filtering,sm=this.settings.summaries,pk=this._schema?this._schema._pk:null;if(pk&&(p.enabled&&p.type==="remote"||s.type==="remote"||f.type==="remote"||sm.type==="remote")){params.pkParams.pk=pk}},_encodeSelectParams:function(params){var selParams=params.selectParams,i;if(!this.settings.localSchemaTransform&&this.schema()&&this.schema().fields().length>0){selParams.$select="";for(i=0;i<this.schema().fields().length;i++){if(i!==0){selParams.$select+=","}selParams.$select+=this.schema().fields()[i].name}}else if(!this.settings.localSchemaTransform&&this.schema()&&this.schema().fields().length===0){selParams.$select="*"}},_encodePagingParams:function(params){var p=this.settings.paging;if(p.enabled&&p.type==="remote"){this._isPagingReq=true;if(p.pageIndexUrlKey!==null&&p.pageSizeUrlKey!==null){params.pagingParams[p.pageIndexUrlKey]=this.pageIndex();params.pagingParams[p.pageSizeUrlKey]=this.pageSize()}else{params.pagingParams.$skip=this.pageIndex()*this.pageSize();params.pagingParams.$top=this.pageSize();params.pagingParams.$inlinecount="allpages";if(this.settings.responseTotalRecCountKey===null){this.settings.responseTotalRecCountKey="d.__count"}}}},_encodeSortingParams:function(params){var s=this.settings.sorting,tmpdir,i,sfields,url,urlQS,hlayout=null;if(s.type==="remote"){if(s.exprString){sfields=this._parseSortExpressions(s.exprString)}else{sfields=s.expressions}this._isSortingReq=true;for(i=0;i<sfields.length;i++){if(sfields[i].layout){hlayout=sfields[i].layout}if(s.sortUrlAscValueKey!==null&&s.sortUrlDescValueKey!==null&&s.sortUrlKey!==null){tmpdir=sfields[i].dir&&sfields[i].dir.toLowerCase().startsWith("asc")?s.sortUrlAscValueKey:s.sortUrlDescValueKey;params.sortingParams[s.sortUrlKey+"("+sfields[i].fieldName+")"]=tmpdir}else{if(params.sortingParams.$orderby===undefined){params.sortingParams.$orderby=""}params.sortingParams.$orderby=params.sortingParams.$orderby+sfields[i].fieldName+" "+sfields[i].dir.toLowerCase();if(i<sfields.length-1){params.sortingParams.$orderby+=","}}}if(hlayout){url=this.settings.dataSource;if(url&&$.type(url)==="string"&&url.indexOf("layout="+hlayout)>=0){url=url.substr(url.indexOf("?")+1);urlQS=url.split("&");for(i=0;i<urlQS.length;i++){if(urlQS[i].indexOf("layout=")>=0){if(urlQS[i].replace("layout=","")===hlayout){hlayout=null}break}}}if(hlayout){params.sortingParams.layout=hlayout}}}},_encodeFilteringParams:function(params){var f=this.settings.filtering,ffields,i,key,exprNotReq,cond,d,day,month,year,curDate,expr,fieldName,logic="and";if(f.type==="remote"){if(f.exprString){ffields=this._parseFilterExprString(f.exprString)}else{ffields=f.expressions}for(i=0;i<ffields.length;i++){this._isFilteringReq=true;cond=ffields[i].cond;exprNotReq=this._isFilteringExprNotReq(cond);if(f.filterExprUrlKey!==null){key=f.filterExprUrlKey+"("+ffields[i].fieldName+")";if($.type(ffields[i].expr)==="date"){d=Date.UTC(ffields[i].expr.getFullYear(),ffields[i].expr.getMonth(),ffields[i].expr.getDate(),ffields[i].expr.getHours(),ffields[i].expr.getMinutes())}else{d=ffields[i].expr}if(params.filteringParams[key]===undefined){params.filteringParams[key]=ffields[i].cond+"("+(exprNotReq?"":d)+")"}else{params.filteringParams[key]=params.filteringParams[key]+","+ffields[i].cond+"("+(exprNotReq?"":d)+")"}}else{if(params.filteringParams.$filter===undefined){params.filteringParams.$filter=""}fieldName=ffields[i].fieldName;expr=ffields[i].expr;if($.type(expr)==="string"){if(!f.caseSensitive){fieldName="tolower("+fieldName+")";expr=expr.toLowerCase()}expr=expr.replace(/\'/g,"''")}if(ffields[i].cond==="startsWith"){params.filteringParams.$filter+="startswith("+fieldName+","+"'"+expr+"') eq true"}else if(ffields[i].cond==="endsWith"){params.filteringParams.$filter+="endswith("+fieldName+","+"'"+expr+"') eq true"}else if(ffields[i].cond==="contains"){params.filteringParams.$filter+="indexof("+fieldName+","+"'"+expr+"') ge 0"}else if(ffields[i].cond==="doesNotContain"){params.filteringParams.$filter+="indexof("+fieldName+","+"'"+expr+"') eq -1"}else if(ffields[i].cond==="equals"){if($.type(ffields[i].expr)==="string"){params.filteringParams.$filter+=fieldName+" eq "+"'"+expr+"'"}else{params.filteringParams.$filter+=ffields[i].fieldName+" eq "+ffields[i].expr}}else if(ffields[i].cond==="true"){params.filteringParams.$filter+=ffields[i].fieldName+" eq true"}else if(ffields[i].cond==="false"){params.filteringParams.$filter+=ffields[i].fieldName+" eq false"}else if(ffields[i].cond==="doesNotEqual"){if($.type(ffields[i].expr)==="string"){params.filteringParams.$filter+=fieldName+" ne "+"'"+expr+"'"}else{params.filteringParams.$filter+=ffields[i].fieldName+" ne "+ffields[i].expr}}else if(ffields[i].cond==="greaterThan"){params.filteringParams.$filter+=ffields[i].fieldName+" gt "+ffields[i].expr}else if(ffields[i].cond==="lessThan"){params.filteringParams.$filter+=ffields[i].fieldName+" lt "+ffields[i].expr}else if(ffields[i].cond==="greaterThanOrEqualTo"){params.filteringParams.$filter+=ffields[i].fieldName+" ge "+ffields[i].expr}else if(ffields[i].cond==="lessThanOrEqualTo"){params.filteringParams.$filter+=ffields[i].fieldName+" le "+ffields[i].expr}else if(ffields[i].cond==="null"){params.filteringParams.$filter+=ffields[i].fieldName+" eq null"}else if(ffields[i].cond==="notNull"){params.filteringParams.$filter+=ffields[i].fieldName+" ne null"}else if(ffields[i].cond==="empty"){params.filteringParams.$filter+="length("+ffields[i].fieldName+") eq 0"}else if(ffields[i].cond==="notEmpty"){params.filteringParams.$filter+="length("+ffields[i].fieldName+") gt 0"}else if(ffields[i].cond==="on"){expr=this._parser.toDate(ffields[i].expr);year=expr.getFullYear();month=expr.getMonth()+1;day=expr.getDate();params.filteringParams.$filter+="day("+ffields[i].fieldName+") eq "+day+" and ";params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="notOn"){expr=this._parser.toDate(ffields[i].expr);year=expr.getFullYear();month=expr.getMonth()+1;day=expr.getDate();params.filteringParams.$filter+="day("+ffields[i].fieldName+") ne "+day+" or ";params.filteringParams.$filter+="month("+ffields[i].fieldName+") ne "+month+" or ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") ne "+year}else if(ffields[i].cond==="after"){expr=this._parser.toDate(ffields[i].expr);params.filteringParams.$filter+=ffields[i].fieldName+" gt DateTime'"+$.ig.formatter(expr,"date","yyyy-MM-ddT23:59:59")+"'"}else if(ffields[i].cond==="before"){expr=this._parser.toDate(ffields[i].expr);params.filteringParams.$filter+=ffields[i].fieldName+" lt DateTime'"+$.ig.formatter(expr,"date","yyyy-MM-dd")+"'"}else if(ffields[i].cond==="today"){expr=this._parser.toDate(ffields[i].expr);year=expr.getFullYear();month=expr.getMonth()+1;day=expr.getDate();params.filteringParams.$filter+="day("+ffields[i].fieldName+") eq "+day+" and ";params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="yesterday"){expr=this._parser.toDate(ffields[i].expr);year=expr.getFullYear();month=expr.getMonth()+1;day=expr.getDate();params.filteringParams.$filter+="day("+ffields[i].fieldName+") eq "+day+" and ";params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="thisMonth"){curDate=new Date;month=curDate.getMonth()+1;year=curDate.getFullYear();params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="lastMonth"){curDate=new Date;month=curDate.getMonth()+1;year=curDate.getFullYear();if(month===1){month=12;year--}else{month--}params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="nextMonth"){curDate=new Date;month=curDate.getMonth()+1;year=curDate.getFullYear();if(month===12){month=1;year++}else{month++}params.filteringParams.$filter+="month("+ffields[i].fieldName+") eq "+month+" and ";params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="thisYear"){curDate=new Date;year=curDate.getFullYear();params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="lastYear"){curDate=new Date;year=curDate.getFullYear()-1;params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}else if(ffields[i].cond==="nextYear"){curDate=new Date;year=curDate.getFullYear()+1;params.filteringParams.$filter+="year("+ffields[i].fieldName+") eq "+year}logic="and";if(ffields[i].logic&&ffields[i].logic.toLowerCase()==="or"){logic="or"}if(i<ffields.length-1){params.filteringParams.$filter+=" "+logic+" "}}}if(f.filterLogicUrlKey!==null&&ffields.length>0){params.filteringParams[f.filterLogicUrlKey]=ffields[0].logic}}},_encodeSummariesParams:function(params){var i,j,s=this.settings.summaries,cs=s.columnSettings,methodsStr,csLength=cs.length;if(s.type==="remote"){for(i=0;i<csLength;i++){methodsStr="";if(cs[i].summaryOperands===undefined||cs[i].summaryOperands===null){continue}for(j=0;j<cs[i].summaryOperands.length;j++){if(cs[i].summaryOperands[j].active===true||cs[i].summaryOperands[j].active===1){methodsStr+=cs[i].summaryOperands[j].type+","}}if(methodsStr!==""){params.summariesParams[s.summaryExprUrlKey+"("+cs[i].columnKey+")"]=methodsStr.slice(0,-1)}}}},filteredData:function(){return this._filteredData},_page:function(keepRecords){var count=0,startIndex,endIndex,i=0;if(keepRecords===undefined){keepRecords=false}if(keepRecords){count=this._dataView.length}else{this._dataView=[]}if(!this._filter){startIndex=this.pageIndex()*this.pageSize();if(startIndex>=this._data.length){this.settings.paging.pageIndex=0;startIndex=this.pageIndex()*this.pageSize()}endIndex=startIndex+this.pageSize()>=this._data.length?this._data.length:startIndex+this.pageSize();for(i=startIndex;i<endIndex;i++){this._dataView[count++]=this._data[i]}}else{startIndex=this.pageIndex()*this.pageSize();if(this.persistedPageIndex()>0&&startIndex>=this._filteredData.length){this.settings.paging.pageIndex=0;startIndex=this.pageIndex()*this.pageSize()}endIndex=startIndex+this.pageSize()>=this._filteredData.length?this._filteredData.length:startIndex+this.pageSize();for(i=startIndex;i<endIndex;i++){this._dataView[count++]=this._filteredData[i]}}},_compareValues:function(x,y){if((x===null||x===undefined)&&(y===null||y===undefined)){return 0}if((x===null||x===undefined)&&y!==null&&y!==undefined){return-1}if(x!==null&&x!==undefined&&(y===null||y===undefined)){return 1}return x>y?1:x<y?-1:0},sort:function(fields,direction){var s=this.settings.sorting,schema,sortF,convertFunc,p=this.settings.paging,data,resetPaging=false,settings=this.settings,compareValFunc=this._compareValues,self=this;if(fields===undefined||fields===null){throw new Error($.ig.DataSourceLocale.locale.noSortingFields)}sortF=function(fields,schema,reverse,convertf){reverse=reverse?-1:1;return function(obj1,obj2){var i,f,arr1=[],arr2=[],a,b,recordsData,recordsDataReverse;for(i=0;i<fields.length;i++){if(fields[i].layout&&(settings.key&&settings.key!==fields[i].layout||!settings.key)){continue}f=fields[i];if($.type(f.compareFunc)==="function"){compareValFunc=f.compareFunc}else if(window[f.compareFunc]&&typeof window[f.compareFunc]==="function"){compareValFunc=window[f.compareFunc]}if(f.fieldIndex>=0){f.fieldName=f.fieldIndex}a=self.getCellValue(f.fieldName,obj1);b=self.getCellValue(f.fieldName,obj2);recordsData={fieldName:f.fieldName,recordX:obj1,recordY:obj2};recordsDataReverse={fieldName:f.fieldName,recordX:obj2,recordY:obj1};if(convertf!==undefined){a=convertf(a,f.fieldName);b=convertf(b,f.fieldName)}if(s.caseSensitive===false){if(a!==undefined&&a!==null&&a.toLowerCase){a=a.toLowerCase()}if(b!==undefined&&b!==null&&b.toLowerCase){b=b.toLowerCase()}}if(f.dir!==undefined&&f.dir!==null){reverse=f.dir.toLowerCase().startsWith("desc");reverse=reverse?-1:1}else if(direction!==undefined&&direction!==null&&direction!==""){reverse=direction.toLowerCase().startsWith("desc");reverse=reverse?-1:1}if(fields.length===1){arr1=reverse*compareValFunc(a,b,recordsData);arr2=reverse*compareValFunc(b,a,recordsDataReverse)}else{if(reverse===-1){arr1.push(-compareValFunc(a,b,recordsData));arr2.push(-compareValFunc(b,a,recordsDataReverse))}else{arr1.push(compareValFunc(a,b,recordsData));arr2.push(compareValFunc(b,a,recordsDataReverse))}}}if(arr1<arr2){return-1}if(arr1>arr2){return 1}return 0}};if(s.applyToAllData&&s.type==="local"){if(this._filter&&(p.type==="local"&&p.enabled===true||p.enabled===false||p.type==="remote"&&p.enabled===true&&this.settings.filtering.type==="local")){data=this._filteredData}else{data=this.data()}resetPaging=true}else{data=this.dataView()}if($.type(s.customFunc)==="function"){data=s.customFunc(data,fields,direction)}else{schema=this.settings.schema;if(!direction){direction=""}if($.type(s.compareFunc)==="function"){sortF=s.compareFunc}if($.isFunction(s.customConvertFunc)){convertFunc=s.customConvertFunc}if($.type(fields)==="string"){fields=this._parseSortExpressions(fields)}if(fields.length>0){data=data.sort(sortF(fields,schema,direction.toLowerCase().startsWith("asc")?false:true,convertFunc));this._allDataSorted=data===this.data()}}if(resetPaging&&p.type==="local"){if(!this._filter){this._data=data}else{this._filteredData=data}this._page()}else{this._dataView=data}this._populateTransformedData(data);return this},clearLocalSorting:function(){var s=this.settings.sorting,p=this.settings.paging,data,resetPaging=false;if(s.applyToAllData&&s.type==="local"){if(this._filter&&(p.type==="local"&&p.enabled===true||p.enabled===false)){data=this._filteredData}else{data=this.data()}resetPaging=true}else{data=this.dataView()}if(resetPaging&&p.type==="local"){if(!this._filter){this._data=data}else{this._filteredData=data}this._page()}else{this._dataView=data}this._populateTransformedData();return this},_parseSortExpressions:function(s){var fields=[],tmp,tmp2,i;tmp=s.split(",");for(i=0;i<tmp.length;i++){fields[i]={};tmp2=$.trim(tmp[i]).split(" ");fields[i].fieldName=tmp2[0];fields[i].dir=tmp2[1]}return fields},filter:function(fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings){var i,j,expr=null,count=0,skipRec=false,data,t,k,schema,fields,tmpbool,resetPaging,allFieldsExpr,stringVal,f=this.settings.filtering,p=this.settings.paging,s=this.settings.sorting;schema=this.schema();if(schema===null||schema===undefined){throw new Error($.ig.DataSourceLocale.locale.filteringNoSchema)}if($.type(fieldExpressions)==="string"){expr=fieldExpressions}if($.type(fieldExpressionsOnStrings)==="string"){allFieldsExpr=fieldExpressionsOnStrings}else if($.type(fieldExpressionsOnStrings)==="undefined"){fieldExpressionsOnStrings=[]}if($.type(fieldExpressions)==="array"&&fieldExpressions.length===0&&$.type(fieldExpressionsOnStrings)==="array"&&fieldExpressionsOnStrings.length===0){return}if(f.applyToAllData&&f.type==="local"){data=this.data();resetPaging=true}else{if(this._cachedDataView&&this._cachedDataView.length>0){data=this._cachedDataView}else{this._cachedDataView=$.merge([],this.dataView());data=this._cachedDataView}}if($.type(f.customFunc)==="function"){data=f.customFunc(fieldExpressions,data);this._filteredData=data;this._dataView=[]}else{this._dataView=[];this._filteredData=[];for(i=0;i<data.length;i++){skipRec=false;if(expr){fieldExpressions=this._parseFilterExprString(expr)}if(allFieldsExpr){fieldExpressionsOnStrings=this._parseFilterExprString(allFieldsExpr)}for(j=0;j<fieldExpressions.length;j++){fields=schema.fields();if(fieldExpressions[j].fieldIndex){if(fieldExpressions[j].fieldIndex<fields.length){t=fields[fieldExpressions[j].fieldIndex].type}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldIndex],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond,fieldExpressions[j].preciseDateFormat,fieldExpressions[j].fieldName,data[i])}else{if(fieldExpressions[j].dataType!==undefined&&fieldExpressions[j].dataType!==null){t=fieldExpressions[j].dataType}else{t=this._getFieldTypeFromSchema(fieldExpressions[j].fieldName)}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldName],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond,fieldExpressions[j].preciseDateFormat,fieldExpressions[j].fieldName,data[i])}tmpbool=fieldExpressions[j].logic!==null&&fieldExpressions[j].logic!==undefined&&(fieldExpressions[j].logic.toLowerCase()==="or"||fieldExpressions[j].logic.toLowerCase()==="and")?fieldExpressions[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}else if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}if(!skipRec){for(j=0;j<fieldExpressionsOnStrings.length;j++){fields=schema.fields();if(fieldExpressionsOnStrings[j].fieldIndex){if(fieldExpressionsOnStrings[j].fieldIndex<fields.length){t=fields[fieldExpressionsOnStrings[j].fieldIndex].type}stringVal=data[i][fieldExpressionsOnStrings[j].fieldIndex]?data[i][fieldExpressionsOnStrings[j].fieldIndex].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond,undefined,fieldExpressionsOnStrings[j].fieldName,data[i])}else{for(k=0;k<fields.length;k++){if(fields[k].name===fieldExpressionsOnStrings[j].fieldName){t=fields[k].type;break}}stringVal=data[i][fieldExpressionsOnStrings[j].fieldName]!==null&&data[i][fieldExpressionsOnStrings[j].fieldName]!==undefined?data[i][fieldExpressionsOnStrings[j].fieldName].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond,undefined,fieldExpressionsOnStrings[j].fieldName,data[i])}tmpbool=fieldExpressionsOnStrings[j].logic!==null&&fieldExpressionsOnStrings[j].logic!==undefined&&(fieldExpressionsOnStrings[j].logic.toLowerCase()==="or"||fieldExpressionsOnStrings[j].logic.toLowerCase()==="and")?fieldExpressionsOnStrings[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}else if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}}if(!skipRec){this._filteredData[count++]=data[i]}}}this._filter=true;if(f.type==="local"&&s.type==="local"&&s.enabled&&!s.sortingApplied&&s.expressions.length>0){this.sort(s.expressions)}if(resetPaging&&p.type==="local"&&p.enabled===true){if(this.persistedPageIndex()>0){this.settings.paging.pageIndex=this.persistedPageIndex()}else{this.settings.paging.pageIndex=0}this.pageSizeDirty(true);this._page();this.persistedPageIndex(null)}else{for(i=0;i<this._filteredData.length;i++){this._dataView[i]=this._filteredData[i]}}this._populateTransformedData(this._filteredData);return this},clearLocalFilter:function(){var i,data,resetPaging,f=this.settings.filtering,p=this.settings.paging,s=this.settings.sorting;if(f.applyToAllData&&f.type==="local"){data=this.data();resetPaging=true}else{if(this._cachedDataView&&this._cachedDataView.length>0){data=this._cachedDataView}else{this._cachedDataView=$.merge([],this.dataView());data=this._cachedDataView}}this._dataView=[];this._filteredData=data;if(s.type==="local"&&s.enabled&&s.expressions.length>0){this.sort(s.expressions)}if(resetPaging&&p.type==="local"&&p.enabled===true){this._filter=true;this.settings.paging.pageIndex=0;this.pageSizeDirty(true);this._page()}else{if(p.enabled===false){this._filter=true}for(i=0;i<this._filteredData.length;i++){this._dataView[i]=this._filteredData[i]}}this._populateTransformedData(this._filteredData);return this},_parseFilterExprString:function(expr){var exprs=$.trim(expr).split(/(?=AND+)|(?=OR+)/i),i,j,fields=[],tmp,tmp2,isInvalid=true;for(i=0;i<exprs.length;i++){fields[i]={};tmp=$.trim(exprs[i]).split(/(?= \=+)|(?=<>+)|(?=>+)|(?=<+)|(?=LIKE+)|(?=NOT\WLIKE)+|(?=>\=+)|(?=<\=+)/);if($.trim(exprs[i]).toLowerCase().startsWith("and")){fields[i].logic="AND"}else if($.trim(exprs[i]).toLowerCase().startsWith("or")){fields[i].logic="OR"}if(i>0&&(fields[i].logic==="AND"||fields[i].logic==="OR")){fields[i-1].logic=fields[i].logic}if(tmp[0].toLowerCase().startsWith("and")||tmp[0].toLowerCase().startsWith("or")){fields[i].fieldName=$.trim(tmp[0].split(" ")[1])}else{fields[i].fieldName=$.trim(tmp[0])}tmp2=$.trim(tmp[1]).split(" ");if(exprs[i].indexOf("<>")!==-1){tmp2[0]="<>";tmp2[1]=tmp[2].replace(">","")}if(tmp2.length>2){for(j=2;j<tmp2.length;j++){tmp2[1]=tmp2[1]+" "+tmp2[j]}tmp2=[tmp2[0],tmp2[1]]}if(tmp[1].startsWith("NOT")){fields[i].expr=$.trim(tmp[2].replace("LIKE",""))}else{fields[i].expr=tmp2[1]}for(j=0;j<this.schema().schema.fields.length;j++){if(this.schema().schema.fields[j].name===fields[i].fieldName){isInvalid=false;break}}if(isInvalid){throw new Error($.ig.DataSourceLocale.locale.fieldMismatch+fields[i].fieldName)}isInvalid=true;if(tmp2[0]===">"){fields[i].cond="greaterThan"}else if(tmp2[0]==="LIKE"){if(fields[i].expr.startsWith("%")&&fields[i].expr.endsWith("%")){fields[i].cond="contains"}else if(fields[i].expr.endsWith("%")){fields[i].cond="startsWith"}else if(fields[i].expr.startsWith("%")){fields[i].cond="endsWith"}else{fields[i].cond="equals"}fields[i].expr=fields[i].expr.replace(/%/g,"")}else if(tmp2[0]==="NOT LIKE"||tmp2[0]==="NOT"){if(fields[i].expr.startsWith("%")&&fields[i].expr.endsWith("%")){fields[i].cond="doesNotContain"}else{fields[i].cond="doesNotEqual"}fields[i].expr=fields[i].expr.replace(/%/g,"")}else if(tmp2[0]==="="){fields[i].cond="equals"}else if(tmp2[0]==="<>"){fields[i].cond="doesNotEqual"}else if(tmp2[0]==="<"){fields[i].cond="lessThan"}else if(tmp2[0]==="<="){fields[i].cond="lessThanOrEqualTo"}else if(tmp2[0]===">="){fields[i].cond="greaterThanOrEqualTo"}else{throw new Error($.ig.DataSourceLocale.locale.unrecognizedCondition+expr)}}return fields},_isFilteringExprNotReq:function(cond){return cond==="false"||cond==="true"||cond==="today"||cond==="yesterday"||cond==="thisMonth"||cond==="lastMonth"||cond==="nextMonth"||cond==="thisYear"||cond==="lastYear"||cond==="nextYear"||cond==="null"||cond==="notNull"||cond==="empty"||cond==="notEmpty"},_findMatch:function(val,expr,t,ignoreCase,cond,preciseDateFormat,colKey,rec){var tmpExpr,custConds=this.settings.filtering.customConditions,f,func,exprNotReq=this._isFilteringExprNotReq(cond);val=this.getCellValue(colKey,rec);if($.type(val)==="function"){val=val()}if(custConds&&(f=custConds[cond]||custConds[colKey+"_"+cond])){func=f.filterFunc;if($.type(func)==="function"){f=func}else if(window[func]&&typeof window[func]==="function"){f=window[func]}else{throw new Error($.ig.DataSourceLocale.locale.errorUnexpectedCustomFilterFunction)}return f(val,expr,t,ignoreCase,preciseDateFormat,colKey)}if(expr===""&&!exprNotReq){return true}tmpExpr=$.trim(expr);if(t==="regexp"||t==="string"&&tmpExpr.startsWith("/")&&tmpExpr.endsWith("/")){if(t==="regexp"){return this._findRegExpMatch(val,expr,false)}return this._findRegExpMatch(val,tmpExpr.substring(1,tmpExpr.length-1),true)}if($.type(val)==="date"&&(t===undefined||t===null)||t==="date"){try{expr=this._parser.toDate(expr)}catch(ignore){}return this._findDateMatch(val,expr,cond,preciseDateFormat)}if($.type(val)==="boolean"&&(t===undefined||t===null)||t==="boolean"||t==="bool"){return this._findBoolMatch(val,cond)}if($.type(val)==="number"&&(t===undefined||t===null)||t==="number"){return this._findNumericMatch(val,expr,cond)}return this._findStringMatch(val,expr,ignoreCase,cond)},_findStringMatch:function(val,expr,ignoreCase,cond){var localVal;if(val!==null&&val!==undefined){localVal=ignoreCase?val.toString().toLowerCase():val||""}else{localVal=val}if(expr!==null&&expr!==undefined){expr=ignoreCase?expr.toString().toLowerCase():expr.toString()}if(cond==="startsWith"){return localVal!==null&&localVal!==undefined&&localVal.startsWith(expr)}if(cond==="endsWith"){return localVal!==null&&localVal!==undefined&&localVal.endsWith(expr)}if(cond==="contains"){return localVal!==null&&localVal!==undefined&&localVal.indexOf(expr)!==-1}if(cond==="doesNotContain"){return localVal!==null&&localVal!==undefined&&localVal.indexOf(expr)===-1}if(cond==="equals"){return localVal!==null&&localVal!==undefined&&localVal===expr}if(cond==="doesNotEqual"){return localVal!==null&&localVal!==undefined&&localVal!==expr}if(cond==="null"){return localVal===null}if(cond==="notNull"){return localVal!==null}if(cond==="empty"){return localVal===null||localVal===undefined||localVal.length===0}if(cond==="notEmpty"){return localVal===null||localVal===undefined||localVal.length!==0}throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)},_findRegExpMatch:function(val,expr,str){if(str){return new RegExp(expr).test(val)}return val.match(expr)},_findNumericMatch:function(val,expr,cond){if($.type(expr)!=="number"){expr=this._parser.toNumber(expr)}if(cond==="equals"){return val===expr}if(cond==="doesNotEqual"){return val!==expr}if(cond==="greaterThan"){return val>expr}if(cond==="lessThan"){return val<expr}if(cond==="greaterThanOrEqualTo"){return val>=expr}if(cond==="lessThanOrEqualTo"){return val<=expr}if(cond==="null"){return val===null}if(cond==="notNull"){return val!==null}if(cond==="empty"){return val===null||val===undefined||isNaN(val)}if(cond==="notEmpty"){return val!==null&&val!==undefined&&!isNaN(val)}throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)},_findBoolMatch:function(val,cond){if(cond==="true"){return val}if(cond==="false"){return!val}if(cond==="null"){return val===null}if(cond==="notNull"){return val!==null}if(cond==="empty"){return val===null||val===undefined}if(cond==="notEmpty"){return val!==null&&val!==undefined}throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)},_getDateParts:function(date){if(!date||$.type(date)!=="date"){return null}var yrs,day,mdate,mins,hrs,month;if(this.settings.enableUTCDates){yrs=date.getUTCFullYear();month=date.getUTCMonth();day=date.getUTCDay();mdate=date.getUTCDate();hrs=date.getUTCHours();mins=date.getUTCMinutes()}else{yrs=date.getFullYear();month=date.getMonth();day=date.getDay();mdate=date.getDate();hrs=date.getHours();mins=date.getMinutes()}return{year:yrs,month:month,day:day,mdate:mdate,hours:hrs,mins:mins}},_findDateMatch:function(val,expr,cond,preciseDateFormat){var day1,mins1,hs1,yrs1,day2,mins2,hs2,yrs2,month1,month2,eq,cur,yrs3,month3,mday1,mday2,mday3,yesterday,onEq,valDateParts,exprDateParts;if(val!==null&&val!==undefined){valDateParts=this._getDateParts(val);day1=valDateParts.day;mday1=valDateParts.mdate;mins1=valDateParts.mins;hs1=valDateParts.hours;yrs1=valDateParts.year;month1=valDateParts.month}if($.type(expr)==="date"){exprDateParts=this._getDateParts(expr);day2=exprDateParts.day;mday2=exprDateParts.mdate;mins2=exprDateParts.mins;hs2=exprDateParts.hours;
yrs2=exprDateParts.year;month2=exprDateParts.month}else{expr=new Date(expr)}cur=new Date;yesterday=new Date(cur.getTime());yesterday.setDate(yesterday.getDate()-1);mday3=cur.getDate();yrs3=cur.getFullYear();month3=cur.getMonth();eq=day1===day2&&mins1===mins2&&hs1===hs2&&yrs1===yrs2&&month1===month2;if(cond==="equals"){return eq}if(cond==="doesNotEqual"){return!eq}if(cond==="before"){return val<expr}if(cond==="after"){return val>expr}if(cond==="today"){return mday1===mday3&&month1===month3&&yrs1===yrs3}if(cond==="yesterday"){return yesterday.getDate()===mday1&&yesterday.getMonth()===month1&&yesterday.getFullYear()===yrs1}if(cond==="thisMonth"){return month1===month3&&yrs1===yrs3}if(cond==="lastMonth"){if(month3===0){return month1===11&&yrs1===yrs3-1}return month1===month3-1&&yrs1===yrs3}if(cond==="nextMonth"){if(month3===11){return month1===0&&yrs1===yrs3+1}return month1===month3+1&&yrs1===yrs3}if(cond==="thisYear"){return yrs1===yrs3}if(cond==="lastYear"){return yrs1===yrs3-1}if(cond==="nextYear"){return yrs1===yrs3+1}if(cond==="on"||cond==="notOn"){onEq=yrs1===yrs2&&month1===month2&&mday1===mday2;if(preciseDateFormat){if(preciseDateFormat.indexOf("m")>=0){onEq=onEq&&mins1===mins2}if(preciseDateFormat.indexOf("h")>=0||preciseDateFormat.indexOf("H")>=0){onEq=onEq&&hs1===hs2}if(preciseDateFormat.indexOf("s")>=0){onEq=onEq&&val.getSeconds()===expr.getSeconds()}if(preciseDateFormat.indexOf("f")>=0){onEq=onEq&&val.getMilliseconds()===expr.getMilliseconds()}}if(cond==="on"){return onEq}return!onEq}if(cond==="null"){return val===null}if(cond==="notNull"){return val!==null}if(cond==="empty"){return val===null||val===undefined}if(cond==="notEmpty"){return val!==null&&val!==undefined}throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)},totalRecordsCount:function(count,key,dsObj,context){var rec,totalRecPath,i;if(context!==undefined&&context!==null){if(key){rec=dsObj;if(rec.hasOwnProperty(key)){rec=rec[key]}else{totalRecPath=key.split(".");for(i=0;i<totalRecPath.length;i++){rec=rec[totalRecPath[i]]}}if(dsObj&&rec!==undefined&&rec!==null){if($.type(rec)==="number"){this._recCount=rec}else{this._recCount=parseInt(rec,10)}this.hasTotalRecordsCount(true)}else{this.hasTotalRecordsCount(false)}}else{this.hasTotalRecordsCount(false)}}else if(count!==undefined&&count!==null){this._recCount=count}return this._recCount},hasTotalRecordsCount:function(hasCount){if(hasCount===undefined||hasCount===null){return this._hasCount}this._hasCount=hasCount},metadata:function(key){if(key===null||key===undefined||key===""||this._metadata===null||this._metadata===undefined){return this._metadata}return this._metadata[key]},totalLocalRecordsCount:function(){if(!this._filter){return this._data.length}return this._dataView.length},pageCount:function(){var c,realCount;if(!this._filter){realCount=this.totalRecordsCount()>0?this.totalRecordsCount():this._data.length}else{realCount=this.totalRecordsCount()>0?this.totalRecordsCount():this._filteredData.length}c=Math.ceil(realCount/this.settings.paging.pageSize);return c===0?1:c},pageIndex:function(index){if(index===undefined||index===null){return this.settings.paging.pageIndex===undefined?0:this.settings.paging.pageIndex}this.settings.paging.pageIndex=parseInt(index,10);this._cachedDataView=null;if(this.settings.paging.type==="local"){this._page(this.settings.paging.appendPage);this._invokeCallback()}else{this.dataBind()}return this},persistedPageIndex:function(value){if(value===undefined){return this.settings.paging._persistedPageIndex}else{this.settings.paging._persistedPageIndex=value}},prevPage:function(){this.pageIndex(this.pageIndex()===0?0:this.pageIndex()-1);return this},nextPage:function(){if(this.pageIndex()>=this.pageCount()-1){return this}this.pageIndex(this.pageIndex()+1);return this},pageSize:function(s){if(s===undefined||s===null){return this.settings.paging.pageSize}this.settings.paging.pageSize=parseInt(s,10);if(this.settings.paging.appendPage){this.settings.paging.pageIndex=0;this._cachedDataView=null}if(this.settings.paging.type==="local"){this._page();this._invokeCallback()}else{this.dataBind()}return this},pageSizeDirty:function(dirty){if(dirty===undefined||dirty===null){return this._dirty}this._dirty=dirty},recordsForPage:function(p){var d=[],si,ps,ei,i,c=0;ps=this.pageSize();si=p*ps;ei=si+ps>=this._data.length?this._data.length:si+ps;for(i=si;i<ei;i++){d[c++]=this._data[i]}return d},tableToObject:function(tableDOM){try{var rows=$(tableDOM).children("tbody").children(),len,data,i,j;len=rows.length>0?rows[0].cells.length:0;data=[];for(i=0;i<rows.length;i++){data[i]=[];for(j=0;j<len;j++){data[i][j]=rows[i].cells[j].innerHTML}}return data}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingHtmlTableNoSchema+e.message)}},_validateTable:function(obj){if(obj.length===0){throw new Error($.ig.DataSourceLocale.locale.errorTableWithIdNotFound+this.dataSource())}else{return obj[0]}},stringToJSONObject:function(s){var data={};try{data=JSON.parse(s)}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingJsonNoSchema+e.message)}return data},stringToXmlObject:function(s){var doc,parser;try{if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else{parser=new DOMParser;doc=parser.parseFromString(s,"text/xml")}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingXmlNoSchema+e.message)}return doc}});$.ig.TypeParser=$.ig.TypeParser||Class.extend({toStr:function(obj){return this.isNullOrUndefined(obj)?"":obj+this.empty()},toDate:function(obj,pk,key){if(this.isNullOrUndefined(obj)||obj===""||$.type(obj)==="function"){return null}if($.type(obj)==="date"){return obj}var d;if(obj.length&&obj.indexOf("/Date(")!==-1){if(this._serverOffsets===undefined||this._serverOffsets[pk]===undefined){return new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10)+this._serverOffset)}if(this._serverOffsets[pk][key]!==undefined&&this._serverOffsets[pk][key]!==null){return new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10)+this._serverOffsets[pk][key])}return new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10))}d=new Date(obj);if(isNaN(d)){d=$.ig.util.dateFromISO(obj)}return d},toNumber:function(obj){return this.isNullOrUndefined(obj)||$.type(obj)==="function"?null:obj*this.num()},toBool:function(obj){var typeObj=$.type(obj);if(typeObj==="boolean"){return obj}if(this.isNullOrUndefined(obj)||typeObj==="function"){return false}if(obj==="1"||obj===1||typeObj==="string"&&obj.toLowerCase()==="true"){return true}return false},isNullOrUndefined:function(obj){return obj===null||obj===undefined},empty:function(){return""},num:function(){return 1}});$.ig.DataSchema=$.ig.DataSchema||Class.extend({schema:{fields:[{name:undefined,type:undefined,xpath:undefined,mapper:undefined}],searchField:null,outputResultsName:null},init:function(type,options){$.ig.DataSchema.prototype.schema.fields=[];if(options){this.schema=$.extend(true,{},$.ig.DataSchema.prototype.schema,options)}this._type=type;this._parser=new $.ig.TypeParser;this._parser._serverOffset=0},transform:function(data){var ndata=[];switch(this._type){case"array":ndata=this._arrays(data);break;case"json":ndata=this._json(data);break;case"xml":ndata=this._xml(data);break;case"htmlTableDom":ndata=this._table(data);break;case"htmlListDom":ndata=this._list(data);break;case"htmlSelectDom":ndata=this._select(data);break;case"singleRow":ndata=this._row(data);break;default:throw new Error("unknown data source type: "+this._type)}return ndata},_setResKey:function(resKey,out){if(!this.isEmpty(resKey)){out[resKey]=[];return out[resKey]}return out},_convertType:function(t,obj,pk,key){if(t==="string"){return this._parser.toStr(obj)}if(t==="date"){return this._parser.toDate(obj,pk,key)}if(t==="number"){return this._parser.toNumber(obj)}if(t==="boolean"||t==="bool"){return this._parser.toBool(obj)}return obj},_val:function(field,val,results,i,rec){var t=field.type,j=null;if(!this.isEmpty(t)){if(this.isEmpty(field.name)){results[i][j]=this._convertType(t,val,this._pk?results[i][this._pk]:i,field.name)}else{results[i][field.name]=this._convertType(t,val,this._pk?results[i][this._pk]:i,field.name)}}else{if(this.isEmpty(field.name)){if(rec){results[i][j]=rec[i][j]}else{results[i][j]=val}}else{if(rec){results[i][field.name]=rec[i][field.name]}else{results[i][field.name]=val}}}},isEmpty:function(o){return o===undefined||o===null||o===""},_row:function(dataRow,index){var t,j,f,tmp,schema=this.schema,fields=schema.fields,fLen=fields.length,fName,nDataRow={};for(j=0;j<fLen;j++){f=fields[j];fName=f.name;tmp=dataRow[fName];t=f.type;if(!this.isEmpty(t)){if(this.isEmpty(fName)){nDataRow[j]=this._convertType(t,tmp,this._pk?dataRow[this._pk]:index,fName)}else{nDataRow[fName]=this._convertType(t,tmp,this._pk?dataRow[this._pk]:index,fName)}}else{if(this.isEmpty(fName)){nDataRow[j]=tmp}else{nDataRow[fName]=tmp}}}return nDataRow},_arrays:function(data){var i,j,tmp,hasArrays,resKey=this.schema.outputResultsName,out={},results;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)&&$.type(results)!=="array"){results=[];out=results}try{if(data.length>0){hasArrays=$.type(data[0])==="array"}for(i=0;i<data.length;i++){if(data[i]===undefined){continue}results.push({});for(j=0;j<this.schema.fields.length;j++){if(hasArrays){tmp=data[i][j]}else{tmp=data[i][this.schema.fields[j].name]}this._val(this.schema.fields[j],tmp,results,results.length-1)}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingArrays+e.message)}return out},_getDataBySearchField:function(data){var searchPath,i,token,root;if(!this.isEmpty(this.schema.searchField)){searchPath=this.schema.searchField.split(/[\[.\]]/);for(i=0;i<searchPath.length;i++){token=searchPath[i];if(token.length===0){continue}token=/^(0|[1-9]\d*)$/.test(token)?parseInt(token,10):token.replace(/^('|")|('|")$/g,"");root=root?root[token]:data[token];if(root===undefined||root===null){break}}if(!root&&$.type(data)==="array"){root=data}}return root},_processMetadata:function(data){if(data.Metadata&&data.Metadata.timezoneOffset!==undefined&&!isNaN(data.Metadata.timezoneOffset)){this._serverOffset=data.Metadata.timezoneOffset;this._parser._serverOffset=this._serverOffset;if(data.Metadata.timezoneOffsets){this._serverOffsets=data.Metadata.timezoneOffsets;this._parser._serverOffsets=data.Metadata.timezoneOffsets}}else{this._parser._serverOffset=0}},_json:function(data){var i,j,root,resKey=this.schema.outputResultsName,out={},results;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{this._processMetadata(data);root=this._getDataBySearchField(data);if(root===undefined||this.isEmpty(this.schema.searchField)){root=data}if(!root.length&&$.type(root)==="object"){root=[root]}if(root&&root.length&&root.length>0){for(i=0;i<root.length;i++){results[i]={};if(this._pk&&this._pk!=="ig_pk"){for(j=0;j<this.schema.fields.length;j++){if(this.schema.fields[j].name===this._pk){break}}if(j<this.schema.fields.length){if(root[i][this._pk]===undefined){throw new Error($.ig.DataSourceLocale.locale.errorSchemaMismatch+this._pk)}this._val(this.schema.fields[j],root[i][this.schema.fields[j].name],results,i,root)}}for(j=0;j<this.schema.fields.length;j++){if(this.schema.fields[j].name!=="ig_pk"&&this.schema.fields[j].name!==this._pk){this._val(this.schema.fields[j],root[i][this.schema.fields[j].name],results,i,root)}}}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingJson+e.message)}return out},_xml:function(data,recursiveSF){var i,j,root,resNode,item,resKey=this.schema.outputResultsName,out={},results,namespaced,sf,k,r,rc,len1,len2,o,carrysf,ireal=0,s;o=window.ActiveXObject;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{if(!this.isEmpty(this.schema.searchField)){namespaced=this._xmlHasNamespaces(data);if(!namespaced){if(window.ActiveXObject===undefined){if(!recursiveSF||recursiveSF.length<=0){root=data.evaluate(this.schema.searchField,data,null,XPathResult.ANY_TYPE,null)}else{root=data.evaluate(recursiveSF,data,null,XPathResult.ANY_TYPE,null)}}else{if(!(data instanceof ActiveXObject)){s=(new XMLSerializer).serializeToString(data);data=new window.ActiveXObject("Microsoft.XMLDOM");data.async=false;data.loadXML(s)}root=data.selectNodes(this.schema.searchField)}}else{if(this.schema.searchField.startsWith("//")){sf=this.schema.searchField.substring(2,this.schema.searchField.length)}else{sf=this.schema.searchField}root=this._findXmlRecordsRoot(data,sf)}}else{root=data}if(!namespaced){if(root&&window.ActiveXObject!==undefined){for(i=0;i<root.length;i++){item=root.item(i);results[i]={};for(j=0;j<this.schema.fields.length;j++){resNode=item.selectSingleNode(this.schema.fields[j].xpath);if(resNode){if(resNode.nodeType===1&&this.schema.childDataProperty&&resNode.nodeName===this.schema.childDataProperty){this.schema.searchField=this.schema.childDataProperty;results[i][resNode.nodeName]=this._xml(item)}else{this._val(this.schema.fields[j],resNode.text,results,i)}}else{results[i][this.schema.fields[j].name]=""}}}}else if(root){i=0;item=root.iterateNext();while(item){results[i]={};for(j=0;j<this.schema.fields.length;j++){resNode=data.evaluate(this.schema.fields[j].xpath,item,null,XPathResult.ANY_TYPE,null).iterateNext();if(resNode){if(resNode.nodeType===1&&this.schema.childDataProperty&&(resNode.nodeName===this.schema.childDataProperty||resNode.nodeName===this.schema.seachField)){if(!recursiveSF||recursiveSF.length<=0){carrysf=this.schema.searchField+"["+(i+1)+"]/"+this.schema.childDataProperty}else{carrysf=recursiveSF+"["+(i+1)+"]/"+this.schema.childDataProperty}results[i][this.schema.childDataProperty]=this._xml(data,carrysf)}else{this._val(this.schema.fields[j],resNode.textContent,results,i)}}else{results[i][this.schema.fields[j].name]=""}}i++;item=root.iterateNext()}}}else{len1=root.childNodes.length;ireal=0;for(i=0;i<len1;i++){r=root.childNodes[i];results.push({});for(j=0;j<this.schema.fields.length;j++){len2=r.childNodes.length;for(k=0;k<len2;k++){rc=r.childNodes[k];if(this.schema.fields[j].name===(o===undefined?rc.localName:rc.baseName)){this._val(this.schema.fields[j],o===undefined?rc.textContent:rc.text,results,ireal);break}}}if($.isEmptyObject(results[ireal])){results.pop()}else{ireal++}}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingXml+e.message)}return out},_findXmlRecordsRoot:function(data,field){var i,len,r,o,ret;o=window.ActiveXObject;if((o===undefined?data.localName:data.baseName)===field){ret=data.parentNode}else if(data&&data.childNodes&&data.childNodes.length>0){len=data.childNodes.length;for(i=0;i<len;i++){r=data.childNodes[i];if(r.childNodes&&r.childNodes.length>0){ret=this._findXmlRecordsRoot(r,field)}}}return ret},_xmlHasNamespaces:function(data){var i,ns,r,len,fc;if(data.childNodes&&data.childNodes.length&&data.childNodes.length>0){len=data.childNodes.length;for(i=0;i<len;i++){r=data.childNodes[i];if(!r){return false}ns=r.namespaceURI;if(ns!==""&&ns!==undefined&&ns!==null){return true}}if(r&&r.childNodes&&r.childNodes.length>0){fc=r.childNodes[0];if(!fc){return false}ns=fc.namespaceURI;return ns!==""&&ns!==undefined&&ns!==null}}return false},_table:function(data){var i,j,r,tbody,rows,resKey=this.schema.outputResultsName,out={},results;tbody=$(data).find("tbody")[0];results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{if(tbody&&tbody.nodeName&&tbody.nodeName==="TBODY"){rows=tbody.rows;for(i=0;i<rows.length;i++){r=rows[i];results[i]={};for(j=0;j<this.schema.fields.length;j++){this._val(this.schema.fields[j],r.cells[j].innerHTML,results,i)}}}else{throw new Error($.ig.DataSourceLocale.locale.errorExpectedTbodyParameter)}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingHtmlTable+e.message)}return out},_list:function(data){var parsedData,img,anchor,id,li,ul,self=this,d=$(data),text,i,header,descriptions,counts,jqmNS="data-";if($.mobile&&$.mobile.ns){jqmNS+=$.mobile.ns}parsedData=[];if(d&&(d.is("ul")||d.is("ol"))&&d.children().length>0){d.children("li:not(["+jqmNS+'role="itemTemplate"], ['+jqmNS+'role="detailsTemplate"], ['+jqmNS+'role="dividerTemplate"])').each(function(index){li=$(this);img=li.children("img");parsedData[index]={};if(self.schema.hasOwnProperty("primaryKey")){self._val(self.schema.primaryKey,li.index(),parsedData,index)}if(self.schema.hasOwnProperty("isDivider")){self._val(self.schema.isDivider,li.attr(jqmNS+"role")==="list-divider",parsedData,index)}if(img.length>0&&img.attr("src")){if(self.schema.hasOwnProperty("imageUrl")){self._val(self.schema.imageUrl,img.attr("src"),parsedData,index)}}anchor=li.children("a");if(anchor.length>0){text=anchor.html();if(anchor.attr("href")){if(self.schema.hasOwnProperty("navigateUrl")){self._val(self.schema.navigateUrl,anchor.attr("href"),parsedData,index)}}if(anchor.attr("target")){if(self.schema.hasOwnProperty("target")){self._val(self.schema.target,anchor.attr("target"),parsedData,index)}}if(img.length===0){img=anchor.children("img");if(img.length>0){img.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}if(img.length>0&&img.attr("src")){if(self.schema.hasOwnProperty("imageUrl")){self._val(self.schema.imageUrl,img.attr("src"),parsedData,index)}}}}else{text="";for(i=0;i<li[0].childNodes.length;i++){if(li[0].childNodes[i].nodeType===3&&li[0].childNodes[i].data){text+=$.trim(li[0].childNodes[i].data)}}}if(self.schema.hasOwnProperty("header")){header=li.children("h1, h2, h3, h4, h5, h6");if(header.length===0&&anchor.length>0){header=anchor.children("h1, h2, h3, h4, h5, h6")}if(header.length>0){self._val(self.schema.header,header.text(),parsedData,index);header.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("description")){descriptions=li.children("p, dd");if(descriptions.length===0&&anchor.length>0){descriptions=anchor.children("p, dd")}if(descriptions.length>0){self._val(self.schema.description,descriptions.text(),parsedData,index);descriptions.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("count")){counts=li.children("span.ui-li-count");if(counts.length===0&&anchor.length>0){counts=anchor.children("span.ui-li-count")}if(counts.length>0){self._val(self.schema.count,parseInt(counts.text(),10),parsedData,index);counts.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("text")){self._val(self.schema.text,text,parsedData,index)}id=li.attr("id");if(id){if(self.schema.hasOwnProperty("value")){self._val(self.schema.value,id,parsedData,index)}}ul=li.children("ul, ol");if(ul.length>0){if(self.schema.hasOwnProperty("childData")&&self.schema.childData.hasOwnProperty("name")){parsedData[index][self.schema.childData.name]=self._list(ul)}}})}return parsedData},_select:function(data){var parsedData=[],self=this;$(data).children().each(function(i){var $curOption=$(this);parsedData[i]={};if($curOption.is("optgroup")){parsedData[i].Group={groupName:this.label,groupItems:self._select(this)}}else{self._val(self.schema.fields[0],$curOption.val(),parsedData,i);self._val(self.schema.fields[1],$curOption.text(),parsedData,i)}});return parsedData},isObjEmpty:function(obj){var prop;for(prop in obj){if(obj.hasOwnProperty(prop)){return false}}return true},fields:function(){return this.schema.fields}});$.ig.RemoteDataSource=$.ig.RemoteDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="remoteUrl";this._super(options);return this}});$.ig.JSONDataSource=$.ig.JSONDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="json";this._super(options);return this}});$.ig.RESTDataSource=$.ig.RESTDataSource||$.ig.DataSource.extend({settings:{restSettings:{create:{url:null,template:null,batch:false},update:{url:null,template:null,batch:false},remove:{url:null,template:null,batch:false},encodeRemoveInRequestUri:true,contentSerializer:null,contentType:"application/json; charset=utf-8"}},init:function(options){if(!options){options={}}else{this._defaultTypeOverridden=options.restSettings&&options.restSettings.contentType&&options.restSettings.contentType!==this.settings.restSettings.contentType}options.restSettings=$.extend(true,this.settings.restSettings,options.restSettings);this._createHttpHandlers();this._createLogVerbMapping();this._setLazyUrls();this._super(options);return this},saveChanges:function(success,error){var log,verb,batchOps={POST:[],PUT:[],DELETE:[],CELL:[]},i;this._asyncCallbackCount=0;this._isc=success&&typeof success==="function"?success:null;this._iec=error&&typeof error==="function"?error:null;for(i=0;i<this._accumulatedTransactionLog.length;i++){log=this._accumulatedTransactionLog[i];verb=this._logVerbMap[log.type];if(log.type==="cell"){batchOps.CELL.push(log)}else if(this._isBatch(verb)===true){batchOps[verb].push(log)}else{this._asyncCallbackCount++;this._saveSingleChange(verb,log)}}if(batchOps.CELL.length>0){this._saveAllCellChanges(batchOps.CELL)}if(batchOps.POST.length>0){this._asyncCallbackCount++;this._saveAllCreateChanges(batchOps.POST)}if(batchOps.PUT.length>0){this._asyncCallbackCount++;this._saveAllUpdateChanges(batchOps.PUT)}if(batchOps.DELETE.length>0){this._asyncCallbackCount++;this._saveAllDeleteChanges(batchOps.DELETE)}},_saveSingleChange:function(verb,change){var data,url;data=verb==="POST"||verb==="PUT"?change.row:null;url=this._getProperUrl(verb,false,verb==="DELETE"||verb==="PUT"?change.rowId:undefined);this._call(verb,url,data)},_saveAllCellChanges:function(cellLogs){var i,combined={},rowLogs=[],cl;for(i=0;i<cellLogs.length;i++){cl=cellLogs[i];if(combined[cl.rowId]===undefined){combined[cl.rowId]={};combined[cl.rowId].row=this.findRecordByKey(cl.rowId)}combined[cl.rowId].row[cl.col]=cl.value}$.each(combined,function(key,value){value.rowId=key;rowLogs.push(value)});if(this._isBatch("PUT")===true){this._asyncCallbackCount++;this._saveAllUpdateChanges(rowLogs)}else{for(i=0;i<rowLogs.length;i++){this._asyncCallbackCount++;this._saveSingleChange("PUT",rowLogs[i])}}},_saveAllCreateChanges:function(createLogs){var data=[],i;for(i=0;i<createLogs.length;i++){data.push(createLogs[i].row)}this._call("POST",this._getProperUrl("POST",true),data)},_saveAllUpdateChanges:function(updateLogs){var data=[],urlParams="?",i;for(i=0;i<updateLogs.length;i++){data.push(updateLogs[i].row);urlParams+="index="+updateLogs[i].rowId+(i!==updateLogs.length-1?"&":"")}this._call("PUT",this._getProperUrl("PUT",true)+urlParams,data)},_saveAllDeleteChanges:function(deleteLogs){var urlParams="",i,data=null;if(this.settings.restSettings.encodeRemoveInRequestUri===true){urlParams="?";for(i=0;i<deleteLogs.length;i++){urlParams+="index="+deleteLogs[i].rowId+(i!==deleteLogs.length-1?"&":"")}}else{data=[];for(i=0;i<deleteLogs.length;i++){data.push(deleteLogs[i].rowId)}}this._call("DELETE",this._getProperUrl("DELETE",true)+urlParams,data)},_createHttpHandlers:function(){this._okHandler=$.proxy(this._responseOk,this);this._createdHandler=$.proxy(this._responseCreated,this);this._noContentHandler=$.proxy(this._responseNoContent,this);this._httpHandlers={POST:{201:this._createdHandler},PUT:{200:this._okHandler,201:this._createdHandler,204:this._noContentHandler},DELETE:{200:this._okHandler,204:this._noContentHandler}}},_createLogVerbMapping:function(){this._logVerbMap={newrow:"POST",row:"PUT",deleterow:"DELETE",cell:"PUT"}},_setLazyUrls:function(){var rs=this.settings.restSettings,tempUrl=null,tempTmpl=null;$.each(rs,function(key,value){if(value){if(value.url){tempUrl=value.url}if(value.template){tempTmpl=value.template}}});$.each(rs,function(key,value){if(value){if(value.url!==undefined&&value.url===null){value.url=tempUrl}if(value.template!==undefined&&value.template===null){value.template=tempTmpl}}});this._putUrl=rs.update.url;this._putTmpl=rs.update.template;this._postUrl=rs.create.url;this._postTmpl=rs.create.template;this._deleteUrl=rs.remove.url;this._deleteTmpl=rs.remove.template},_getProperUrl:function(verb,batch,id){var vL=verb.toLowerCase(),url=this["_"+vL+"Url"];if(url&&url.length>0&&url.substr(url.length-1)!=="/"){url+="/"}if(!batch||batch===false){if(this["_"+vL+"Tmpl"]!==null){url=this["_"+vL+"Tmpl"];if(id){url=url.replace("${id}",id)}}else{if(id){url+=id}}}return url},_responseOk:function(data,textStatus,jqXHR){this._asyncCallbackCount--;if(this._asyncCallbackCount===0){this._saveChangesSuccess({Success:textStatus==="success"},textStatus,jqXHR)}},_responseCreated:function(data,textStatus,jqXHR){this._asyncCallbackCount--;if(this._asyncCallbackCount===0){this._saveChangesSuccess({Success:textStatus==="success"},textStatus,jqXHR)}},_responseNoContent:function(data,textStatus,jqXHR){this._asyncCallbackCount--;if(this._asyncCallbackCount===0){this._saveChangesSuccess({Success:textStatus==="success"||textStatus==="nocontent"},textStatus,jqXHR)}},_isBatch:function(verb){switch(verb){case"POST":return this.settings.restSettings.create.batch;case"PUT":return this.settings.restSettings.update.batch;case"DELETE":return this.settings.restSettings.remove.batch;default:return false}},_call:function(verb,url,data){var dataString,ct=this.settings.restSettings.contentType,serializer=this.settings.restSettings.contentSerializer,self=this;if(serializer!==null){if(typeof serializer==="string"){serializer=window[serializer]}}if(data!==null){dataString=serializer!==null?serializer(data):JSON.stringify(data)}else{if(!this._defaultTypeOverridden){ct="text/plain"}dataString=""}this._ajaxRequest=$.ajax({type:verb,url:url,data:dataString,statusCode:this._httpHandlers[verb],contentType:ct,cache:false,success:function(data,textStatus,jqXHR){if(self._isc){self._isc(data,textStatus,jqXHR)}},error:function(jqXHR,textStatus,errorThrown){self._saveChangesError(jqXHR,textStatus,errorThrown);if(self._iec){self._iec(jqXHR,textStatus,errorThrown)}},processData:true})}});$.ig.JSONPDataSource=$.ig.JSONPDataSource||$.ig.DataSource.extend({settings:{jsonp:null,jsonpCallback:null},init:function(options){if(!options){options={}}options.responseDataType="jsonp";this._super(options);return this}});$.ig.XmlDataSource=$.ig.XmlDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="xml";this._super(options);return this}});$.ig.FunctionDataSource=$.ig.FunctionDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="function";this._super(options);return this}});$.ig.HtmlTableDataSource=$.ig.HtmlTableDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="htmlTableDom";this._super(options);return this}});$.ig.ArrayDataSource=$.ig.ArrayDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="array";this._super(options);return this}});$.ig.MashupDataSource=$.ig.MashupDataSource||$.ig.DataSource.extend({mashupSettings:{ignorePartialRecords:false,dataSource:[]},init:function(options){this._super(options);if(options){this.settings=$.extend(true,{},$.ig.DataSource.prototype.settings,options);this.settings=$.extend(true,{},$.ig.MashupDataSource.prototype.mashupSettings,this.settings)}this._sources=[];this._dataBindingComplete=false;this._sourcesStatus=[];this._hashedDataViews=[];return this},_checkDataBindingComplete:function(status,msg,ownerDs){var i,j,k,hasPrimaryKeys=true,hasForeignKeys=false,totalLength=0,data=[],merged=[],d,rindex,keyVal,prop,keyIndexHash,fkeyIndexHash,mergedData;this._dataBindingComplete=true;for(i=0;i<this._sources.length;i++){if(this._sources[i]===ownerDs){this._sourcesStatus[i]=1}if(this._sourcesStatus[i]===0){this._dataBindingComplete=false}}if(this._dataBindingComplete){for(i=0;i<this._sources.length;i++){if(this._sources[i].settings.primaryKey===""||this._sources[i].settings.primaryKey===null||this._sources[i].settings.primaryKey===undefined){hasPrimaryKeys=false;break}}for(i=0;i<this._sources.length;i++){if(this._sources[i].settings.foreignKey!==""&&this._sources[i].settings.foreignKey!==null&&this._sources[i].settings.foreignKey!==undefined){hasForeignKeys=true;break}}totalLength=this._sources[0].dataView().length;for(i=0;i<this._sources.length;i++){totalLength=this.settings.ignorePartialRecords?this._sources[i].dataView().length<totalLength?this._sources[i].dataView().length:totalLength:this._sources[i].dataView().length>totalLength?this._sources[i].dataView().length:totalLength}if(hasPrimaryKeys&&!hasForeignKeys){for(i=0;i<this._sources.length;i++){this._hashedDataViews[i]={};for(j=0;j<this._sources[i].dataView().length;j++){this._hashedDataViews[i][this._sources[i].dataView()[j][this._sources[i].settings.primaryKey]]=this._sources[i].dataView()[j]}}keyIndexHash={};j=0;for(i=0;i<this._hashedDataViews.length;i++){for(keyVal in this._hashedDataViews[i]){if(this._hashedDataViews[i].hasOwnProperty(keyVal)){if(keyIndexHash.hasOwnProperty(keyVal)){data[keyIndexHash[keyVal]]=$.extend(true,{},data[keyIndexHash[keyVal]],this._hashedDataViews[i][keyVal]);merged[keyIndexHash[keyVal]]++}else{data.push({});merged.push(1);data[j]=$.extend(true,{},data[j],this._hashedDataViews[i][keyVal]);keyIndexHash[keyVal]=j;j++}}}}if(this.settings.ignorePartialRecords){for(i=merged.length-1;i>=0;i--){if(merged[i]<this._sources.length){data.splice(i,1)}}}}else if(hasForeignKeys&&hasPrimaryKeys){for(i=0;i<this._sources.length;i++){this._hashedDataViews[i]={};for(j=0;j<this._sources[i].dataView().length;j++){this._hashedDataViews[i][this._sources[i].dataView()[j][this._sources[i].settings.primaryKey]]=this._sources[i].dataView()[j]}}keyIndexHash=[{}];fkeyIndexHash=[{}];for(i=0;i<this._hashedDataViews.length;i++){j=0;for(keyVal in this._hashedDataViews[0]){if(this._hashedDataViews[0].hasOwnProperty(keyVal)){if(!keyIndexHash[i]){keyIndexHash.push({})}if(!keyIndexHash[i].hasOwnProperty(keyVal)){keyIndexHash[i][keyVal]=j;j++;if(this._sources[i+1]&&this._sources[i+1].settings.foreignKey){if(!fkeyIndexHash[i]){fkeyIndexHash.push({})}fkeyIndexHash[i][keyVal]=this._hashedDataViews[0][keyVal][this._sources[i+1].settings.foreignKey]}}}}}mergedData=$.extend(true,{},data,this._hashedDataViews[0]);for(i=0;i<this._hashedDataViews.length;i++){if(!this._sources[i].settings.foreignKey){continue}mergedData=this._mergeSources(this._hashedDataViews[i],this._sources[i].settings.foreignKey,fkeyIndexHash[i-1],mergedData)}j=0;for(var mergedRecKey in mergedData){data[j]=mergedData[mergedRecKey];j++}}else{for(i=0;i<totalLength;i++){data[i]={};for(j=0;j<this._sources.length;j++){d=this._sources[j];if(d.dataView()[0].length){for(k=0;k<d.dataView()[0].length;k++){rindex+=k;if(d.schema()&&d.schema().fields().length>0){data[i][d.schema().fields()[k]]=i>=d.dataView().length?"":d.dataView()[i][d.schema().fields()[k]]}else{data[i][rindex]=i>=d.dataView().length?"":d.dataView()[i][k]}}}else{for(prop in d.dataView()[i]){if(d.dataView()[i].hasOwnProperty(prop)){data[i][prop]=i>=d.dataView().length?"":d.dataView()[i][prop]}}}}rindex=0}}this.settings.dataSource=data;this.settings.type="array";this._runtimeType=this.analyzeDataSource();this.dataBind()}},_mergeSources:function(dataView,fKey,fkeyIndex,data){var newObject={},fkValueCollection;for(var recID in data){if(Array.isArray(data[recID][fKey])){newObject={};fkValueCollection=data[recID][fKey];for(var fk in fkValueCollection){var currValue=dataView[fkValueCollection[fk]];for(var variable in currValue){if(variable!==fKey){if(newObject.hasOwnProperty(variable)){newObject[variable].push(currValue[variable])}else{newObject[variable]=[currValue[variable]]}}}}data[recID]=$.extend(true,{},data[recID],newObject)}else{data[recID]=$.extend(true,{},data[recID],dataView[fkeyIndex[recID]])}}return data},setCellValue:function(rowId,colId,val,autoCommit){var rowObject=this.findRecordByKey(rowId,this._data),t,rec,self=this,newObject,lookupRecord;
$(this._sources).each(function(){if(this.settings.foreignKey&&this.settings.foreignKey===colId){if(Array.isArray(val)){newObject={};for(var value in val){lookupRecord=this.dataSource()[val[value]];for(var variable in lookupRecord){if(variable!==this.settings.foreignKey){if(newObject.hasOwnProperty(variable)){newObject[variable].push(lookupRecord[variable])}else{newObject[variable]=[lookupRecord[variable]]}}else{newObject[variable]=val}}}rowObject=$.extend(true,{},rowObject,newObject)}else if(this.settings.foreignKey!==colId){rowObject=$.extend(true,{},rowObject,this.dataSource()[val])}if(this.settings.primaryKey===null){rec=self._data[parseInt(rowId,10)]}else{rec=self.findRecordByKey(rowId,self._data)}for(var prop in rec){rec[prop]=rowObject[prop]}}});t=this._createCellTransaction(rowId,colId,val);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}return t},updateRow:function(rowId,rowObject,autoCommit){var t,newObject,lookupRecord,oldRow=this.settings.primaryKey===null?this._data[parseInt(rowId,10)]:this.findRecordByKey(rowId),rowIndex=this.settings.primaryKey===null?rowId:$.ig.indexInArray(this._data,oldRow);$(this._sources).each(function(){if(this.settings.foreignKey){if(Array.isArray(rowObject[this.settings.foreignKey])){newObject={};for(var value in rowObject[this.settings.foreignKey]){lookupRecord=this.dataSource()[rowObject[this.settings.foreignKey][value]];for(var variable in lookupRecord){if(variable!==this.settings.foreignKey){if(newObject.hasOwnProperty(variable)){newObject[variable].push(lookupRecord[variable])}else{newObject[variable]=[lookupRecord[variable]]}}}}rowObject=$.extend(true,{},rowObject,newObject)}else if(rowObject[this.settings.foreignKey]!==oldRow[this.settings.foreignKey]){rowObject=$.extend(true,{},rowObject,this.dataSource()[rowObject[this.settings.foreignKey]])}}});t=this._createRowTransaction(rowId,rowObject);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowUpdated)==="function"){if(this.settings.callee){this.settings.rowUpdated.apply(this.settings.callee,[{rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this])}else{this.settings.rowUpdated({rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this)}}return t},addRow:function(rowId,rowObject,autoCommit){var t,newObject,lookupRecord;$(this._sources).each(function(){if(this.settings.foreignKey){if(Array.isArray(rowObject[this.settings.foreignKey])){newObject={};for(var value in rowObject[this.settings.foreignKey]){lookupRecord=this.dataSource()[rowObject[this.settings.foreignKey][value]];for(var variable in lookupRecord){if(variable!==this.settings.foreignKey){if(newObject.hasOwnProperty(variable)){newObject[variable].push(lookupRecord[variable])}else{newObject[variable]=[lookupRecord[variable]]}}}}rowObject=$.extend(true,{},rowObject,newObject)}else{rowObject=$.extend(true,{},rowObject,this.dataSource()[rowObject[this.settings.foreignKey]])}}});t=this._createNewRowTransaction(rowId,rowObject);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowAdded)==="function"){if(this.settings.callee){this.settings.rowAdded.apply(this.settings.callee,[{rowId:rowId,row:rowObject},this])}else{this.settings.rowAdded({rowId:rowId,row:rowObject},this)}}return t},insertRow:function(rowId,rowObject,rowIndex,autoCommit,parentRowId){var t,newObject,lookupRecord,oldRow;$(this._sources).each(function(){if(this.settings.foreignKey){if(Array.isArray(rowObject[this.settings.foreignKey])){newObject={};for(var value in rowObject[this.settings.foreignKey]){lookupRecord=this.dataSource()[rowObject[this.settings.foreignKey][value]];for(var variable in lookupRecord){if(variable!==this.settings.foreignKey){if(newObject.hasOwnProperty(variable)){newObject[variable].push(lookupRecord[variable])}else{newObject[variable]=[lookupRecord[variable]]}}}}rowObject=$.extend(true,{},rowObject,newObject)}else if(rowObject[this.settings.foreignKey]!==oldRow[this.settings.foreignKey]){rowObject=$.extend(true,{},rowObject,this.dataSource()[rowObject[this.settings.foreignKey]])}}});t=this._createInsertRowTransaction(rowId,rowObject,rowIndex);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowInserted)==="function"){if(this.settings.callee){this.settings.rowInserted.apply(this.settings.callee,[{rowId:rowId,row:rowObject,rowIndex:rowIndex},this])}else{this.settings.rowInserted({rowId:rowId,row:rowObject,rowIndex:rowIndex},this)}}return t},dataBind:function(){var i,ds=this.settings.dataSource;if(this._dataBindingComplete||this._sources.length>0){this._dataBindingComplete=false;this._super()}else{this._dataBindingComplete=false;for(i=0;i<ds.length;i++){if(ds[i]instanceof $.ig.DataSource){this._sources[i]=ds[i]}else if(ds[i].hasOwnProperty("dataSource")&&ds[i].dataSource instanceof $.ig.DataSource){this._sources[i]=ds[i].dataSource}else{this._sources[i]=new $.ig.DataSource(ds[i])}this._sources[i].settings.callee=this;this._sources[i].settings.callback=this._checkDataBindingComplete;this._sourcesStatus[i]=0}for(i=0;i<ds.length;i++){this._sources[i].dataBind()}}return this}});$.ig.HierarchicalDataSource=$.ig.HierarchicalDataSource||Class.extend({settings:{autogenerate:false,initialDataBindDepth:0,maxDataBindDepth:-1,defaultChildrenDataProperty:"children",callback:null,callee:null,data:[],dataSource:null,dataBinding:null,dataBound:null,type:"unknown",responseDataType:null,responseContentType:null,localSchemaTransform:true,urlParamsEncoding:null,urlParamsEncoded:null,requestType:"GET",odata:false,paging:{},sorting:{},filtering:{},schema:[]},init:function(options){if(options){this.__ds=options.dataSource;options.dataSource=null;this.settings=$.extend(true,{},$.ig.HierarchicalDataSource.prototype.settings,options);this.settings.dataSource=this.__ds}this._rootopts=this.settings;this._rootopts.urlParamsEncoded=$.proxy(this._encodeHierarchicalUrlParams,this);if(this._rootopts.dataSource&&typeof this._rootopts.dataSource._xmlToArray==="function"&&typeof this._rootopts.dataSource._encodePkParams==="function"){this._rootds=this._rootopts.dataSource;this._rootds.settings.urlParamsEncoded=this.settings.urlParamsEncoded;this._rootds.settings.odata=this.settings.odata;if(!this._rootds.settings.schema){this._rootds.settings.schema={}}this._rootds.settings.schema.layouts=this.settings.schema.layouts}else{if($.type(this._rootopts.dataSource)==="string"&&this._rootopts.dataSource.indexOf("$callback=?")!==-1){this._rootds=new $.ig.JSONPDataSource(this._rootopts)}else if(this._rootopts.restSettings&&(this._rootopts.restSettings.update.url!==null||this._rootopts.restSettings.update.template!==null||this._rootopts.restSettings.create.url!==null||this._rootopts.restSettings.create.template!==null||this._rootopts.restSettings.remove.url!==null||this._rootopts.restSettings.remove.template!==null)){this._rootds=new $.ig.RESTDataSource(this._rootopts)}else{this._rootds=new $.ig.DataSource(this._rootopts)}}},dataBind:function(callback,callee){this._rootds.dataBind(callback,callee)},root:function(){if(!this._rootds){this._rootds=new $.ig.DataSource(this._rootopts)}return this._rootds},dataAt:function(path,keyspath){var data=this.root().data(),paths=path.split("/"),kp=keyspath.split("/"),k,i,searchField="Records",j,cd=null,ckey=this.settings.primaryKey,ckeyval="",ckeys=[],ckeyvals=[],match=false;for(i=0;i<paths.length;i++){ckey=paths[i].split(":")[0];ckeyval=paths[i].split(":")[1];if(paths[i]!==""){for(j=0;data&&j<data.length;j++){if(ckey&&ckey.indexOf(",")!==-1){ckeys=ckey.split(",");ckeyvals=ckeyval.split(",");for(k=0;k<ckeys.length;k++){if(!data[j][ckeys[k]].charAt&&ckeyvals[k].charAt){ckeyvals[k]=parseInt(ckeyvals[k],10)}match=data[j][ckeys[k]]===ckeyvals[k];if(!match){break}}}else{if(data[j][ckey]!==undefined&&!data[j][ckey].charAt&&ckeyval.charAt){ckeyval=parseInt(ckeyval,10)}match=data[j][ckey]===ckeyval}if(match){cd=data[j][kp[i]];searchField=this.root().schema&&this.root().schema()&&this.root().schema().schema?this.root().schema().schema.searchField:searchField;if(cd&&paths.length>1&&i<paths.length-1&&$.type(cd)!=="array"&&cd[searchField]){cd=cd[searchField]}break}}data=cd}}return cd},_encodeUrlPath:function(rowid,name){return"path="+rowid+"&layout="+name},_encodeHierarchicalUrlParams:function(owner,args){var expand="",layouts=this.settings.schema.layouts,i,j,tmp,name,lc=0;if(this.settings.odata&&this.settings.initialDataBindDepth!==0){i=j=0;for(name in layouts){if(layouts.hasOwnProperty(name)){lc++}}lc++;for(name in layouts){if(layouts.hasOwnProperty(name)){if($.type(layouts[name])!=="function"){if(name.startsWith("/")){name=name.substring(1,name.length-1)}tmp=name.split("/");for(i=0;i<tmp.length;i++){tmp[i]=tmp[i].substring(0,tmp[i].indexOf(":"))}tmp=tmp.join("/");if(j!==0&&j!==lc-1){expand+=","}expand+=tmp;j++}}}args.selectParams.$expand=expand}else{args.selectParams.dbdepth=this.settings.initialDataBindDepth}}});$.ig.TreeHierarchicalDataSource=$.ig.TreeHierarchicalDataSource||$.ig.DataSource.extend({settings:{treeDS:{childDataKey:null,foreignKey:null,initialExpandDepth:-1,enableRemoteLoadOnDemand:false,dataSourceUrl:null,requestDataCallback:null,requestDataSuccessCallback:null,requestDataErrorCallback:null,propertyExpanded:"__ig_options.expanded",propertyDataLevel:"__ig_options.dataLevel",initialFlatDataView:false,customEncodeUrlFunc:null,persistExpansionStates:false,filtering:{fromLevel:0,toLevel:-1,displayMode:"showWithAncestors",matchFiltering:"__matchFiltering"},sorting:{fromLevel:0,toLevel:-1},paging:{mode:"rootLevelOnly",contextRowMode:"none"}}},_isHierarchicalDataSource:true,init:function(options){if(!options){options={}}this._totalRecordsCount=0;options.treeDS=$.extend(true,{},this.settings.treeDS,options.treeDS);this._flatVisibleData=[];this._super(options);this._isHierarchicalDataSource=options.treeDS.foreignKey===null?true:false;return this},_checkGeneratedSchema:function(){var s=this.settings.treeDS,fs=this.settings.filtering,propertyExp=s.propertyExpanded,propertyMatchFiltering=s.filtering.matchFiltering;this._checkGeneratedSchemaByKey(s.childDataKey);if(!this._isHierarchicalDataSource){this._checkGeneratedSchemaByKey(s.foreignKey)}if(propertyExp!==null&&propertyExp!==undefined){this._addSchemaField(propertyExp,"boolean")}if(fs&&fs.enabled&&fs.type==="remote"&&propertyMatchFiltering){this._addSchemaField(propertyMatchFiltering,"boolean")}if(s.initialFlatDataView&&s.propertyDataLevel){this._addSchemaField(s.propertyDataLevel,"number")}},_addSchemaField:function(propName,propType){if(!this.schema()||!this.schema().schema){return}var i,schema=this.schema().schema,fields=schema.fields;if($.type(fields)!=="array"){return}for(i=0;i<fields.length;i++){if(fields[i].name===propName){return}}schema.fields.push({name:propName,type:propType})},_checkGeneratedSchemaByKey:function(key){if(key===null||key===undefined){return}var schema=this.schema(),i,fields=schema.fields(),fL=fields.length;for(i=0;i<fL;i++){if(fields[i].name===key){if(fields[i].name===this.settings.treeDS.childDataKey&&fields[i].type){delete fields[i].type}break}}if(i===fL){fields.push({name:key})}},dataBind:function(callback,callee){this._totalRecordsCount=0;this._dataBinding=true;this._isHierarchicalDataSource=this.settings.treeDS.foreignKey===null?true:false;var s=this.schema();this.isTransformedToHierarchicalData(false);if(s){this._checkGeneratedSchema();if(!this._transformCallback){this._transformCallback=$.proxy(s.transform,s);s.transform=$.proxy(this._transformSchema,this)}}this._flatDataView=[];this._generatedFlatData=false;this._dataBoundDepth=null;this._super(callback,callee)},getParentRowsForRow:function(dataRow,ds){var key,data=ds||this._data,search,propL,i,res,objPath={},rec,prows;if(dataRow===undefined||dataRow===null){return[]}if($.type(dataRow)==="object"){search=data&&$.isArray(data[0])?this._lookupPkIndex():this.settings.primaryKey;key=dataRow[search];if(key===undefined||key===null){return[]}}else{key=dataRow}if(this._metadata&&$.type(this._metadata.ancestors)==="array"){prows=this._metadata.ancestors;propL=this.settings.treeDS.propertyDataLevel;res=[];for(i=0;i<prows.length;i++){res.push({row:this.schema()._row(prows[i]),level:prows[i][propL]})}return res}rec=this.findRecordByKey(key,data,objPath);if(!rec){return[]}return objPath.parentRows},_internalDataBound:function(callDatabound){this._dataBinding=false;this._super(callDatabound)},_completeCallback:function(){this.generateFlatDataView();this._super()},getDataBoundDepth:function(){if(this._dataBoundDepth===null||this._dataBoundDepth===undefined){this._dataBoundDepth=0;this._getDataBoundDepthRecursive()}return this._dataBoundDepth},_getDataBoundDepthRecursive:function(data,level){var i,layoutKey=this.settings.treeDS.childDataKey,dataLen,dataRow;if(!this._dataBoundDepth){this._dataBoundDepth=0}if(!level){level=0}if(data===undefined){data=this.data()}if(level>this._dataBoundDepth){this._dataBoundDepth=level}if($.type(data)==="array"){dataLen=data.length;for(i=0;i<dataLen;i++){dataRow=data[i];if(!dataRow){continue}if(dataRow&&$.type(dataRow[layoutKey])==="array"&&dataRow[layoutKey].length){this._getDataBoundDepthRecursive(dataRow[layoutKey],level+1)}}}},_processJsonResponse:function(data,context){this.schema()._processMetadata(data);if(data&&data.Metadata&&data.Metadata.initialFlatDataView!==undefined){this.settings.treeDS.initialFlatDataView=data.Metadata.initialFlatDataView;this._checkGeneratedSchema()}return this._super(data,context)},isTransformedToHierarchicalData:function(isTransformed){if(isTransformed===undefined||isTransformed===null){return this._transformedHierarchicaData}this._transformedHierarchicaData=isTransformed},transformToHierarchicalData:function(data){if($.type(data)!=="array"){return data}var i,rowData,nData,parents=[],children=[],dataLen=data.length;for(i=0;i<dataLen;i++){rowData=$.extend(true,{},data[i]);if(this._hasRecordParent(rowData,data)){children.push(rowData)}else{parents.push(rowData)}}nData=this._getDataLayouts(parents,children);this.isTransformedToHierarchicalData(true);return nData},_getDataLayouts:function(parents,children){var i,pLen=parents.length,key=this.settings.treeDS.key,layoutKey=this.settings.treeDS.childDataKey,res=[],parent,cp;for(i=0;i<pLen;i++){parent=parents[i];cp=this._getChildrenByKeyInFlatDS(parents[i][key],children);children=cp.others;if(cp.children.length>0){parent[layoutKey]=this._getDataLayouts(cp.children,children)}res.push(parent)}return res},_getChildrenByKeyInFlatDS:function(foreignKey,data){var i,dr,len=data.length,fKey=this.settings.treeDS.foreignKey,others=[],children=[];for(i=0;i<len;i++){dr=data[i];if(dr[fKey]===foreignKey){children.push(dr)}else{others.push(dr)}}return{children:children,others:others}},_hasRecordParent:function(dataRecord,ds){var i,dataRecordKey,dataRecordPKey,dsRowKey,dsLen,s=this.settings.treeDS,rlv=s.foreignKeyRootValue,foreignKey=s.foreignKey,key=s.key;dataRecordPKey=dataRecord[foreignKey];if(dataRecordPKey===null||dataRecordPKey===undefined){return false}if(rlv===false){dataRecordKey=dataRecord[key];if(dataRecordKey===null||dataRecordKey===undefined){return false}dsLen=ds.length;for(i=0;i<dsLen;i++){dsRowKey=ds[i][key];if(dsRowKey!==dataRecordKey&&dsRowKey===dataRecordPKey){return true}}return false}return dataRecordPKey!==rlv},_transformSchema:function(data){if(this.settings.treeDS.initialFlatDataView){return this._transformCallback(data)}return this.processDataPerLevel(data,0)},processDataPerLevel:function(data,level,suppressTransformation){var i,layoutKey=this.settings.treeDS.childDataKey,dataLen,dataRow,isRootLevel=false,expDepth=this.settings.treeDS.initialExpandDepth,exp,nData=[],s=this.schema(),layout,hasChildren,lLen,propertyExp=this.settings.treeDS.propertyExpanded,propertyDataLevel=this.settings.treeDS.propertyDataLevel,applyPropertyDataLevel=propertyDataLevel!==null&&propertyDataLevel!==undefined,applyPropertyExp=propertyExp!==null&&propertyExp!==undefined;if(!data){data=this.data()}if($.type(data)==="object"){data=s._getDataBySearchField(data)}if(!level){if(!this._isHierarchicalDataSource&&!this.isTransformedToHierarchicalData()){if(this.metadata("flatToHierarchicalDataTransformed")){this.isTransformedToHierarchicalData(true)}else{data=this.transformToHierarchicalData(data)}}this._totalRecordsCount=0;this._flatData=[];isRootLevel=true;level=0}if(!data||!this.settings.localSchemaTransform){return data}if($.type(data)==="array"){if(!this._dataBoundDepth){this._dataBoundDepth=0}if(level>this._dataBoundDepth){this._dataBoundDepth=level}dataLen=data.length;try{for(i=0;i<dataLen;i++){dataRow=data[i];if(!dataRow){continue}this._totalRecordsCount++;layout=dataRow[layoutKey];exp=dataRow[propertyExp];if(!suppressTransformation){dataRow=s._row(dataRow,i)}this._flatData.push(dataRow);nData.push(dataRow);hasChildren=$.type(layout)==="array";lLen=-1;if(hasChildren){lLen=layout.length}if(applyPropertyExp){if(exp===undefined||exp===null){exp=true;if(hasChildren&&lLen===0){exp=false}if(expDepth!==-1&&expDepth<=level){exp=false}}if(exp===0){exp=false}dataRow[propertyExp]=exp}if(applyPropertyDataLevel){dataRow[propertyDataLevel]=level}if(hasChildren&&lLen>0){dataRow[layoutKey]=this.processDataPerLevel(layout,level+1,suppressTransformation)}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingArrays+e.message)}}else{nData=this._transformCallback(data)}if(isRootLevel){this._generatedFlatData=true}return nData},getFlatDataForRecord:function(record,level){if(!record){return}var layoutKey=this.settings.treeDS.childDataKey,propertyDataLevel=this.settings.treeDS.propertyDataLevel,data=record[layoutKey];if(data){if(level===undefined||level===null){level=0;if(propertyDataLevel!==null&&propertyDataLevel!==undefined&&record[propertyDataLevel]){level=record[propertyDataLevel]}}return this.generateFlatData(data,level)}},generateFlatData:function(data,level){var obj,flatData=[],flatVisibleData=[];if(!level){level=0}obj={flatData:flatData,flatVisibleData:flatVisibleData,recordsCount:0,visibleRecordsCount:0};this._generateFlatDataRecursive(data,level,obj,false);return obj},_generateFlatDataRecursive:function(data,level,obj,parentCollapsed){var i,dataRow,dataLen,exp,expDepth=this.settings.treeDS.initialExpandDepth,propertyExp=this.settings.treeDS.propertyExpanded,propertyDataLevel=this.settings.treeDS.propertyDataLevel,layoutKey=this.settings.treeDS.childDataKey,applyPropertyDataLevel=propertyDataLevel!==null&&propertyDataLevel!==undefined,applyPropertyExp=propertyExp!==null&&propertyExp!==undefined;if(!data){data=this.data()}if(!level){level=0}if($.type(data)==="array"){dataLen=data.length;for(i=0;i<dataLen;i++){dataRow=data[i];if(!dataRow){continue}obj.recordsCount++;obj.flatData.push(data[i]);if(applyPropertyExp){exp=dataRow[propertyExp];if(exp===undefined||exp===null){exp=true;if(expDepth!==-1&&expDepth<=level){exp=false}}if(exp===0){exp=false}dataRow[propertyExp]=exp}if(applyPropertyDataLevel){dataRow[propertyDataLevel]=level}if(!parentCollapsed){obj.flatVisibleData.push(dataRow);obj.visibleRecordsCount++}if(dataRow&&$.type(dataRow[layoutKey])==="array"&&dataRow[layoutKey].length){this._generateFlatDataRecursive(dataRow[layoutKey],level+1,obj,!exp||parentCollapsed)}}}},generateFlatDataView:function(){if(this.settings.treeDS.initialFlatDataView){this._flatDataView=this._data;return}var resObj=this.generateFlatData(this.dataView());this._flatDataView=resObj.flatVisibleData},flatDataView:function(){if(this.settings.treeDS.initialFlatDataView){return this._data}return this._flatDataView},_generateFlatDataAndCountProperties:function(){var resObj;if(!this._filter){resObj=this.generateFlatData(this.data())}else{resObj=this.generateFlatData(this._filteredData)}this._flatData=resObj.flatData;this._totalRecordsCount=resObj.recordsCount;this._recCount=resObj.visibleRecordsCount;this._flatVisibleData=resObj.flatVisibleData},getVisibleFlatData:function(){if(!this._flatVisibleData){this._generateFlatDataAndCountProperties()}return this._flatVisibleData},getFlatData:function(){if(!this._flatData||this._flatData.length!==this._totalRecordsCount){this._generateFlatDataAndCountProperties()}return this._flatData},getFlatDataCount:function(){return this._totalRecordsCount},_page:function(keepRecords){if(this.settings.treeDS.paging.mode==="rootLevelOnly"){return this._super(keepRecords)}var count=0,startIndex,endIndex,i=0;if(keepRecords===undefined){keepRecords=false}if(keepRecords){count=this._flatVisibleData.length}else{this._flatDataView=[]}this._generateFlatDataAndCountProperties();startIndex=this.pageIndex()*this.pageSize();endIndex=startIndex+this.pageSize()>=this._flatVisibleData.length?this._flatVisibleData.length:startIndex+this.pageSize();for(i=startIndex;i<endIndex;i++){this._flatDataView[count++]=this._flatVisibleData[i]}},setExpandedStateByRowIndex:function(index,expanded,callbackArgs){var rec=this.flatDataView()[index];return this._expandCollapseRecord(rec,expanded,callbackArgs)},setExpandedStateByPrimaryKey:function(rowId,expanded,callbackArgs){var rec=this.findRecordByKey(rowId,null);return this._expandCollapseRecord(rec,expanded,callbackArgs)},getExpandStateById:function(rowId){var rec=this.findRecordByKey(rowId),propertyExp=this.settings.treeDS.propertyExpanded,applyPropertyExp=propertyExp!==null&&propertyExp!==undefined;if(!rec||!applyPropertyExp){return}return rec[propertyExp]},toggleRow:function(rowId,callbackArgs){var rec=this.findRecordByKey(rowId),expanded,propertyExp=this.settings.treeDS.propertyExpanded,applyPropertyExp=propertyExp!==null&&propertyExp!==undefined;if(!rec||!applyPropertyExp){return}expanded=!rec[propertyExp];return this._expandCollapseRecord(rec,expanded,callbackArgs)},_encodeUrlPath:function(path,depth){var p="path="+path;if(depth!==undefined){p+="&depth="+depth}return p},_requestDataSuccess:function(requestArgs,data){var layoutKey=this.settings.treeDS.childDataKey,layoutData,level,record,callbackArgs,expand;if($.type(data)==="object"){record=requestArgs.record;callbackArgs=requestArgs.callbackArgs;expand=requestArgs.expand;level=record[this.settings.treeDS.propertyDataLevel];layoutData=this.processDataPerLevel(data,level+1);record[layoutKey]=layoutData;this._onRecordToggled(record,expand,callbackArgs)}},_encodeUrl:function(){var params=this._super(),s=this.settings.treeDS;if(s.persistExpansionStates){params=this._encodeExpansionStates(params)}if(s.foreignKey){params.fk=s.foreignKey;if(s.foreignKeyRootValue!==undefined){params.fkRootValue=s.foreignKeyRootValue}}params.propertyDataLevel=s.propertyDataLevel;params.propertyExpanded=s.propertyExpanded;params.childDataKey=s.childDataKey;params.initialExpandDepth=s.initialExpandDepth;if(s.enableRemoteLoadOnDemand){params.loadOnDemand=true}return params},_encodePagingParams:function(params){var p=this.settings.paging;this._super(params);if(p.enabled&&p.type==="remote"){params.pagingParams["paging.mode"]=this.settings.treeDS.paging.mode;params.pagingParams["paging.contextRowMode"]=this.settings.treeDS.paging.contextRowMode}},_encodeSortingParams:function(params){var s=this.settings.sorting;this._super(params);if(s.enabled&&s.type==="remote"){params.sortingParams["sorting.fromLevel"]=this.settings.treeDS.sorting.fromLevel;params.sortingParams["sorting.toLevel"]=this.settings.treeDS.sorting.toLevel}},_encodeFilteringParams:function(params){var f=this.settings.filtering;this._super(params);if(f.enabled&&f.type==="remote"){params.filteringParams["filtering.fromLevel"]=this.settings.treeDS.filtering.fromLevel;params.filteringParams["filtering.toLevel"]=this.settings.treeDS.filtering.toLevel;params.filteringParams.__matchFiltering=this.settings.treeDS.filtering.matchFiltering;params.filteringParams["filtering.displayMode"]=this.settings.treeDS.filtering.displayMode}},_encodeExpansionStates:function(params){var key,listHasValues=false,list=this._listExpansionStates,newList;if(list){newList={};for(key in list){if(list.hasOwnProperty(key)){listHasValues=true;newList[key]=list[key].state}}if(listHasValues){params.listExpansionStates=newList}}return params},_requestData:function(record,expand,callbackArgs){if(!record){return}var opts,me=this,url,path,params,func,s=this.settings.treeDS,args={record:record,callbackArgs:callbackArgs,expand:expand};path=this.getPathBy(record);params=this._encodeUrl();params.expand=expand;url=s.dataSourceUrl+"?"+this._encodeUrlPath(path,record[s.propertyDataLevel]);func=s.customEncodeUrlFunc;if(func){if($.type(func)!=="function"){if(window[func]&&typeof window[func]==="function"){func=window[func]}else{func=null}}if(func){url=func(record,expand)}}opts={type:"GET",url:url,data:params,success:function(data,textStatus,jqXHR){var func=s.requestDataErrorCallback,noCancel=true;if($.type(func)==="function"){noCancel=func(args,data,textStatus,jqXHR)}if(noCancel){me._requestDataSuccess(args,data,textStatus,jqXHR)}},error:function(jqXHR,textStatus,errorThrown){var func=s.requestDataErrorCallback;if($.type(func)==="function"){func(args,jqXHR,textStatus,errorThrown)}}};$.ajax(opts)},_applyToggleCallback:function(resObj,callbackArgs){if(!callbackArgs){return}var rec=resObj.record,res=resObj.result,expand=resObj.expand,callback=callbackArgs.callback,args=callbackArgs.args;if(!callback||$.type(callback)!=="function"){return}callback(rec,expand,res,args)},_saveExpansionStateByPKVal:function(pkVal,expand){if(this.settings.treeDS.persistExpansionStates){if(!this._listExpansionStates){this._listExpansionStates={}}if(pkVal!==null&&pkVal!==undefined){if(this._listExpansionStates[pkVal]&&this._listExpansionStates[pkVal].initState===expand){delete this._listExpansionStates[pkVal]}else{this._listExpansionStates[pkVal]={state:expand,initState:!expand}}}}},_onRecordToggled:function(record,expand,callbackArgs){var propertyExp=this.settings.treeDS.propertyExpanded,filteredRecord=null,res=record,resObj,paging=this.settings.paging,pkVal,applyPropertyExp=propertyExp!==null&&propertyExp!==undefined;resObj={result:false,record:res,expand:expand};if(!record){this._applyToggleCallback(resObj,callbackArgs);return}pkVal=record[this.settings.primaryKey];if(this._filter){if(pkVal!==null&&pkVal!==undefined){filteredRecord=this.findRecordByKey(pkVal,this._filteredData);if(filteredRecord){res=filteredRecord}}}if(applyPropertyExp){record[propertyExp]=expand;if(filteredRecord){filteredRecord[propertyExp]=expand}if(this.settings.treeDS.persistExpansionStates&&!this.settings.treeDS.enableRemoteLoadOnDemand){this.dataBind()}else{if(paging&&paging.enabled&&this.settings.treeDS.paging.mode!=="rootLevelOnly"){if(paging.type==="local"){this._page();this._invokeCallback()}}else{if(this.shouldCallGenerateFlatDataView()){this.generateFlatDataView()}}}}resObj.result=true;resObj.record=res;this._applyToggleCallback(resObj,callbackArgs)},_expandCollapseRecord:function(record,expand,callbackArgs){if(!record){return}var s=this.settings,treeSettings=s.treeDS,func,layout,layoutKey=treeSettings.childDataKey;this._saveExpansionStateByPKVal(record[this.settings.primaryKey],expand);if(s.paging.enabled&&s.paging.type==="remote"&&treeSettings.paging.mode==="allLevels"){this.dataBind();return}if(expand&&treeSettings.enableRemoteLoadOnDemand){layout=record[layoutKey];if(layout===true||$.type(layout)==="array"&&!layout.length){func=treeSettings.requestDataCallback;if($.type(func)==="string"){func=window[func]}if($.type(func)!=="function"){func=$.proxy(this._requestData,this)}func(record,expand,callbackArgs);return}}this._onRecordToggled(record,expand,callbackArgs)},sort:function(fields,direction){var s=this.settings.sorting,p=this.settings.paging,data,resetPaging=false;if(fields===undefined||fields===null){throw new Error($.ig.DataSourceLocale.locale.noSortingFields)}this._generatedFlatData=false;if(s.applyToAllData&&s.type==="local"){if(this._filter&&(p.type==="local"&&p.enabled===true||p.enabled===false||p.type==="remote"&&p.enabled===true&&this.settings.filtering.type==="local")){data=this._filteredData}else{data=this.data()}resetPaging=true}else{data=this.dataView()}data=this.sortDataRecursive(data,0,fields,direction);if(resetPaging&&p.type==="local"){if(!this._filter){this._data=data}else{this._filteredData=data}this._page()}else{this._dataView=data}if(this.shouldCallGenerateFlatDataView()){this.generateFlatDataView()}this._populateTransformedData(data);return this},sortDataRecursive:function(data,level,fields,direction){var layoutKey=this.settings.treeDS.childDataKey,i,childDS,dataLen=data.length,s=this.settings.treeDS.sorting;if(s.toLevel===-1||s.toLevel>=level){for(i=0;i<dataLen;i++){childDS=data[i][layoutKey];if(childDS&&childDS.length>0){childDS=this.sortDataRecursive(childDS,level+1,fields,direction)}}}if((s.fromLevel<=level||s.fromLevel===-1)&&(s.toLevel>=level||s.toLevel===-1)){data=this.sortData(data,fields,direction)}return data},sortData:function(data,fields,direction){var s=this.settings.sorting,schema,sortF,convertFunc,settings=this.settings,self=this;if($.type(s.customFunc)==="function"){data=s.customFunc(data,fields,direction)}else{schema=this.settings.schema;if(!direction){direction=""}if($.type(s.compareFunc)==="function"){sortF=s.compareFunc}else{sortF=function(grid,fields,schema,reverse,convertf,caseSensitive){reverse=reverse?-1:1;function compareVals(format,enableUTCDates,rowTemplate,x,y){if(format){if($.type(x)==="date"&&$.type(y)==="date"){if(format==="time"||format==="timeLong"||format==="h:mm:ss tt"){x=new Date("January 01, 2000 "+$.ig.formatter(x,"date",format,rowTemplate,enableUTCDates));y=new Date("January 01, 2000 "+$.ig.formatter(y,"date",format,rowTemplate,enableUTCDates))}}}if((x===null||x===undefined)&&(y===null||y===undefined)){return 0}if((x===null||x===undefined)&&y!==null&&y!==undefined){return-1}if(x!==null&&x!==undefined&&(y===null||y===undefined)){return 1}return x>y?1:x<y?-1:0}return function(obj1,obj2){var i,f,arr1=[],arr2=[],a,b,key,col,format,o,enableUTCDates,rowTemplate;if(grid){o=grid.options;enableUTCDates=o.enableUTCDates;rowTemplate=!o.rowTemplate||o.rowTemplate.length<=0}for(i=0;i<fields.length;i++){key=fields[i].fieldName;if(grid&&grid.columnByKey){col=grid.columnByKey(key);if(col!==undefined&&col!==null){format=col.format}}if(fields[i].layout&&(settings.key&&settings.key!==fields[i].layout||!settings.key)){continue}f=fields[i];if(f.fieldIndex>=0){f.fieldName=f.fieldIndex}a=self.getCellValue(f.fieldName,obj1);b=self.getCellValue(f.fieldName,obj2);if(convertf!==undefined){a=convertf(a,f.fieldName);b=convertf(b,f.fieldName)}if(caseSensitive===false){if(a!==undefined&&a!==null&&a.toLowerCase){a=a.toLowerCase()}if(b!==undefined&&b!==null&&b.toLowerCase){b=b.toLowerCase()}}if(f.dir!==undefined&&f.dir!==null){reverse=f.dir.toLowerCase().startsWith("desc");reverse=reverse?-1:1}else if(direction!==undefined&&direction!==null&&direction!==""){reverse=direction.toLowerCase().startsWith("desc");reverse=reverse?-1:1}if(fields.length===1){arr1=reverse*compareVals(format,enableUTCDates,rowTemplate,a,b);arr2=reverse*compareVals(format,enableUTCDates,rowTemplate,b,a)}else{if(reverse===-1){arr1.push(-compareVals(format,enableUTCDates,rowTemplate,a,b));arr2.push(-compareVals(format,enableUTCDates,rowTemplate,b,a))}else{arr1.push(compareVals(format,enableUTCDates,rowTemplate,a,b));arr2.push(compareVals(format,enableUTCDates,rowTemplate,b,a))}}}if(arr1<arr2){return-1}if(arr1>arr2){return 1}return 0}}}if($.isFunction(s.customConvertFunc)){convertFunc=s.customConvertFunc}if($.type(fields)==="string"){fields=this._parseSortExpressions(fields)}if(fields.length>0){data=data.sort(sortF(this.settings.callee,fields,schema,direction.toLowerCase().startsWith("asc")?false:true,convertFunc,s.caseSensitive));this._allDataSorted=data===this.data()}}return data},totalLocalRecordsCount:function(){var fdv=this._flatVisibleData;if(fdv&&this.settings.paging.type!=="remote"&&this.settings.treeDS.paging.mode!=="rootLevelOnly"){return fdv.length}return this._super()},getFilteringMatchRecordsCount:function(){var count=this.metadata("filtering.countRecords");if(count!==undefined&&count!==null){return count
}return this.totalRecordsCount()},filter:function(fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings){var i,f=this.settings.filtering,p=this.settings.paging,data,resetPaging;if(f.applyToAllData&&f.type==="local"){data=this.data();resetPaging=true}else{if(this._cachedDataView&&this._cachedDataView.length>0){data=this._cachedDataView}else{this._cachedDataView=$.merge([],this.dataView());data=this._cachedDataView}}this._filteredRecordsCount=0;this._generatedFlatData=false;this._filteredData=this._filterDataRecursive(data,0,fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings);this._dataView=[];this._filter=true;if(resetPaging&&p.type==="local"&&p.enabled===true){this.settings.paging.pageIndex=0;this.pageSizeDirty(true);this._page()}else{for(i=0;i<this._filteredData.length;i++){this._dataView[i]=this._filteredData[i]}}if(this.shouldCallGenerateFlatDataView()){this.generateFlatDataView()}this._populateTransformedData(this._filteredData);return this},_filterDataRecursive:function(data,level,fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings){var i,j,expr=null,count=0,skipRec=false,f=this.settings.filtering,foundChildDS,subDS,t,k,schema,fields,tmpbool,allFieldsExpr,stringVal,fExprLen,fExprStrLen,propertyExp=this.settings.treeDS.propertyExpanded,filteredData=[],childDS,layoutKey=this.settings.treeDS.childDataKey,fts=this.settings.treeDS.filtering,matchFiltering=fts.matchFiltering;schema=this.schema();if(schema===null||schema===undefined){throw new Error($.ig.DataSourceLocale.locale.filteringNoSchema)}if($.type(fieldExpressions)==="string"){expr=fieldExpressions}if($.type(fieldExpressionsOnStrings)==="string"){allFieldsExpr=fieldExpressionsOnStrings}else if($.type(fieldExpressionsOnStrings)==="undefined"){fieldExpressionsOnStrings=[]}if($.type(fieldExpressions)==="array"&&fieldExpressions.length===0&&$.type(fieldExpressionsOnStrings)==="array"&&fieldExpressionsOnStrings.length===0){return}if($.type(f.customFunc)==="function"){filteredData=f.customFunc(fieldExpressions,data)}else{if(expr){fieldExpressions=this._parseFilterExprString(expr)}if(allFieldsExpr){fieldExpressionsOnStrings=this._parseFilterExprString(allFieldsExpr)}fExprLen=fieldExpressions.length;fExprStrLen=fieldExpressionsOnStrings.length;for(i=0;i<data.length;i++){if(matchFiltering){delete data[i][matchFiltering]}if(!((fts.fromLevel<=level||fts.fromLevel===-1)&&(fts.toLevel>=level||fts.toLevel===-1))){childDS=data[i][layoutKey];if(childDS&&childDS.length){childDS=this._filterDataRecursive(childDS,level+1,fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings);if(childDS&&childDS.length>0){filteredData[count++]=$.extend(true,{},data[i]);filteredData[count-1][layoutKey]=childDS}}continue}skipRec=false;for(j=0;j<fExprLen;j++){fields=schema.fields();if(fieldExpressions[j].fieldIndex){if(fieldExpressions[j].fieldIndex<fields.length){t=this._getFieldTypeFromSchema(fields[fieldExpressions[j].fieldIndex].name)}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldIndex],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond,fieldExpressions[j].preciseDateFormat)}else{if(fieldExpressions[j].dataType!==undefined&&fieldExpressions[j].dataType!==null){t=fieldExpressions[j].dataType}else{for(k=0;k<fields.length;k++){if(fields[k].name===fieldExpressions[j].fieldName){t=this._getFieldTypeFromSchema(fields[k].name);break}}}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldName],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond,fieldExpressions[j].preciseDateFormat,fieldExpressions[j].fieldName,data[i])}tmpbool=fieldExpressions[j].logic!==null&&fieldExpressions[j].logic!==undefined&&(fieldExpressions[j].logic.toLowerCase()==="or"||fieldExpressions[j].logic.toLowerCase()==="and")?fieldExpressions[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}if(!skipRec&&fExprStrLen){for(j=0;j<fExprStrLen;j++){fields=schema.fields();if(fieldExpressionsOnStrings[j].fieldIndex){if(fieldExpressionsOnStrings[j].fieldIndex<fields.length){t=this._getFieldTypeFromSchema(fields[fieldExpressionsOnStrings[j].fieldIndex].name)}stringVal=data[i][fieldExpressionsOnStrings[j].fieldIndex]?data[i][fieldExpressionsOnStrings[j].fieldIndex].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond,data[i])}else{for(k=0;k<fields.length;k++){if(fields[k].name===fieldExpressionsOnStrings[j].fieldName){t=this._getFieldTypeFromSchema(fields[k].name);break}}stringVal=data[i][fieldExpressionsOnStrings[j].fieldName]!==null&&data[i][fieldExpressionsOnStrings[j].fieldName]!==undefined?data[i][fieldExpressionsOnStrings[j].fieldName].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond,data[i])}tmpbool=fieldExpressionsOnStrings[j].logic!==null&&fieldExpressionsOnStrings[j].logic!==undefined&&(fieldExpressionsOnStrings[j].logic.toLowerCase()==="or"||fieldExpressionsOnStrings[j].logic.toLowerCase()==="and")?fieldExpressionsOnStrings[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}}foundChildDS=false;childDS=data[i][layoutKey];subDS=null;if(childDS&&childDS.length){childDS=this._filterDataRecursive(childDS,level+1,fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings);if(childDS&&childDS.length>0){subDS=data[i][layoutKey];data[i][layoutKey]=null;filteredData[count++]=$.extend(true,{},data[i]);data[i][layoutKey]=subDS;filteredData[count-1][layoutKey]=childDS;foundChildDS=true;if(propertyExp){filteredData[count-1][propertyExp]=true}if(!skipRec&&matchFiltering){filteredData[count-1][matchFiltering]=true;this._filteredRecordsCount++}}}if(!skipRec&&!foundChildDS){if(fts.displayMode==="showWithAncestors"&&childDS){subDS=data[i][layoutKey];data[i][layoutKey]=null;filteredData[count]=$.extend(true,{},data[i]);data[i][layoutKey]=subDS;filteredData[count][layoutKey]=null;count++}else{if(childDS){subDS=data[i][layoutKey];data[i][layoutKey]=null}filteredData[count]=$.extend(true,{},data[i]);if(subDS){filteredData[count][layoutKey]=subDS;data[i][layoutKey]=subDS}count++}this._filteredRecordsCount++;if(matchFiltering){filteredData[count-1][matchFiltering]=true}if(childDS&&propertyExp){filteredData[count-1][propertyExp]=false}}}}return filteredData},getFilteredRecordsCountFromDataView:function(){var fdv=this.flatDataView(),i,count=0,propMatchFiltering=this.settings.treeDS.filtering.matchFiltering;if(this._filter){for(i=0;i<fdv.length;i++){if(fdv[i][propMatchFiltering]){count++}}}return count},getFilteredRecordsCount:function(){if(this._filter){return this._filteredRecordsCount}return 0},clearLocalFilter:function(){this.clearMatchFiltering();this._super();this._filter=false;if(this.shouldCallGenerateFlatDataView()){this.generateFlatDataView()}},shouldCallGenerateFlatDataView:function(){var s=this.settings,paging=s.paging;return!paging||!paging.enabled||paging.type!=="local"||this.settings.treeDS.paging.mode==="rootLevelOnly"},clearMatchFiltering:function(data){var i,fts=this.settings.treeDS.filtering,dataLen,layout,matchFiltering=fts.matchFiltering,layoutKey=this.settings.treeDS.childDataKey;if(!matchFiltering){return}if(!data){data=this._filteredData;if(!data){return}}dataLen=data.length;for(i=0;i<dataLen;i++){delete data[i][matchFiltering];layout=data[i][layoutKey];if(layout){this.clearMatchFiltering(layout)}}},getPathBy:function(record){if(record===null||record===undefined){return null}var data=this._data,resRecord,search,key,objPath={path:""},path,len=data?data.length:0;search=len>0&&$.isArray(data[0])?this._lookupPkIndex():this.settings.primaryKey;if($.type(record)!=="object"){key=record}else{key=record[search]}resRecord=this.findRecordByKey(key,null,objPath);if(!resRecord){return null}path=objPath.path;if(path!==""){path+="/"}return path+key},_findIndexInFlatDS:function(ds,foreignKeyValue,targetInd){var i,dr,fKey=this.settings.treeDS.foreignKey,len=ds.length,lastInd,layoutInd=0,foundLayout=false;for(i=0;i<len;i++){dr=ds[i];if(dr[fKey]===foreignKeyValue){foundLayout=true;lastInd=i;if(targetInd===layoutInd){return i}layoutInd++}}if(foundLayout){return++lastInd}return-1},findRecordByKey:function(key,ds,objPath){var i,d,layouts=[],res,path,data=ds||this._data,len=data?data.length:0,dsLayoutKey=this.settings.treeDS.childDataKey,search=len>0&&$.isArray(data[0])?this._lookupPkIndex():this.settings.primaryKey;objPath=objPath||{path:"",parentRows:[]};objPath.parentRows=objPath.parentRows||[];objPath.path=objPath.path||"";for(i=0;i<len;i++){d=data[i];if(d[search]===key){objPath.parentRows.push({row:d,level:d[this.settings.treeDS.propertyDataLevel]});return data[i]}if(d[dsLayoutKey]){path=objPath.path;if(path!==""){path+="/"}layouts.push({layout:d[dsLayoutKey],objPath:{path:path+d[search],parentRows:objPath.parentRows.concat({row:d,level:d[this.settings.treeDS.propertyDataLevel]})}})}}len=layouts.length;for(i=0;i<len;i++){res=this.findRecordByKey(key,layouts[i].layout,layouts[i].objPath);objPath.path=layouts[i].objPath.path;objPath.parentRows=layouts[i].objPath.parentRows;if(res){return res}}return null},_invokeCallback:function(callee,callback){if(!this.schema()&&this._dataBinding){this._data=this.processDataPerLevel(this._data,0,true)}if(this.shouldCallGenerateFlatDataView()){this.generateFlatDataView()}this._super(callee,callback)},removeRecordByKey:function(key,origDs){var data,count=0,all=[this._data,this._dataView,this._filteredData,origDs];while(count<all.length){data=all[count++];this._removeRecordByKeyForData(key,data);if(data===all[count]){count++}}},_removeRecordByKeyForData:function(key,data){var i,prime=this.settings.primaryKey,len=data?data.length:0,search=len>0&&$.isArray(data[0])?this._lookupPkIndex():prime,layoutKey=this.settings.treeDS.childDataKey,layoutData=[],found=false;for(i=0;i<len;i++){if(data[i]){if(data[i][search]===key){$.ig.removeFromArray(data,i);found=true;break}if(data[i][layoutKey]){layoutData.push(data[i][layoutKey])}}}if(!found){len=layoutData.length;for(i=0;i<len;i++){found=this._removeRecordByKeyForData(key,layoutData[i]);if(found){return true}}}else{return true}return false},deleteRow:function(rowId,autoCommit){var ret=this._super.call(this,rowId,autoCommit);this._dataBoundDepth=null;this.getDataBoundDepth();return ret},getChildrenByKey:function(key,ds){var childKey=this.settings.treeDS.childDataKey,rec=this.findRecordByKey(key,ds);if(rec&&rec[childKey]){return rec[childKey]}return null},insertRow:function(rowId,rowObject,rowIndex,autoCommit,parentRowId){if(parentRowId===null||parentRowId===undefined){return this._super(rowId,rowObject,rowIndex,autoCommit)}var t=this._createInsertNodeTransaction(rowId,rowObject,rowIndex,parentRowId);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowInserted)==="function"){if(this.settings.callee){this.settings.rowInserted.apply(this.settings.callee,[{rowId:rowId,row:rowObject,parentRowId:parentRowId,rowIndex:rowIndex},this])}else{this.settings.rowInserted({rowId:rowId,row:rowObject,parentRowId:parentRowId,rowIndex:rowIndex},this)}}return t},_createInsertNodeTransaction:function(rowId,rowObject,rowIndex,parentRowId){return{type:"insertnode",tid:this._generateTransactionId(),row:rowObject,rowId:rowId,rowIndex:rowIndex,parentRowId:parentRowId}},_commitTransaction:function(t){var origDs,dv,rec;if(t.type==="insertnode"){origDs=this.settings.localSchemaTransform?this._origDs:null;if(origDs===this._data){origDs=null}this._addRow(t.row,t.rowIndex,origDs,t.parentRowId);this._removeTransactionByTransactionId(t.tid)}else{this._super(t);if(this._filter&&(t.type==="cell"||t.type==="row")){dv=this.dataView();rec=this.findRecordByKey(t.rowId,dv);if(rec){this._updateRecOnCommit(t,[rec])}}}if(this.settings.paging.enabled&&this.settings.paging.type!=="remote"){this._generateFlatDataAndCountProperties()}this.generateFlatDataView()},_preprocessAddRow:function(row,index,origDs,at,data){var newRow,recAt,res={parentRec:null,cashedData:data,layoutData:null},childKey=this.settings.treeDS.childDataKey;if(at===undefined||at===null||!data){res.layoutData=data;return res}if(!this._isHierarchicalDataSource&&data===origDs){if($.type(row)==="object"){newRow=$.extend(true,{},row)}if(this.settings.treeDS.foreignKey!==null){newRow[this.settings.treeDS.foreignKey]=at}data.push(newRow);return res}recAt=this.findRecordByKey(at,data);if(!recAt){return res}recAt[childKey]=recAt[childKey]||[];res.parentRec=recAt;res.layoutData=recAt[childKey];return res},_postprocessAddRow:function(row,index,origDs,at,pdata){var parentRec=pdata?pdata.parentRec:null,childKey=this.settings.treeDS.childDataKey;if(parentRec&&pdata.newData&&childKey!==null){parentRec[childKey]=pdata.newData;if(parentRec[this.settings.treeDS.propertyDataLevel]===this.getDataBoundDepth()){this._dataBoundDepth++}}},_addRow:function(row,index,origDs,at){var ret=this._super.call(this,row,index,origDs,at);if(at!==undefined&&at!==null&&!this.settings.treeDS.propertyDataLevel){this._dataBoundDepth=null;this.getDataBoundDepth()}return ret}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.datasource",["ig.util"],function(){return $.ig.DataSource})}})(jQuery);/*!@license
* Infragistics.Web.ClientUI templating localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Templating){$.ig.Templating={};$.extend($.ig.Templating,{locale:{undefinedArgument:"An error has occurred while trying to retrieve data source property: "}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Templating Engine 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * Engine used for data templating
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *
 */
(function($){$.ig=$.ig||{};$.extend($.ig,{tmpl:function(template,data,args){var tmpl=template,cacheConst;if(tmpl){tmpl=tmpl.replace(this.regExp.lineBreak,"");tmpl=tmpl.replace(this.regExp.comment,"");if(typeof data==="function"){if(args){data=data.apply(this,args)}else{data=data.call()}}if(this._internalTmplCache&&this._internalTmplCache.hasOwnProperty(tmpl)){this.tokens=this._internalTmplCache[tmpl].tokens;this.args=this._internalTmplCache[tmpl].args;this.i=this._internalTmplCache[tmpl].i;this._hasBlock=this._internalTmplCache[tmpl]._hasBlock;tmpl=this._internalTmplCache[tmpl].tmpl}else{this.tokens=[];this.args=[];this.i=0;this._tokenizeTemplate(tmpl);cacheConst=tmpl;this._internalTmplCache[cacheConst]={};this._internalTmplCache[cacheConst].tokens=this.tokens;if(this.regExp.block.test(tmpl)){this._hasBlock=true;tmpl=this._tokenizeDirectives(tmpl)}else{this._hasBlock=false}this._internalTmplCache[cacheConst].args=this.args;this._internalTmplCache[cacheConst].i=this.i;this._internalTmplCache[cacheConst]._hasBlock=this._hasBlock;this._internalTmplCache[cacheConst].tmpl=tmpl}if(!this.tokens){return tmpl}if(this._hasBlock){tmpl=this._compileTemplate(tmpl,data)}else{tmpl=this._populateTemplate(tmpl,data)}delete this.args;delete this.tokens;delete this._hasBlock;delete this.i}return tmpl},clearTmplCache:function(){delete this._internalTmplCache;this._internalTmplCache={}},encode:function(value){return value!==null&&value!==undefined?value.toString().replace(this.regExp.lt,"&lt;").replace(this.regExp.gt,"&gt;").replace(this.regExp.ap,"&#39;").replace(this.regExp.ic,"&#34;"):""},regExp:{comment:/\s#[^#]*#/g,sub:/\$\{(([\w\$]+(\.|\s)?[\w\$]*)+)\}/,nonEncodeSub:/\{\{html\s+([\w\$]+(\.|\s)?[\w\$]*)+\}\}/,forSub:/\$\{(([\w\$]+\.[\w\$]*)+)\}/,arg:/args\[\d+\](?!.*\+)/,block:/\{\{(\w+).*?\}\}+(.*)(\{\{\/\1\}\})/,blockCont:/\{\{(?!\/)(\S+)(.*)\}\}(.*)/,blockDirective:/\{\{\S+.*?\}\}/,index:/\$i/g,lineBreak:/(\r\n|\n|\r)/gm,lt:/</g,gt:/>/g,ap:/'/g,ic:/"/g},_directives:{"if":{start:"if (",close:") {",end:" }"},elseif:{start:" } else if (",close:") {",end:""},"else":{start:" } else {",close:"",end:""},each:{start:"for (var i = 0; i < $data.length; i++) {",close:"",end:" }"}},_internalTmplCache:{},_tokenizeTemplate:function(template){var tempToken,splitName;if(this.regExp.sub.test(template)){tempToken=this.regExp.sub.exec(template);while(tempToken!==null){splitName=tempToken[1].split(".");template=template.replace(new RegExp("\\$\\{"+tempToken[1].replace(/\$/g,"\\$")+"\\}","g"),"");tempToken[3]=new RegExp("\\$\\{"+tempToken[1].replace(/\$/g,"\\$")+"\\}","g");tempToken[1]=splitName;tempToken[2]=true;this.tokens.push(tempToken);tempToken=this.regExp.sub.exec(template)}}if(this.regExp.nonEncodeSub.test(template)){tempToken=this.regExp.nonEncodeSub.exec(template);while(tempToken!==null){splitName=tempToken[1].split(".");template=template.replace(new RegExp("\\{\\{html\\s+"+tempToken[1].replace(/\$/g,"\\$")+"\\}\\}","g"),"");tempToken[3]=new RegExp("\\{\\{html\\s+"+tempToken[1].replace(/\$/g,"\\$")+"\\}\\}","g");tempToken[1]=splitName;tempToken[2]=false;this.tokens.push(tempToken);tempToken=this.regExp.nonEncodeSub.exec(template)}}},_tokenizeDirectives:function(template){var tmpl='var result = "";',tokens=this.regExp.block.exec(template),temp;if(template.indexOf(tokens[0])>0||template.length!==tokens[0].length){temp=template.split(tokens[0]);if(temp[0]&&temp[0].length>0){this.args.push(temp[0]);tmpl+="result += args["+this.i++ +"];"}}tmpl+=this._handleCompleteBlock(tokens);if(temp&&temp.length>0&&temp[1].length>0){this.args.push(temp[1]);tmpl+="result += args["+this.i++ +"];"}tmpl+="return result;";return tmpl},_handleCompleteBlock:function(tokens){var tmpl=tokens[0],template="",blocks=[],i,temp;tmpl=tmpl.replace("{{"+tokens[1],this._directives[tokens[1]].start);if(tokens[1]==="each"){blocks.push(tokens[0].split(tokens[3]));blocks.push(tokens[2].split(tokens[3]));for(i=0;i<blocks[1].length;i++){if(blocks[0][i].indexOf("{{each")>0){temp=blocks[0][i].split("{{each")[0];this.args.push(temp);template+="result += args["+this.i++ +"];";blocks[0][i]=blocks[0][i].substr(blocks[0][i].indexOf("{{each"));temp=this.regExp.blockDirective.exec(blocks[1][i]);blocks[1][i]=blocks[1][i].substr(blocks[1][i].indexOf(temp[0])+temp[0].length)}blocks[0][i]=blocks[0][i].replace("{{"+tokens[1],this._directives[tokens[1]].start);template+=this._handleEach(blocks[0][i]+"{{/each}}",[blocks[0][i]+"{{/each}}","each",blocks[1][i],"{{/each}}"])}}else if(tokens[1]==="if"){template+=this._handleIfElse(tmpl,tokens)}return template},_handleEach:function(template,tokens){var tmpl=template,eachVar,body,forSub,sub,expr,inner;eachVar=this.regExp.sub.exec(tmpl);tmpl=tmpl.replace(eachVar[0],"");tmpl=tmpl.replace("$data",eachVar[0]);body=tokens[2];if(/\$data/.test(body)){body=body.replace(/\$data/g,'" + '+eachVar[0]+'[ i ] + "');this.args.push(eachVar[0]);this.i++}forSub=this.regExp.forSub.exec(body);while(forSub){body=body.replace(new RegExp("\\$\\{"+forSub[1]+"\\}","g"),'" + '+eachVar[0]+"[ i ]"+forSub[1].substr(forSub[1].indexOf("."))+' + "');forSub=this.regExp.forSub.exec(body)}body=body.replace(/\$index/g,'" + i + "');tmpl=tmpl.replace(tokens[2],'result += "'+body+'"');tmpl=tmpl.replace(/\}\}/,this._directives[tokens[1]].close);tmpl=tmpl.replace(tokens[3],this._directives[tokens[1]].end);if(this.regExp.block.test(tmpl)){inner=this.regExp.block.exec(tmpl);tmpl=tmpl.replace(inner[0],this._handleCompleteBlock(inner))}sub=this.regExp.sub.exec(tmpl);while(sub){expr=new RegExp("\\$\\{"+sub[1]+"\\}","g");tmpl=tmpl.replace(expr,"args["+this.i++ +"]");this.args.push(sub[0]);sub=this.regExp.sub.exec(tmpl)}return tmpl},_handleIfElse:function(template,tokens){var tmpl=template,i=0,htmlStrings,sub,inner,index,tmplArr=[];tmpl=tmpl.replace(/\}\}/,this._directives[tokens[1]].close);index=tmpl.lastIndexOf(tokens[3]);tmpl=tmpl.substr(0,index)+tmpl.slice(index+tokens[3].length-1);if(this.regExp.block.test(tmpl)){inner=this.regExp.block.exec(tmpl);tmpl=tmpl.replace(inner[0],this._handleCompleteBlock(inner))}htmlStrings=tokens[2].split(this.regExp.blockDirective);tmplArr.push(tmpl.slice(0,tmpl.indexOf(") {")+3));tmplArr.push(tmpl.slice(tmpl.indexOf(") {")+3));for(i;i<htmlStrings.length;i++){if(htmlStrings[i]&&htmlStrings[i].length&&htmlStrings[i].length>0){tmplArr[1]=tmplArr[1].replace(htmlStrings[i],"result += args["+this.i++ +"];");this.args.push(htmlStrings[i])}}tmpl=tmplArr.join("");tokens=this.regExp.blockCont.exec(tmpl);while(tokens){tmpl=tmpl.replace("{{"+tokens[1],this._directives[tokens[1]].start);tmpl=tmpl.replace(/\}\}/,this._directives[tokens[1]].close);tokens=this.regExp.blockCont.exec(tmpl)}sub=this.regExp.sub.exec(tmpl);while(sub){tmpl=tmpl.replace(new RegExp("\\$\\{"+sub[1]+"\\}","g"),"args["+this.i++ +"]");this.args.push(sub[0]);sub=this.regExp.sub.exec(tmpl)}return tmpl},_populateTemplate:function(template,data){var i,j,result="",temp;if(!data.length){for(i=0;i<this.tokens.length;i++){template=this._populateArgumentValue(data,this.tokens[i],template)}result=template}else if(data.length){for(j=0;j<data.length;j++){temp=template;for(i=0;i<this.tokens.length;i++){temp=this._populateArgumentValue(data[j],this.tokens[i],temp)}temp=temp.replace(this.regExp.index,j);result+=temp}}return result},_compileTemplate:function(template,data){var i,j,k,result="",temp,tempArgs=[],arg="",f;if(!data.length){for(j=0;j<this.args.length;j++){arg=this.args[j];for(i=0;i<this.tokens.length;i++){if(arg===this.tokens[i][0]){arg=this._getArgumentValue(data,this.tokens[i],arg);break}else if(typeof arg==="string"){arg=this._populateArgumentValue(data,this.tokens[i],arg)}}if(arg===undefined){throw new Error($.ig.Templating.locale.undefinedArgument+this.tokens[i][0])}if(typeof arg==="string"){arg=arg.replace(this.regExp.index,0)}tempArgs.push(arg)}template=template.replace(/\$i/g,0);result=new Function("args",template).call(this,tempArgs)||""}else if(data.length){temp=template.replace(this.regExp.index,"args["+this.args.length+"]");f=new Function("args",temp);for(j=0;j<data.length;j++){tempArgs=[];for(k=0;k<this.args.length;k++){arg=this.args[k];for(i=0;i<this.tokens.length;i++){if(arg===this.tokens[i][0]){arg=this._getArgumentValue(data[j],this.tokens[i],arg);break}else if(typeof arg==="string"){arg=this._populateArgumentValue(data[j],this.tokens[i],arg)}}if(arg===undefined){throw new Error($.ig.Templating.locale.undefinedArgument+this.tokens[i][0])}if(typeof arg==="string"){arg=arg.replace(this.regExp.index,j)}tempArgs.push(arg)}tempArgs.push(j);result+=f.call(this,tempArgs)||""}}return result},_getArgumentValue:function(data,token,arg){var tempData,l;if(token[1].length&&token[1].length>1){tempData=data;for(l=0;l<token[1].length;l++){if(tempData&&tempData.hasOwnProperty(token[1][l])){tempData=tempData[token[1][l]]}else{tempData="";break}}if(token[2]&&typeof tempData==="string"){arg=this.encode(tempData)}else{arg=tempData}}else{if(token[2]&&typeof data[token[1]]==="string"){arg=this.encode(data[token[1]])}else{arg=data[token[1]]}}return arg},_populateArgumentValue:function(data,token,arg){var tempData,l,self=this;if(token[1].length&&token[1].length>1){tempData=data;for(l=0;l<token[1].length;l++){if(tempData&&tempData.hasOwnProperty(token[1][l])){tempData=typeof tempData[token[1][l]]==="function"?tempData[token[1][l]]():tempData[token[1][l]]}else{tempData="";break}}if(token[2]&&typeof tempData==="string"){arg=arg.replace(token[3],function(){return self.encode(tempData)})}else{arg=arg.replace(token[3],function(){return tempData===null?"":tempData})}}else{if(token[2]){arg=arg.replace(token[3],function(){return self.encode(typeof data[token[1]]==="function"?data[token[1]]():data[token[1]])})}else{arg=arg.replace(token[3],function(){return data[token[1]]===null?"":typeof data[token[1]]==="function"?data[token[1]]():data[token[1]]})}}return arg}})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Scroll 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on:
* jquery-1.4.4.js
* jquery.ui.core.js
* jquery.ui.widget.js
* infragistics.util.js
*/
(function($){var _attr="data-scroll",_stop=function(e){try{e.preventDefault();e.stopPropagation()}catch(ex){}},_aNull=function(val){return val===null||val===undefined||typeof val==="number"&&isNaN(val)},_num=function(val){return isNaN(val=parseInt(val,10))?0:val},_int=function(elem,css){return _num(elem.css(css))},_draggable=function(type){return type==="draggable"},_thin=function(type){return type==="show"},_zero=function(num){return isNaN(num)||num<5},_touch=function(e){e=e.originalEvent;e=e?e.touches:null;return e&&e.length===1?e[0]:null},_src=function(e){e=e.target;return e.nodeName==="#text"?e.parentNode:e},_is=function(elem,src){return elem&&(elem.has(src).length>0||elem[0]===src)},_valid=function(elem){return elem&&elem[0].parentNode?elem:null},_remove=function(elem){if(_valid(elem)){elem.remove()}},_find=function(notMobile){setTimeout(function(){if(!$.ig.util.isModernizrAvailable||$.ig.util.isTouch){$("body").find("["+_attr+"]").each(function(){var elem=$(this),scroll=elem.data("igScroll");if((!scroll||!scroll.evts)&&!elem.data("igScroll")&&!elem.data("scrollview")){elem.igScroll({_find:true})}})}},notMobile===true?1e3:100)},setPointerCaptureFName=typeof Element.prototype.msSetPointerCapture==="function"?"msSetPointerCapture":"setPointerCapture",releasePointerCaptureFName=typeof Element.prototype.msReleasePointerCapture==="function"?"msReleasePointerCapture":"releasePointerCapture";$.widget("ui.igScroll",{options:{thumbOpacityDrag:null,thumbOpacity:null,cancelStart:null,oneDirection:null,direction:null,animateShowDuration:null,animateHideDuration:null,hideThumbsDelay:null,hideDragThumbsDelay:null,xInertia:null,yInertia:null,xThumb:null,yThumb:null,xLabel:null,yLabel:null,marginLeft:null,marginRight:null,marginTop:null,marginBottom:null,xScroller:null,yScroller:null},events:{starting:null,started:null,scrolling:null,scrolled:null,stopped:null},scrollLeft:function(val){if(_aNull(val)){return this._getScroll(true)}this._scroll(val);return this},scrollTop:function(val){if(_aNull(val)){return this._getScroll()}this._scroll(null,val);return this},scrollWidth:function(){return this._getScroll(true,true)},scrollHeight:function(){return this._getScroll(false,true)},_create:function(){var v,key,self=this,elem=self.element,o=self.options;if(o._find){for(key in o){if(o.hasOwnProperty(key)&&_aNull(o[key])){if(_aNull(v=elem.attr("data-"+key))){v=elem.attr("data-"+key.replace("S","-s").replace("D","-d").replace("O","-o").replace("R","-r").replace("T","-t").replace("I","-i").replace("B","-b").replace("L","-l").replace("H","-h").replace("D","-d"))}if(!_aNull(v)){o[key]=v}}}o.direction=o.direction||elem.attr(_attr)}v=$.ui.igScroll.defaults;for(key in v){if(v.hasOwnProperty(key)&&o[key]===null){o[key]=v[key]}}v=o.direction;self.dir=o.oneDirection&&v!=="x"&&v!=="y";self.evts={pointerdown:function(e){var evt=e.originalEvent;if(!evt||evt.pointerType!==2&&evt.pointerType!=="touch"){return}e.target[setPointerCaptureFName](self._pointer=evt.pointerId);self.evts.touchstart(e)},pointermove:function(e){if(self._pointer){self._move(e)}},pointerup:function(e){if(!self._pointer){return}e.target[releasePointerCaptureFName](self._pointer);self.evts.touchend(e);delete self._pointer},touchstart:function(e){delete self.skip;var touch=self._pointer?e.originalEvent:_touch(e);if(touch){self.x=touch.pageX;self.y=touch.pageY;self.click=true;if(self._isCancel(o)){_stop(e)}}else{self._move(e,"start")}},touchmove:function(e){self._move(e)},touchend:function(e){if(!self.click){self._move(e,"end")}else if(self._isCancel(o)){$(_src(e)).trigger("mousedown").trigger("mouseup").trigger("click")}}};elem.bind(self.evts);elem.bind({MSPointerDown:self.evts.pointerdown,MSPointerMove:self.evts.pointermove,MSPointerUp:self.evts.pointerup})},_isCancel:function(o){o=o.cancelStart;return o===true||o==="ms"&&this._pointer},_createBar:function(elem,hor,type){var bar,thumb,border,sizeInt,span,img,iconSize=17,thumbSize=5,thumbDragSize=30,thin=_thin(type),display=hor?"inline-block":"block",margin="margin"+(hor?"Top":"Left"),size=hor?"height":"width";if(thin||_draggable(type)){bar=$("<span />").css({position:"absolute",zIndex:_int(elem,"zIndex")+2,background:"transparent",border:"0px",opacity:0,display:"block"}).addClass("ui-widget").css(size,"1px").insertAfter(elem);sizeInt=thin?thumbSize:thumbDragSize;thumb=$("<span />").css("position","relative").css(size,sizeInt).css("display","block").appendTo(bar);if(thin){thumb.css("background","#101010")}else{bar.css("msTouchAction","none");thumb.addClass("ui-corner-all ui-state-hover");border=thumb.css("borderTopColor");sizeInt=hor?thumb[0].offsetHeight:thumb[0].offsetWidth;span=$("<span />").css({display:display,borderStyle:"solid",borderColor:border,borderWidth:hor?"0px 1px 0px 0px":"0px 0px 1px 0px"}).addClass("ui-corner-"+(hor?"left":"top")).css(size,"100%").appendTo(thumb);img=$("<span />").css("display","block").css(margin,Math.floor((sizeInt-iconSize)/2)+"px").addClass("ui-icon ui-icon-carat-1-"+(hor?"w":"n")).appendTo(span);span=$("<span />").css("display",display).css(size,"100%").appendTo(thumb);img=$("<span />").css("display","block").css(margin,Math.floor((sizeInt-iconSize)/2)+"px").addClass("ui-icon ui-icon-grip-dotted-"+(hor?"vertical":"horizontal")).appendTo(span);span=$("<span />").css({display:display,borderStyle:"solid",borderColor:border,borderWidth:hor?"0px 0px 0px 1px":"1px 0px 0px 0px"}).addClass("ui-corner-"+(hor?"right":"bottom")).css(size,"100%").appendTo(thumb);img=$("<span />").css("display","block").css(margin,Math.floor((sizeInt-iconSize)/2)+"px").addClass("ui-icon ui-icon-carat-1-"+(hor?"e":"s")).appendTo(span)}thumb.css(margin,-(sizeInt+1)+"px")}if(hor){this.barX=bar;this.thumbX=thumb}else{this.barY=bar;this.thumbY=thumb}},_bar:function(elem,hor){var v,left,top,thumb,locElem,locBar,shiftBar,shiftX,shiftY,thumbSize,o=this.options,barMargin=2,barSizeMargin=_num(hor?o.marginLeft:o.marginTop),barSizeMargin2=_num(hor?o.marginRight:o.marginBottom),minBarSize=4,minThumbSize=15,bar=hor?this.barX:this.barY,type=hor?o.xThumb:o.yThumb,elemSize=hor?elem[0].offsetWidth:elem[0].offsetHeight,barSize=Math.max(elemSize-barSizeMargin-barSizeMargin2,minBarSize),scrollSize=Math.max(this._getScroll(hor,true),minBarSize+barSizeMargin+barSizeMargin2);if(!elemSize||scrollSize-elemSize<1){if(bar){bar.remove();delete this.bar}return}if(bar){if(!_valid(bar)){bar.insertAfter(elem)}}if(!bar){this._createBar(elem,hor,type)}bar=hor?this.barX:this.barY;if(!bar){return}thumb=hor?this.thumbX:this.thumbY;if(_draggable(type)&&thumb){thumb.bind(this.evts)}shiftBar=(hor?elem[0].offsetHeight:elem[0].offsetWidth)-barMargin;left=_int(elem,"marginLeft")+(hor?barSizeMargin:shiftBar);top=_int(elem,"marginTop")+(hor?shiftBar:barSizeMargin);bar.css({left:elem.css("left"),top:elem.css("top"),marginLeft:left+"px",marginTop:top+"px"});if(_thin(type)){thumb.css(hor?"width":"height",Math.floor(Math.max(elemSize*elemSize/scrollSize,minThumbSize))+"px")}thumbSize=hor?thumb[0].offsetWidth:thumb[0].offsetHeight;v=(scrollSize-barSize-barSizeMargin-barSizeMargin2+barMargin)/(barSize-thumbSize);if(hor){this.ratioX=v}else{this.ratioY=v}locElem=elem.offset();locBar=bar.offset();shiftY=locBar.top-locElem.top-(hor?shiftBar:barSizeMargin);shiftX=locBar.left-locElem.left-(hor?barSizeMargin:shiftBar);if(Math.abs(shiftY)>0){bar.css("marginTop",top-shiftY+_int(elem,"borderTopWidth")+"px")}if(Math.abs(shiftX)>0){bar.css("marginLeft",left-shiftX+_int(elem,"borderLeftWidth")+"px")}return bar},_scroller:function(hor){var o=this.options,div=o.direction;if(!this.evts||hor&&div==="y"||!hor&&div==="x"){return}div=hor?o.xScroller:o.yScroller;if(div&&typeof div==="string"){div=$(div)[0];if(hor){o.xScroller=div}else{o.yScroller=div}}if(div&&div.length){div=div[0]}return div||this.element[0]},_getScroll:function(hor,size){var div=this._scroller(hor);if(!div){return 0}return hor?size?div.scrollWidth:div.scrollLeft:size?div.scrollHeight:div.scrollTop},_scroll:function(x,y){var div=this._scroller(true);this._bar(this.element);if(div&&!this.inBarY&&this.dir!=="y"&&!_aNull(x)){div.scrollLeft=x;if(this.thumbX){this.thumbX.css("marginLeft",Math.floor(div.scrollLeft/this.ratioX)+"px")}}div=this._scroller();if(div&&!this.inBarX&&this.dir!=="x"&&!_aNull(y)){div.scrollTop=y;if(this.thumbY){this.thumbY.css("marginTop",Math.floor(div.scrollTop/this.ratioY)+"px")}}},_vis:function(){return this.evts&&this.element[0].offsetWidth},_inertia:function(){var self=this,arg={owner:self},max=.97,stopTimerSpeed=.8,x=self.speedX,y=self.speedY,o=self.options,tick=17,rateX=Math.max(Math.min(parseFloat(o.xInertia),max),0),rateY=Math.max(Math.min(parseFloat(o.yInertia),max),0),speedX=(x?x[0]+x[1]+x[2]:0)*tick,speedY=(y?y[0]+y[1]+y[2]:0)*tick,left=self._getScroll(true),top=self._getScroll(),inertia=function(){self.timer=setTimeout(function(){delete self.timer;arg.deltaX=-Math.floor(speedX);arg.deltaY=-Math.floor(speedY);if(!self._vis()||!self._trigger("scrolling",null,arg)){self._end();return}left+=arg.deltaX;top+=arg.deltaY;self._scroll(Math.floor(left),Math.floor(top));self._trigger("scrolled",null,arg);speedY*=rateY;speedX*=rateX;if(Math.abs(speedY)>stopTimerSpeed&&top>0||Math.abs(speedX)>stopTimerSpeed&&left>0){inertia()}else{self._end()}},tick*3)};inertia()},_show:function(valid){var bar,self=this,o=self.options,val=parseFloat(o.thumbOpacity),valDrag=parseFloat(o.thumbOpacityDrag),dur=valid?0:_num(o.animateShowDuration),barX=_valid(self.barX),barY=_valid(self.barY);if(self.hiding){self.hiding.stop(true);delete self.hiding}if(_zero(dur)){if(barX){barX.css("opacity",self.inBarX?valDrag:val)}if(barY){barY.css("opacity",self.inBarY?valDrag:val)}return}bar=barX||barY;if(bar){self.showing=bar.animate({opacity:val},{duration:dur,complete:function(){delete self.showing},step:function(now){if(barX&&barY){barY.css("opacity",now)}}})}},_hide:function(hide){var self=this;if(!self.time){return}if(self.showing){self.showing.stop(true);delete self.showing}setTimeout(function(){if(self.hiding||hide){_remove(self.barX);_remove(self.barY);delete self.hiding;self._fixSB()}},0)},_end:function(){var self=this,o=self.options,delay=self.thumbX&&_draggable(o.xThumb)||self.thumbY&&_draggable(o.yThumb),dur=_num(o.animateHideDuration);self._trigger("stopped",null,{owner:self});if(self.skip||!self._vis()){return self._hide(true)}delay=_num(delay?o.hideDragThumbsDelay:o.hideThumbsDelay);self.timerEnd=setTimeout(function(){if(!self.timer&&self.timerEnd){if(_zero(dur)){self._hide(true)}else{var bar=_valid(self.barX),bar2=_valid(self.barY);if(!bar){bar=bar2;bar2=null}if(bar){self.hiding=bar.animate({opacity:0},{duration:dur,complete:function(){self._hide()},step:function(now){if(bar2){bar2.css("opacity",now)}if(self.skip&&self.hiding){self.hiding.stop()}}})}}}delete self.timerEnd},_zero(delay)?5:delay)},_clear:function(){if(this.timer){clearTimeout(this.timer);delete this.timer}if(this.timerEnd){clearTimeout(this.timerEnd);delete this.timerEnd}},_fire:function(t,e,x,y){return this._trigger(t,e,{owner:this,left:x,top:y})},_skip:function(x,y){var dir=this.options.direction,left=this._scroller(true)||0,top=this._scroller()||0,height=0,width=0,heightScroll=0,widthScroll=0;if(left){width=left.clientWidth;widthScroll=left.scrollWidth;left=left.scrollLeft}if(top){height=top.clientHeight;heightScroll=top.scrollHeight;top=top.scrollTop}if((dir==="y"||width>=widthScroll)&&(dir==="x"||height>=heightScroll)){return true}if((Math.abs(y)>Math.abs(x)||dir==="y")&&dir!=="x"){return y>0&&!top||y<0&&top+height>=heightScroll}return x>0&&!left||x<0&&left+width>=widthScroll},_fixSB:function(hide){var vert,hor,on=this._on;if(hide&&on||!on&&!hide){return}vert=this._scroller();hor=this._scroller(true);if(on){if(vert&&!_aNull(on.y)){vert.style.overflowY=on.y}if(hor&&!_aNull(on.x)){hor.style.overflowX=on.x}delete this._on;return}on=this._on={};if(vert){on.y=$(vert).css("overflowY");vert.style.overflowY="hidden"}if(hor){on.x=$(hor).css("overflowX");hor.style.overflowX="hidden"}},_move:function(evt,end){if(!this.evts){return}var speed,arg={owner:this},time=(new Date).getTime(),self=this,maxSpeed=3,oldX=self.x0,oldY=self.y0,speedX=self.speedX,speedY=self.speedY,oldTop=self.top,oldLeft=self.left,inBarY=self.inBarY,inBarX=self.inBarX,barX=self.barX,barY=self.barY,start=!self.drag,elem=self.element,touch=self._pointer?evt.originalEvent:_touch(evt),x=touch?touch.pageX:0,y=touch?touch.pageY:0,src=_src(evt);if(self.click&&self._pointer&&Math.abs(self.x-x)<3&&Math.abs(self.y-y)<3){return}delete self.click;if(self.skip){return}self._fixSB(true);self._clear();if(end||!touch){if(!self.skip&&end==="end"&&!start){if(self.inBarX||self.inBarY){self._end()}else{self._inertia()}}delete self.drag;return}if(start){self.skip=self._skip(x-self.x,y-self.y);if(self.skip){self._end()}}else{arg.deltaX=self.x-x;arg.deltaY=self.y-y}if(self.skip||!this._trigger(start?"starting":"scrolling",evt,arg)){return}if(start){speed=_valid(barX)||_valid(barY);oldX=self.x0=x;oldLeft=self.left=self._getScroll(true);delete self.speedX;barX=self._bar(elem,true);inBarX=self.inBarX=_is(barX,src);oldY=self.y0=y;oldTop=self.top=self._getScroll();delete self.speedY;barY=self._bar(elem);inBarY=self.inBarY=_is(barY,src);self._show(speed||inBarX||inBarY)}else{x=self.x-arg.deltaX;speed=(x-self.x)/(time-self.time);if(Math.abs(speed)>maxSpeed){speed=speed>0?maxSpeed:-maxSpeed}if(!speedX){self.speedX=[0,0,speed]}else{speedX[0]=speedX[1];speedX[1]=speedX[2];speedX[2]=speed}y=self.y-arg.deltaY;speed=(y-self.y)/(time-self.time);if(Math.abs(speed)>maxSpeed){speed=speed>0?maxSpeed:-maxSpeed}if(!speedY){self.speedY=[0,0,speed];if(self.dir){self.dir=Math.abs(speed)>=Math.abs(self.speedX[2])?"y":"x"}}else{speedY=self.speedY=[0,0,speed];speedY[0]=speedY[1];speedY[1]=speedY[2];speedY[2]=speed}}self.drag=true;self.x=x;self.y=y;self.time=time;_stop(evt);x=inBarX?oldLeft+Math.floor((x-oldX)*self.ratioX):oldLeft-x+oldX;y=inBarY?oldTop+Math.floor((y-oldY)*self.ratioY):oldTop-y+oldY;self._scroll(x,y);this._trigger(start?"started":"scrolled",evt)},destroy:function(){if(this.evts){this.element.unbind(this.evts);delete this.evts;if(this.showing){this.showing.stop(true)}if(this.hiding){this.hiding.stop(true)}this._clear();_remove(this.barX);_remove(this.barY);$.Widget.prototype.destroy.apply(this,arguments)}return this}});$.extend($.ui.igScroll,{version:"16.1.20161.1009"});$.ui.igScroll.defaults={thumbOpacityDrag:1,thumbOpacity:.5,animateShowDuration:300,animateHideDuration:500,hideThumbsDelay:200,hideDragThumbsDelay:1e3,xInertia:.8,yInertia:.85,marginLeft:2,marginRight:2,marginTop:2,marginBottom:2,xThumb:"show",yThumb:"show"};try{$(":jqmData(role='page')").live("pageshow",_find)}catch(ex){_find(true);$(document).bind("igcontrolcreated",function(event,args){var container=args.owner.scrollContainer();if(container.length===0&&args.owner.container){container=args.owner.container().find("[data-scroll]").eq(0)}container.igScroll({_find:true})})}})(jQuery);/*!@license
* Infragistics.Web.ClientUI Popover localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Popover){$.ig.Popover={};$.extend($.ig.Popover,{locale:{popoverOptionChangeNotSupported:"Changing the following option after igPopover has been initialized is not supported:",popoverShowMethodWithoutTarget:"The target parameter of the show function is mandatory when the selectors option is used"}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI jQuery Popover 16.1.20161.1009
 *
 * Copyright (c) 2013-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.2.js
 *  jquery.ui.core.js
 *  jquery.ui.widget.js
 *  infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igPopover",{css:{baseClasses:"ui-widget ui-igpopover",arrowBaseClass:"ui-igpopover-arrow ui-igpopover-arrow-",closeButtonClass:"ui-icon ui-icon-closethick ui-igpopover-close-button",titleClass:"ui-igpopover-title"},options:{closeOnBlur:true,direction:"auto",position:"auto",width:null,height:null,minWidth:60,maxWidth:200,maxHeight:200,animationDuration:150,contentTemplate:null,selectors:null,headerTemplate:{closeButton:false,title:null},showOn:"mouseenter",containment:null,appendTo:"body"},events:{showing:"showing",shown:"shown",hiding:"hiding",hidden:"hidden"},_create:function(){this._target=this.options.selectors===null||this.options.selectors===undefined?this.element:null;this._priorityDir=["bottom","top","right","left"];this._arrowDir=["top","bottom","left","right"];this._positions=["balanced","start","end"];this._directionIndex=-1;this._positionIndex=-1;this._forced=this.options.direction!=="auto"&&this.options.position!=="auto";this._visible=false;$(window).on("resize.popover",$.proxy(this._resizeHandler,this))},_createWidget:function(options,element){$.Widget.prototype._createWidget.apply(this,arguments);this.element=$(element);if(element&&element.nodeType!==undefined){this._renderPopover()}if(this.options.direction!=="auto"||this.options.position!=="auto"){this._getPrioritiesIndex()}},_setOption:function(key,value){switch(key){case"direction":this.options.direction=value;if(this.options.direction!=="auto"){this._getPrioritiesIndex()}this._forced=this.options.direction!=="auto"&&this.options.position!=="auto";this._resizeHandler();break;case"position":this.options.position=value;if(this.options.position!=="auto"){this._getPrioritiesIndex()}this._forced=this.options.direction!=="auto"&&this.options.position!=="auto";break;case"contentTemplate":if(typeof value==="string"){this.options.contentTemplate=value}break;case"animationDuration":if(typeof value==="number"){this.options.animationDuration=value}break;case"containment":if(value instanceof jQuery){this.options.containment=value}break;case"closeOnBlur":this.options.closeOnBlur=value;break;case"headerTemplate":case"selectors":case"width":case"height":case"maxWidth":case"maxHeight":case"minWidth":case"showOn":throw new Error($.ig.Popover.locale.popoverOptionChangeNotSupported+" "+key)}},destroy:function(){this._detachEventsFromTarget();$(window).off("resize.popover",this._resizeHandler);this.popover.remove();$.Widget.prototype.destroy.call(this);return this},id:function(){return this.element[0].id},container:function(){return this.contentInner},show:function(trg,content){var target=trg||this._target;if(content){this._setNewContent(content)}if(target===null){throw new Error($.ig.Popover.locale.popoverShowMethodWithoutTarget)}this._openPopover(target)},hide:function(){this._closePopover()},getContent:function(){return this.contentInner.html()},setContent:function(newCnt){if(typeof newCnt==="string"){this._setNewContent(newCnt)}},target:function(){if(this._currentTarget){return this._currentTarget}return null},getCoordinates:function(){var currPosition={left:0,top:0};currPosition.left=this.popover.css("left");currPosition.top=this.popover.css("top");return currPosition},setCoordinates:function(pos){this.popover.css({top:pos.top,left:pos.left})},_renderPopover:function(){this.popover=$("<div></div>").addClass(this.css.baseClasses);if(this.id()){this.popover.attr("id",this.id()+"_popover")}if(this.options.direction!=="auto"){this._getPrioritiesIndex();this.arrow=$("<div></div>").addClass(this.css.arrowBaseClass+this._arrowDir[this._directionIndex]).appendTo(this.popover);if(this.id()){this.arrow.attr("id",this.id()+"_popover_arrow")}}this.popover.appendTo(this.options.appendTo);this._attachEventsToTarget();this._createContentDiv()},_createContentDiv:function(){var cnt,currContent,rightMargin,isTouchDeviceWithIE=this._isTouchDevice()&&$.ig.util.isIE;cnt=$("<div></div>").css("position","relative").css("max-width",this.options.maxWidth).css("max-height",this.options.maxHeight).css("min-width",this.options.minWidth).css("width",isTouchDeviceWithIE?"auto":this.options.width||"auto").css("height",isTouchDeviceWithIE?"auto":this.options.height||"auto").addClass("ui-widget-content ui-corner-all").appendTo(this.popover);if(this.id()){cnt.attr("id",this.id()+"_popover_contentFrame")}if(this.options.headerTemplate!==null){if(this.options.headerTemplate.closeButton){var closeBtn=$("<div></div>").addClass(this.css.closeButtonClass).bind("click.popover",$.proxy(this._closeBtnClick,this)).appendTo(cnt);if(this.id()){closeBtn.attr("id",this.id()+"_popover_closeBtn")}}if(this.options.headerTemplate.title!==null){var title=$("<div></div>").addClass(this.css.titleClass).html(this.options.headerTemplate.title).appendTo(cnt);if(this.id()){title.attr("id",this.id()+"_popover_title")}}}currContent=this.options.contentTemplate;if((typeof currContent==="string"||!currContent)&&this._target){currContent=this.options.contentTemplate||this._target[0].title||""}else if(this.options.selectors!==null&&!this._target&&!currContent){this.options.contentTemplate=function(){return $(this).attr("title")}}else if(typeof currContent==="function"&&this._target){currContent=this.options.contentTemplate.call(this._target[0],function(){return})}rightMargin=this.options.headerTemplate.closeButton&&(this.options.headerTemplate.title===null||this.options.headerTemplate.title==="")?$(".ui-icon").width():null;this.contentInner=$("<div></div>").css("position","relative").css("margin-right",rightMargin).html(currContent).appendTo(cnt);if(this.id()){this.contentInner.attr("id",this.id()+"_popover_contentInner")}$("<div></div>").css("clear","both").appendTo(cnt)},_updateArrowDiv:function(nDir,idx,trg){var conDiv=this.contentInner.parent(),dims;if(!this.arrow){this.arrow=$("<div></div>").addClass(this.css.arrowBaseClass+this._arrowDir[idx]).appendTo(this.popover);if(this.id()){this.arrow.attr("id",this.id()+"_popover_arrow")}}else{this.arrow.removeClass("ui-igpopover-arrow-left ui-igpopover-arrow-right ui-igpopover-arrow-bottom ui-igpopover-arrow-top").addClass(this.css.arrowBaseClass+this._arrowDir[idx])}dims=this._getHiddenElementsDimensions([this.arrow,conDiv],trg);switch(nDir){case"top":conDiv.css({left:"",top:dims[0].height*-1,"float":""});this.arrow.css({left:"",top:"","float":""});break;case"bottom":conDiv.css({left:"",top:dims[0].height,"float":""});this.arrow.css({left:"",top:"","float":""});break;case"left":conDiv.css({left:dims[0].width*-1,top:"","float":"left"});this.arrow.css({left:"",top:"","float":"left"});break;case"right":conDiv.css({left:dims[0].width,top:"","float":"left"});this.arrow.css({left:"",top:"","float":"left"});break}this.oDir=nDir},_targetMouseLeave:function(){this._hoveredTarget=null;if(this.options.closeOnBlur===true){this._closePopover()}},_targetMouseMove:function(trg){var self=this;if(this._target){this._openPopover($(this._target))}else{$(trg.currentTarget).addClass("is-hover");setTimeout(function(){if(self._hoveredTarget===trg.currentTarget){self._openPopover($(trg.currentTarget));$(trg.currentTarget).removeClass("is-hover")}},self.options.animationDuration);this._hoveredTarget=trg.currentTarget}},_targetClick:function(trg){var t=this._target||trg.currentTarget;if($(t).data("onFocus")&&this.container().is(":visible")){this._closePopover();$(t).data("onFocus",false)}else{this._openPopover($(t));$(t).focus();$(t).data("onFocus",true)}},_targetBlur:function(trg){var t=this._target||trg.currentTarget,self=this;setTimeout(function(){if($(t).data("onFocus")){if(self.options.closeOnBlur===true){self._closePopover();$(t).data("onFocus",false)}}},10)},_focusin:function(trg){var t=this._target||trg.currentTarget;this._openPopover($(t))},_focusout:function(){if(this.options.closeOnBlur===true){this._closePopover()}},_closeBtnClick:function(event){this._closePopover();event.stopPropagation()},_resizeHandler:function(){if(this._visible&&this._currentTarget){this._positionPopover(this._currentTarget)}},_attachEventsToTarget:function(){var self=this,t=this._target,showEvt,hideEvt,targetShowEvt,targetHideEvt;if(this.options.showOn&&this.options.showOn.match(/click|focus|mouseenter/)){switch(this.options.showOn){case"click":showEvt="click.popover";hideEvt="blur.popover";targetShowEvt=self._targetClick;targetHideEvt=self._targetBlur;break;case"focus":showEvt="focusin.popover";hideEvt="focusout.popover";targetShowEvt=self._focusin;targetHideEvt=self._focusout;break;case"mouseenter":showEvt="mouseenter.popover";hideEvt="mouseleave.popover";targetShowEvt=self._targetMouseMove;targetHideEvt=self._targetMouseLeave;break}}if(t&&(window.HTMLElement!==undefined&&(t instanceof HTMLElement||t instanceof jQuery)&&showEvt||typeof t[0]==="object"&&t[0].nodeType===1&&typeof t[0].style==="object"&&typeof t[0].ownerDocument==="object")){$(t).unbind(showEvt).bind(showEvt,$.proxy(targetShowEvt,this));$(t).unbind(hideEvt).bind(hideEvt,$.proxy(targetHideEvt,this))}else if(this.options.selectors&&showEvt){this.element.find(self.options.selectors).addBack().each(function(){var target=$(this)[0];if(target===self.element[0]){return}$(target).unbind(showEvt).bind(showEvt,$.proxy(targetShowEvt,self));$(target).unbind(hideEvt).bind(hideEvt,$.proxy(targetHideEvt,self))})}},_detachEventsFromTarget:function(){var t=this._target,self=this;if(t&&(window.HTMLElement!==undefined&&(t instanceof HTMLElement||t instanceof jQuery)||typeof t[0]==="object"&&t[0].nodeType===1&&typeof t[0].style==="object"&&typeof t[0].ownerDocument==="object")){$(t).unbind(".popover")}else if(this.options.selectors){this.element.find(self.options.selectors).addBack().each(function(){var target=$(this);$(target).unbind(".popover")})}},_positionPopover:function(trg){var i=0,fn,fnRes;if(this.options.direction==="auto"){do{this._updateArrowDiv(this._priorityDir[i],i,trg);fn="_"+this._priorityDir[i]+"Position";fnRes=this[fn](trg);i++}while(fnRes===false&&i<this._priorityDir.length);if(fnRes===false){return}}else{this._updateArrowDiv(this.options.direction,this._directionIndex,trg);fn="_"+this.options.direction+"Position";if(!this[fn](trg)){this._forced=true;do{this._updateArrowDiv(this._priorityDir[i],i,trg);fn="_"+this._priorityDir[i]+"Position";fnRes=this[fn](trg);i++}while(fnRes===false&&i<this._priorityDir.length);return}}},_findProperPosition:function(dir,x,trg){var fnRes,y,cDim,cPos,win=$(window),trgFDim,wScroll,boundary,countainmentBoundary,leftOffset,$containment,oParent=trg.offsetParent(),useParentOffset=false,rightOffset=$.ig.util.offset(trg).left+trg.outerWidth(),parentRightOffset=$.ig.util.offset(oParent).left+oParent.outerWidth();if(dir==="left"){cPos="left";cDim="outerWidth";wScroll=win.scrollLeft()}else{cPos="top";cDim="outerHeight";wScroll=win.scrollTop()}boundary=wScroll+(cDim==="outerWidth"?win.width():win.height());$containment=this.options.containment;if(this.options.containment){countainmentBoundary=$.ig.util.offset($containment)[cPos];if(cDim==="outerWidth"){countainmentBoundary=countainmentBoundary+$containment.outerWidth()}else{countainmentBoundary=countainmentBoundary+$containment.outerHeight()}if(boundary>countainmentBoundary){boundary=countainmentBoundary}}if($.ig.util.offset(trg)[cPos]+trg[cDim]()>boundary){trgFDim=boundary-$.ig.util.offset(trg)[cPos]}else if(cPos==="left"&&$.ig.util.offset(trg)[cPos]<$.ig.util.offset(oParent)[cPos]&&rightOffset>parentRightOffset){trgFDim=oParent[cDim]();useParentOffset=true}else if(cPos==="left"&&$.ig.util.offset(trg)[cPos]<parentRightOffset&&rightOffset>parentRightOffset){trgFDim=parentRightOffset-$.ig.util.offset(trg)[cPos]}else if(cPos==="left"&&$.ig.util.offset(trg)[cPos]<$.ig.util.offset(oParent)[cPos]&&$.ig.util.offset(oParent)[cPos]<rightOffset){trgFDim=rightOffset-$.ig.util.offset(oParent)[cPos];useParentOffset=true}else{trgFDim=trg[cDim]()}if(trgFDim>this.popover[cDim]()){leftOffset=useParentOffset?$.ig.util.offset(oParent)[cPos]:$.ig.util.offset(trg)[cPos];y=leftOffset+trgFDim/2-this.popover[cDim]()/2;fnRes=dir==="left"?this._checkCollision(x,y,trg):this._checkCollision(y,x,trg)}else{fnRes=this._cyclePossiblePositions(trg,dir,cPos,cDim,trgFDim,useParentOffset,x)}if(fnRes===false&&!this.options.containment){fnRes=this._cyclePossiblePositions(trg,dir,cPos,cDim,trgFDim,useParentOffset,x,true)}if(fnRes===true){this._adjustArrowPosition(trg,dir,cPos,cDim,trgFDim,useParentOffset)}return fnRes},_cyclePossiblePositions:function(trg,dir,cPos,cDim,trgFDim,useParentOffset,x,useDocument){var i=0,y,tPos,fnRes;if(this.options.position==="auto"){do{tPos=this._positions[i];y=this._getCounterPosition(trg,trgFDim,tPos,cPos,cDim,useParentOffset);fnRes=dir==="left"?this._checkCollision(x,y,trg,useDocument):this._checkCollision(y,x,trg,useDocument)}while(fnRes===false&&++i<this._positions.length)}else{y=this._getCounterPosition(trg,trgFDim,this.options.position,cPos,cDim,useParentOffset);fnRes=dir==="left"?this._checkCollision(x,y,trg,useDocument):this._checkCollision(y,x,trg,useDocument)}return fnRes},_getCounterPosition:function(trg,trgFDim,tPos,cPos,cDim,useParentOffset){var y,offset=useParentOffset?$.ig.util.offset(trg.offsetParent())[cPos]:$.ig.util.offset(trg)[cPos];switch(tPos){case"balanced":y=offset+trgFDim/2-this.popover[cDim]()/2;break;case"start":y=offset;break;case"end":y=offset-this.popover[cDim]()+trgFDim;break}return y},_topPosition:function(trg){var top=$.ig.util.offset(trg).top-this.popover.outerHeight(),parentTop=$.ig.util.offset(trg.offsetParent()).top-this.popover.outerHeight();if(top<parentTop){top=parentTop}return this._findProperPosition("left",top,trg)},_bottomPosition:function(trg){var bottom=$.ig.util.offset(trg).top+trg.outerHeight(),parentBottom=$.ig.util.offset(trg.offsetParent()).top+trg.offsetParent().outerHeight();if(bottom>parentBottom){bottom=parentBottom}return this._findProperPosition("left",bottom,trg)},_leftPosition:function(trg){var left=$.ig.util.offset(trg).left-this.popover.outerWidth(),parentLeft=$.ig.util.offset(trg.offsetParent()).left-this.popover.outerWidth();if(left<parentLeft){left=parentLeft}return this._findProperPosition("top",left,trg)},_rightPosition:function(trg){var right=$.ig.util.offset(trg).left+trg.outerWidth(),parentRight=$.ig.util.offset(trg.offsetParent()).right+trg.outerWidth();if(right>parentRight){right=parentRight}return this._findProperPosition("top",right,trg)},_checkCollision:function(top,left,trg,useDocument){var tfullw=this.popover.outerWidth(),tfullh=this.popover.outerHeight(),win=$(window),wh,ww,os,$containment,rightBoundary,bottomBoundary,leftBoundary,topBoundary;ww=win.width()+win.scrollLeft();wh=win.height()+win.scrollTop();rightBoundary=ww;bottomBoundary=wh;leftBoundary=win.scrollLeft();topBoundary=win.scrollTop();$containment=this.options.containment;if(this.options.containment){if(leftBoundary<$.ig.util.offset($containment).left){leftBoundary=$.ig.util.offset($containment).left}if($.ig.util.offset($containment).left+$containment.outerWidth()<rightBoundary){rightBoundary=$.ig.util.offset($containment).left+$containment.outerWidth()}if(bottomBoundary>$.ig.util.offset($containment).top+$containment.outerHeight()){bottomBoundary=$.ig.util.offset($containment).top+$containment.outerHeight()}if(topBoundary<$.ig.util.offset($containment).top){topBoundary=$.ig.util.offset($containment).top}}if(useDocument){leftBoundary=0;rightBoundary=$(document).width();bottomBoundary=$(document).height();topBoundary=0}if(left<leftBoundary){if(this.oDir==="left"){return false}left=leftBoundary}if($.ig.util.offset(trg).left+tfullw/2>rightBoundary&&this.options.direction!=="right"){left=rightBoundary-tfullw}if($.ig.util.offset(trg).top+tfullh+this.arrow.height()>bottomBoundary&&this.oDir==="bottom"||$.ig.util.offset(trg).top-tfullh-this.arrow.height()<topBoundary&&this.oDir==="top"){if(this.options.selectors){return false}}if(left<leftBoundary||left+tfullw>rightBoundary||top<topBoundary||top+tfullh>bottomBoundary){if(this._forced===false){return false}}if(!$(this.options.appendTo).is("body")&&this._target){os=$.ig.util.getRelativeOffset(this.popover);top=top-os.top;left=left-os.left}this.popover.css({top:top,left:left});return true},_getPrioritiesIndex:function(){var i;if(this.options.direction!=="auto"){for(i=0;i<this._priorityDir.length;i++){if(this.options.direction===this._priorityDir[i]){this._directionIndex=i;break}}}if(this.options.position!=="auto"){for(i=0;i<this._positions.length;i++){if(this.options.position===this._positions[i]){this._positionIndex=i;break}}}},_openPopover:function(trg){var args,noCancel,val=this.getContent(),self=this,contentFunc;args={element:trg,content:val,popover:this.popover,owner:this};$(this.popover).data("isAnimating",true);noCancel=this._trigger(this.events.showing,this,args);if(noCancel===true){self._restoreOriginalTitle(self._currentTarget);if(args.content!==val){this._setNewContent(args.content)}else if(typeof this.options.contentTemplate==="function"){contentFunc=this.options.contentTemplate;args.content=contentFunc.call(trg[0],function(){return});this._setNewContent(args.content||"")}this._positionPopover(trg);this._currentTarget=trg;$(this.popover).data("isAnimating",false);this.popover.stop(true,true).fadeIn(this.options.animationDuration,function(){self.popover.css("display","block");self._trigger(self.events.shown,self,args)});this._visible=true;this._removeOriginalTitle(trg)}},_closePopover:function(){var args,noCancel,self=this;args={element:this._currentTarget,content:this.getContent(),popover:this.popover,owner:this};$(this.popover).data("isAnimating",true);noCancel=this._trigger(this.events.hiding,this,args);if(noCancel===true){$(this.popover).data("isAnimating",false);this.popover.stop(true,true).fadeOut(this.options.animationDuration,function(){self.popover.css("display","none");self._trigger(self.events.hidden,self,args)});this._visible=false}},_mouseenter:function(e){this._removeOriginalTitle($(e._currentTarget))},_removeOriginalTitle:function(element){while(element.length&&!element.is("body")){if(element.attr("title")){element.data("popover-title",element.attr("title"));element.attr("title","")}element=element.parent()}},_restoreOriginalTitle:function(element){if(element&&element.data("popover-title")){element.attr("title",element.data("popover-title"));element.removeData("popover-title")}},_adjustArrowPosition:function(trg,dir,cPos,cDim,trgFDim,useParentOffset){var offset={left:0,top:0},left,leftOffset=useParentOffset?$.ig.util.offset(trg.offsetParent())[cPos]:$.ig.util.offset(trg)[cPos];if(!$(this.options.appendTo).is("body")&&this._target){offset=$.ig.util.getRelativeOffset(this.popover)}if(dir==="top"){this.arrow.css({top:$.ig.util.offset(trg)[cPos]-parseInt(this.popover.css(cPos),10)-offset.top+trgFDim/2-this.arrow.height()/2})}else{left=leftOffset-parseInt(this.popover.css(cPos),10)-offset.left+trgFDim/2;left=left<parseInt(this.arrow.css("border-left-width"),10)?parseInt(this.arrow.css("border-left-width"),10):left;this.arrow.css({left:left})}},_getHiddenElementsDimensions:function(elArr,trg){var dim=[],i,elem;if(this.options.containment===null){this.popover.css("left",trg.position().left);this.popover.css("top",trg.position().top)}if(!this._visible){this.popover.show()}for(i=0;i<elArr.length;i++){elem=elArr[i];dim.push({width:elem.outerWidth(),height:elem.outerHeight()})}if(!this._visible){this.popover.hide()}return dim},_setNewContent:function(nc){var newContent=nc;if(nc instanceof jQuery){newContent=nc.html()}else if(typeof nc==="object"){newContent=nc.innerHTML}this.contentInner.html(newContent)},_isTouchDevice:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}});if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector===null||selector===undefined?this.prevObject:this.prevObject.filter(selector))}}$.extend($.ui.igPopover,{version:"16.1.20161.1009"})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Notifier localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Notifier){$.ig.Notifier={};$.extend($.ig.Notifier,{locale:{successMsg:"Success",errorMsg:"Error",warningMsg:"Warning"}})}})(jQuery);/*!@license
* Infragistics.Web.ClientUI jQuery Notifier 16.1.20161.1009
*
* Copyright (c) 2013-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on:
*  jquery-1.4.2.js
*  jquery.ui.core.js
*  jquery.ui.widget.js
*  infragistics.util.js
*  infragistics.ui.popover.js
*/
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igNotifier",$.ui.igPopover,{css:{baseClasses:"ui-widget ui-igpopover ui-ignotify",contentInner:"ui-ignotify-content",inline:"ui-ignotify-inline",iconContainer:"ui-ignotify-icon-container",infoState:"ui-ignotify-info",infoIcon:"ui-icon ui-icon-info",successState:"ui-ignotify-success",successIcon:"ui-icon ui-icon-circle-check",warningState:"ui-ignotify-warn",warningIcon:"ui-icon ui-icon-alert",errorState:"ui-ignotify-error",errorIcon:"ui-icon ui-icon-circle-close"},options:{state:"info",notifyLevel:"success",appendTo:"body",mode:"auto",allowCSSOnTarget:true,messages:{success:"Success",info:"",warning:"Warning",error:"Error"},showIcon:false,contentTemplate:"<span class='{0}'><span class='{1}'></span></span>{2}",headerTemplate:{closeButton:true,title:null},showOn:"manual",closeOnBlur:false,animationDuration:250,animationSlideDistance:5},inlineStates:["success","error"],_create:function(){$.ui.igPopover.prototype._create.apply(this,arguments);this._priorityDir=["top","left","right","bottom"];this._arrowDir=["bottom","right","left","top"];this._states=["success","info","warning","error"];this._modes=["auto","popover","inline"];this._currentText=this.options.messages[this.options.state]},_createWidget:function(options){var messageDefaults={success:$.ig.Notifier&&$.ig.Notifier.locale?$.ig.Notifier.locale.successMsg:"Success",info:"",warning:$.ig.Notifier&&$.ig.Notifier.locale?$.ig.Notifier.locale.warningMsg:"Warning",error:$.ig.Notifier&&$.ig.Notifier.locale?$.ig.Notifier.locale.errorMsg:"Error"};this.options.messages=$.extend(messageDefaults,options&&options.messages||{});$.ui.igPopover.prototype._createWidget.apply(this,arguments)},_setState:function(value,message){if($.inArray(value,this._states)===-1){console.log("Supported states: "+this._states.join(", "));return}if(message!==undefined){this._currentText=message}if(this.options.state!==value){this._currentText=message!==undefined?this._currentText:this.options.messages[value];this._previousState=this.options.state;this.options.state=value;if(this._visible){this._setTargetState()}if(this._isInline(value)!==this._isInline(this._previousState)){this._setMode(this.options.mode,true);return}}this.popover.removeClass(this.css[this._previousState+"State"]).addClass(this.css[this.options.state+"State"]);this._setNewContent(this.options.contentTemplate)},_setTargetState:function(clean){this._target.removeClass(this.css[this._previousState+"State"]).removeClass(this.css[this.options.state+"State"]);if(this.options.allowCSSOnTarget&&!clean){this._target.addClass(this.css[this.options.state+"State"])}},_setOption:function(key,value){switch(key){case"state":this._setState(value);if(this._visible&&!this._isInline()){this._positionPopover(this._target);this._slide()}break;case"mode":if(typeof value==="string"){this._setMode(value)}break;case"contentTemplate":if(typeof value==="string"){this.options.contentTemplate=value;this._setNewContent(this.options.contentTemplate)}break;case"messages":if(typeof value==="object"){this.options.messages=$.extend(this.options.messages,value);this._currentText=this.options.messages[this.options.state];this._setNewContent(this.options.contentTemplate);if(this._visible&&!this._isInline()){this._positionPopover(this._target);this._slide()}}break;case"allowCSSOnTarget":if(typeof value==="boolean"){this.options.allowCSSOnTarget=value;if(this._visible){this._setTargetState(!value)}}break;case"showIcon":this.options.showIcon=value;if(this._visible){this._setNewContent(this.options.contentTemplate)}break}$.ui.igPopover.prototype._setOption.apply(this,arguments)},_setMode:function(value,force){if($.inArray(value,this._modes)===-1){console.log("Supported modes: "+this._modes.join(", "));return}if(this.options.mode!==value||force){this.popover.remove();delete this.arrow;this.options.mode=value;this._renderPopover();if(this._visible){if(!this._isInline()){this._positionPopover(this._target)}this.popover.show();this._slide()}}},_isInline:function(state){var target=state||this.options.state;if(this.options.mode==="inline"){return true}else{return this.options.mode==="auto"&&$.inArray(target,this.inlineStates)>-1}},notify:function(state,message){if($.inArray(state,this._states)>=$.inArray(this.options.notifyLevel,this._states)){if(!this._visible||this.options.state!==state||this._currentText!==message){this._setState(state,message);this.show()}}else{this.hide();this._setState(state,message)}},isVisible:function(){return this._visible},_renderPopover:function(){if(this._isInline()){this.popover=$("<div></div>").addClass(this.css.baseClasses).addClass(this.css.inline);this.contentInner=$("<div></div>").appendTo(this.popover);this.popover.insertAfter(this._target);this._attachEventsToTarget()}else{$.ui.igPopover.prototype._renderPopover.apply(this,arguments)}this._setState(this.options.state);this.contentInner.addClass(this.css.contentInner)},_openPopover:function(){var initialState=this._visible;this._visible=false;$.ui.igPopover.prototype._openPopover.apply(this,arguments);if(this._visible){var change=this._visible!==initialState;this._slide(!change);if(change){this._setTargetState()}}else{this._visible=initialState}},_slide:function(quick){if(!this.options.animationSlideDistance||!this.oDir||this._isInline()){return}var slideAnimation;switch(this.oDir){case"top":slideAnimation={top:"-="+this.options.animationSlideDistance+"px"};break;case"bottom":slideAnimation={top:"+="+this.options.animationSlideDistance+"px"};break;case"left":slideAnimation={left:"-="+this.options.animationSlideDistance+"px"};break;case"right":slideAnimation={left:"+="+this.options.animationSlideDistance+"px"};break}this.popover.animate(slideAnimation,{queue:false,duration:quick?0:this.options.animationDuration})},_resizeHandler:function(event){if(this._visible&&this._currentTarget){this._positionPopover(this._currentTarget);this._slide(event)}},_attachEventsToTarget:function(){if(this.options.showOn!=="manual"){$.ui.igPopover.prototype._attachEventsToTarget.apply(this,arguments)}},_closePopover:function(){var initialState=this._visible;$.ui.igPopover.prototype._closePopover.apply(this,arguments);if(!this._visible&&this._visible!==initialState){this._setTargetState(true)}},_positionPopover:function(){if(!this._isInline()){$.ui.igPopover.prototype._positionPopover.apply(this,arguments)}},_setNewContent:function(nc){var newContent=nc;if(nc instanceof jQuery){newContent=nc.html()}else if(typeof nc==="object"){newContent=nc.innerHTML}newContent=newContent.replace("{0}",this.css.iconContainer).replace("{1}",this.options.showIcon?this.css[this.options.state+"Icon"]:"").replace("{2}",this._currentText);this.contentInner.html(newContent)},destroy:function(){this._setTargetState(true);$.ui.igPopover.prototype.destroy.apply(this,arguments);return this}});$.extend($.ui.igNotifier,{version:"16.1.20161.1009"})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Validator localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Validator){$.ig.Validator={locale:{defaultMessage:"This field needs attention",selectMessage:"A value should be selected",rangeSelectMessage:"At least {0} but no more than {1} items should be selected",minSelectMessage:"At least {0} item(s) should be selected",maxSelectMessage:"No more than {0} item(s) should be selected",rangeLengthMessage:"Entry should be between {0} and {1} characters long",minLengthMessage:"Entry should be at least {0} character(s) long",maxLengthMessage:"Entry should be no more than {0} character(s) long",requiredMessage:"This field is required",patternMessage:"Entry does not match the required pattern",maskMessage:"All required positions should be filled",dateFieldsMessage:"Date field values should be entered",invalidDayMessage:"A valid day of the month should be entered",dateMessage:"A valid date should be entered",numberMessage:"A valid number should be entered",rangeValueMessage:"A value between {0} and {1} should be entered",minValueMessage:"A value of at least {0} should be entered",maxValueMessage:"A value no more than {0} should be entered",emailMessage:"A valid email address should be entered",equalToMessage:"The two values do not match",optionalString:"(optional)"}}}})(jQuery);/*!@license
* Infragistics.Web.ClientUI Editors 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
* Depends on:
* jquery-1.4.4.js
* jquery.ui.core.js
* jquery.ui.widget.js
* infragistics.util.js
* infragistics.ui.popover.js
* infragistics.ui.notifier.js

* Example to use:
*	<script type="text/javascript">
*	$(function () {
*		$('#text1').igValidator({ minLength: 3 });
*	});
*	</script>
*	<input id="text1" type="text" />
*/
(function($){$.widget("ui.igValidator",{options:{onchange:false,onblur:true,onsubmit:true,required:false,number:false,date:false,email:false,lengthRange:null,valueRange:null,pattern:null,messageTarget:null,errorMessage:null,successMessage:null,threshold:-1,equalTo:null,custom:null,fields:[{selector:null}],notificationOptions:null,requiredIndication:false,optionalIndication:false},css:{target:"ui-igvalidator-target",requiredIndication:"ui-igvalidator-required-indication",optionalIndication:"ui-igvalidator-optional-indication"},events:{validating:"validating",validated:"validated",success:"success",error:"error",errorShowing:"errorShowing",errorHiding:"errorHiding",errorShown:"errorShown",errorHidden:"errorHidden",successShowing:"successShowing",successHiding:"successHiding",successShown:"successShown",successHidden:"successHidden",formValidating:"formValidating",formValidated:"formValidated",formError:"formError",formSuccess:"formSuccess"},locale:{defaultMessage:"Please fix this field",selectMessage:"Please select a value",rangeSelectMessage:"Please select no more than {1} and not less than {0} items",minSelectMessage:"Please select at least {0} items",maxSelectMessage:"Please select no more than {0} items",rangeLengthMessage:"Please enter a value between {0} and {1} characters long",minLengthMessage:"Please enter at least {0} characters",maxLengthMessage:"Please enter no more than {0} characters",requiredMessage:"This field is required",patternMessage:"Please fix pattern of this field",maskMessage:"Please fill all required positions",dateFieldsMessage:"Please enter values in date fields",invalidDayMessage:"Invalid day of month. Please enter correct day",dateMessage:"Please enter a valid date",numberMessage:"Please enter a valid number",rangeValueMessage:"Please enter a value between {0} and {1}",minValueMessage:"Please enter a value greater than or equal to {0}",maxValueMessage:"Please enter a value less than or equal to {0}",emailMessage:"Please enter a valid email address",equalToMessage:"Values don't match",optionalString:"(optional)"},emailRegEx:/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,numberRegEx:"^-?[\\d]+({0}[\\d]+)?$",notifierDefaults:{state:"error"},_createWidget:function(){delete this.options.fields;$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._decimalSeparator=".";this._thousandsSeparator=",";this._formHandleCounter=0;this._fieldOptions=this.options.fields?$.extend([],this.options.fields):null;var shouldHandleForm=false;if(this.options.fields){for(var i=0;i<this.options.fields.length;i++){var options=this.options.fields[i];this._initializeField($(options.selector),options);if(options.onsubmit!==undefined?options.onsubmit:this.options.onsubmit){shouldHandleForm=true;this._formHandleCounter++}}}else{this._initializeField(this.element,this.options)}this._attachToForm(shouldHandleForm||this.options.onsubmit)},_setOption:function(option,value){switch(option){case"notificationOptions":this.options.notificationOptions=value;this._updateNotifiers();break;case"onchange":case"onblur":if(!this.options.fields&&!this.options._control){this.element.unbind(".validator");this._attachFieldEvents(this.element)}break;case"onsubmit":if(this.options.onsubmit===value){break}if(this.options.fields){for(var i=0;i<this.options.fields.length;i++){if(this.options.fields[i].onsubmit===undefined){if(value){if(!this._formHandleCounter){this._attachToForm(true)}this._formHandleCounter++}else if(!--this._formHandleCounter){this._detachFromForm()}}}}break;case"messageTarget":var oldVisible=this._fieldMessageVisible(this.options);this._clearMessageTarget(this.options);this._hideSuccess(this.options);this._hideError(this.options);this.options.messageTarget=value;this._evalMessageTarget(this.options);if(oldVisible){if(this.options.isValid){this._showSuccess(this.options,{message:this.options._currentMessage})}else{this._showError(this.options,{message:this.options._currentMessage})}}break;case"errorMessage":case"successMessage":this._hideError(this.options);this._hideSuccess(this.options);break;case"requiredIndication":case"optionalIndication":this._removeFieldIndications(this.options);this.options[option]=value;this._addFieldIndications(this.options,this.element);break;case"fields":return;default:break}$.Widget.prototype._setOption.apply(this,arguments)},_initializeField:function(element,options){var target=element;if(!target.length){options._ignored=true;return}options._control=this._getEditor(target);if(options._control){this._form=this._form||target.closest("form").get(0);if(options._control.widgetName==="igCombo"){options._type="selectrange"}else if(options._control.widgetName==="igRating"){options._type="select"}if(options._control._options){options._control._options.validator=this}else{options._control._validator=this}}else{var elemType=target[0].tagName;switch(elemType){case"INPUT":if(target[0].type==="checkbox"){options._group=this._findGroupTargets(target);options._type=options._group.length>1?"checkboxrange":"checkbox";target=options._group}else if(target[0].type==="radio"){options._group=this._findGroupTargets(target);options._type="radio";target=options._group}else{options._type="input"}break;case"TEXTAREA":options._type="textarea";break;case"SELECT":if(target[0].multiple){options._type="selectrange"}else{options._type="select"}break;case"FORM":this._form=this._form||target[0];options._ignored=true;return;default:this._form=this._form||target.closest("form").get(0);options._ignored=true;return}this._attachFieldEvents(target)}options._ignored=false;target.addClass(this.css.target);target.data("igValidatorField",options);options.notifyTarget=this._targetFromOptions(options,true);this._evalMessageTarget(options);this._ensureNotifier(options,true);this._addFieldIndications(target,options)},_findGroupTargets:function(target){if(target[0].name){return $("[name="+target[0].name+"]",target[0].form||document)}return target},_attachFieldEvents:function(element){var self=this,evts={"keyup.validator":function(e){if(e.keyCode!==9&&e.keyCode<15||e.keyCode>20){self._validateInternal(element,e)}},"change.validator":function(e){self._validateInternal(element,e)},"cut.validator":function(e){setTimeout(function(){self._validateInternal(element,e)},10)},"paste.validator":function(e){setTimeout(function(){self._validateInternal(element,e)},10)},"drop.validator":function(e){setTimeout(function(){self._validateInternal(element,e)},10)},"dragend.validator":function(e){setTimeout(function(){self._validateInternal(element,e)},10)},"blur.validator":function(e){self._validateInternal(element,e,true)}};element.bind(evts)},_ensureNotifier:function(options,reinit){if(reinit&&options.notifyTarget.data("igNotifier")){options.notifyTarget.igNotifier("destroy").unbind(".validator")}if(!options.notifyTarget.data("igNotifier")){var args={owner:this,target:options.notifyTarget};options.notifyTarget.igNotifier($.extend({},this.notifierDefaults,this.options.notificationOptions,options.notificationOptions)).bind({"ignotifiershowing.validator":function(evt,ui){return args.owner._handleNotifierEvent(evt,ui,"Showing",args)},"ignotifiershown.validator":function(evt,ui){return args.owner._handleNotifierEvent(evt,ui,"Shown",args)},"ignotifierhiding.validator":function(evt,ui){return args.owner._handleNotifierEvent(evt,ui,"Hiding",args)},"ignotifierhidden.validator":function(evt,ui){return args.owner._handleNotifierEvent(evt,ui,"Hidden",args)}})}},_updateNotifiers:function(){if(this.options.fields){for(var i=0;i<this.options.fields.length;i++){this._ensureNotifier(this.options.fields[i],true)}}else{this._ensureNotifier(this.options,true)}},_clearMessageTarget:function(options){if(options._$messageTarget){options._$messageTarget.removeClass("field-validation-valid field-validation-error").empty().css("display","")}},_evalMessageTarget:function(options){options._$messageTarget=options.messageTarget;if(typeof options._$messageTarget==="string"){var target=$("[data-valmsg-for='"+options._$messageTarget+"']");options._$messageTarget=target.length?target:$(options._$messageTarget)}if(options._$messageTarget instanceof $&&!options._$messageTarget.length){options._$messageTarget=null}},_addFieldIndications:function(element,options){if(options._group&&options._group.length>1||options._control&&options._control.widgetName==="igRating"){return}if(options.required&&options.requiredIndication){options._$indicator=element.after("<span title='"+this._getLocalizedMessage("required")+"' class='"+this.css.requiredIndication+"'>*</span>").next()}if(!options.required&&options.optionalIndication){options._$indicator=element.after("<span class='"+this.css.optionalIndication+"'>"+this._getLocalizedMessage("optional","String")+"</span>").next()}},_removeFieldIndications:function(options){if(options._$indicator){options._$indicator.hide();options._$indicator.remove();delete options._$indicator}},_attachToForm:function(shouldHandleForm){this._form=this._form||this.element[0].form||this.element.closest("form").get(0);if(!this._form||!shouldHandleForm){return}if(!this._form._igValidators||!this._form._igValidators.length){this._form._igValidators=[];$(this._form).bind("submit.validator",function(e){this._igErrorShown=false;var summaryResult=true,current;for(var i=0;i<this._igValidators.length;i++){current=this._igValidators[i]._validateForm(e);summaryResult=summaryResult?current:summaryResult}if(!summaryResult){e.preventDefault();e.stopPropagation()}})}this._form._igValidators.push(this)},_detachFromForm:function(){var index;if(this._form&&(index=$.inArray(this,this._form._igValidators))>-1){this._form._igValidators.splice(index,1);if(!this._form._igValidators.length){$(this._form).unbind("submit.validator")}}},_validate:function(field,evt,isSubmitting){var current,i,valid=true;if(this.options.fields){if(field!==undefined&&(i=this._fieldIndexOf(field))>-1){field=this.options.fields[i];valid=field.isValid=this._validateField(field,evt,isSubmitting)}else{for(i=0;i<this.options.fields.length;i++){field=this.options.fields[i];current=field.isValid=this._validateField(field,evt,isSubmitting);valid=valid?current:valid}}}else{valid=this._validateField(this.options,evt,isSubmitting);this.options.isValid=valid}return valid},_validateForm:function(evt){var valid=true,args={owner:this,target:$(evt.target)};if(this._trigger(this.events.formValidating,evt,args)){if(!$.ui.igValidator.defaults.showAllErrorsOnSubmit&&this._form&&this._form._igErrorShown){this._skipMessages=true}args.valid=valid=this._validate(null,evt,true);this._trigger(this.events.formValidated,evt,args);this._trigger(valid?this.events.formSuccess:this.events.formError,window.event,args)}return valid},_validateInternal:function(element,evt,blur,value){element=element||evt&&(element=$(evt.target).closest("."+this.css.target)).length||this.element;var field=element.data("igValidatorField");if(field){field.isValid=this._validateField(field,evt||{},false,value,blur);return field.isValid}if(value!==undefined){this.options.isValid=this._validateField(this.options,evt||{},false,value,blur);return this.options.isValid}else{return this._validate(null,evt||{})}},_validateField:function(opts,evt,isSubmitting,value,blur){if(opts._ignored){return true}var options=this._addGlobalSettings(opts);value=value!==undefined?value:this._getTargetValue(options);var min,max,isNumber=this._isNumber(options,value),isDateParsable=!isNaN(new Date(value).getSeconds()),isDate=value instanceof Date,hasLength=value!==undefined&&value!==null&&value.length!==undefined,internalValue=isNumber?value.toString():value;if(isSubmitting&&!options.onsubmit){return true}if(!this._forceValidation&&!isSubmitting){if(blur&&!options.onblur||!blur&&!options.onchange){return true}if(options.hasOwnProperty("threshold")&&hasLength&&value.length<=options.threshold){return true}}var args={value:value,owner:this,fieldOptions:options===this.options?null:opts};if(evt&&!this._trigger(this.events.validating,evt,args)){return true}opts._currentMessage=null;if(options.required&&(!internalValue||value.length===0)){switch(options._type){case"checkboxrange":case"radio":case"select":case"selectrange":opts._currentMessage=this._getRuleMessage(options,"required","select");break;default:opts._currentMessage=this._getRuleMessage(options,"required","required")}args.message=opts._currentMessage;args.rule="required";this._showError(options,args,evt);return false}else if(!options.required&&!internalValue){args.message=opts._currentMessage=options.successMessage;this._success(options,args,evt,isSubmitting);return true}if(options._control&&typeof options._control.isValid==="function"){var result=options._control.isValid();if(!result){opts._currentMessage=options.errorMessage||options._control._currentMessage||this._getLocalizedMessage("default");args.message=opts._currentMessage;args.rule="control";this._showError(options,args,evt);return false}}if(options.number&&!isNumber&&internalValue){opts._currentMessage=this._getRuleMessage(options,"number","number");args.message=opts._currentMessage;args.rule="number";this._showError(options,args,evt);return false}if(options.date&&!isDateParsable&&internalValue){opts._currentMessage=this._getRuleMessage(options,"date","date");args.message=opts._currentMessage;args.rule="date";this._showError(options,args,evt);return false}if(hasLength&&value.length&&options.lengthRange){var messageType=value.push?"Select":"Length",minLength=options.lengthRange.push?options.lengthRange[0]:options.lengthRange.min,maxLength=options.lengthRange.push?options.lengthRange[1]:options.lengthRange.max;min=minLength&&value.length<minLength;max=maxLength&&value.length>maxLength;if(minLength&&maxLength&&(min||max)){opts._currentMessage=this._getRuleMessage(options,"lengthRange","range"+messageType);opts._currentMessage=opts._currentMessage.replace("{0}",minLength).replace("{1}",maxLength);args.message=opts._currentMessage}else if(min){opts._currentMessage=this._getRuleMessage(options,"lengthRange","min"+messageType);opts._currentMessage=opts._currentMessage.replace("{0}",minLength);args.message=opts._currentMessage}else if(max){opts._currentMessage=this._getRuleMessage(options,"lengthRange","max"+messageType);opts._currentMessage=opts._currentMessage.replace("{0}",maxLength);args.message=opts._currentMessage}if(args.message){args.rule="lengthRange";this._showError(options,args,evt);return false}}if(options.valueRange&&(isDateParsable||isNumber)){var minValue=options.valueRange.push?options.valueRange[0]:options.valueRange.min,maxValue=options.valueRange.push?options.valueRange[1]:options.valueRange.max,hasMin=typeof minValue==="number"||minValue,hasMax=typeof maxValue==="number"||maxValue;if(hasMin||hasMax){if(isNumber&&!options.date){value=parseFloat(value);min=hasMin&&minValue;min=value<min?min.toString():null;max=hasMax&&maxValue;max=value>max?max.toString():null}if(isDateParsable&&(options.date||isDate)){value=new Date(value);if(hasMin){min=minValue=new Date(minValue);minValue=minValue.toLocaleString()}min=value<min?min.toLocaleString():null;if(hasMax){max=maxValue=new Date(maxValue);maxValue=maxValue.toLocaleString()}max=value>max?max.toLocaleString():null}if(hasMin&&hasMax&&(min||max)){opts._currentMessage=this._getRuleMessage(options,"valueRange","rangeValue");opts._currentMessage=opts._currentMessage.replace("{0}",min||minValue).replace("{1}",max||maxValue);args.message=opts._currentMessage}else if(min){opts._currentMessage=this._getRuleMessage(options,"valueRange","minValue");opts._currentMessage=opts._currentMessage.replace("{0}",min);args.message=opts._currentMessage}else if(max){opts._currentMessage=this._getRuleMessage(options,"valueRange","maxValue");opts._currentMessage=opts._currentMessage.replace("{0}",max);args.message=opts._currentMessage}if(args.message){args.rule="valueRange";this._showError(options,args,evt);return false}}}if(options.equalTo){var selector=options.equalTo.selector||options.equalTo,targetValue=this._getTargetValue({_control:this._getEditor($(selector)),selector:selector});if($.ig.util.compare(value,targetValue)){opts._currentMessage=this._getRuleMessage(options,"equalTo","equalTo");args.message=opts._currentMessage;args.rule="equalTo";this._showError(options,args,evt);return false}}if(options.email){if(!this.emailRegEx.test(value)){opts._currentMessage=this._getRuleMessage(options,"email","email");args.message=opts._currentMessage;args.rule="email";this._showError(options,args,evt);return false}}if(options.pattern){var regEx=options.pattern.expresion||options.pattern.expression||options.pattern;regEx=regEx.test?regEx:new RegExp(regEx.toString());if(!regEx.test(value)){opts._currentMessage=this._getRuleMessage(options,"pattern","pattern");args.message=opts._currentMessage;args.rule="pattern";this._showError(options,args,evt);return false}}if(options.custom){var func=options.custom.method||options.custom;if(typeof func==="string"){func=window[func]}if(typeof func==="function"&&!func.apply(this,[value,args.fieldOptions])){opts._currentMessage=this._getRuleMessage(options,"custom","default");args.message=opts._currentMessage;args.rule="custom";this._showError(options,args,evt);return false}}args.message=opts._currentMessage=options.successMessage;this._success(options,args,evt,isSubmitting);return true},_success:function(options,args,evt,isSubmitting){this._hideError(options);args.valid=true;if(evt){this._trigger(this.events.validated,evt,args);this._trigger(this.events.success,evt,args)}if(!isSubmitting){this._showSuccess(options,args,evt)}},_isNumber:function(options,value){if(typeof value==="number"){return true}else if(typeof value==="string"){var decimalSeparator=options.number&&options.number.decimalSeparator,thousandsSeparator=options.number&&options.number.thousandsSeparator,thousandsRegEx,regEx;decimalSeparator=decimalSeparator||this._decimalSeparator;thousandsSeparator=thousandsSeparator||this._thousandsSeparator;thousandsRegEx=new RegExp("\\"+thousandsSeparator,"g");regEx=new RegExp(this.numberRegEx.replace("{0}","\\"+decimalSeparator));value=value.replace(thousandsRegEx,"");if(regEx.test(value)&&this._parseNumber(value,decimalSeparator)!==null){return true}}return false},_parseNumber:function(value,decimalSeparator){var result=value.replace(decimalSeparator,this._decimalSeparator);result=parseFloat(result);if(isNaN(result)){return null}return result},_showError:function(options,args,evt){args.valid=false;if(evt){this._trigger(this.events.validated,evt,args);this._trigger(this.events.error,evt,args)}if(this._skipMessages){return}if(evt&&!this._trigger(this.events.errorShowing,evt,args)){return}this._ensureNotifier(options);if(options._$messageTarget){options._$messageTarget.removeClass("field-validation-valid").addClass("field-validation-error").html(args.message).show();options.notifyTarget.data("igNotifier")._setOption("state","error");options.notifyTarget.data("igNotifier")._setTargetState()}else{options.notifyTarget.igNotifier("notify","error",args.message);if(this._form){this._form._igErrorShown=true}}this._trigger(this.events.errorShown,evt,args)},_hideError:function(options,evt){var notifier=options._$messageTarget||options.notifyTarget.data("igNotifier"),args={owner:this,target:options._$messageTarget||options.notifyTarget,message:notifier._currentText||options._$messageTarget&&options._$messageTarget.text()};if(options._$messageTarget||notifier.options&&notifier.options.state==="error"){if(evt&&!this._trigger(this.events.errorHiding,evt,args)){return}notifier.hide();options.notifyTarget.data("igNotifier")._setTargetState(true);this._trigger(this.events.errorHidden)}},_showSuccess:function(options,args,evt){if(this._skipMessages){return}args.target=options._$messageTarget?options._$messageTarget:options.notifyTarget;var cancel=evt&&!this._trigger(this.events.successShowing,evt,args);if(args.message&&!cancel){this._ensureNotifier(options);if(options._$messageTarget){options._$messageTarget.removeClass("field-validation-error").addClass("field-validation-valid").html(args.message).show();options.notifyTarget.data("igNotifier")._setOption("state","success");options.notifyTarget.data("igNotifier")._setTargetState()}else{options.notifyTarget.igNotifier("notify","success",args.message)}this._trigger(this.events.successShown,evt,args)}},_hideSuccess:function(options,evt){var notifier=options._$messageTarget||options.notifyTarget.data("igNotifier"),args={owner:this,target:options._$messageTarget||options.notifyTarget,message:notifier._currentText||options._$messageTarget&&options._$messageTarget.text()};if(options._$messageTarget||notifier.options&&notifier.options.state==="success"){if(evt&&!this._trigger(this.events.successHiding,evt,args)){return}notifier.hide();this._trigger(this.events.successHidden)}},_handleNotifierEvent:function(evt,ui,type,args){var state=ui.owner.options.state;args.message=ui.message;if(state==="error"){return args.owner._trigger(this.events["error"+type],evt,args)}else if(state==="success"){return args.owner._trigger(this.events["success"+type],evt,args)}return true},_getTargetValue:function(options){if(options._control){if(options._control.options.checked!==undefined){return options._control.options.checked}else if(options._control.refreshValue&&options._control.options.allowCustomValue){options._control.refreshValue()}return options._control.value()}var $target=this._targetFromOptions(options);if(!$target.length){return null}switch(options._type){case"textarea":return $target.val().replace(/\r?\n/g,"\r\n");case"checkbox":return $target[0].checked;case"radio":case"checkboxrange":return options._group.filter(":checked").map(function(){return this.value}).get();case"input":case"select":case"selectrange":return $target.val()}return $target.val&&$target.val()},_getRuleMessage:function(options,rule,messageName){if(options[rule].errorMessage){return options[rule].errorMessage}else if(options.errorMessage){return options.errorMessage}return this._getLocalizedMessage(messageName)},_getLocalizedMessage:function(key,postfix){key+=postfix||"Message";var message=this.options.locale?this.options.locale[key]:null;if(!message&&$.ig&&$.ig.Validator&&$.ig.Validator.locale){message=$.ig.Validator.locale[key]}return message||this.locale[key]},_targetFromOptions:function(options,outer){if(outer&&options._control){if(options._control.editorContainer){return options._control.editorContainer()}else if(options._control.comboWrapper){return options._control.comboWrapper().children().first()}}if(options.selector){return options.selector instanceof $?options.selector:$(options.selector)}else{return this.element}},_getEditor:function(elem){var widgets=elem.data(),controls=["Editor","Combo","Rating","DatePicker"],regEx=new RegExp("ig.*?("+controls.join("|")+")");for(var i in widgets){if(widgets[i].widgetName&&regEx.test(widgets[i].widgetName)){return widgets[i]}}return null},_cleanupField:function(options){var element=this._targetFromOptions(options||this.options);element.unbind(".validator");if(options.notifyTarget&&options.notifyTarget.data("igNotifier")){options.notifyTarget.igNotifier("destroy").unbind(".validator")}this._clearMessageTarget(options);if(element.data("igValidatorField")){element.removeData("igValidatorField")}this._removeFieldIndications(options);if(options._control){if(options._control._options){options._control._options.validator=null}else{options._control._validator=null}}element.removeClass(this.css.target)},_addGlobalSettings:function(options){if(options===this.options){return options}var properties=["required","threshold","lengthRange","number","date","valueRange","email","triggers","onblur","onchange","onsubmit","successMessage","errorMessage"],extendedOptions=$.extend({},options);for(var i=0;i<properties.length;i++){if(!options.hasOwnProperty(properties[i])&&this.options[properties[i]]!==null){extendedOptions[properties[i]]=this.options[properties[i]]}}return extendedOptions},_indexOfByProerty:function(array,property,value){for(var i=0;i<array.length;i++){if(array[i][property]&&array[i][property]===value){return i}}return-1},_fieldMessageVisible:function(options){if(options._$messageTarget){return options._$messageTarget.is(":visible")&&this.options._currentMessage}if(options.notifyTarget.data("igNotifier")){return options.notifyTarget.data("igNotifier").isVisible()}return false},_fieldIndexOf:function(fieldParam){var index=-1;if(typeof fieldParam==="number"&&this.options.fields[fieldParam]){return fieldParam}if(typeof fieldParam==="string"){index=this._indexOfByProerty(this.options.fields,"selector",fieldParam)}if(typeof fieldParam==="object"){index=$.inArray(fieldParam,this.options.fields)}if(index>=this.options.fields.length){return-1}return index},validate:function(field){var valid;this._forceValidation=true;valid=this._validate(field);this._forceValidation=false;return valid},isValid:function(field){this._skipMessages=true;var valid=this.validate(field);this._skipMessages=false;return valid},hide:function(field){var i;if(this.options.fields){if(field!==undefined&&(i=this._fieldIndexOf(field))>-1){this._hideError(this.options.fields[i]);this._hideSuccess(this.options.fields[i])}else{return}for(i=0;i<this.options.fields.length;i++){if(this.options.fields[i].isValid!==undefined){this._hideError(this.options.fields[i]);this._hideSuccess(this.options.fields[i])}}}else{this._hideError(this.options);this._hideSuccess(this.options)}},getErrorMessages:function(field){var result=[],i;if(this.options.fields){if(field!==undefined){if((i=this._fieldIndexOf(field))>-1&&this.options.fields[i].isValid!==undefined&&!this.options.fields[i].isValid){result.push(this.options.fields[i]._currentMessage)}return result}for(i=0;i<this.options.fields.length;i++){if(this.options.fields[i].isValid!==undefined&&!this.options.fields[i].isValid){result.push(this.options.fields[i]._currentMessage)}}}else if(this.options.isValid!==undefined&&!this.options.isValid){result.push(this.options._currentMessage)}return result},isMessageDisplayed:function(field){var result=false,i;if(this.options.fields){if(field!==undefined){if((i=this._fieldIndexOf(field))>-1){result=!result?this._fieldMessageVisible(this.options.fields[i]):result}return result}for(i=0;i<this.options.fields.length;i++){result=!result?this._fieldMessageVisible(this.options.fields[i]):result}}else{result=this._fieldMessageVisible(this.options)}return result},notifier:function(field){var i,notifier;if(field!==undefined&&this.options.fields&&(i=this._fieldIndexOf(field))>-1){notifier=this.options.fields[i].notifyTarget&&this.options.fields[i].notifyTarget.data("igNotifier")}else{notifier=this.options.notifyTarget&&this.options.notifyTarget.data("igNotifier")}return notifier||null},addField:function(field){if(!this.options.fields){return}this.options.fields.push(field);this._initializeField($(field.selector),field);var options=this._addGlobalSettings(field);if(options.onsubmit){if(!this._formHandleCounter){this._attachToForm(true)}this._formHandleCounter++}},removeField:function(field){if(!this.options.fields){return}var index=this._fieldIndexOf(field);if(index>-1){var removed=this.options.fields.splice(index,1)[0],options=this._addGlobalSettings(removed);this._cleanupField(removed);if(options.onsubmit&&!--this._formHandleCounter){this._detachFromForm()}}},updateField:function(field,fieldOptions){if(!this.options.fields){return}var index=this._fieldIndexOf(field);if(index>-1){if(!fieldOptions){this._cleanupField(this.options.fields[index]);this._initializeField($(this.options.fields[index].selector),this.options.fields[index]);return}fieldOptions=$.extend({},this.options.fields[index],fieldOptions);var current=this._addGlobalSettings(this.options.fields[index]),options=this._addGlobalSettings(fieldOptions);this._cleanupField(current);this._initializeField($(fieldOptions.selector),fieldOptions);if(current.onsubmit&&!--this._formHandleCounter){this._detachFromForm()}if(options.onsubmit){if(!this._formHandleCounter){this._attachToForm(true)}this._formHandleCounter++}this.options.fields.splice(index,1,fieldOptions)}},destroy:function(){if(!this.options.fields){this._cleanupField(this.options)}else{for(var i=0;i<this.options.fields.length;i++){this._cleanupField(this.options.fields[i])}}this._detachFromForm();$.Widget.prototype.destroy.apply(this,arguments)}});$.extend($.ui.igValidator,{version:"16.1.20161.1009"});$.ui.igValidator.defaults={showAllErrorsOnSubmit:true}})(jQuery);/*!@license
* Infragistics.Web.ClientUI Editors localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Editor){$.ig.Editor={locale:{spinUpperTitle:"Increment",spinLowerTitle:"Decrement",buttonTitle:"Show list",clearTitle:"Clear value",ariaTextEditorFieldLabel:"Text Editor",ariaNumericEditorFieldLabel:"Numeric Editor",ariaCurrencyEditorFieldLabel:"Currency Editor",ariaPercentEditorFieldLabel:"Percent Editor",ariaMaskEditorFieldLabel:"Mask Editor",ariaDateEditorFieldLabel:"Date Editor",ariaDatePickerFieldLabel:"Date Picker",ariaSpinUpButton:"Spin up",ariaSpinDownButton:"Spin down",ariaDropDownButton:"Drop down",ariaClearButton:"Clear",ariaCalendarButton:"Calendar",datePickerButtonTitle:"Show calendar",updateModeUnsupportedValue:'updateMode requires a different configuration. Choose a value between "onChange" and "immediate".',updateModeNotSupported:'updateMode property supports only "onchange" mode for igMaskEditor, igDateEditor and igDatePicker extensions',renderErrMsg:"A base editor cannot be instantiated directly. Try with a text, numeric, date, or other editor.",multilineErrMsg:'textArea requires a different configuration. The textMode should be set to "multiline".',targetNotSupported:"This target element is not supported.",placeHolderNotSupported:"The placeholder attribute is not supported by your browser.",allowedValuesMsg:"Pick a value from the drop-down list",maxLengthErrMsg:"Entry is too long and was trimmed to {0} symbols",maxLengthWarningMsg:"Entry reached the maximum length of {0} for this field",minLengthErrMsg:"At least {0} characters should be entered",maxValErrMsg:"Entry reached the maximum value of {0} for this field",minValErrMsg:"Entry reached the minimum value of {0} for this field",maxValExceedRevertErrMsg:"Entry exceeded the maximum value of {0} and was reverted to previous one",minValExceedRevertErrMsg:"Entry was less than the minimum value of {0} and was reverted to previous one",maxValExceededWrappedAroundErrMsg:"Entry exceeded the maximum value of {0} and was set to the minimum allowed one",minValExceededWrappedAroundErrMsg:"Entry was less than the minimum value of {0} and was set to the maximum allowed one",btnValueNotSupported:'A different button value is required. Choose a value between "dropdown", "clear" and "spin".',scientificFormatErrMsg:'A different scientificFormat is required. Choose a value between "E", "e", "E+" and "e+".',spinDeltaIsOfTypeNumber:"A different type of spinDelta is required. A positive number should be entered.",spinDeltaCouldntBeNegative:"The spinDelta option cannot be negative. A positive number should be entered.",spinDeltaContainsExceedsMaxDecimals:"Maximum allowed fractions for spinDelta are set to {0}. Either change MaxDecimals or try to shrink your value.",spinDeltaIncorrectFloatingPoint:'A floating point spinDelta requires a different configuration. Set the dataMode of the editor to either "double" or "float" or set spinDelta to integer.',notEditableOptionByInit:"This option cannot be edited after initialization. Its value should be set during initialization.",numericEditorNoSuchMethod:"The numeric editor does not support this method.",numericEditorNoSuchOption:"The numeric editor does not support this option.",displayFactorIsOfTypeNumber:"displayFactor requires a different value. Its value should be set to 1 or 100 as a number.",displayFactorAllowedValue:"displayFactor requires a different value. Its value should be set to 1 or 100 as a number.",instantiateCheckBoxErrMsg:"igCheckboxEditor requires a different element. Use INPUT, SPAN or DIV element.",cannotParseNonBoolValue:"igCheckboxEditor requires a different value. A boolean value should be provided.",cannotSetNonBoolValue:"igCheckboxEditor requires a different value. A boolean value should be provided.",maskEditorNoSuchMethod:"The mask editor does not support this method.",datePickerEditorNoSuchMethod:"The date editor does not support this method.",datePickerNoSuchMethodDropDownContainer:"The date editor does not support this method. Use 'getCalendar' one instead.",buttonTypeIsDropDownOnly:"Datepicker allows only dropdown and clear values for the buttonType option.",dateEditorMinValue:"MinValue option can not be set runtime.",dateEditorMaxValue:"MaxValue option can not be set runtime.",cannotSetRuntime:"This option can not be set runtime",invalidDate:"Invalid date",maskMessage:"All required positions should be filled",dateMessage:"A valid date should be entered",centuryThresholdValidValues:"centuryThreshold property shoud be between 0 and 99. The value has been reverted to defaults.",noListItemsNoButton:"No spin or dropdown button is rendered because there are no listitems."}}}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI CountDown 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 * jquery-1.9.1.js
 *	jquery.ui-1.9.0.js
 *	infragistics.util.js
 *	infragistics.ui.popover.js
 *	infragistics.ui.notifier.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igBaseEditor",{options:{width:null,height:null,value:null,tabIndex:null,allowNullValue:false,nullValue:null,inputName:null,readOnly:false,disabled:false,validatorOptions:null},css:{editor:"ui-igedit-input",container:"ui-igedit ui-igedit-container ui-widget ui-corner-all ui-state-default",hover:"ui-state-hover",active:"ui-state-active",focus:"ui-state-focus",disabled:"ui-state-disabled"},events:{rendering:"rendering",rendered:"rendered",mousedown:"mousedown",mouseup:"mouseup",mousemove:"mousemove",mouseover:"mouseover",mouseout:"mouseout",blur:"blur",focus:"focus",valueChanging:"valueChanging",valueChanged:"valueChanged"},_createWidget:function(options){this._definedOptions=options;$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._initialize();this._readAttributes();this._saveDOMConent();this._render()},_initialize:function(){this._timeouts=[]},_readAttributes:function(){this._saveAttributes();this._removeAttributesAndSetThemAsOptions()},_saveAttributes:function(){var i;var element=this.element[0],attr;this._initialAttributes=[];attr=element.attributes;for(i=0;i<attr.length;i++){if(attr[i].name!=="id"){this._initialAttributes.push({name:attr[i].name,attrValue:attr[i].value})}}},_removeAttributesAndSetThemAsOptions:function(){var element=this.element,name=element.attr("name"),value=element.attr("value"),disabled=element.attr("disabled"),readOnly=element.attr("readOnly");if(name){element.removeAttr("name");if(this.options.inputName===null){this.options.inputName=name}}if(value){element.removeAttr("value");if(this.options.value===null){this.options.value=value}}if(disabled){element.removeAttr("disabled");if(this._definedOptions===undefined||this._definedOptions.disabled===undefined){this.options.disabled=true}}if(readOnly){element.removeAttr("readonly");if(this._definedOptions===undefined||this._definedOptions.readOnly===undefined){this.options.readOnly=true}}delete this._definedOptions},_saveDOMConent:function(){if(this.element.children().length>0){this._initialDOMContent=this.element.children().clone(true);this.element.empty()}},_render:function(){throw $.ig.Editor.locale.renderErrMsg},_applyOptions:function(){if(this.options.tabIndex!==null){this._setTabIndex(this.options.tabIndex)}if(this.options.readOnly){this._setReadOnly(true)}if(this.options.disabled){this._setDisabled(true)}if(this.options.inputName){this.inputName(this.options.inputName)}if(this.options.validatorOptions){this._setupValidator()}},_attachEvents:function(){var self=this;this._editorContainer.on({"mousedown.editor":function(event){self._triggerMouseDown(event)},"mouseup.editor":function(event){self._triggerMouseUp(event)},"mousemove.editor":function(event){self._triggerMouseMove(event)},"mouseover.editor":function(event){self._triggerMouseOver(event)},"mouseout.editor":function(event){self._triggerMouseOut(event)}})},_setupValidator:function(){if(this.element.igValidator){this._validator=this.element.igValidator(this.options.validatorOptions).data("igValidator");this._validator.owner=this}},_destroyValidator:function(){if(this._validator&&this._validator.owner===this){this._validator.destroy();this._validator=null}},_applyAria:function(){var ariaLabeledBy=this.element.attr("aria-labelledby");if(ariaLabeledBy){this.element.removeAttr("aria-labelledby");this._editorInput.attr("aria-labelledby",ariaLabeledBy)}if(this._dropDownButton){this._editorInput.attr("role","combobox")}else{this._editorInput.attr("role","textbox")}},_triggerRendering:function(){var args={element:this.element,owner:this};return this._trigger(this.events.rendering,null,args)},_triggerRendered:function(){var args={element:this.element,owner:this};this._trigger(this.events.rendered,null,args)},_triggerMouseMove:function(event){var args={owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.mousemove,event,args)},_triggerMouseDown:function(event){this._editorContainer.addClass(this.css.active);var args={owner:this,element:event.target,editorInput:this._editorInput};return this._trigger(this.events.mousedown,event,args)},_triggerMouseUp:function(event){this._editorContainer.removeClass(this.css.active);var args={owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.mouseup,event,args)},_triggerMouseOver:function(event){this._editorContainer.addClass(this.css.hover);var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.mouseover,event,args)},_triggerMouseOut:function(event){this._editorContainer.removeClass(this.css.hover);var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.mouseout,event,args)},_triggerFocus:function(event){this._editorContainer.addClass(this.css.focus);var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.focus,event,args)},_triggerBlur:function(event){this._editorContainer.removeClass(this.css.focus);this._clearEditorNotifier();var args={owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.blur,event,args)},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"readOnly":this._setReadOnly(value);break;case"disabled":this._setDisabled(value);break;case"width":this._setWidth(value);break;case"height":this._setHeight(value);break;case"validatorOptions":this._setupValidator();break;default:break}},_validateValue:function(val){return val?true:false},_updateValue:function(value){if(value===this.options.nullValue&&this.options.nullValue===null){this._editorInput.val("");this._valueInput.val("")}else{this._valueInput.val(value)}this.options.value=value},_clearValue:function(){if(this.options.allowNullValue){this._updateValue(this.options.nullValue)}else{this._updateValue("")}},_detachEvents:function(){if(this._detachButtonsEvents){this._detachButtonsEvents()}if(this._detachListEvents){this._detachListEvents()}this._editorContainer.off("mousedown.editor mouseup.editor mouseover.editor mouseout.editor")},_detachButtonsEvents:function(){if(this._dropDownList){this._detachListEvents()}if(this._dropDownButton){this._detachButtonsEvents(this._dropDownButton)}if(this._clearButton){this._detachButtonsEvents(this._clearButton)}if(this._spinUpButton){this._detachButtonsEvents(this._spinUpButton)}if(this._spinDownButton){this._detachButtonsEvents(this._spinDownButton)}},_restoreDOMStructure:function(){this._removeDOM();this._removeAttributes();this._setPropsDefaults();this._recoverInitialAttributes();this._recoverInitialDOMContent()},_removeDOM:function(){this._removeList();this._removeClearButton();this._removeSpinButtons();this._removeContainer()},_removeContainer:function(){this._valueInput.remove();if(this.element.is("input")){this.element.unwrap().unwrap()}else if(this.element.is("div")){this.element.empty()}else if(this.element.is("span")){this.element.empty();this.element.unwrap().unwrap()}},_removeList:function(){if(this._dropDownList){this._deleteList();this._deleteDropDownButton()}},_removeClearButton:function(){if(this._clearButton){this._clearButton.remove();delete this._clearButton}},_removeSpinButtons:function(){if(this._spinUpButton){this._spinUpButton.remove();delete this._spinUpButton}if(this._spinDownButton){this._spinDownButton.remove();delete this._spinDownButton}},_removeAttributes:function(){var element=this.element,attr=element[0].attributes,concatenatedAttr="",i;for(i=0;i<attr.length;i++){if(attr[i].name!=="id"){concatenatedAttr+=attr[i].name+" "}}element.removeAttr(concatenatedAttr.trim(" "))},_setPropsDefaults:function(){var element=this.element[0];element.disabled=false;element.readOnly=false;element.checked=false;element.value=null},_recoverInitialAttributes:function(){var i;if(this._initialAttributes){for(i=0;i<this._initialAttributes.length;i++){if(this._initialAttributes[i].name!=="id"){this.element.attr(this._initialAttributes[i].name,this._initialAttributes[i].attrValue)}}delete this._initialAttributes}},_recoverInitialDOMContent:function(){if(this._initialDOMContent){this._initialDOMContent.appendTo(this.element);delete this._initialDOMContent}},_clearStyling:function(){this._editorContainer.removeClass(this.css.container).removeClass(this.css.hover).removeClass(this.css.active);this._editorInput.removeClass(this.css.editor)},_deleteInternalProperties:function(){delete this._editorInput;delete this._editorContainer;delete this._valueInput;if(this._timeouts){delete this._timeouts}},_clearTimeouts:function(){var i,timeouts=this._timeouts;if(timeouts&&timeouts instanceof Array){for(i=0;i<timeouts.length;i++){clearTimeout(timeouts[i])}this._timeouts=[]}},_disableEditor:function(applyDisabledClass){if(applyDisabledClass){this._editorContainer.addClass(this.css.disabled)}this._detachEvents()},_setEditableMode:function(){this._editorInput.prop("readonly",false);this._valueInput.prop("readonly",false);this._editorInput.prop("disabled",false);this._valueInput.prop("disabled",false);this._editorContainer.removeClass(this.css.disabled);this._attachEvents()},_setDisabled:function(activate){if(activate){this._editorInput.prop("disabled",true);this._valueInput.prop("disabled",true);this._disableEditor(true)}else{this._editorInput.prop("disabled",false);this._valueInput.prop("disabled",false);if(!this.options.readOnly){this._setEditableMode()}}},_setReadOnly:function(activate){if(activate){this._editorInput.prop("readonly",true);this._valueInput.prop("readonly",true);this._disableEditor()}else{this._editorInput.prop("readonly",false);this._valueInput.prop("readonly",false);if(!this.options.disabled){this._setEditableMode()}this._editorInput.off(".readonly")}},_setWidth:function(width){if(width){this._editorContainer.css("width",this.options.width)}},_setHeight:function(height){if(height){this._editorContainer.css("height",this.options.height)}},_setTabIndex:function(index){this._editorInput.attr("tabIndex",index)},_setFocusDelay:function(delay){var self=this;if(delay){this._timeouts.push(setTimeout(function(){self.field().focus()},delay))}else{this.field().focus()}},_setFocus:function(event){this._focused=true;this._enterEditMode();if(event){this._triggerFocus(event)}},_setBlur:function(event){var newValue;if(this._cancelBlurOnInput){this._editorInput.focus();delete this._cancelBlurOnInput}else{this._triggerBlur(event);newValue=$(event.target).val();this._currentInputTextValue=this._editorInput.val();this._processValueChanging(newValue);this._processTextChanged();this._exitEditMode();if(this._dropDownList&&this._dropDownList.is(":visible")&&this._triggerDropDownClosing()){this._hideDropDownList()}this._focused=false;this._clearTimeouts();if(this._validator){this._validator._validateInternal(this.element,event,true)}if(this._inComposition===true){delete this._inComposition}}},inputName:function(newValue){if(newValue){this.options.inputName=newValue;this._valueInput.attr("name",newValue)}else{return this.options.inputName}},value:function(newValue){if(newValue!==undefined){this._clearEditorNotifier();if(this._validateValue(newValue)){if(this.options.toUpper){if(newValue){newValue=newValue.toLocaleUpperCase()}}else if(this.options.toLower){if(newValue){newValue=newValue.toLocaleLowerCase()}}this._updateValue(newValue);this._editorInput.val(this._getDisplayValue())}else{this._clearValue();if(this._focused!==true){this._exitEditMode()}}}else{return this.options.value}},field:function(){return this._editorInput},editorContainer:function(){return this._editorContainer},hasFocus:function(){return this._focused},setFocus:function(delay){this._setFocusDelay(delay)},hide:function(){this._editorContainer.hide()},show:function(){this._editorContainer.show()},validator:function(){return this._validator},isValid:function(){this._skipMessages=true;var valid=this._validateValue(this._editMode?this.field().val():this.value());this._skipMessages=false;return valid},validate:function(){if(this.options.validatorOptions){return this.validator().validate()}else{return this._validateValue(this.value())}},destroy:function(){this._destroyValidator();this._detachEvents();this._clearTimeouts();this._clearStyling();this._restoreDOMStructure();this._deleteInternalProperties();delete this.options;$.Widget.prototype.destroy.apply(this,arguments);return this}});$.extend($.ui.igBaseEditor,{version:"16.1.20161.1009"});$.widget("ui.igTextEditor",$.ui.igBaseEditor,{options:{buttonType:"none",listItems:null,listWidth:0,listItemHoverDuration:0,dropDownAttachedToBody:false,dropDownAnimationDuration:300,visibleItemsCount:5,includeKeys:null,excludeKeys:null,textAlign:"left",placeHolder:null,selectionOnFocus:"selectAll",textMode:"text",spinWrapAround:false,isLimitedToListValues:false,revertIfNotValid:true,preventSubmitOnEnter:false,dropDownOrientation:"auto",maxLength:null,dropDownOnReadOnly:false,toUpper:false,toLower:false,locale:null,suppressNotifications:false},css:{editorInputContainer:"ui-igeditor-input-container ui-corner-all",spinButtonUpImage:"ui-igedit-spinupperimage ui-icon-carat-1-n ui-icon "+"ui-igedit-buttondefault ui-igedit-spinbutton ui-igedit-buttonimage",spinButtonDownImage:"ui-igedit-spinlowerimage ui-icon-carat-1-s ui-icon "+"ui-igedit-buttondefault ui-igedit-spinbutton ui-igedit-buttonimage",dropDownImage:"ui-icon ui-icon-triangle-1-s ui-igedit-buttonimage",dropDownButton:"ui-igedit-dropdown-button ",clearButtonImage:"ui-igedit-buttonimage ui-icon-circle-close "+"ui-icon ui-igedit-buttondefault",clearButton:"ui-igedit-cleararea ui-state-default",buttonCommon:"ui-igedit-button-common ui-unselectable "+"ui-igedit-button-ltr ui-state-default",dropDownList:"ui-igedit-dropdown ui-widget",listItem:"ui-igedit-listitem ui-state-default",listItemHover:"ui-igedit-listitemhover ui-state-hover",listItemActive:"ui-state-active ui-igedit-listitemactive",listItemSelected:"ui-igedit-listitemselected ui-state-highlight",buttonHover:"ui-igedit-buttonhover ui-state-hover",buttonPressed:"ui-igedit-buttonpressed ui-state-highlight",placeHolder:"ui-igedit-placeholder",textArea:"ui-igedit-textarea"},events:{keydown:"keydown",keypress:"keypress",keyup:"keyup",dropDownListOpening:"dropDownListOpening",dropDownListOpened:"dropDownListOpened",dropDownListClosing:"dropDownListClosing",dropDownListClosed:"dropDownListClosed",dropDownItemSelecting:"dropDownItemSelecting",dropDownItemSelected:"dropDownItemSelected",textChanged:"textChanged"},_create:function(){$.ui.igBaseEditor.prototype._create.call(this)},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"value":if(this._validateValue(value)){this._updateValue(value);this._exitEditMode()}else{this._clearValue();this._exitEditMode()}break;case"placeHolder":this._applyPlaceHolder();break;case"suppressNotifications":if(value){this._clearEditorNotifier()}break;case"listItems":this._deleteList();this._createList();this._clearValue();break;case"excludeKeys":if(value===""){this._excludeKeysArray=[]}else{this._excludeKeysArray=value.toString().split("")}break;case"includeKeys":if(value===""){this._includeKeysArray=[]}else{this._includeKeysArray=value.toString().split("")}break;case"dropDownOnReadOnly":case"visibleItemsCount":case"buttonType":case"dropDownAttachedToBody":this.options[option]=prevValue;throw new Error($.ig.Editor.locale.cannotSetRuntime);default:this.options[option]=prevValue;this._super(option,value);break}},_updateValue:function(value){if(value!==null&&value!==undefined){value=value.toString()}this._super(value)},_applyOptions:function(){var initialValue;this._super();if(this.options.includeKeys){this._includeKeysArray=this.options.includeKeys.toString().split("")}if(this.options.excludeKeys){this._excludeKeysArray=this.options.excludeKeys.toString().split("")}if(this.options.value!==undefined){initialValue=this.options.value;if(this.options.maxLength){if(initialValue&&initialValue.toString().length>this.options.maxLength){initialValue=initialValue.toString().substring(0,this.options.maxLength);this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxLengthErrMsg,this.options.maxLength))}}if(this._validateValue(initialValue)){this._setInitialValue(initialValue);this._editorInput.val(this._getDisplayValue())}}else if(this.element.val()&&this._validateValue(this.element.val())){initialValue=this.element.val();if(this.options.maxLength){if(initialValue&&initialValue.toString().length>this.options.maxLength){initialValue=initialValue.toString().substring(0,this.options.maxLength);this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxLengthErrMsg,this.options.maxLength))}}if(this._validateValue(initialValue)){this._setInitialValue(initialValue);this._editorInput.val(this._getDisplayValue())}else{this._editorInput.val("")}}this._applyPlaceHolder()},_render:function(){var editorElementWrapper,editorElement,tempTimeStamp;this._triggerRendering();if(this.element.attr("id")!==undefined){this.id=this.element.attr("id")}else{tempTimeStamp=new Date;this.id=tempTimeStamp.getTime()}if(this.element.is("div")||this.element.is("span")){if(this.options.textMode==="multiline"){editorElement=$("<textarea rows='4' cols='50'></textarea>");editorElement.addClass(this.css.textArea)}else if(this.options.textMode==="password"){editorElement=$("<input type='password' autocomplete='off'/>")}else{editorElement=$("<input type='text' />")}if(this.element.is("span")){editorElement=this.element.html(editorElement)}editorElementWrapper=editorElement.wrap($("<div></div>")).parent();editorElementWrapper.addClass(this.css.editorInputContainer);this._editorInputWrapper=editorElementWrapper;if(this.element.is("span")){this._editorInput=editorElement.children(0);this._editorContainer=editorElementWrapper.wrap($("<div></div>")).parent()}else{this._editorInput=editorElement;this._editorContainer=this.element}this._editorContainer.prepend(editorElementWrapper)}else if(this.element.is("input")){this._editorContainer=this.element.wrap($("<div></div>")).parent();this._editorInput=this.element;editorElementWrapper=this._editorInput.wrap($("<div></div>")).parent();editorElementWrapper.addClass(this.css.editorInputContainer);this._editorInputWrapper=editorElementWrapper}else if(this.element.is("textarea")){if(this.options.textMode!=="multiline"){throw $.ig.Editor.locale.multilineErrMsg}else{this._editorContainer=this.element.wrap($("<div></div>")).parent();this._editorInput=this.element;this._editorInput.addClass(this.css.textArea);editorElementWrapper=this._editorInput.wrap($("<div></div>")).parent();editorElementWrapper.addClass(this.css.editorInputContainer);this._editorInputWrapper=editorElementWrapper}}else{throw $.ig.Editor.locale.targetNotSupported}this._editorContainer.addClass(this.css.container);this._editorInput.addClass(this.css.editor);this._editorInput.css("height","100%");if(this.element.is("input")&&this._editorInput.attr("id")!==undefined){this._editorInputId=this._editorInput.attr("id")}else{this._editorInput.attr("id",this.id+"EditingInput");this._editorInputId=this.id+"EditingInput"}if(!$.ig.util.isIE8){if(this.options.textMode!=="multiline"){if(this.options.textMode==="password"){this._editorInput.attr("type","password");this._editorInput.attr("autocomplete","off")}else{this._editorInput.attr("type","text")}}}if(this.options.buttonType&&this.options.buttonType!=="none"&&this.options.textMode!=="multiline"&&this.options.textMode!=="password"){this._renderButtons()}if(this.options.width){this._editorContainer.css("width",this.options.width)}if(this.options.height){this._editorContainer.css("height",this.options.height)}if(this.options.textMode==="multiline"){this._valueInput=$("<textarea style='display:none'></textarea>")}else{this._valueInput=$("<input type='hidden'></input>")}this._editorInput.after(this._valueInput);this._editorInput.css("text-align",this.options.textAlign);this._createList();this._attachEvents();this._applyOptions();this._applyAria();this._triggerRendered()},_applyAria:function(){this._super();this._applyInputAriaLabel()},_applyInputAriaLabel:function(){var ariaLabelText;switch(this.widgetName){case"igTextEditor":{ariaLabelText=this._getLocaleOption("ariaTextEditorFieldLabel")}break;case"igNumericEditor":{ariaLabelText=this._getLocaleOption("ariaNumericEditorFieldLabel")}break;case"igCurrencyEditor":{ariaLabelText=this._getLocaleOption("ariaCurrencyEditorFieldLabel")}break;case"igPercentEditor":{ariaLabelText=this._getLocaleOption("ariaPercentEditorFieldLabel")}break;case"igMaskEditor":{ariaLabelText=this._getLocaleOption("ariaMaskEditorFieldLabel")}break;case"igDateEditor":{ariaLabelText=this._getLocaleOption("ariaDateEditorFieldLabel")}break;case"igDatePicker":{ariaLabelText=this._getLocaleOption("ariaDatePickerFieldLabel")}break;default:{ariaLabelText=this._getLocaleOption("ariaTextEditorFieldLabel")}}this._editorInput.attr("aria-label",ariaLabelText)},_sendNotification:function(state,message){if(this.options.suppressNotifications||this._skipMessages){this._currentMessage=message;return}if(!this._editorContainer.data("igNotifier")){this._editorContainer.igNotifier()}this._editorContainer.igNotifier("notify",state,message)},_applyPlaceHolder:function(){if(this.options.placeHolder&&this.options.placeHolder!==""){this._editorInput.attr("placeholder",this.options.placeHolder);this._editorInput.addClass(this.css.placeHolder);if(this._placeHolderNotSupported()){console.log($.ig.Editor.locale.placeHolderNotSupported)}}else if(this._editorInput.attr("placeholder")){this._editorInput.removeAttr("placeholder")}},_placeHolderNotSupported:function(){return document.createElement("input").placeholder===undefined},_setInitialValue:function(value){this._updateValue(value)},_disableEditor:function(applyDisabledClass){if(this.options.dropDownOnReadOnly){if(applyDisabledClass){this._editorInput.addClass(this.css.disabled)}}else{if(applyDisabledClass){this._editorContainer.addClass(this.css.disabled)}this._detachEvents()}if(this._dropDownList&&!this.options.dropDownOnReadOnly){if(applyDisabledClass){this._dropDownList.addClass(this.css.disabled)}this._detachListEvents()}if(this._dropDownButton&&!this.options.dropDownOnReadOnly){this._dropDownButton.addClass(this.css.disabled);this._detachButtonsEvents(this._dropDownButton)}if(this._clearButton){this._clearButton.addClass(this.css.disabled);this._detachButtonsEvents(this._clearButton)}if(this._spinUpButton){this._spinUpButton.addClass(this.css.disabled);this._detachButtonsEvents(this._spinUpButton)}if(this._spinDownButton){this._spinDownButton.addClass(this.css.disabled);this._detachButtonsEvents(this._spinDownButton)}},_replaceCharAt:function(stringValue,index,ch){if(stringValue!==undefined){return stringValue.substring(0,index)+ch+stringValue.substring(index+1)}},_getStringRange:function(stringValue,start,end){if(stringValue!==undefined){return stringValue.substring(start,end)}},_replaceStringRange:function(stringValue,replacementValue,indexStart,indexEnd){var i=0;while(indexStart<=indexEnd){stringValue=this._replaceCharAt(stringValue,indexStart,replacementValue.charAt(i));i++;indexStart++}return stringValue},_validateValue:function(val){var loweredItems,result;if(val===undefined){result=false}else if(val===null){if(this.options.allowNullValue){result=val===this.options.nullValue?true:false}else{result=false}}else if(this.options.isLimitedToListValues&&this._dropDownList){loweredItems=$.map(this.options.listItems,function(item){return item===null||item===undefined?"":item.toString().toLowerCase()});if($.inArray(val.toString().toLowerCase(),loweredItems)!==-1){result=true}else{this._sendNotification("warning",$.ig.Editor.locale.allowedValuesMsg);result=false}}else if(this.options.maxLength){if(val.toString().length<=this.options.maxLength){result=true}else{this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxLengthErrMsg,this.options.maxLength));result=false}}else{result=true}return result},_setEditableMode:function(){this._super("_setEditableMode");if(this._dropDownList&&!this.options.dropDownOnReadOnly){this._dropDownList.removeClass(this.css.disabled);this._attachListEvents()}if(this._dropDownButton&&!this.options.dropDownOnReadOnly){this._dropDownButton.removeClass(this.css.disabled);this._attachButtonsEvents("dropdown",this._dropDownButton)}if(this._clearButton){this._clearButton.removeClass(this.css.disabled);this._attachButtonsEvents("clear",this._clearButton)}if(this._spinUpButton){this._spinUpButton.removeClass(this.css.disabled);this._attachButtonsEvents("spinUp",this._spinUpButton)}if(this._spinDownButton){this._spinDownButton.removeClass(this.css.disabled);this._attachButtonsEvents("spinDown",this._spinDownButton)}},_calculateDropDownListOrientation:function(){var containerOffset=this._editorContainer.offset(),containerTop=containerOffset.top,containerHeight=parseFloat(this._editorContainer.css("height")),dropDownAndEditorHeight=parseInt(containerTop+containerHeight+this._listInitialHeight),widndowHeight=$(window).height(),orientation;if(this.options.dropDownOrientation==="auto"){if(dropDownAndEditorHeight<widndowHeight+$(window).scrollTop()){orientation="bottom"}else if(containerTop-this._listInitialHeight>0){orientation="top"}else{orientation="bottom"}}else{orientation=this.options.dropDownOrientation}return orientation},_positionDropDownList:function(){var containerOffset=this._editorContainer.offset(),containerTop=containerOffset.top,containerLeft=containerOffset.left,containerHeight=parseFloat(this._editorContainer.css("height")),orientation=this._calculateDropDownListOrientation();if(this.options.dropDownAttachedToBody){this._dropDownList.css("left",containerLeft);if(orientation==="bottom"){this._dropDownList.css("top",containerTop+containerHeight);this._dropDownListOrientation="down";this._dropDownList.removeClass("ui-igedit-dropdown-orientation-top");this._dropDownList.addClass("ui-igedit-dropdown-orientation-bottom")}else{this._dropDownList.css("top",containerTop-this._listInitialHeight);this._dropDownListOrientation="up";this._dropDownList.removeClass("ui-igedit-dropdown-orientation-bottom");this._dropDownList.addClass("ui-igedit-dropdown-orientation-top")}}else{this._dropDownList.css("left","");if(orientation==="bottom"){this._dropDownList.css("top","");this._dropDownListOrientation="down";this._dropDownList.removeClass("ui-igedit-dropdown-orientation-top");this._dropDownList.addClass("ui-igedit-dropdown-orientation-bottom")}else{this._dropDownList.css("top",-this._listInitialHeight);this._dropDownListOrientation="up";this._dropDownList.removeClass("ui-igedit-dropdown-orientation-bottom");this._dropDownList.addClass("ui-igedit-dropdown-orientation-top")}}this._setDropDownListWidth()},_createList:function(){if(this.options.textMode!=="multiline"&&this.options.textMode!=="password"&&this.options.listItems&&this.options.listItems.length>0){if(this.options.buttonType.toString().indexOf("dropdown")===-1){this._renderDropDownButton()}this._renderList();this._positionDropDownList();this._attachListEvents()}},_renderList:function(){var i,list=this.options.listItems,itemValue,currentItem,itemHeight,currentItemId;var dropdown=$("<div id='"+this.id+"_list"+"' tabindex='-1'></div>)").addClass(this.css.dropDownList);this._editorInput.attr("aria-owns",this.id+"_list");dropdown.attr("role","listbox");dropdown.attr("aria-activedescendant",this._editorInputId);for(i=0;i<list.length;i++){currentItemId=dropdown.attr("id");currentItemId=currentItemId.toString();currentItemId+="_item_";currentItemId+=(i+1).toString();currentItem=$("<span id='"+currentItemId+"' tabindex='-1' role='option' aria-selected='false' aria-posinset='"+(i+1).toString()+"'></span>").addClass(this.css.listItem);itemValue=this.options.displayFactor?this._multiplyWithPrecision(list[i],this.options.displayFactor):list[i];currentItem.attr("title",itemValue);currentItem.append(itemValue).appendTo(dropdown)}if(this.options.dropDownAttachedToBody){$(document.body).append(dropdown)}else{this._editorContainer.append(dropdown)}itemHeight=currentItem.css("height");itemHeight=parseFloat(itemHeight);if(itemHeight===0){itemHeight=23}if(list.length<this.options.visibleItemsCount){dropdown.css("height",parseFloat(itemHeight*list.length));this._listInitialHeight=parseFloat(itemHeight*list.length)}else{dropdown.css("height",parseFloat(itemHeight*this.options.visibleItemsCount)+2);this._listInitialHeight=parseFloat(itemHeight*this.options.visibleItemsCount)+2}this._dropDownList=dropdown;this._setDropDownListWidth();dropdown.hide();dropdown.visible=false},_setDropDownListWidth:function(){if(this.options.listWidth&&this.options.listWidth>0){this._dropDownList.css("width",this.options.listWidth)}else{this._dropDownList.css("width",this._editorContainer.css("width"))}},_attachListEvents:function(){var self=this;this._dropDownList.on({"mouseenter.editorList":function(event){var item=event.target;$(item).addClass(self.css.listItemHover,self.options.listItemHoverDuration);$(item).attr("data-hovered",true)},"mouseleave.editorList":function(event){var item=event.target;$(item).removeClass(self.css.listItemHover,self.options.listItemHoverDuration);$(item).removeAttr("data-hovered")},"click.editorList":function(event){self._triggerListItemClick(event.target)},"mousedown.editorList":function(event){event.preventDefault();if(!$.ig.util.isIE8){event.stopPropagation()}}},".ui-igedit-listitem");this._dropDownList.on("mousedown.editorList",function(event){self._listMouseDownHandler(event)})},_listMouseDownHandler:function(event){if($.ig.util.isIE||$.ig.util.isEdge){this._cancelBlurOnInput=true}else{event.preventDefault();event.stopPropagation()}},_deleteList:function(){this._detachListEvents();this._dropDownList.remove();delete this._dropDownList},_deleteDropDownButton:function(){this._detachButtonsEvents(this._dropDownButton);this._dropDownButton.remove();delete this._dropDownButton},_detachListEvents:function(){if(this._dropDownList){this._dropDownList.off("mouseenter.editorList mouseleave.editorList ");this._dropDownList.off("click.editorList mousedown.editorList")}},_renderDropDownButton:function(){var dropDownButton=$("<div role='button' tabindex='-1' id='"+this.id+"_dropDownButton' aria-label='"+this._getLocaleOption("ariaDropDownButton")+"'></div>"),dropDownIcon=$("<div></div>");if(this._dropDownButton){return}dropDownButton.addClass(this.css.buttonCommon);dropDownButton.attr("title",this._getLocaleOption("buttonTitle"));this._editorContainer.prepend(dropDownButton.addClass(this.css.dropDownButton).append(dropDownIcon.addClass(this.css.dropDownImage)));this._dropDownButton=dropDownButton;this._attachButtonsEvents("dropdown",dropDownButton)},_renderSpinButtons:function(){var spinButtonUp=$("<div role='button' tabindex='-1' id='"+this.id+"_spinUpButton' aria-label='"+this._getLocaleOption("ariaSpinUpButton")+"'></div>"),spinButtonUpImage=$("<div></div>"),spinButtonDown=$("<div role='button' tabindex='-1' id='"+this.id+"_spinDownButton' aria-label='"+this._getLocaleOption("ariaSpinDownButton")+"'></div>"),spinButtonDownImage=$("<div></div>");if(this._spinUpButton){return}spinButtonUp.addClass(this.css.buttonCommon).append(spinButtonUpImage.addClass(this.css.spinButtonUpImage));spinButtonDown.addClass(this.css.buttonCommon).append(spinButtonDownImage.addClass(this.css.spinButtonDownImage));spinButtonUp.attr("title",this._getLocaleOption("spinUpperTitle"));spinButtonDown.attr("title",this._getLocaleOption("spinLowerTitle"));this._editorContainer.prepend(spinButtonDown).prepend(spinButtonUp);this._attachButtonsEvents("spinDown",spinButtonDown);this._attachButtonsEvents("spinUp",spinButtonUp);this._spinUpButton=spinButtonUp;this._spinDownButton=spinButtonDown
},_renderClearButton:function(){var clearButton=$("<div role='button' id='"+this.id+"_clearButton' tabindex='-1' aria-label='"+this._getLocaleOption("ariaClearButton")+"'></div>"),buttonClearIcon=$("<div></div>");if(this._clearButton){return}clearButton.addClass(this.css.buttonCommon);clearButton.append(buttonClearIcon.addClass(this.css.clearButtonImage));clearButton.attr("title",this._getLocaleOption("clearTitle"));this._editorContainer.prepend(clearButton.addClass(this.css.clearButton));this._clearButton=clearButton;this._attachButtonsEvents("clear",clearButton)},_renderButtons:function(){var buttons=this.options.buttonType.toString().split(/[\s,]+/),buttonsCountRendered=0;if($.inArray("clear",buttons)!==-1){this._renderClearButton();buttonsCountRendered++}if($.inArray("spin",buttons)!==-1){if(this._numericType||this.options.listItems&&this.options.listItems!==null&&this.options.listItems.length>0){this._renderSpinButtons();buttonsCountRendered+=2}else if(this.options.listItems===null||this.options.listItems.length===0){throw new Error($.ig.Editor.locale.noListItemsNoButton)}}if($.inArray("dropdown",buttons)!==-1){if(this.options.listItems&&this.options.listItems!==null&&this.options.listItems.length>0){this._renderDropDownButton();buttonsCountRendered++}else if(this.options.listItems===null||this.options.listItems.length===0){throw new Error($.ig.Editor.locale.noListItemsNoButton)}}if(buttonsCountRendered===0){console.log($.ig.Editor.locale.btnValueNotSupported)}},_attachButtonsEvents:function(type,target){var self=this;if(!target){return}target.on({"mouseenter.button":function(){target.addClass(self.css.buttonHover)},"mouseleave.button":function(){target.removeClass(self.css.buttonHover);if(target._pressed){delete target._pressed;target.removeClass(self.css.buttonPressed)}if(target._spinTimeOut){clearTimeout(target._spinTimeOut);delete target._spinTimeOut}if(target._spinInterval){clearInterval(target._spinInterval);delete target._spinInterval}},"mousedown.button":function(event){if(event.button===0||event.button===1&&$.ig.util.isIE8){target.addClass(self.css.buttonPressed);target._pressed=true;event.preventDefault();if(type==="spinUp"||type==="spinDown"){self._handleSpinEvent(type,target)}}event.stopPropagation()},"mouseup.button":function(){target.removeClass(self.css.buttonPressed);delete target._pressed;if(target._spinTimeOut){clearTimeout(target._spinTimeOut);delete target._spinTimeOut}if(target._spinInterval){clearInterval(target._spinInterval);delete target._spinInterval}},"click.button":function(event){self._triggerButtonClick(event,type)}})},_detachButtonsEvents:function(target){if(target){target.off("mouseenter.button mouseleave.button mousedown.button mouseup.button click.button")}},_attachEvents:function(){var self=this;self._super();this._editorInput.on({"focus.editor":function(event){self._setFocus(event)},"blur.editor":function(event){self._setBlur(event)},"paste.editor":function(event){self._currentInputTextValue=self._editorInput.val();self._pasteHandler(event)},"keydown.editor":function(event){self._currentInputTextValue=self._editorInput.val();self._triggerKeyDown(event)},"keyup.editor":function(event){self._triggerKeyUp(event);self._processTextChanged()},"keypress.editor":function(event){self._triggerKeyPress(event)},"compositionstart.editor":function(){var widgetName=self.widgetName,cursorPosition=self._getCursorPosition();if(cursorPosition===-1){switch(widgetName){case"igMaskEditor":case"igDateEditor":case"igDatePicker":{self._editorInput.val(self._maskWithPrompts);self._setCursorPosition(0)}break;default:}}self._compositionStartValue=self._editorInput.val();self._copositionStartIndex=self._getCursorPosition();self._inComposition=true},"compositionend.editor":function(){setTimeout(function(){var value,pastedValue,widgetName=self.widgetName,cursorPosition=self._getCursorPosition();if(self._inComposition!==true){return}switch(widgetName){case"igMaskEditor":{pastedValue=value=self._replaceStringRange(self._compositionStartValue,self._currentCompositionValue,self._copositionStartIndex,self._copositionStartIndex+self._currentCompositionValue.length-1)}break;case"igDateEditor":case"igDatePicker":{value=self._currentCompositionValue;value=$.ig.util.IMEtoNumberString(value,$.ig.util.IMEtoENNumbersMapping());pastedValue=value=self._parseValueByMask(value);if(value!==self._maskWithPrompts){value=self._parseDateFromMaskedValue(value)}}break;default:{pastedValue=value=self._editorInput.val()}}value=$.ig.util.IMEtoNumberString(value,$.ig.util.IMEtoENNumbersMapping());pastedValue=$.ig.util.IMEtoNumberString(pastedValue,$.ig.util.IMEtoENNumbersMapping());if(self._validateValue(value)){self._insert(pastedValue,self._compositionStartValue);self._setCursorPosition(cursorPosition)}else{if(self.options.revertIfNotValid){value=self._valueInput.val();self._updateValue(value)}else{self._clearValue()}if(self._focused){self._enterEditMode()}}delete self._inComposition;delete self._copositionStartIndex;delete self._currentCompositionValue;delete self._compositionStartValue},0)},"compositionupdate.editor":function(evt){setTimeout(function(){self._currentCompositionValue=$(evt.target).val().toString().substring(self._copositionStartIndex,self._getCursorPosition())},0)}})},_detachEvents:function(){this._super();this._editorInput.off("focus.editor blur.editor paste.editor");this._editorInput.off("keydown.editor keyup.editor keypress.editor");this._editorInput.off("compositionstart.editor compositionend.editor compositionupdate.editor")},_processValueChanging:function(value){if(value!==this.value()){if(!(this.value()===null&&value==="")){this._triggerInternalValueChange(value)}}},_triggerInternalValueChange:function(value){var noCancel=this._triggerValueChanging(value);if(noCancel){this._processInternalValueChanging(value);this._triggerValueChanged(value)}},_processInternalValueChanging:function(value){if(this._validateValue(value)){this._updateValue(value)}else{if(this.options.revertIfNotValid){value=this._valueInput.val();this._updateValue(value)}else{this._clearValue();value=this._valueInput.val()}}},_triggerKeyDown:function(event){var e=event,noCancel,activeItem,args,currentInputVal,selection;args={owner:this,element:event.target,key:event.keyCode,editorInput:this._editorInput};noCancel=this._trigger(this.events.keydown,event,args);if(noCancel){this._clearEditorNotifier();if(e.keyCode===13){if(event.altKey&&this.options.textMode==="multiline"){this._editorInput.val(this._editorInput.val()+"\n")}else{currentInputVal=this._editorInput.val();if(this._dropDownList&&this._dropDownList.is(":visible")){activeItem=this._dropDownList.children(".ui-igedit-listitem").filter("[data-active='true']");if(activeItem.length>0){this._triggerListItemClick(activeItem)}else{this._processValueChanging(currentInputVal)}}else{this._processValueChanging(currentInputVal)}}}else if(this._dropDownList){if(e.keyCode===38){if(e.altKey&&this._dropDownList.is(":visible")){this._toggleDropDown()}else if(this._dropDownList.is(":visible")){activeItem=this._dropDownList.children(".ui-igedit-listitem").filter("[data-active='true']");if(activeItem.length>0&&!activeItem.is(":first-child")){this._hoverPreviousDropDownListItem()}else{this._toggleDropDown()}}}else if(e.keyCode===40||e.keyCode===38&&e.altKey){if(!this._dropDownList.is(":visible")){this._toggleDropDown()}else{this._hoverNextDropDownListItem()}}else if(e.keyCode===27&&this._dropDownList.is(":visible")){this._toggleDropDown()}}else if(this.options.maxLength){currentInputVal=this._editorInput.val();if(currentInputVal.length===this.options.maxLength&&e.keyCode>46&&!e.altKey&&!e.ctrlKey&&!e.shiftKey){selection=this._getSelection(this._editorInput[0]);if(selection.start===selection.end){e.preventDefault();e.stopPropagation();this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxLengthWarningMsg,this.options.maxLength))}}}}return noCancel},_triggerKeyUp:function(event){var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.keyup,event,args)},_validateNonCharacter:function(event){if($.ig.util.isFF){var e=event;if($.inArray(e.keyCode,[46,8,9,27,13,110,190])!==-1||e.which===97&&e.ctrlKey===true||e.which===99&&e.ctrlKey===true||e.which===120&&e.ctrlKey===true||e.which===118&&e.ctrlKey===true||e.which===122&&e.ctrlKey===true||e.which===121&&e.ctrlKey===true||e.keyCode>=35&&e.keyCode<=40){return true}}else{return false}},_triggerKeyPress:function(event){if(this._validateNonCharacter(event)||this._validateKey(event)){var args={owner:this,element:event.target,key:event.keyCode,editorInput:this._editorInput};if(this.options.preventSubmitOnEnter&&event.keyCode===13&&!event.shiftKey&&this.options.textMode!=="multiline"){event.preventDefault();event.stopPropagation()}if((this.options.toUpper||this.options.toLower)&&!this._validateNonCharacter(event)){var keyCode=event.which?event.which:event.keyCode;if(keyCode){var charStr,transformedChar,key,selection,val;charStr=String.fromCharCode(keyCode);if(this.options.toUpper){transformedChar=charStr.toLocaleUpperCase()}else{transformedChar=charStr.toLocaleLowerCase()}key=transformedChar.charCodeAt(0);args.key=key;selection=this._getSelection(this._editorInput[0]);val=this._editorInput.val();this._editorInput.val(val.slice(0,selection.start)+transformedChar+val.slice(selection.end));this._setCursorPosition(selection.start+1);event.preventDefault()}}return this._trigger(this.events.keypress,event,args)}else{event.preventDefault();event.stopPropagation()}},_triggerValueChanged:function(originalValue){var args={owner:this,editorInput:this._editorInput,newValue:this.options.value};if(originalValue){args.originalValue=originalValue}this._trigger(this.events.valueChanged,null,args)},_triggerValueChanging:function(newValue){var args={owner:this,editorInput:this._editorInput,oldValue:this.value(),newValue:newValue};return this._trigger(this.events.valueChanging,null,args)},_triggerListItemClick:function(item){var noCancel;noCancel=this._triggerDropDownItemSelecting(item);if(noCancel){$(item).parent().children(".ui-igedit-listitem").removeClass(this.css.listItemSelected).attr("aria-selected",false);$(item).addClass(this.css.listItemSelected);$(item).attr("aria-selected",true);noCancel=this._triggerDropDownClosing();if(noCancel){this._hideDropDownList()}this._triggerDropDownItemSelected(item);if(this.value()!==$(item).text()){this._currentInputTextValue=this._editorInput.val();this._processValueChanging($(item).text());this._processTextChanged();this._enterEditMode()}}},_triggerButtonClick:function(event,buttonType){if(buttonType){switch(buttonType){case"dropdown":{this._toggleDropDown()}break;case"clear":{this._currentInputTextValue=this._editorInput.val();this._clearValue();this._processTextChanged();if(!this._editMode){this._exitEditMode();this._triggerValueChanged()}else{this._enterEditMode()}}break}}},_triggerDropDownClosing:function(){var args={editor:this._editorContainer,owner:this,editorInput:this._editorInput,list:this._dropDownList};return this._trigger(this.events.dropDownListClosing,null,args)},_triggerDropDownClosed:function(){var args={editor:this._editorContainer,owner:this,editorInput:this._editorInput,list:this._dropDownList};this._trigger(this.events.dropDownListClosed,null,args)},_triggerDropDownOpening:function(){var args={editor:this._editorContainer,owner:this,editorInput:this._editorInput,list:this._dropDownList};return this._trigger(this.events.dropDownListOpening,null,args)},_triggerDropDownOpened:function(){var args={owner:this,editorInput:this._editorInput,list:this._dropDownList};return this._trigger(this.events.dropDownListOpened,null,args)},_triggerDropDownItemSelecting:function(item){var args={editor:this._editorContainer,owner:this,editorInput:this._editorInput,list:this._dropDownList,item:item};return this._trigger(this.events.dropDownItemSelecting,null,args)},_triggerDropDownItemSelected:function(item){var args={owner:this,editorInput:this._editorInput,list:this._dropDownList,item:item};this._trigger(this.events.dropDownItemSelected,null,args)},_processTextChanged:function(){var currentVal=this._editorInput.val(),previousVal=this._currentInputTextValue;if(previousVal===undefined){this._triggerTextChanged("",currentVal)}else if(currentVal!==previousVal){this._triggerTextChanged(previousVal,currentVal);if(this._validator){this._validator._validateInternal(this.element,null,false,this._editMode?this._valueFromText(currentVal):this.value())}this._currentInputTextValue=currentVal}},_triggerTextChanged:function(oldValue,newValue){var args={owner:this,text:newValue,oldText:oldValue?oldValue:""};this._trigger(this.events.textChanged,null,args)},_elementPositionInViewport:function(el){var areaTop=Math.ceil(el.parent().offset().top),elementoffset=Math.ceil(el.offset().top),elementHeight=Math.ceil(el.outerHeight()),listVisibleHeight=el.parent().outerHeight(),result;if(elementoffset-areaTop<0){result="top"}else if(elementoffset+elementHeight-areaTop<listVisibleHeight){result="inside"}else if(elementoffset+elementHeight-areaTop>listVisibleHeight){result="bottom"}return result},_hoverPreviousDropDownListItem:function(){var items=this._dropDownList.children(".ui-igedit-listitem"),newItem,currentItem;if(items&&items.length>0){if(items.filter("[data-active='true']").length>0){currentItem=items.filter("[data-active='true']");newItem=currentItem.prev();if(currentItem.is(":first-child")){if(this.options.spinWrapAround){newItem=items.last();this._dropDownList.scrollTop(this._dropDownList.scrollTop()+newItem.position().top)}else{return}}else{if(this._elementPositionInViewport(newItem)==="top"){this._dropDownList.scrollTop(this._dropDownList.scrollTop()-newItem.outerHeight())}}currentItem.removeClass(this.css.listItemActive,this.options.listItemHoverDuration);currentItem.removeAttr("data-active");newItem.addClass(this.css.listItemActive,this.options.listItemHoverDuration);newItem.attr("data-active",true)}}},_hoverNextDropDownListItem:function(){var items=this._dropDownList.children(".ui-igedit-listitem"),newItem,currentItem;if(items&&items.length>0){if(items.filter("[data-active='true']").length>0){currentItem=items.filter("[data-active='true']");newItem=currentItem.next();if(currentItem.is(":last-child")){if(this.options.spinWrapAround){newItem=items.first();this._dropDownList.scrollTop(this._dropDownList.scrollTop()+newItem.position().top)}else{return}}if(this._elementPositionInViewport(newItem)==="bottom"){this._dropDownList.scrollTop(this._dropDownList.scrollTop()+newItem.outerHeight())}currentItem.removeClass(this.css.listItemActive,this.options.listItemHoverDuration);currentItem.removeAttr("data-active")}else{newItem=items.filter(":visible").first()}newItem.addClass(this.css.listItemActive,this.options.listItemHoverDuration);newItem.attr("data-active",true)}},_pasteHandler:function(event){var self=this,previousValue=$(event.target).val(),newValue;this._currentInputTextValue=this._editorInput.val();this._timeouts.push(setTimeout(function(){newValue=$(event.target).val();self._insert(newValue,previousValue)},10))},_insertHandler:function(string){var selection=this._getSelection(this.field()[0]),previousValue,newValue;if(string){previousValue=this._editMode?this._editorInput.val():this.displayValue();newValue=this._replaceDisplayValue(selection,previousValue,string);this._insert(newValue,previousValue)}},_replaceDisplayValue:function(selection,previousValue,string){return previousValue.substring(0,selection.start)+string+previousValue.substring(selection.end,previousValue.length)},_insert:function(newValue,previousValue){var selection;if(this.options.maxLength){if(newValue&&newValue.toString().length>this.options.maxLength){newValue=newValue.toString().substring(0,this.options.maxLength);this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxLengthErrMsg,this.options.maxLength))}}if(this._validateValue(newValue)){selection=this._getSelection(this._editorInput[0]);if(this.options.toUpper){if(newValue){newValue=newValue.toLocaleUpperCase()}}else if(this.options.toLower){if(newValue){newValue=newValue.toLocaleLowerCase()}}if(this._focused){this._editorInput.val(newValue)}this._processValueChanging(newValue);this._processTextChanged();this._setCursorPosition(selection.start+newValue.length)}else{this._editorInput.val(previousValue)}},_clearDropDownHoverActiveItem:function(){var hoveredItem=this._dropDownList.children(".ui-igedit-listitem").filter("[data-hovered='true']"),activeItem=this._dropDownList.children(".ui-igedit-listitem").filter("[data-active='true']");if(hoveredItem.length>0){hoveredItem.removeClass(this.css.listItemHover);hoveredItem.removeAttr("data-hovered")}if(activeItem.length>0){activeItem.removeClass(this.css.listItemActive);activeItem.removeAttr("data-active")}},_showDropDownList:function(){var direction;this._positionDropDownList();if(this._dropDownListOrientation==="up"){direction="down"}else{direction="up"}try{$(this._dropDownList).show("blind",{direction:direction},this.options.dropDownAnimationDuration,$.proxy(this._triggerDropDownOpened,this))}catch(ex){$(this._dropDownList).show(this.options.dropDownAnimationDuration,$.proxy(this._triggerDropDownOpened,this))}this._editorInput.attr("aria-expanded",true)},_hideDropDownList:function(){var direction;if(this._dropDownListOrientation==="up"){direction="down"}else{direction="up"}try{$(this._dropDownList).hide("blind",{direction:direction},this.options.dropDownAnimationDuration,$.proxy(this._triggerDropDownClosed,this))}catch(ex){$(this._dropDownList).hide(this.options.dropDownAnimationDuration,$.proxy(this._triggerDropDownClosed,this))}this._editorInput.attr("aria-expanded",false);this._clearDropDownHoverActiveItem()},_toggleDropDown:function(){var noCancel;if(this._dropDownList.is(":visible")){noCancel=this._triggerDropDownClosing();if(noCancel){this._hideDropDownList()}}else{noCancel=this._triggerDropDownOpening();if(noCancel){this._editorInput.focus();this._showDropDownList()}}},_validateKey:function(event){var ch,result;if(this.options.excludeKeys){ch=String.fromCharCode(event.charCode||event.which);if($.inArray(ch,this._excludeKeysArray)!==-1){result=false}else{result=true}}else if(this.options.includeKeys){ch=String.fromCharCode(event.charCode||event.which);if($.inArray(ch,this._includeKeysArray)!==-1){result=true}else{result=false}}else{result=true}return result},_enterEditMode:function(){this._editMode=true;var selection=this._getSelection(this._editorInput[0]);this._currentInputTextValue=this._editorInput.val();this._editorInput.val(this._valueInput.val());this._positionCursor(selection.start,selection.end);this._processTextChanged()},_exitEditMode:function(){if(this.options.textMode==="text"&&!$.ig.util.isIE8){this._editorInput.attr("type","text")}this._currentInputTextValue=this._editorInput.val();this._editorInput.val(this._getDisplayValue());this._editMode=false;this._processTextChanged()},_getDisplayValue:function(){return this._valueInput.val()},_valueFromText:function(text){return text},_getSelectionRange:function(){var selection;if(window.getSelection){selection=window.getSelection();if(selection.rangeCount){return selection.getRangeAt(0)}}else if(document.selection){return document.selection.createRange()}},_setCursorPosition:function(positionIndex){this._setSelectionRange(this._editorInput[0],positionIndex,positionIndex)},_setSelectionRange:function(input,selectionStart,selectionEnd){if(input.setSelectionRange){input.setSelectionRange(selectionStart,selectionEnd)}else if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",selectionEnd);range.moveStart("character",selectionStart);range.select()}},_positionCursor:function(startPostion,endPosition){var currentValue=this._editorInput.val(),self=this;if(currentValue&&currentValue.length>0){switch(this.options.selectionOnFocus){case"selectAll":{if($.ig.util.isChrome||$.ig.util.isSafari){this._timeouts.push(setTimeout(function(){self._setSelectionRange(self._editorInput[0],0,currentValue.length)},100))}else{this._editorInput.select()}}break;case"atStart":{if($.ig.util.isChrome||$.ig.util.isSafari){this._timeouts.push(setTimeout(function(){self._setSelectionRange(self._editorInput[0],0,0)},100))}else{this._setSelectionRange(this._editorInput[0],0,0)}}break;case"atEnd":{if($.ig.util.isChrome||$.ig.util.isSafari){this._timeouts.push(setTimeout(function(){self._setSelectionRange(self._editorInput[0],currentValue.length,currentValue.length)},100))}else{this._setSelectionRange(this._editorInput[0],currentValue.length,currentValue.length)}}break;case"browserDefault":{if(startPostion){if(endPosition){if(endPosition>currentValue.length-1){endPosition=currentValue.length-1}}else{endPosition=startPostion}if($.ig.util.isChrome||$.ig.util.isSafari){this._timeouts.push(setTimeout(function(){self._setSelectionRange(self._editorInput[0],startPostion,endPosition)},100))}else{this._setSelectionRange(this._editorInput[0],startPostion,endPosition)}}else{if($.ig.util.isChrome||$.ig.util.isSafari){this._timeouts.push(setTimeout(function(){self._setSelectionRange(self._editorInput[0],0,currentValue.length)},100))}else{this._editorInput.select()}}}break;default:}}else{this._editorInput.select()}},_spinUp:function(){if(this._dropDownList&&this._dropDownList.is(":visible")){this._hoverPreviousDropDownListItem()}},_spinDown:function(){if(this._dropDownList&&this._dropDownList.is(":visible")){this._hoverNextDropDownListItem()}},_handleSpinUpEvent:function(){this._spinUp()},_handleSpinDownEvent:function(){this._spinDown()},_handleSpinEvent:function(type,target){var self=this;if(type==="spinUp"){this._handleSpinUpEvent();if(!target.attr("disabled")){target._spinTimeOut=setTimeout(function(){target._spinInterval=setInterval(function(){self._handleSpinUpEvent()},75)},300)}}else if(type==="spinDown"){this._handleSpinDownEvent();if(!target.attr("disabled")){target._spinTimeOut=setTimeout(function(){target._spinInterval=setInterval(function(){self._handleSpinDownEvent()},75)},300)}}this._timeouts.push(target._spinTimeOut)},_clearValue:function(){this._super();if(this._dropDownList&&this._dropDownList.children(".ui-igedit-listitemselected").length>0){this._dropDownList.children(".ui-igedit-listitemselected").removeClass(this.css.listItemSelected)}},_clearEditorNotifier:function(){var notifier=this._editorContainer.data("igNotifier");if(notifier&&notifier.options.state==="warning"&&notifier.isVisible()){notifier.hide()}},_getCursorPosition:function(){var selection=this._getSelection(this._editorInput[0]);if(selection.end-selection.start===this._editorInput.val().length&&this._editorInput.val().length>0){return-1}else{return selection.start}},_getSelection:function(editor){var startPostion=0,endPosition=0;if(editor.selectionStart!==undefined){startPostion=editor.selectionStart;endPosition=editor.selectionEnd}else if(document.selection){var globalSelection=document.selection.createRange(),range,rangeClone;if(globalSelection!==null){range=editor.createTextRange();rangeClone=range.duplicate();range.moveToBookmark(globalSelection.getBookmark());endPosition=range.text.length;rangeClone.setEndPoint("EndToStart",range);startPostion=rangeClone.text.length;endPosition+=startPostion}}return{start:startPostion,end:endPosition}},_getLocaleOption:function(key){var locale=this.options.locale;if(locale&&locale[key]){return locale[key]}else if($.ig&&$.ig.Editor&&$.ig.Editor.locale){return $.ig.Editor.locale[key]}else{return""}},_listItems:function(){return this._dropDownList.children(".ui-igedit-listitem")},_getListItemByIndex:function(index){return this._dropDownList.children(".ui-igedit-listitem:nth-child("+(index+1)+")")},_getSelectedItemIndex:function(){var items=this._listItems(),i;for(i=0;i<items.length;i++){if($(items[i]).hasClass(this.css.listItemSelected)){return i}}return-1},_setSelectedItemByIndex:function(index){var oldSelectedItem,newSelectedItem;if(this._getSelectedItemIndex()!==index){oldSelectedItem=this.getSelectedListItem();oldSelectedItem.removeClass(this.css.listItemSelected);oldSelectedItem.removeAttr("data-active");newSelectedItem=this._getListItemByIndex(index);newSelectedItem.addClass(this.css.listItemSelected);if(this.dropDownVisible()){newSelectedItem.attr("data-active",true)}}},displayValue:function(){return this._getDisplayValue()},dropDownContainer:function(){return this._dropDownList?this._dropDownList:null},showDropDown:function(){this._showDropDownList()},hideDropDown:function(){this._hideDropDownList()},dropDownButton:function(){return this._dropDownButton},dropDownVisible:function(){return this._dropDownList.is(":visible")},clearButton:function(){return this._clearButton},findListItemIndex:function(text,matchType){var list=this.options.listItems,matchCase="i",index=-1,regString,regExp,i;if(!list||list.length===0){return-1}switch(matchType){case"startsWith":regString="^{pattern}";break;case"endsWith":regString="{pattern}$";break;case"exact":regString="^{pattern}$";matchCase=undefined;break;default:regString="{pattern}";break}regExp=new RegExp(regString.replace("{pattern}",$.ig.util.escapeRegExp(text)),matchCase);for(i=0;i<list.length;i++){if(regExp.test(list[i])){index=i}}return index},selectedListIndex:function(index){if(index!==undefined){this._setSelectedItemByIndex(index)}else{return this._getSelectedItemIndex()}},getSelectedListItem:function(){return this._listItems().filter(".ui-igedit-listitemselected")},getSelectedText:function(){var text=this._editMode?this._editorInput.val():this.displayValue(),startIndex=this.getSelectionStart(),endIndex=this.getSelectionEnd();if(startIndex===undefined||endIndex===undefined||startIndex===null||endIndex===null||startIndex===endIndex){return""}return text.substring(startIndex,endIndex)},getSelectionStart:function(){return this._getSelection(this._editorInput[0]).start},getSelectionEnd:function(){return this._getSelection(this._editorInput[0]).end},insert:function(string){this._insertHandler(string)},select:function(start,end){this._setSelectionRange(this._editorInput[0],start,end)},spinUp:function(){this._spinUp()},spinDown:function(){this._spinDown()},spinUpButton:function(){return this._spinUpButton},spinDownButton:function(){return this._spinDownButton}});$.widget("ui.igNumericEditor",$.ui.igTextEditor,{options:{regional:null,negativeSign:null,negativePattern:null,decimalSeparator:null,groupSeparator:null,groups:null,maxDecimals:null,minDecimals:null,textAlign:"right",dataMode:"double",minValue:null,maxValue:null,allowNullValue:false,spinDelta:1,scientificFormat:null,spinWrapAround:false,maxLength:null,excludeKeys:null,includeKeys:null,toLower:null,toUpper:null},events:{},css:{negative:"ui-igedit-negative"},_create:function(){$.ui.igTextEditor.prototype._create.call(this);if(!$.ig.util.isIE8){this._editorInput.attr("type","tel")}},_initialize:function(){this._super();this._applyRegionalSettings();this._applyDataModeSettings();this._setNumericType();var numericChars="0123456789",dataMode=this.options.dataMode;if(dataMode==="double"||dataMode==="float"){numericChars+=this.options.decimalSeparator;if(this.options.decimalSeparator!=="."){numericChars+="."}}if(this._getScientificFormat()){numericChars+=this._getScientificFormat()}if(dataMode==="double"||dataMode==="float"||dataMode==="long"||dataMode==="int"||dataMode==="short"||dataMode==="sbyte"){numericChars+=this.options.negativeSign}if(this.options.excludeKeys){this.options.excludeKeys=null}this.options.includeKeys=numericChars},_setNumericType:function(){this._numericType="numeric"},_getScientificFormat:function(){var result;if(this.options.scientificFormat){switch(this.options.scientificFormat){case"E":case"E+":{result="E"}break;case"e":case"e+":{result="e"}break;default:{result="e";throw $.ig.Editor.locale.scientificFormatErrMsg}}}else{result=null}return result},_applyRegionalSettings:function(){this.options.negativeSign=this._getRegionalOption("negativeSign");this.options.negativePattern=this.options.negativePattern||this._getRegionalOption("numericNegativePattern");this.options.decimalSeparator=this.options.decimalSeparator||this._getRegionalOption("numericDecimalSeparator");this.options.groupSeparator=this.options.groupSeparator!==null?this.options.groupSeparator:this._getRegionalOption("numericGroupSeparator");this.options.groups=this.options.groups||this._getRegionalOption("numericGroups");this.options.maxDecimals=this.options.maxDecimals===null?this._getRegionalOption("numericMaxDecimals"):this.options.maxDecimals;this.options.minDecimals=this.options.minDecimals===null?this._getRegionalOption("numericMinDecimals"):this.options.minDecimals},_applyOptions:function(){var delta,fractional;this._super();if(this.options.spinDelta!==1){delta=this.options.spinDelta;if(typeof delta!=="number"){this.options.spinDelta=1;throw new Error($.ig.Editor.locale.spinDeltaIsOfTypeNumber)}if(delta<0){this.options.spinDelta=1;throw new Error($.ig.Editor.locale.spinDeltaCouldntBeNegative)}if(this.options.dataMode==="float"||this.options.dataMode==="double"){if(delta%1!==0){fractional=delta.toString().substring(delta.toString().indexOf(".")+1);if(fractional.toString().length>this.options.maxDecimals){throw new Error($.ig.util.stringFormat($.ig.Editor.locale.spinDeltaContainsExceedsMaxDecimals,this.options.maxDecimals))}}}else{if(delta%1!==0){throw new Error($.ig.Editor.locale.spinDeltaIncorrectFloatingPoint)}}}if(this.options.scientificFormat){this.options.spinDelta=Number(this.options.spinDelta.toExponential())}if(this.options.maxLength!==null){this.options.maxLength=null}if(this.options.value<0){this._editorInput.addClass(this.css.negative)}},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"spinDelta":{if(typeof value!=="number"){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.spinDeltaIsOfTypeNumber)}else if(value<0){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.spinDeltaCouldntBeNegative)}else if(this.options.dataMode!=="float"&&this.options.dataMode!=="double"&&value%1!==0){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.spinDeltaIncorrectFloatingPoint)}else if(this.options.scientificFormat){this.options[option]=Number(value.toExponential())}break}case"minDecimals","maxDecimals":value=parseFloat(value);if(isNaN(value)){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.notEditableOptionByInit)}break;case"excludeKeys":case"includeKeys":this.options[option]=prevValue;throw new Error($.ig.Editor.locale.numericEditorNoSuchOption);default:{this.options[option]=prevValue;this._super(option,value)}break}},_processValueChanging:function(value){if(typeof value==="string"||value instanceof String){value=value.trim();value=this._parseNumericValueByMode(value,this._numericType,this.options.dataMode);if(this._numericType==="percent"&&this.options.displayFactor){value=this._divideWithPrecision(value,this.options.displayFactor)}}this._super(value)},_processInternalValueChanging:function(value){if(!this._validateValue(value)){value=this._parseNumericValueByMode(value,this._numericType,this.options.dataMode);if(value!==""&&!isNaN(value)){if(this.options.revertIfNotValid){value=this._valueInput.val()}else{if(value<=this.options.minValue){value=this.options.minValue}else{value=this.options.maxValue}}}else{if(this.options.allowNullValue){value=this.options.nullValue}else{if(this.options.revertIfNotValid){value=this._valueInput.val()}else{value=0;if(this.options.minValue>0){value=this.options.minValue}else if(this.options.maxValue<0){value=this.options.maxValue}else{value=0}}}}}if(value!==this.value()){this._updateValue(value)}this._setSpinButtonsState(value)},_triggerKeyDown:function(event){var e=event,noCancel,args,currentInputVal;args={owner:this,element:event.target,key:event.keyCode,editorInput:this._editorInput};
noCancel=this._trigger(this.events.keydown,event,args);if(noCancel){this._clearEditorNotifier();if(e.keyCode===13){currentInputVal=this._editorInput.val();this._processValueChanging(currentInputVal)}else if(e.keyCode===38){if(e.altKey&&this._dropDownList&&this._dropDownList.is(":visible")){this._toggleDropDown()}else if(!this.options.readOnly){this._handleSpinUpEvent()}}else if(e.keyCode===40){if(e.altKey&&this._dropDownList&&!this._dropDownList.is(":visible")){this._toggleDropDown()}else if(!this.options.readOnly){this._handleSpinDownEvent()}}else if(e.keyCode===27&&this._dropDownList&&this._dropDownList.is(":visible")){this._toggleDropDown()}else if(this.options.maxLength){currentInputVal=this._editorInput.val();if(currentInputVal.length===this.options.maxLength&&e.keyCode>46&&!e.altKey&&!e.ctrlKey&&!e.shiftKey){e.preventDefault();e.stopPropagation()}}}return noCancel},_applyDataModeSettings:function(){var doubleMaxDecimals=15;switch(this.options.dataMode){case"double":{this._setMinMaxValues(-Number.MAX_VALUE,Number.MAX_VALUE);this._setMinMaxDecimals(doubleMaxDecimals)}break;case"float":{var floatMaxDecimals=7,floatMinValue=-3.40282347e38,floatMaxValue=3.40282347e38;this._setMinMaxValues(floatMinValue,floatMaxValue);this._setMinMaxDecimals(floatMaxDecimals)}break;case"long":{var longMinValue=-0x8000000000000000,longMaxValue=0x8000000000000000;this._setMinMaxValues(longMinValue,longMaxValue)}break;case"ulong":{var ulongMinValue=0,ulongMaxValue=0x10000000000000000;this._setMinMaxValues(ulongMinValue,ulongMaxValue)}break;case"int":{var intMinValue=-2147483647,intMaxValue=2147483647;this._setMinMaxValues(intMinValue,intMaxValue)}break;case"uint":{var uintMinValue=0,uintMaxValue=4294967295;this._setMinMaxValues(uintMinValue,uintMaxValue)}break;case"short":{var shortMinValue=-32768,shortMaxValue=32767;this._setMinMaxValues(shortMinValue,shortMaxValue)}break;case"ushort":{var ushortMinValue=0,ushortMaxValue=65535;this._setMinMaxValues(ushortMinValue,ushortMaxValue)}break;case"sbyte":{var sbyteMinValue=-127,sbyteMaxValue=127;this._setMinMaxValues(sbyteMinValue,sbyteMaxValue)}break;case"byte":{var byteMinValue=0,byteMaxValue=256;this._setMinMaxValues(byteMinValue,byteMaxValue)}break;default:{this.options.dataMode="double";this._setMinMaxValues(Number.MIN_VALUE,Number.MAX_VALUE);this._setMinMaxDecimals(doubleMaxDecimals)}}},_setMinMaxDecimals:function(typeMaxDecimals){if(this.options.maxDecimals===null||this.options.maxDecimals>typeMaxDecimals){this.options.maxDecimals=typeMaxDecimals}if(this.options.minDecimals&&this.options.minDecimals>this.options.maxDecimals){this.options.maxDecimals=this.options.minDecimals}},_setMinMaxValues:function(typeMinValue,typeMaxValue){if(this.options.minValue===null||this.options.minValue<typeMinValue){this.options.minValue=typeMinValue}if(this.options.maxValue===null||this.options.maxValue>typeMaxValue){this.options.maxValue=typeMaxValue}},_parseNumericValueByMode:function(value,numericEditorType,dataMode){var val,stringValue,decimalSeparator,groupSeparator,minDecimals,maxDecimals;decimalSeparator=this.options.decimalSeparator;groupSeparator=this.options.groupSeparator;minDecimals=this.options.minDecimals;maxDecimals=this.options.maxDecimals;if(value===null||value===""){return value}if($.type(value)!=="number"){value=$.ig.util.IMEtoNumberString(value,$.ig.util.IMEtoENNumbersMapping);value=value.toString().replace(new RegExp($.ig.util.escapeRegExp(groupSeparator),"g"),"");if(this.options.negativeSign!=="-"){value=value.replace(this.options.negativeSign,"-")}if(numericEditorType==="percent"){value=value.replace(this.options.percentSymbol,"").trim()}else if(numericEditorType==="currency"){value=value.replace(this.options.currencySymbol,"").trim()}}if(dataMode==="double"||dataMode==="float"){stringValue=value.toString().toLowerCase();if(stringValue.indexOf("e")!==-1){val=value}else{if(stringValue.indexOf(decimalSeparator)!==-1||stringValue.indexOf(".")!==-1){var integerDigits,fractionalDigits;if(stringValue.indexOf(".")!==-1){decimalSeparator="."}fractionalDigits=stringValue.substring(stringValue.indexOf(decimalSeparator)+1);if(fractionalDigits.indexOf(decimalSeparator)>0){fractionalDigits=fractionalDigits.substring(0,fractionalDigits.indexOf(decimalSeparator))}if(fractionalDigits.length>maxDecimals){fractionalDigits=fractionalDigits.substring(0,maxDecimals)}integerDigits=stringValue.substring(0,stringValue.indexOf(decimalSeparator));val=(integerDigits+"."+fractionalDigits)/1}else{val=parseFloat(parseInt(value).toFixed(minDecimals))}}}else{if(value.toString().toLowerCase().indexOf("e")!==-1){value=this._toFixed(value.toString().toLocaleLowerCase())}if(this._numericType==="percent"&&this.options.displayFactor===100&&this.options.dataMode==="int"&&parseInt(value)!==parseInt(this._editorInput.val())){val=value}else{val=parseInt(value)}}if(this.options.scientificFormat&&val.toString().toLowerCase().indexOf("e")===-1){val=val.toExponential()}return val},_toFixed:function(x){var e;if(Math.abs(x)<1){e=parseInt(x.toString().split("e-")[1]);if(e){x*=Math.pow(10,e-1);x="0."+new Array(e).join("0")+x.toString().substring(2)}}else{e=parseInt(x.toString().split("+")[1]);if(e>20){e-=20;x/=Math.pow(10,e);x+=new Array(e+1).join("0")}}return x},_multiplyWithPrecision:function(value1,value2,precision){var fractionalDigits,fractionalDigits2,result;if(!precision){fractionalDigits=value1.toString().indexOf(".")>0?value1.toString().substring(value1.toString().indexOf(".")+1):"";fractionalDigits2=value2.toString().indexOf(".")>0?value2.toString().substring(value2.toString().indexOf(".")+1):"";if(fractionalDigits2.length){fractionalDigits+=fractionalDigits2}precision=Math.pow(10,fractionalDigits.length)}value1*=precision;value2*=precision;result=value1*value2/(precision*precision);return result.toFixed(fractionalDigits.length)*1},_divideWithPrecision:function(value1,value2){var fractionalDigits,fractionalDigits2,precision;fractionalDigits=value1.toString().indexOf(".")>0?value1.toString().substring(value1.toString().indexOf(".")+1):"";fractionalDigits2=value2.toString().indexOf(".")>0?value2.toString().substring(value2.toString().indexOf(".")+1):"";if(fractionalDigits2.length>fractionalDigits.length){fractionalDigits=fractionalDigits2}precision=Math.pow(10,fractionalDigits.length);value1=this._multiplyWithPrecision(value1,precision);value2=this._multiplyWithPrecision(value2,precision);return value1/value2},_updateValue:function(value){var val,dataMode=this.options.dataMode;if(value===""&&this.options.allowNullValue){val=this.options.nullValue;this._valueInput.val("")}else if(value===this.options.nullValue&&value===null){val=value;this._valueInput.val("")}else{val=this._parseNumericValueByMode(value,this._numericType,dataMode);this._valueInput.val(val)}this.options.value=val},_validateKey:function(event){if(this._super(event)){var dataMode=this.options.dataMode,negativeSign=this.options.negativeSign,ch,val,cursorPos=this._getCursorPosition(),isDecimal=event.which?event.which===46:false;ch=String.fromCharCode(event.charCode||event.which);if(ch===negativeSign&&cursorPos>0){return false}if(dataMode==="double"||dataMode==="float"){var decimalSeparator=this.options.decimalSeparator;val=this._editorInput.val();if(decimalSeparator!=="."&&isDecimal&&(val.indexOf(".")!==-1||val.indexOf(decimalSeparator)!==-1)&&cursorPos!==-1){return false}if((ch===decimalSeparator||isDecimal)&&(val.indexOf(decimalSeparator)!==-1||val.indexOf(".")!==-1)&&cursorPos!==-1||ch===negativeSign&&val.indexOf(negativeSign)!==-1&&cursorPos!==-1){return false}else{return true}}else if(dataMode==="long"||dataMode==="int"||dataMode==="short"||dataMode==="sbyte"){val=$(event.target).val();if(ch===negativeSign&&val.indexOf(negativeSign)>0&&cursorPos!==-1){return false}else{return true}}else{return true}}else{return false}},_disableSpinButton:function(target){if(target&&!target.attr("disabled")&&!this.options.spinWrapAround){target.addClass(this.css.disabled);target.attr("disabled",true);target.removeClass(this.css.buttonHover);if(target._pressed){delete target._pressed;target.removeClass(this.css.buttonPressed)}if(target._spinTimeOut){clearTimeout(target._spinTimeOut);delete this._spinUpButton._spinTimeOut}if(target._spinInterval){clearInterval(target._spinInterval);delete target._spinInterval}this._detachButtonsEvents(target)}},_enableSpinButton:function(target,type){if(target&&target.attr("disabled")){target.removeClass(this.css.disabled);target.attr("disabled",false);this._attachButtonsEvents(type,target)}},_setSpinButtonsState:function(val){if(typeof val==="string"||val instanceof String){val=val.trim()}if(val===null){this._enableSpinButton(this._spinDownButton,"spinDown");this._enableSpinButton(this._spinUpButton,"spinUp");return}if(val!==""&&!this.options.spinWrapAround){if(val>=this.options.maxValue){this._disableSpinButton(this._spinUpButton);this._enableSpinButton(this._spinDownButton,"spinDown");this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValErrMsg,this.options.maxValue))}else if(val<=this.options.minValue){this._disableSpinButton(this._spinDownButton);this._enableSpinButton(this._spinUpButton,"spinUp");this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValErrMsg,this.options.minValue))}else{this._enableSpinButton(this._spinDownButton,"spinDown");this._enableSpinButton(this._spinUpButton,"spinUp")}}},_validateValue:function(val){var result;if(this._super(val)&&!isNaN(val=this._parseNumericValueByMode(val,this._numericType,this.options.dataMode))){if(val>this.options.maxValue){result=false;if(this.options.revertIfNotValid){this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValExceedRevertErrMsg,this.options.maxValue))}}else if(val<this.options.minValue){result=false;if(this.options.revertIfNotValid){this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValExceedRevertErrMsg,this.options.minValue))}}else{result=true}}else{result=false}return result},_insert:function(newValue,previousValue){if(!isNaN(newValue=this._parseNumericValueByMode(newValue,this._numericType,this.options.dataMode))){if(this.options.maxValue&&newValue>this.options.maxValue){newValue=this.options.maxValue}else if(this.options.minValue&&newValue<this.options.minValue){newValue=this.options.minValue}if(!this._validateValue(newValue)&&this.options.revertIfNotValid){newValue=previousValue}else if(this.options.revertIfNotValid){newValue=previousValue}else{newValue=""}this._editorInput.val(newValue);this._setSpinButtonsState(newValue);this._processTextChanged()}},_clearValue:function(){if(this.options.allowNullValue){this._updateValue(this.options.nullValue);if(this.options.nullValue===null){this._editorInput.val("")}else{this._editorInput.val(this.options.nullValue)}}else{if(this.options.minValue&&this.options.minValue>0){this._updateValue(this.options.minValue);this._editorInput.val(this.options.minValue)}else if(this.options.maxValue&&this.options.maxValue<0){this._updateValue(this.options.maxValue);this._editorInput.val(this.options.maxValue)}else{if(this.value()){this._updateValue(0);this._editorInput.val(0)}}}if(this.dropDownContainer()&&this.dropDownContainer().children(".ui-igedit-listitemselected").length>0){this.dropDownContainer().children(".ui-igedit-listitemselected").removeClass(this.css.listItemSelected)}},_getRegionalOption:function(key){var regional=this.options.regional;if(this.options[key]){return this.options[key]}if(typeof regional==="string"){regional=$.ig.regional[regional]}if(regional&&regional[key]){return regional[key]}else{return $.ig.regional.defaults[key]}},_convertScientificToNumeric:function(num){var parts=num.toString().split("e+"),first,zeroes,i;first=parts[0].replace(".","");zeroes=parseInt(parts[1],10)-(first.length-1);for(i=0;i<zeroes;i++){first+="0"}return first},_getDisplayValue:function(){var value=this._valueInput.val(),decimalSeparator=this.options.decimalSeparator,decimalPoint=".",minDecimals=this.options.minDecimals,dataMode=this.options.dataMode,stringValue,displayValue,integerDigits,fractionalDigits,scientificPrecision,scientificValue,negativeSign,positivePattern,negativePattern,groups,groupSeparator,symbol="";if(value===this.options.nullValue||value===""||isNaN(value)){if(isNaN(value)){this._valueInput.val("");return""}else{return value}}if(this._numericType!=="numeric"){positivePattern=this.options.positivePattern;symbol=this.options[this._numericType+"Symbol"]}negativePattern=this.options.negativePattern;groups=this.options.groups;groupSeparator=this.options.groupSeparator;if(this._numericType==="percent"&&this.options.displayFactor){value=this._multiplyWithPrecision(value,this.options.displayFactor);value=this._parseNumericValueByMode(value,this._numericType,this.options.dataMode)}if(dataMode==="double"||dataMode==="float"){stringValue=value.toString().toLowerCase();if(this.options.scientificFormat){if(stringValue.indexOf("e")!==-1){displayValue=stringValue.replace("e",this._getScientificFormat())}else{scientificValue=(stringValue/1).toExponential();displayValue=scientificValue.toString().replace("e",this._getScientificFormat())}}else{if(stringValue.indexOf("e")!==-1){scientificPrecision=stringValue.substring(stringValue.toLowerCase().indexOf("e")+1);stringValue=stringValue/1;if(scientificPrecision>0){stringValue=this._convertScientificToNumeric(stringValue)}else{stringValue=stringValue.toFixed(Math.abs(scientificPrecision))}}if(stringValue.indexOf("e")!==-1){displayValue=stringValue}else{if(stringValue.indexOf(decimalPoint)!==-1){fractionalDigits=stringValue.substring(stringValue.indexOf(decimalPoint)+1);if(fractionalDigits.length<minDecimals){var missingDecimals=minDecimals-fractionalDigits.length;while(missingDecimals>0){fractionalDigits+="0";missingDecimals--}}integerDigits=stringValue.substring(0,stringValue.indexOf(decimalPoint))}else{integerDigits=stringValue;if(minDecimals>0){stringValue=parseInt(stringValue).toFixed(minDecimals);fractionalDigits=stringValue.substring(stringValue.indexOf(decimalPoint)+1)}}integerDigits=this._applyGroups(integerDigits,groups,groupSeparator);if(fractionalDigits&&fractionalDigits.length>0){displayValue=integerDigits+decimalSeparator+fractionalDigits}else{displayValue=integerDigits}}}}else{displayValue=this._applyGroups(value.toString(),groups,groupSeparator)}if(value<0&&(this.options.scientificFormat===null||displayValue.indexOf("e")===-1)){negativeSign=this.options.negativeSign;displayValue=displayValue.replace("-","");displayValue=negativePattern.replace("n",displayValue).replace("$",symbol).replace("-",negativeSign)}else if(positivePattern&&(this.options.scientificFormat===null||displayValue.indexOf("e")===-1)){displayValue=positivePattern.replace("n",displayValue).replace("$",symbol)}return displayValue},_valueFromText:function(text){return this._parseNumericValueByMode(text,this._numericType,this.options.dataMode)},_applyGroups:function(integerDigits,groups,groupSeparator){var digitsPosition=integerDigits.length-1,br=1,l=groups.length,digitsLimit=0,group;group=groups.length>0?groups[0]:0;if(group>integerDigits.length||group===0){return integerDigits}if(parseFloat(integerDigits)<0){digitsLimit=1}for(digitsPosition;digitsPosition>digitsLimit;digitsPosition--){if(--group===0){integerDigits=integerDigits.substring(0,digitsPosition)+groupSeparator+integerDigits.substring(digitsPosition);if(br===l){group=groups[--br]}else{group=groups[br];br++}}}return integerDigits},_enterEditMode:function(){var val,selection=this._getSelection(this._editorInput[0]);if(!$.ig.util.isIE8){this._editorInput.attr("type","tel")}this._currentInputTextValue=this._editorInput.val();val=this._valueInput.val();if(val<0){this._editorInput.removeClass(this.css.negative)}if(this._numericType==="percent"&&this.options.displayFactor){val=this._parseNumericValueByMode(val,this._numericType,this.options.dataMode);val=this._multiplyWithPrecision(val,this.options.displayFactor)}if(this.options.decimalSeparator!=="."){val=val.toString().replace(".",this.options.decimalSeparator)}if(this.options.negativeSign!=="-"){val=val.toString().replace("-",this.options.negativeSign)}this._editorInput.val(val);this._editMode=true;this._positionCursor(selection.start,selection.end);this._processTextChanged()},_exitEditMode:function(){this._super();if(this.value()<0){this._editorInput.addClass(this.css.negative)}else{this._editorInput.removeClass(this.css.negative)}},_getSpinValue:function(spinType,currentValue,decimalSeparator){var fractional,scientificPrecision,spinPrecision,valuePrecision,spinDelta,toFixedVal,precision;if(currentValue.toString().toLowerCase().indexOf("e")!==-1){currentValue=Number(currentValue);if(this.options.spinDelta.toString().toLowerCase().indexOf("e")===-1){spinDelta=Number(this.options.spinDelta.toExponential())}else{spinDelta=this.options.spinDelta}if(spinType==="spinUp"){currentValue+=spinDelta}else{currentValue-=spinDelta}}else if(currentValue.toString().indexOf(decimalSeparator)!==-1){fractional=currentValue.substring(currentValue.toString().indexOf(decimalSeparator)+1);toFixedVal=fractional.toString().length;if(decimalSeparator!=="."){currentValue=currentValue.toString().replace(decimalSeparator,".")}currentValue=currentValue/1;if(this.options.spinDelta.toString().toLowerCase().indexOf("e")!==-1){currentValue=Number(currentValue.toExponential());scientificPrecision=this.options.spinDelta.toString().toLowerCase().substring(this.options.spinDelta.toString().toLowerCase().indexOf("e")+1);spinPrecision=Math.abs(scientificPrecision)}else{spinPrecision=this.options.spinDelta.toString().toLowerCase().substring(this.options.spinDelta.toString().toLowerCase().indexOf(".")+1).length;valuePrecision=currentValue.toString().substring(currentValue.toString().indexOf(".")+1).length;spinPrecision=valuePrecision>spinPrecision?valuePrecision:spinPrecision}precision=Math.pow(10,spinPrecision);if(spinType==="spinUp"){if(currentValue===0&&scientificPrecision){currentValue=this.options.spinDelta.toFixed(spinPrecision)}else{currentValue=(Math.round(currentValue*precision)+Math.round(this.options.spinDelta*precision))/precision}}else{if(currentValue===0&&scientificPrecision){currentValue=(-this.options.spinDelta).toFixed(spinPrecision)}else{currentValue=(Math.round(currentValue*precision)-Math.round(this.options.spinDelta*precision))/precision}}if(currentValue.toString().substring(currentValue.toString().indexOf(".")+1).length<fractional.length){currentValue=currentValue.toFixed(toFixedVal)}if(decimalSeparator!=="."){currentValue=currentValue.toString().replace(".",decimalSeparator)}}else{currentValue=currentValue/1;if(this.options.spinDelta%1===0){if(spinType==="spinUp"){currentValue+=this.options.spinDelta}else{currentValue-=this.options.spinDelta}}else{if(this.options.spinDelta.toString().toLowerCase().indexOf("e")!==-1){scientificPrecision=this.options.spinDelta.toString().toLowerCase().substring(this.options.spinDelta.toString().toLowerCase().indexOf("e")+1);spinPrecision=Math.abs(scientificPrecision)}else{spinPrecision=this.options.spinDelta.toString().toLowerCase().substring(this.options.spinDelta.toString().toLowerCase().indexOf(".")+1).length}precision=Math.pow(10,spinPrecision);if(spinType==="spinUp"){if(currentValue===0){currentValue=this.options.spinDelta.toFixed(spinPrecision)}else{currentValue=(Math.round(currentValue*precision)+Math.round(this.options.spinDelta*precision))/precision}}else{if(currentValue===0){currentValue=(-this.options.spinDelta).toFixed(spinPrecision)}else{currentValue=(Math.round(currentValue*precision)-Math.round(this.options.spinDelta*precision))/precision}}}}return currentValue},_spinUp:function(){var currVal,decimalSeparator=this.options.decimalSeparator,noCancel;if(this._focused){currVal=this._editorInput.val()}else{if(this.value()||this.value()===0){currVal=this.value().toString()}else{currVal=""}}this._clearEditorNotifier();this._currentInputTextValue=this._editorInput.val();currVal=this._getSpinValue("spinUp",currVal,decimalSeparator);if(!this._validateValue(currVal)&&currVal>this.options.maxValue&&this.options.spinWrapAround||currVal<this.options.minValue){currVal=this.options.minValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValExceededWrappedAroundErrMsg,this.options.maxValue))}else if(currVal>=this.options.maxValue&&!this.options.spinWrapAround){currVal=this.options.maxValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValErrMsg,this.options.maxValue))}if(this._focused){if(this.options.scientificFormat){currVal=Number(currVal).toExponential().replace("e",this._getScientificFormat())}this._editorInput.val(currVal);this._processTextChanged()}else{noCancel=this._triggerValueChanging(currVal);if(noCancel){this._updateValue(currVal);this._exitEditMode();this._triggerValueChanged(currVal)}}this._setSpinButtonsState(currVal)},_spinDown:function(){var currVal,decimalSeparator=this.options.decimalSeparator,noCancel;if(this._focused){currVal=this._editorInput.val()}else{if(this.value()||this.value()===0){currVal=this.value().toString()}else{currVal=""}}this._clearEditorNotifier();this._currentInputTextValue=this._editorInput.val();currVal=this._getSpinValue("spinDown",currVal,decimalSeparator);if(!this._validateValue(currVal)&&currVal<this.options.minValue&&this.options.spinWrapAround||currVal>this.options.maxValue){currVal=this.options.maxValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValExceededWrappedAroundErrMsg,this.options.minValue))}else if(currVal<=this.options.minValue&&!this.options.spinWrapAround){currVal=this.options.minValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValErrMsg,this.options.minValue))}if(this._focused){if(this.options.scientificFormat){currVal=Number(currVal).toExponential().replace("e",this._getScientificFormat())}this._editorInput.val(currVal);this._processTextChanged()}else{noCancel=this._triggerValueChanging(currVal);if(noCancel){this._updateValue(currVal);this._exitEditMode();this._triggerValueChanged(currVal)}}this._setSpinButtonsState(currVal)},_handleSpinUpEvent:function(){var cursorPosition=this._getCursorPosition();if(this.options.dataMode==="double"||this.options.dataMode==="float"){if(this._focused){switch(this._fractionalOrIntegerSelected(cursorPosition)){case"fractional":{this._spinUp(true);this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition)}break;case"integer":{this._spinUp();this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition)}break;case"all":{this._spinUp();this._editorInput.select()}break;default:this._spinUp();this._editorInput.select()}}else{this._spinUp()}}else{this._spinUp()}},_handleSpinDownEvent:function(){var cursorPosition=this._getCursorPosition();if(this.options.dataMode==="double"||this.options.dataMode==="float"){if(this._focused){switch(this._fractionalOrIntegerSelected(cursorPosition)){case"fractional":{this._spinDown(true);this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition)}break;case"integer":{this._spinDown();this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition)}break;case"all":{this._spinDown();this._editorInput.select()}break;default:this._spinDown();this._editorInput.select()}}else{this._spinDown()}}else{this._spinDown()}},_fractionalOrIntegerSelected:function(cursorPosition){var decimalSeparator,val;if(cursorPosition===-1){return"all"}else{decimalSeparator=this.options.decimalSeparator;val=this._editorInput.val();if(val.indexOf(decimalSeparator)<0){return"all"}else{if(cursorPosition<=val.indexOf(decimalSeparator)){return"integer"}else{return"fractional"}}}},value:function(newValue){if(newValue!==undefined){this._clearEditorNotifier();if(newValue!==null&&!isNaN(this._parseNumericValueByMode(newValue,this._numericType,this.options.dataMode))){if(this._validateValue(newValue)){this._updateValue(newValue);if(!this._focused){this._editorInput.val(this._getDisplayValue())}else{this._enterEditMode()}}else{if(newValue<this.options.minValue){newValue=this.options.minValue}else if(newValue>this.options.maxValue){newValue=this.options.maxValue}this._updateValue(newValue);if(!this._focused){this._editorInput.val(this._getDisplayValue())}else{this._enterEditMode()}}this._setSpinButtonsState(newValue)}else{if(this.options.revertIfNotValid&&!(newValue===null&&this.options.allowNullValue)){newValue=this._valueInput.val()}else{this._clearValue()}}if(newValue<0){this._editorInput.addClass(this.css.negative)}else{this._editorInput.removeClass(this.css.negative)}}else{return this.options.value}},findListItemIndex:function(number){var list=this.options.listItems,i;for(i=0;i<list.length;i++){if(this._parseNumericValueByMode(list[i],this._numericType,this.options.dataMode)===number){return i}}return-1},getSelectedText:function(){throw $.ig.Editor.locale.numericEditorNoSuchMethod},getSelectionStart:function(){throw $.ig.Editor.locale.numericEditorNoSuchMethod},getSelectionEnd:function(){throw $.ig.Editor.locale.numericEditorNoSuchMethod},spinUp:function(delta){this._spinUp(delta)},spinDown:function(delta){this._spinDown(delta)},selectListIndexUp:function(){$.ui.igTextEditor.prototype.spinUp.call(this)},selectListIndexDown:function(){$.ui.igTextEditor.prototype.spinDown.call(this)},getRegionalOption:function(){return this._getRegionalOption()}});$.widget("ui.igCurrencyEditor",$.ui.igNumericEditor,{options:{positivePattern:null,currencySymbol:null},events:{},_create:function(){$.ui.igNumericEditor.prototype._create.call(this)},_setNumericType:function(){this._numericType="currency"},_applyRegionalSettings:function(){this.options.negativeSign=this._getRegionalOption("negativeSign");this.options.currencySymbol=this._getRegionalOption("currencySymbol");this.options.positivePattern=this.options.positivePattern||this._getRegionalOption("currencyPositivePattern");this.options.negativePattern=this.options.negativePattern||this._getRegionalOption("currencyNegativePattern");this.options.decimalSeparator=this.options.decimalSeparator||this._getRegionalOption("currencyDecimalSeparator");this.options.groupSeparator=this.options.groupSeparator!==null?this.options.groupSeparator:this._getRegionalOption("currencyGroupSeparator");this.options.groups=this.options.groups||this._getRegionalOption("currencyGroups");this.options.maxDecimals=this.options.maxDecimals===null?this._getRegionalOption("currencyMaxDecimals"):this.options.maxDecimals;this.options.minDecimals=this.options.minDecimals===null?this._getRegionalOption("currencyMinDecimals"):this.options.minDecimals},currencySymbol:function(symbol){if(symbol){this.options.currencySymbol=symbol}else{return this.options.currencySymbol}}});$.widget("ui.igPercentEditor",$.ui.igNumericEditor,{options:{positivePattern:null,percentSymbol:null,displayFactor:100,dataMode:"float",spinDelta:.01},events:{},_create:function(){$.ui.igNumericEditor.prototype._create.call(this)},_setNumericType:function(){this._numericType="percent"},_insert:function(newValue,previousValue){if(!isNaN(newValue=this._parseNumericValueByMode(newValue,this._numericType,this.options.dataMode))){if(this.options.maxValue&&newValue/this.options.displayFactor>this.options.maxValue){newValue=this.options.maxValue*this.options.displayFactor}else if(this.options.minValue&&newValue/this.options.displayFactor<this.options.minValue){newValue=this.options.minValue*this.options.displayFactor}if(!this._validateValue(newValue/this.options.displayFactor)&&this.options.revertIfNotValid){newValue=previousValue}}else if(this.options.revertIfNotValid){newValue=previousValue}else{newValue=""}this._editorInput.val(newValue);this._setSpinButtonsState(newValue/this.options.displayFactor);this._processTextChanged()},_applyRegionalSettings:function(){this.options.negativeSign=this.options.negativeSign||this._getRegionalOption("negativeSign");this.options.percentSymbol=this.options.percentSymbol||this._getRegionalOption("percentSymbol");this.options.positivePattern=this.options.positivePattern||this._getRegionalOption("percentPositivePattern");this.options.negativePattern=this.options.negativePattern||this._getRegionalOption("percentNegativePattern");this.options.decimalSeparator=this.options.decimalSeparator||this._getRegionalOption("percentDecimalSeparator");this.options.groupSeparator=this.options.groupSeparator!==null?this.options.groupSeparator:this._getRegionalOption("percentGroupSeparator");this.options.groups=this.options.groups||this._getRegionalOption("percentGroups");this.options.maxDecimals=this.options.maxDecimals===null?this._getRegionalOption("percentMaxDecimals"):this.options.maxDecimals;this.options.minDecimals=this.options.minDecimals===null?this._getRegionalOption("percentMinDecimals"):this.options.minDecimals;if(this.options.displayFactor===100){this.options.maxDecimals+=2}this.options.displayFactor=this.options.displayFactor||this._getRegionalOption("displayFactor");if(typeof this.options.displayFactor!=="number"){throw new Error($.ig.Editor.locale.displayFactorIsOfTypeNumber)}else if(this.options.displayFactor!==1&&this.options.displayFactor!==100){throw new Error($.ig.Editor.locale.displayFactorAllowedValue)}},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"displayFactor":{if(typeof value!=="number"){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.displayFactorIsOfTypeNumber)}else if(value!==1&&value!==100){this.options[option]=prevValue;throw new Error($.ig.Editor.locale.displayFactorAllowedValue)}}break;default:{this.options[option]=prevValue;this._super(option,value)}break}},_valueFromText:function(text){var val=this._parseNumericValueByMode(text,this._numericType,this.options.dataMode);return this._divideWithPrecision(val,this.options.displayFactor)},_spinUp:function(){var currVal,displayValue,decimalSeparator=this.options.decimalSeparator,noCancel;if(this._focused){currVal=this._divideWithPrecision(this._editorInput.val(),this.options.displayFactor).toString()}else{if(this.value()||this.value()===0){currVal=this.value().toString()}else{currVal=""}}this._clearEditorNotifier();this._currentInputTextValue=this._editorInput.val();currVal=this._getSpinValue("spinUp",currVal,decimalSeparator);if(!this._validateValue(currVal)&&currVal>this.options.maxValue&&this.options.spinWrapAround||currVal<this.options.minValue){currVal=this.options.minValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValExceededWrappedAroundErrMsg,this.options.maxValue))}else if(currVal>=this.options.maxValue&&!this.options.spinWrapAround){currVal=this.options.maxValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValErrMsg,this.options.maxValue))}if(this._focused){displayValue=this._multiplyWithPrecision(currVal,this.options.displayFactor);if(this.options.scientificFormat){currVal=Number(displayValue).toExponential().replace("e",this._getScientificFormat())}this._editorInput.val(displayValue);this._processTextChanged()}else{noCancel=this._triggerValueChanging(currVal);if(noCancel){this._updateValue(currVal);this._exitEditMode();this._triggerValueChanged(currVal)}}this._setSpinButtonsState(currVal)},_spinDown:function(){var currVal,decimalSeparator=this.options.decimalSeparator,noCancel;if(this._focused){currVal=this._divideWithPrecision(this._editorInput.val(),this.options.displayFactor).toString()}else{if(this.value()||this.value()===0){currVal=this.value().toString()}else{currVal=""}}this._clearEditorNotifier();this._currentInputTextValue=this._editorInput.val();currVal=this._getSpinValue("spinDown",currVal,decimalSeparator);if(!this._validateValue(currVal)&&currVal<this.options.minValue&&this.options.spinWrapAround||currVal>this.options.maxValue){currVal=this.options.maxValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValExceededWrappedAroundErrMsg,this.options.minValue))
}else if(currVal<=this.options.minValue&&!this.options.spinWrapAround){currVal=this.options.minValue;this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValErrMsg,this.options.minValue))}if(this._focused){this._editorInput.val(this._multiplyWithPrecision(currVal,this.options.displayFactor));this._processTextChanged()}else{noCancel=this._triggerValueChanging(currVal);if(noCancel){this._updateValue(currVal);this._exitEditMode();this._triggerValueChanged(currVal)}}this._setSpinButtonsState(currVal)},percentSymbol:function(symbol){if(symbol){this.options.percentSymbol=symbol}else{return this.options.percentSymbol}}});$.widget("ui.igMaskEditor",$.ui.igTextEditor,{options:{regional:null,buttonType:"none",inputMask:"CCCCCCCCCC",dataMode:"allText",unfilledCharsPrompt:"_",padChar:" ",emptyChar:" ",includeKeys:null,excludeKeys:null},events:{},_create:function(){$.ui.igTextEditor.prototype._create.call(this)},_initialize:function(){this._super();if(this.options.maxLength){this.options.maxLength=null}if(this.options.listItems){this.options.listItems=null}if(this._maskFlagsArray){this._maskFlagsArray=$.merge(this._maskFlagsArray,["C","&","a","A","?","L","9","0","<",">","#"])}else{this._maskFlagsArray=["C","&","a","A","?","L","9","0","<",">","#"]}this._promptCharsIndices=[]},_applyOptions:function(){this._super();if(this.options.value===null||this.options.value===undefined){this._setInitialValue()}},_enterEditMode:function(){var selection=this._getSelection(this._editorInput[0]);this._editMode=true;this._currentInputTextValue=this._editorInput.val();if(this._maskedValue===""){this._editorInput.val(this._maskWithPrompts)}else{this._editorInput.val(this._maskedValue)}this._positionCursor(selection.start,selection.end);this._processTextChanged()},_insert:function(newValue){var selection=this._getSelection(this._editorInput[0]);if(this.options.toUpper){if(newValue){newValue=newValue.toLocaleUpperCase()}}else if(this.options.toLower){if(newValue){newValue=newValue.toLocaleLowerCase()}}this._promptCharsIndices=[];newValue=this._parseValueByMask(newValue);this._editorInput.val(newValue);this._processTextChanged();this._setCursorPosition(selection.start+newValue.length)},_pasteHandler:function(event){var self=this,previousValue=$(event.target).val(),newValue;this._currentInputTextValue=this._editorInput.val();this._timeouts.push(setTimeout(function(){newValue=$(event.target).val();if(self._validateValueAgainstMask(newValue)){self._insert(newValue,previousValue)}else{if(self.options.revertIfNotValid){newValue=self._valueInput.val();self._updateValue(newValue)}else{self._clearValue()}if(self._focused){self._enterEditMode()}}},10))},_attachEvents:function(){var self=this;self._super();this._editorInput.on({"dragend.editor":function(){self._handleDeleteKey(true)},"cut.editor":function(){self._handleDeleteKey(true)},"drop.editor":function(event){event.preventDefault();self._pasteHandler(event)}})},_detachEvents:function(){this._super();this._editorInput.off("cut.editor dragend.editor")},_getMaskLiteralsAndRequiredPositions:function(){var mask,literalIndeces=[],requiredFieldsIndeces=[],maskFlagsArray=this._maskFlagsArray,output,maskChar,unescapedMask,i,j,isToLower=false,isToUpper=false,toLowerIndeces=[],toUpperIndeces=[];output=unescapedMask=mask=this.options.inputMask;for(i=0,j=0;i<mask.length;i++,j++){maskChar=mask.charAt(i);if($.inArray(maskChar,maskFlagsArray)!==-1){if(isToLower){toLowerIndeces.push(j)}else if(isToUpper){toUpperIndeces.push(j)}if(maskChar==="&"||maskChar==="A"||maskChar==="L"||maskChar==="0"){requiredFieldsIndeces.push(j)}else if(maskChar===">"){if(!isToUpper){isToUpper=true;if(isToLower){isToLower=false;toLowerIndeces.pop()}}else{isToUpper=false;toUpperIndeces.pop()}unescapedMask=this._replaceCharAt(unescapedMask,j,"");j--}else if(maskChar==="<"){if(!isToLower){isToLower=true;if(isToUpper){isToUpper=false;toUpperIndeces.pop()}}else{isToLower=false;toLowerIndeces.pop()}unescapedMask=this._replaceCharAt(unescapedMask,j,"");j--}}else if(maskChar==="\\"){if($.inArray(mask.charAt(i+1),maskFlagsArray)!==-1){unescapedMask=this._replaceCharAt(unescapedMask,j,"");i++}literalIndeces.push(j)}else{literalIndeces.push(j)}}this._literalIndeces=literalIndeces;this._requiredIndeces=requiredFieldsIndeces;this._toLowerIndeces=toLowerIndeces;this._toUpperIndeces=toUpperIndeces;this._unescapedMask=unescapedMask},_validateValue:function(val){if(val===undefined||val===null){return this._super(val)}else{return this._validateValueAgainstMask(val)}},_parseValueByMask:function(value){var mask=this.options.inputMask,outputVal=mask,ch,maskFlagsArray=this._maskFlagsArray,length=mask.length,i,j,tempChar;value=value?value.toString():"";if(length&&length>0){if(value.indexOf(this.options.unfilledCharsPrompt!==-1)){i=225;tempChar=String.fromCharCode(i);while(mask.indexOf(tempChar)!==-1&&value.indexOf(tempChar)!==-1){i++}}for(i=0,j=0;i<length;i++,j++){ch=value.charAt(j);if(this._validateCharOnPostion(ch,i)===null){if(mask.charAt(i)==="\\"){i++;j--}else if(mask.charAt(i)==="<"||mask.charAt(i)===">"){j--}else if($.inArray(i,this._literalIndeces)!==-1){if(mask.charAt(i)!==ch){j--}}}else if(this._validateCharOnPostion(ch,i)===true){if(ch===this.options.unfilledCharsPrompt){outputVal=this._replaceCharAt(outputVal,i,tempChar)}else{outputVal=this._replaceCharAt(outputVal,i,ch)}}else{outputVal=this._replaceCharAt(outputVal,i,this.options.unfilledCharsPrompt)}}for(i=0;i<outputVal.length;i++){ch=outputVal.charAt(i);if(ch==="\\"&&$.inArray(outputVal.charAt(i+1),maskFlagsArray)!==-1){outputVal=this._replaceCharAt(outputVal,i,"")}else if(ch==="<"||ch===">"){outputVal=this._replaceCharAt(outputVal,i,"");i--}else if($.inArray(i,this._toLowerIndeces)!==-1){if(ch===tempChar){outputVal=this._replaceCharAt(outputVal,i,this.options.unfilledCharsPrompt);this._promptCharsIndices.push(i)}outputVal=this._replaceCharAt(outputVal,i,outputVal.charAt(i).toLocaleLowerCase())}else if($.inArray(i,this._toUpperIndeces)!==-1){outputVal=this._replaceCharAt(outputVal,i,outputVal.charAt(i).toLocaleUpperCase());if(ch===tempChar){outputVal=this._replaceCharAt(outputVal,i,this.options.unfilledCharsPrompt);this._promptCharsIndices.push(i)}}else if(ch===tempChar){outputVal=this._replaceCharAt(outputVal,i,this.options.unfilledCharsPrompt);this._promptCharsIndices.push(i)}}}return outputVal},_getValueByDataMode:function(maskedVal){var dataModeValue,regExpr,i,ch,index,tempChar,dataMode=this.options.dataMode;maskedVal=maskedVal!==undefined?maskedVal:this._maskedValue;if(this._promptCharsIndices.length>0){i=225;tempChar=String.fromCharCode(i);while(maskedVal.indexOf(tempChar)!==-1){i++}for(i=0;i<this._promptCharsIndices.length;i++){index=this._promptCharsIndices[i];maskedVal=this._replaceCharAt(maskedVal,index,tempChar)}}switch(dataMode){case"allText":{regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");dataModeValue=maskedVal.replace(regExpr,this.options.emptyChar);if(this._promptCharsIndices.length>0){regExpr=new RegExp($.ig.util.escapeRegExp(tempChar),"g");dataModeValue=dataModeValue.replace(regExpr,this.options.unfilledCharsPrompt)}}break;case"rawText":{dataModeValue="";for(i=0;i<maskedVal.length;i++){ch=maskedVal.charAt(i);if($.inArray(i,this._literalIndeces)===-1&&ch!==this.options.unfilledCharsPrompt){if(this._promptCharsIndices.length>0&&ch===tempChar){dataModeValue+=this.options.unfilledCharsPrompt}else{dataModeValue+=ch}}}}break;case"rawTextWithRequiredPrompts":{dataModeValue="";for(i=0;i<maskedVal.length;i++){ch=maskedVal.charAt(i);if($.inArray(i,this._literalIndeces)===-1){if(ch===this.options.unfilledCharsPrompt){if($.inArray(i,this._requiredIndeces)!==-1){dataModeValue+=this.options.emptyChar}}else{if(this._promptCharsIndices.length>0&&ch===tempChar){dataModeValue+=this.options.unfilledCharsPrompt}else{dataModeValue+=ch}}}}}break;case"rawTextWithAllPrompts":{dataModeValue="";for(i=0;i<maskedVal.length;i++){ch=maskedVal.charAt(i);if($.inArray(i,this._literalIndeces)===-1){if(ch===this.options.unfilledCharsPrompt){dataModeValue+=this.options.emptyChar}else{if(this._promptCharsIndices.length>0&&ch===tempChar){dataModeValue+=this.options.unfilledCharsPrompt}else{dataModeValue+=ch}}}}}break;case"rawTextWithLiterals":{dataModeValue="";for(i=0;i<maskedVal.length;i++){ch=maskedVal.charAt(i);if(ch!==this.options.unfilledCharsPrompt){if(this._promptCharsIndices.length>0&&ch===tempChar){dataModeValue+=this.options.unfilledCharsPrompt}else{dataModeValue+=ch}}}}break;case"rawTextWithRequiredPromptsAndLiterals":{dataModeValue="";for(i=0;i<maskedVal.length;i++){ch=maskedVal.charAt(i);if($.inArray(i,this._literalIndeces)===-1){if(ch===this.options.unfilledCharsPrompt){if($.inArray(i,this._requiredIndeces)!==-1){dataModeValue+=this.options.emptyChar}}else{if(this._promptCharsIndices.length>0&&ch===tempChar){dataModeValue+=this.options.unfilledCharsPrompt}else{dataModeValue+=ch}}}else{dataModeValue+=ch}}}break;default:{regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");dataModeValue=maskedVal.replace(regExpr,this.options.emptyChar);if(this._promptCharsIndices.length>0){regExpr=new RegExp($.ig.util.escapeRegExp(tempChar),"g");dataModeValue=dataModeValue.replace(regExpr,this.options.unfilledCharsPrompt)}}}return dataModeValue},_updateValue:function(value){var nullValue;if(value===""){this.options.value="";this._valueInput.val("");this._maskedValue=""}else if(value===null){if(this.options.allowNullValue){if(this.options.nullValue===null){this._valueInput.val("");this.options.value=this.options.nullValue}else{nullValue=this._parseValueByMask(this.options.nullValue);this._maskedValue=nullValue;this._valueInput.val(nullValue);this.options.value=nullValue}}else{this.options.value="";this._valueInput.val("");this._maskedValue=""}}else{this._maskedValue=value;this.options.value=this._getValueByDataMode();this._valueInput.val(this.options.value)}},_getDisplayValue:function(){var result,maskedVal=this._maskedValue,i,j,p,maskChar,tempChar,index,regExpr,inputMask=this.options.inputMask,maskFlagsArray=this._maskFlagsArray;result=maskedVal;if(this._promptCharsIndices.length>0){i=225;tempChar=String.fromCharCode(i);while(maskedVal.indexOf(tempChar)!==-1){i++}for(i=0;i<this._promptCharsIndices.length;i++){index=this._promptCharsIndices[i];maskedVal=this._replaceCharAt(maskedVal,index,tempChar)}}for(i=0,j=0,p=0;i<maskedVal.length;i++,j++,p++){if(inputMask.charAt(j)==="<"||inputMask.charAt(j)===">"){j++}if(inputMask.charAt(j)==="\\"&&$.inArray(inputMask.charAt(j+1),maskFlagsArray)!==-1){j++;continue}if(maskedVal.charAt(i)===this.options.unfilledCharsPrompt){maskChar=inputMask.charAt(j);if(maskChar==="&"||maskChar==="A"||maskChar==="L"||maskChar==="0"){result=this._replaceCharAt(result,p,this.options.padChar)}else{result=this._replaceCharAt(result,p,"");p--}}}if(this._promptCharsIndices.length>0){regExpr=new RegExp($.ig.util.escapeRegExp(tempChar),"g");result=result.replace(regExpr,this.options.unfilledCharsPrompt)}return result},_valueFromText:function(text){return this._getValueByDataMode(text)},_validateValueAgainstMask:function(value){var i,j,length=value.length,result=true,ch,mask=this.options.inputMask;if(length&&length>0){for(j=0,i=0;i<mask.length&&j<value.length;i++,j++){ch=value.charAt(j);if(this._focused&&ch===this.options.unfilledCharsPrompt){continue}if(this._validateCharOnPostion(ch,i)===null){if(mask.charAt(i)==="\\"){i++;j--}else if(mask.charAt(i)==="<"||mask.charAt(i)===">"){j--}else if($.inArray(i,this._literalIndeces)!==-1){if(mask.charAt(i)!==ch){j--}}}else if(this._validateCharOnPostion(ch,i)===false){return false}}}else{result=true}return result},_setInitialValue:function(value){this._maskWithPrompts=this._parseValueByMask("");this._getMaskLiteralsAndRequiredPositions();if(value===null||value===""||typeof value===undefined){this._maskedValue=""}else{this._maskedValue=this._parseValueByMask(value);this._updateValue(this._maskedValue)}},_triggerInternalValueChange:function(value){if(value===this._maskWithPrompts&&this._promptCharsIndices.length===0){value=""}var noCancel=this._triggerValueChanging(value);if(noCancel){this._processInternalValueChanging(value);this._triggerValueChanged(value);if(value!==""&&!this._validateRequiredPrompts(value)){this._sendNotification("warning",$.ig.Editor.locale.maskMessage)}}},_validateRequiredPrompts:function(value){var i;if(value===""){return false}for(i=0;i<this._requiredIndeces.length;i++){var ch=value.charAt(this._requiredIndeces[i]);if(ch===this.options.unfilledCharsPrompt){if(this._promptCharsIndices.length>0&&$.inArray(this._requiredIndeces[i],this._promptCharsIndices)!==-1){continue}else{return false}}}return true},_processInternalValueChanging:function(value){if(this._validateValue(value)){this._updateValue(value)}else{if(this.options.revertIfNotValid){value=this._valueInput.val();this._updateValue(value)}else{this._clearValue();value=this._valueInput.val();if(this._focused){this._enterEditMode()}}}},_triggerKeyDown:function(event){var key=!event.charCode?event.which:event.charCode,cursorStartPosition=this._getSelection(this._editorInput[0]).start,ch,transformedChar,noCancel;noCancel=this._super(event);if(noCancel){if(key===8){this._handleBackSpaceKey();event.preventDefault()}else if(key===46){this._handleDeleteKey();event.preventDefault()}else if($.inArray(cursorStartPosition,this._toUpperIndeces)!==-1&&this._inComposition!==true){if(!event.ctrlKey&&!event.altKey&&(key>46&&key<91||key>145)){if(!$.ig.util.isWebKit||key!==229){ch=String.fromCharCode(key);transformedChar=ch.toLocaleUpperCase();this._editorInput.val(this._replaceCharAt(this._editorInput.val(),cursorStartPosition,transformedChar));this._setCursorPosition(cursorStartPosition+1);event.preventDefault()}}}else if($.inArray(cursorStartPosition,this._toLowerIndeces)!==-1&&this._inComposition!==true){if(!event.ctrlKey&&!event.altKey&&(key>46&&key<91||key>145)){if(!$.ig.util.isWebKit||key!==229){ch=String.fromCharCode(key);transformedChar=ch.toLocaleLowerCase();this._editorInput.val(this._replaceCharAt(this._editorInput.val(),cursorStartPosition,transformedChar));this._setCursorPosition(cursorStartPosition+1);event.preventDefault()}}}}return noCancel},_triggerKeyPress:function(event){var cursorPosition,key=!event.charCode?event.which:event.charCode,ch;if(this._super(event)){cursorPosition=this._getCursorPosition();if(key===46&&this._promptCharsIndices.length>0){if($.inArray(cursorPosition,this._promptCharsIndices)!==-1){this._promptCharsIndices=this._promptCharsIndices.splice($.inArray(cursorPosition,this._promptCharsIndices),1)}}else if(key===8&&this._promptCharsIndices.length>0){if($.inArray(cursorPosition-1,this._promptCharsIndices)!==-1){this._promptCharsIndices=this._promptCharsIndices.splice($.inArray(cursorPosition-1,this._promptCharsIndices),1)}}else{ch=String.fromCharCode(key);if(ch===this.options.unfilledCharsPrompt&&$.inArray(cursorPosition,this._promptCharsIndices)===-1){this._promptCharsIndices.push(cursorPosition)}}}},_validateKey:function(event){var result,ch,key,cursorPosition=this._getCursorPosition();if(this._super(event)&&this.options.inputMask){key=!event.charCode?event.which:event.charCode;if($.ig.util.isFF&&this._validateNonCharacter(event)){result=true}else if(key!==8&&key!==46){ch=String.fromCharCode(key);if(cursorPosition===-1){this._editSelectAllStartied=true;this._editorValueBeforeClear=this._editorInput.val();this._editorInput.val(this._maskWithPrompts);cursorPosition++}while($.inArray(cursorPosition,this._literalIndeces)!==-1||cursorPosition===this._maskWithPrompts.length){cursorPosition++}result=this._validateKeyCharAgainstMask(ch,cursorPosition,this._unescapedMask);if(result===true){if($.ig.util.isFF&&event.keyCode===37){this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition-1)}else{this._setSelectionRange(this._editorInput[0],cursorPosition,cursorPosition+1)}}}}else{result=false}if(result===false&&this._editSelectAllStartied){this._editorInput.val(this._editorValueBeforeClear);this._editorInput.select();delete this._editSelectAllStartied;delete this._editorValueBeforeClear}if(result===true&&this._editSelectAllStartied){delete this._editSelectAllStartied;delete this._editorValueBeforeClear}return result},_validateKeyCharAgainstMask:function(ch,cursorPosition,inputMask){var mask=inputMask||this.options.inputMask,isValid;if(cursorPosition>=this._maskWithPrompts.length){isValid=false}else{if(this._validateCharOnPostion(ch,cursorPosition,mask)===null){isValid=this._validateKeyCharAgainstMask(ch,cursorPosition+1)}else{isValid=this._validateCharOnPostion(ch,cursorPosition,mask)}}return isValid},_validateCharOnPostion:function(ch,position,inputMask){var maskSymbol,mask,isValid,regex,inputChar=ch,letterOrDigitRegEx="[\\dÀ-῿Ⰰ-퟿a-zA-Z]",letterRegEx="[À-῿Ⰰ-퟿a-zA-Z]",digitRegEx="[\\d]",digitSpecialRegEx="[\\d_\\+]";mask=inputMask||this.options.inputMask;maskSymbol=mask.charAt(position);switch(maskSymbol){case"C":case"&":{if(inputChar===""){isValid=false}else{isValid=true}}break;case"a":case"A":{regex=new RegExp(letterOrDigitRegEx);if(regex.test(inputChar)){isValid=true}else{isValid=false}}break;case"?":case"L":{regex=new RegExp(letterRegEx);if(regex.test(inputChar)){isValid=true}else{isValid=false}}break;case"0":case"9":{regex=new RegExp(digitRegEx);if(regex.test(inputChar)){isValid=true}else{isValid=false}}break;case"#":{regex=new RegExp(digitSpecialRegEx);if(regex.test(inputChar)){isValid=true}else{isValid=false}}break;default:{isValid=null}}return isValid},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"inputMask":{this.options[option]=prevValue;throw new Error($.ig.Editor.locale.cannotSetRuntime)}case"excludeKeys":case"includeKeys":this.options[option]=prevValue;throw new Error($.ig.Editor.locale.cannotSetRuntime);default:{this.options[option]=prevValue;this._super(option,value)}break}},_handleBackSpaceKey:function(){var selection=this._getSelection(this._editorInput[0]),startPostion=selection.start,endPosition=selection.end,index=endPosition;if(startPostion===endPosition){startPostion--}index--;for(index;index>startPostion-1;index--){while($.inArray(index,this._literalIndeces)!==-1||index===-1){index--}if(index>-1){this._editorInput.val(this._replaceCharAt(this._editorInput.val(),index,this.options.unfilledCharsPrompt));this._setCursorPosition(index)}}},_handleDeleteKey:function(skipCursorPosition){var selection=this._getSelection(this._editorInput[0]),startPostion=selection.start,endPosition=selection.end,index=startPostion;if(startPostion===endPosition){endPosition++}for(index;index<endPosition;index++){while($.inArray(index,this._literalIndeces)!==-1&&index<=this._maskWithPrompts.length){index++}if(index!==this._maskWithPrompts.length){this._editorInput.val(this._replaceCharAt(this._editorInput.val(),index,this.options.unfilledCharsPrompt));if(!skipCursorPosition){this._setCursorPosition(index+1)}}else{if(!skipCursorPosition){this._setCursorPosition(index)}}}},value:function(newValue){if(newValue!==undefined){this._clearEditorNotifier();if(newValue!==null){this._promptCharsIndices=[];newValue=this._parseValueByMask(newValue)}if(newValue===this._maskWithPrompts){newValue=""}this._updateValue(newValue);if(this._focused===false||this._focused===undefined){this._editorInput.val(this._editMode?this._maskedValue:this._getDisplayValue())}}else{return this.options.value}},dropDownContainer:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},showDropDown:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},hideDropDown:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},dropDownButton:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},spinUpButton:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},spinDownButton:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},dropDownVisible:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},findListItemIndex:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},selectedListIndex:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},getSelectedListItem:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},spinUp:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},spinDown:function(){throw new Error($.ig.Editor.locale.maskEditorNoSuchMethod)},isValid:function(){var value,valid;this._skipMessages=true;if(this._editMode){value=this.field().val();valid=this._validateRequiredPrompts(value)}else{value=this.options.value;valid=this._validateValue(value);if(value!==""&&!this._validateRequiredPrompts(this._maskedValue)){valid=false;this._sendNotification("warning",$.ig.Editor.locale.maskMessage)}}this._skipMessages=false;return valid}});$.widget("ui.igDateEditor",$.ui.igMaskEditor,{options:{value:null,minValue:null,maxValue:null,dateDisplayFormat:null,dateInputFormat:null,dataMode:"date",buttonType:"none",spinDelta:1,limitSpinToCurrentField:false,enableUTCDates:false,centuryThreshold:29,yearShift:0,isLimitedToListValues:false,listItemHoverDuration:0,listItems:null,listWidth:0,dropDownAnimationDuration:0,dropDownAttachedToBody:false,dropDownOnReadOnly:false},events:{dropDownListOpening:"dropDownListOpening",dropDownListOpened:"dropDownListOpened",dropDownListClosing:"dropDownListClosing",dropDownListClosed:"dropDownListClosed",dropDownItemSelecting:"dropDownItemSelecting",dropDownItemSelected:"dropDownItemSelected"},_create:function(){$.ui.igMaskEditor.prototype._create.call(this)},_initialize:function(){this._super();this._applyRegionalSettings();this.options.inputMask=this._convertDateMaskToDigitMask(this.options.dateInputFormat);this._setNumericType();this._mvcDateRegex=/^\/Date\((.*?)\)\/$/i},_setNumericType:function(){this._numericType="datetime"},_setOption:function(option,value){var prevValue=this.options[option];if($.type(prevValue)==="date"){var date=this._getDateObjectFromValue(value);if($.type(date)==="date"&&prevValue.getTime()===date.getTime()){return}}else if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"minValue":{this.options[option]=prevValue;throw new Error($.ig.Editor.locale.dateEditorMinValue)}case"maxValue":{this.options[option]=prevValue;throw new Error($.ig.Editor.locale.dateEditorMaxValue)}break;case"dateInputFormat":{this.options[option]=prevValue;throw new Error($.ig.Editor.locale.cannotSetRuntime)}break;default:{this.options[option]=prevValue;this._super(option,value)}break}},_applyRegionalSettings:function(){var format;if(this.options.dateInputFormat!==null){format=this.options.dateInputFormat;if(format==="date"||format==="dateLong"||format==="dateTime"||format==="time"||format==="timeLong"){this.options.dateInputFormat=this._getRegionalOption(format+"Pattern")}}else{this.options.dateInputFormat=this._getRegionalOption("datePattern")}if(this.options.dateDisplayFormat!==null){format=this.options.dateDisplayFormat;if(format==="date"||format==="dateLong"||format==="dateTime"||format==="time"||format==="timeLong"){this.options.dateDisplayFormat=this._getRegionalOption(format+"Pattern")}}else{this.options.dateDisplayFormat=this.options.dateInputFormat}},_setInitialValue:function(value){this._maskWithPrompts=this._parseValueByMask("");this._getMaskLiteralsAndRequiredPositions();if(value===null||value===""||typeof value==="undefined"){this._maskedValue=""}else{if(this._validateValue(value)){this._updateValue(this._getDateObjectFromValue(value));this._updateMaskedValue()}this._editorInput.val(this._getDisplayValue())}},_applyOptions:function(){this._super();if(this.options.centuryThreshold>99||this.options.centuryThreshold<0){this.options.centuryThreshold=29;console.log($.ig.Editor.locale.centuryThresholdValidValues)}if(this.options.minValue){if(!this._isValidDate(new Date(this.options.minValue))){throw new Error($.ig.Editor.locale.invalidDate)}}if(this.options.maxValue){if(!this._isValidDate(new Date(this.options.maxValue))){throw new Error($.ig.Editor.locale.invalidDate)}}if(this._maskWithPrompts===undefined){this._setInitialValue()}},_triggerKeyDown:function(event){var key=!event.charCode?event.which:event.charCode,noCancel;noCancel=this._super(event);if(noCancel){if(key===38&&!(this instanceof $.ui.igDatePicker)){this._spinUpEditMode()}if(key===40&&!(this instanceof $.ui.igDatePicker)){this._spinDownEditMode()}if(key===13){this._enterEditMode()}}return noCancel},_handleSpinUpEvent:function(){this.spinUp(1)},_handleSpinDownEvent:function(){this.spinDown(1)},_replaceDisplayValue:function(selection,previousValue,newValue){var value=previousValue,currentIndex=selection.start,currentChar,charCode,charIndex=0,newChar;newValue=newValue.toString();while(currentIndex<previousValue.length&&charIndex<newValue.length){currentChar=previousValue.charAt(currentIndex);charCode=previousValue.charCodeAt(currentIndex);newChar=newValue.charAt(charIndex);if(charCode>=48&&charCode<=57||currentChar==="_"){value=value.substring(0,currentIndex)+newChar+value.substring(currentIndex+1,previousValue.length);charIndex++}currentIndex++}return value},_getDateField:function(flag,date){var utc=this.options.enableUTCDates,shift=this.options.yearShift,year;if(!date){date=this._dateObjectValue}if(!date){return null}if(flag==="year"){year=utc?date.getUTCFullYear():date.getFullYear();if(shift){year+=shift}return year}if(flag==="month"){return utc?date.getUTCMonth():date.getMonth()}if(flag==="day"){return utc?date.getUTCDay():date.getDay()}if(flag==="date"){return utc?date.getUTCDate():date.getDate()}if(flag==="hours"){return utc?date.getUTCHours():date.getHours()}if(flag==="minutes"){return utc?date.getUTCMinutes():date.getMinutes()}if(flag==="seconds"){return utc?date.getUTCSeconds():date.getSeconds()}return utc?date.getUTCMilliseconds():date.getMilliseconds()},_setDateField:function(flag,date,newValue){var utc=this.options.enableUTCDates,shift=this.options.yearShift;if(!date){date=this._dateObjectValue}if(flag==="year"){if(shift){newValue-=shift}if(utc){date.setUTCFullYear(newValue)}else{date.setFullYear(newValue)}}if(flag==="month"){if(utc){date.setUTCMonth(newValue)}else{date.setMonth(newValue)}}if(flag==="date"){if(utc){date.setUTCDate(newValue)}else{date.setDate(newValue)}}if(flag==="hours"){if(utc){date.setUTCHours(newValue)}else{date.setHours(newValue)}}if(flag==="minutes"){if(utc){date.setUTCMinutes(newValue)}else{date.setMinutes(newValue)}}if(flag==="seconds"){if(utc){date.setUTCSeconds(newValue)}else{date.setSeconds(newValue)}}if(flag==="milliseconds"){if(utc){date.setUTCMilliseconds(newValue)}else{date.setMilliseconds(newValue)}}return date},_getInternalMaskedValue:function(newDate){return this._updateMaskedValue(newDate,true)},_updateMaskedValue:function(newDate,returnValue){var currentMaskValue=this._maskWithPrompts?this._maskWithPrompts:this._parseValueByMask(""),dateObj,year,month,day,hours,minutes,seconds,milliseconds;dateObj=newDate?newDate:this._dateObjectValue;if(dateObj){if(this._dateIndices.yy!==undefined){year=this._getDateField("year",dateObj).toString();if(this._dateIndices.fourDigitYear){if(year.toString().length<4){while(year.toString().length<4){year="0"+year}}currentMaskValue=this._replaceStringRange(currentMaskValue,year,this._dateIndices.yy,this._dateIndices.yy+3)}else{year=year.substring(2);currentMaskValue=this._replaceStringRange(currentMaskValue,year,this._dateIndices.yy,this._dateIndices.yy+1)}}if(this._dateIndices.MM!==undefined){month=this._getDateField("month",dateObj);month++;if(month<10){month="0"+month.toString()}else{month=month.toString()}currentMaskValue=this._replaceStringRange(currentMaskValue,month,this._dateIndices.MM,this._dateIndices.MM+1)}if(this._dateIndices.dd!==undefined){day=this._getDateField("date",dateObj);if(day<10){day="0"+day.toString()}else{day=day.toString()}currentMaskValue=this._replaceStringRange(currentMaskValue,day,this._dateIndices.dd,this._dateIndices.dd+1)}if(this._dateIndices.hh!==undefined){hours=this._getDateField("hours",dateObj);if(!this._dateIndices.hh24&&hours>12){hours-=12}if(!this._dateIndices.hh24&&hours===0){hours=12}if(hours<10){hours="0"+hours.toString()}else{hours=hours.toString()}currentMaskValue=this._replaceStringRange(currentMaskValue,hours,this._dateIndices.hh,this._dateIndices.hh+1)}if(this._dateIndices.mm!==undefined){minutes=this._getDateField("minutes",dateObj);if(minutes<10){minutes="0"+minutes.toString()}else{minutes=minutes.toString()}currentMaskValue=this._replaceStringRange(currentMaskValue,minutes,this._dateIndices.mm,this._dateIndices.mm+1)}if(this._dateIndices.ss!==undefined){seconds=this._getDateField("seconds",dateObj);if(seconds<10){seconds="0"+seconds.toString()}else{seconds=seconds.toString()}currentMaskValue=this._replaceStringRange(currentMaskValue,seconds,this._dateIndices.ss,this._dateIndices.ss+1)}if(this._dateIndices.tt!==undefined){hours=this._getDateField("hours",dateObj);if(hours>=12&&hours<24){if(this._dateIndices._ttLength===1){currentMaskValue=this._replaceCharAt(currentMaskValue,this._dateIndices.tt,"P")}else{currentMaskValue=this._replaceStringRange(currentMaskValue,"PM",this._dateIndices.tt,this._dateIndices.tt+1)}}else{if(this._dateIndices._ttLength===1){currentMaskValue=this._replaceCharAt(currentMaskValue,this._dateIndices.tt,"A")}else{currentMaskValue=this._replaceStringRange(currentMaskValue,"AM",this._dateIndices.tt,this._dateIndices.tt+1)}}}if(this._dateIndices.ff!==undefined){milliseconds=this._getDateField("milliseconds",dateObj);if(this._dateIndices.ffLength===1){currentMaskValue=this._replaceCharAt(currentMaskValue,this._dateIndices.ff,this._getMilliseconds(milliseconds,100).toString())}else if(this._dateIndices.ffLength===2){currentMaskValue=this._replaceStringRange(currentMaskValue,this._getMilliseconds(milliseconds,10).toString(),this._dateIndices.ff,this._dateIndices.ff+1)}else{currentMaskValue=this._replaceStringRange(currentMaskValue,this._getMilliseconds(milliseconds,1).toString(),this._dateIndices.ff,this._dateIndices.ff+2)}}}if(returnValue===true){return currentMaskValue}else{this._maskedValue=currentMaskValue}},_convertDateMaskToDigitMask:function(mask){var x,i,j,flag=-1,txt="",maskVal=mask;if(!maskVal){maskVal=""}maskVal=maskVal.replace("dddd","ddd").replace("ddd,","").replace("ddd ","").replace(" ddd","").replace("ddd","");this._dateIndices={};this._dateIndices.fourDigitYear=false;maskVal=maskVal.replace(/\x08/g," ").replace(/\x09/g," ");maskVal=maskVal.replace(/\\f/g,"").replace(/\\d/g,"").replace(/\\s/g,"").replace(/\\m/g,"").replace(/\\t/g,"").replace(/\\H/g,"").replace(/\\h/g,"").replace(/\\M/g,"\b").replace(/\\y/g,"	");maskVal=maskVal.replace(/9/g,"").replace(/0/g,"");maskVal=maskVal.replace("fff","24").replace("ff","23").replace("f","22");maskVal=maskVal.replace("dddd","").replace("ddd","").replace("dd","09").replace("d","08").replace("ss","19").replace("s","18").replace("mm","17").replace("m","16");maskVal=maskVal.replace("tt","15").replace("t","14").replace("HH","13").replace("H","12").replace("hh","11").replace("h","10");maskVal=maskVal.replace("MMMM","MM").replace("MMM","MM").replace("MM","05").replace("M","04");maskVal=maskVal.replace("yyyy","03").replace("yy","02").replace("y","01");maskVal=maskVal.replace(/\x01/g,"g").replace(/\x02/g,"d").replace(/\x03/g,"s").replace(/\x04/g,"m").replace(/\x05/g,"t").replace(/\x06/g,"H").replace(/\x07/g,"h").replace(/\x08/g,"M").replace(/\x09/g,"y");for(i=0,j=0;i<maskVal.length;i++,j++){x=maskVal.charCodeAt(i);if(x<48||x>57){flag=maskVal.charAt(i);if(flag==="\\"&&i+1<maskVal.length&&$.inArray(maskVal.charAt(i+1),this._maskFlagsArray)!==-1||maskVal.charAt(i+1)===""||maskVal.charAt(i+1)===""){j--}txt+=maskVal.charAt(i);continue}flag=(x-48)*10+maskVal.charCodeAt(++i)-48;if(flag===14){txt+="L"}else if(flag===15){txt+="LL"}else if(flag===22){txt+="0"}else{txt+="00";if(flag===3){txt+="00"
}if(flag===24){txt+="0"}}switch(flag){case 4:case 5:case 6:case 7:{if(this._dateIndices.MM){j++;break}else{this._dateIndices.MM=j;j++}}break;case 8:case 9:case 20:case 21:{if(this._dateIndices.dd){j++;break}else{this._dateIndices.dd=j;j++}}break;case 1:case 2:{if(this._dateIndices.yy){j++;break}else{this._dateIndices.yy=j;j++;this._dateIndices.fourDigitYear=false}}break;case 3:{if(this._dateIndices.yy){j+=3;break}else{this._dateIndices.yy=j;j+=3;this._dateIndices.fourDigitYear=true}}break;case 14:{if(this._dateIndices.tt){break}else{this._dateIndices.tt=j;j++;this._dateIndices._ttLength=1}}break;case 15:{if(this._dateIndices.tt){j++;break}else{this._dateIndices.tt=j;j++;this._dateIndices._ttLength=2}}break;case 10:case 11:{if(this._dateIndices.hh){j+=2;break}else{this._dateIndices.hh=j;this._dateIndices.hh24=false;j++}}break;case 12:case 13:{if(this._dateIndices.hh){j+=2;break}else{this._dateIndices.hh=j;this._dateIndices.hh24=true;j++}}break;case 16:case 17:{if(this._dateIndices.mm){j++;break}else{this._dateIndices.mm=j;j++}}break;case 18:case 19:{if(this._dateIndices.ss){j++;break}else{this._dateIndices.ss=j;j++}}break;case 22:{if(this._dateIndices.ff){break}else{this._dateIndices.ff=j;this._dateIndices.ffLength=1}}break;case 23:{if(this._dateIndices.ff){j++;break}else{this._dateIndices.ff=j;this._dateIndices.ffLength=2;j++}}break;case 24:{if(this._dateIndices.ff){j+=2;break}else{this._dateIndices.ff=j;this._dateIndices.ffLength=3;j+=2}}break;default:}}txt=txt.replace(/\x11/g,9).replace(/\x12/g,0);return txt},_getRegionalOption:function(key){var regional=this.options.regional;if(this.options[key]){return this.options[key]}if(typeof regional==="string"){regional=$.ig.regional[regional]}if(regional&&regional[key]){return regional[key]}else{return $.ig.regional.defaults[key]}},_validateKey:function(event){var result=true,ch,key,cursorPosition;if(this._super(event)===true){cursorPosition=this._getCursorPosition();if(cursorPosition===this._dateIndices.MM||cursorPosition-1===this._dateIndices.MM){result=this._validateMonthInput(event,cursorPosition)}else if(cursorPosition===this._dateIndices.dd||cursorPosition-1===this._dateIndices.dd){result=this._validateDayInput(event,cursorPosition)}else if(cursorPosition===this._dateIndices.hh||cursorPosition-1===this._dateIndices.hh){result=this._validateHoursInput(event,cursorPosition)}else if(cursorPosition===this._dateIndices.mm||cursorPosition-1===this._dateIndices.mm){result=this._validateMinutesInput(event,cursorPosition)}else if(cursorPosition===this._dateIndices.ss||cursorPosition-1===this._dateIndices.ss){result=this._validateSecondsInput(event,cursorPosition)}else if(cursorPosition===this._dateIndices.tt||cursorPosition-1===this._dateIndices.tt){result=this._validateMidDayInput(event,cursorPosition);if(result===true){key=!event.charCode?event.which:event.charCode;ch=String.fromCharCode(key);if(ch.toLocaleLowerCase()==="a"){this._editorInput.val(this._replaceCharAt(this._editorInput.val(),cursorPosition,"A"))}else{this._editorInput.val(this._replaceCharAt(this._editorInput.val(),cursorPosition,"P"))}if(this._dateIndices._ttLength===2){this._editorInput.val(this._replaceCharAt(this._editorInput.val(),++cursorPosition,"M"))}this._setCursorPosition(++cursorPosition);event.preventDefault()}}else{result=true}if(result===null){cursorPosition++;while($.inArray(cursorPosition,this._literalIndeces)!==-1||cursorPosition===this._maskWithPrompts.length){cursorPosition++}this._setCursorPosition(cursorPosition);result=this._validateKey(event)}if(result===false){this._setCursorPosition(cursorPosition)}}else{result=false}return result},_setBlur:function(event){var newValue,oldVal,convertedDate;if(this._cancelBlurOnInput){this._editorInput.focus();delete this._cancelBlurOnInput}else{this._triggerBlur(event);newValue=$(event.target).val();oldVal=this._dateObjectValue;convertedDate=this._parseDateFromMaskedValue(newValue);if(newValue===this._maskWithPrompts){if(oldVal){this._processValueChanging(newValue)}}else if(!oldVal){this._processValueChanging(newValue)}else if(convertedDate!==""&&convertedDate-oldVal!==0){this._processValueChanging(newValue)}this._exitEditMode();this._focused=false;this._clearTimeouts();if(this._validator){this._validator._validateInternal(this.element,event,true)}}},_validateDayInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key),num=parseInt(ch),charAtCurrentPosition=parseInt(this._editorInput.val().charAt(position)),charAtPreviousPosition,charAtNextPosition;if(position===this._dateIndices.dd){if(num<4){charAtNextPosition=parseInt(this._editorInput.val().charAt(position+1));if(!isNaN(charAtNextPosition)&&charAtNextPosition>1&&num===3){result=null}else{result=true}}else{if(!isNaN(charAtCurrentPosition)&&charAtCurrentPosition===3){result=null}else{this._setSelectionRange(this._editorInput[0],position+1,position+2);result=true}}}else{charAtPreviousPosition=parseInt(this._editorInput.val().charAt(position-1));if(!isNaN(charAtPreviousPosition)&&charAtPreviousPosition===3){if(num===0||num===1){result=true}else{this._setCursorPosition(position-1);this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position,position+1);result=true}}else{result=true}}return result},_validateMonthInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key),num=parseInt(ch),charAtCurrentPosition=parseInt(this._editorInput.val().charAt(position)),charAtPreviousPosition,charAtNextPosition;position=position?position:this._getCursorPosition();if(position===this._dateIndices.MM){if(num<2){charAtNextPosition=parseInt(this._editorInput.val().charAt(position+1));if(!isNaN(charAtNextPosition)&&charAtNextPosition>2&&num===1){result=null}else{result=true}}else{if(!isNaN(charAtCurrentPosition)&&charAtCurrentPosition===1){if(num===2){result=true}else{result=null}}else if(this._editorInput.val().charAt(position)===this.options.unfilledCharsPrompt){if(num<2){result=true}else{result=null}}else{this._setSelectionRange(this._editorInput[0],position+1,position+2);result=true}}}else{charAtPreviousPosition=parseInt(this._editorInput.val().charAt(position-1));if(!isNaN(charAtPreviousPosition)&&charAtPreviousPosition===1){if(num===0||num===1||num===2){result=true}else{this._setCursorPosition(position-1);this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position,position+1);result=true}}else{result=true}}return result},_validateMidDayInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key);position=position?position:this._getCursorPosition();if(position===this._dateIndices.tt){if(ch.toString().toLocaleLowerCase()==="a"||ch.toString().toLocaleLowerCase()==="p"){result=true}else{result=false}}else{result=null}return result},_validateHoursInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key),num=parseInt(ch),charAtPreviousPosition,charAtNextPosition;position=position?position:this._getCursorPosition();if(position===this._dateIndices.hh){if(this._dateIndices.hh24){if(num===0||num===1){result=true}else if(num===2){charAtNextPosition=parseInt(this._editorInput.val().charAt(position+1));if(!isNaN(charAtNextPosition)&&charAtNextPosition>4){result=null}else{result=true}}else{result=null}}else{if(num===0){result=true}else if(num===1){charAtNextPosition=parseInt(this._editorInput.val().charAt(position+1));if(!isNaN(charAtNextPosition)&&charAtNextPosition>2){result=null}else{result=true}}else{result=null}}}else{charAtPreviousPosition=parseInt(this._editorInput.val().charAt(position-1));if(this._dateIndices.hh24){if(!isNaN(charAtPreviousPosition)&&charAtPreviousPosition===2){if(num<=4){result=true}else{result=true;this._setCursorPosition(position-1);this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position,position+1)}}else{result=true}}else{if(!isNaN(charAtPreviousPosition)&&charAtPreviousPosition===1){if(num<=2){result=true}else{this._setCursorPosition(position-1);this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position,position+1);result=true}}else{result=true}}}return result},_validateMinutesInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key),num=parseInt(ch);position=position?position:this._getCursorPosition();if(position===this._dateIndices.mm){if(num<6){result=true}else{result=true;this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position+1,position+2)}}else{result=true}return result},_validateSecondsInput:function(event,position){var result=false,key=!event.charCode?event.which:event.charCode,ch=String.fromCharCode(key),num=parseInt(ch);position=position?position:this._getCursorPosition();if(position===this._dateIndices.ss){if(num<6){result=true}else{this._handleDeleteKey();this._setSelectionRange(this._editorInput[0],position+1,position+2);result=true}}else{result=true}return result},_fillCentury:function(year){if(!isNaN(year)){if(year>=0&&year<=this.options.centuryThreshold){year=2e3+year}else if(year<100){year=1900+year}}return year},_triggerKeyPress:function(event){if(event.keyCode===13){this._processInternalValueChanging(this._editorInput.val())}else{this._super(event)}},_triggerInternalValueChange:function(value){if(value===this._maskWithPrompts){value=""}var noCancel=this._triggerValueChanging(value);if(noCancel){this._processInternalValueChanging(value);this._triggerValueChanged(value)}},_processInternalValueChanging:function(value){var parsedVal,cursorPosition;if(value===""){cursorPosition=this._getCursorPosition();this._clearValue();if(this._focused&&cursorPosition!==undefined){cursorPosition=cursorPosition===-1?cursorPosition++:cursorPosition;this._setCursorPosition(cursorPosition)}return}if($.type(value)==="date"){parsedVal=value}else{parsedVal=this._parseDateFromMaskedValue(value)}if(this._validateValue(parsedVal)){this._updateValue(parsedVal)}else{if(this.options.revertIfNotValid){value=this._valueInput.val();this._updateValue(value)}else{this._clearValue();value=this._valueInput.val()}}},_isValidDate:function(date){date=this._getDateObjectFromValue(date);return date.getTime()===date.getTime()},_validateValue:function(val){var result,dateObj,minValue,maxValue;if(val===null||val===""){return true}dateObj=this._getDateObjectFromValue(val);if(this.options.minValue){minValue=this._getDateObjectFromValue(this.options.minValue)}if(this.options.maxValue){maxValue=this._getDateObjectFromValue(this.options.maxValue)}if(this._isValidDate(dateObj)){if(this.options.maxValue&&this._isValidDate(maxValue)&&dateObj>maxValue){result=false;if(this.options.revertIfNotValid){this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.maxValExceedRevertErrMsg,this._getDisplayValue(new Date(this.options.maxValue))))}}else if(this.options.minValue&&this._isValidDate(minValue)&&dateObj<minValue){result=false;if(this.options.revertIfNotValid){this._sendNotification("warning",$.ig.util.stringFormat($.ig.Editor.locale.minValExceedRevertErrMsg,this._getDisplayValue(new Date(this.options.minValue))))}}else{result=true}}else{result=false}return result},_updateValue:function(value){if(value===null){this._maskedValue=this._maskWithPrompts;this._valueInput.val("");this.options.value=null;this._dateObjectValue=null}else if(value===""){this._maskedValue=this._maskWithPrompts;this._valueInput.val("");this.options.value="";this._dateObjectValue=null}else{this._dateObjectValue=this._getDateObjectFromValue(value);this._updateMaskedValue();this.options.value=this._getValueByDataMode();if($.type(this.options.value)==="date"){this._valueInput.val(this.options.value.toISOString())}else{this._valueInput.val(this.options.value)}}},_clearValue:function(){if(this.options.allowNullValue){this._updateValue(this.options.nullValue);if(this.options.nullValue===null){this._editorInput.val(this._maskWithPrompts)}}else{this._updateValue("");this._editorInput.val(this._maskWithPrompts)}if(this._editMode===false){this._exitEditMode()}},_getDateObjectFromValue:function(value){var date;if($.type(value)==="date"){date=value}else if(this._mvcDateRegex.test(value)){date=new Date(parseInt(value.replace(this._mvcDateRegex,"$1"),10))}else{date=new Date(value);if(this.options.enableUTCDates){date=new Date(Date.UTC(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds()))}}return date},_getValueByDataMode:function(){var dataModeValue,maskedVal=this._maskedValue?this._maskedValue:this._maskWithPrompts,dataMode=this.options.dataMode;switch(dataMode){case"date":{dataModeValue=this._dateObjectValue}break;case"displayModeText":{dataModeValue=this._getDisplayValue()}break;case"editModeText":{dataModeValue=maskedVal}break;default:{dataModeValue=this._dateObjectValue}}return dataModeValue},_parseDateFromMaskedValue:function(value){var dateField,monthField,yearField,hourField,minutesField,secondsField,millisecondsField,midDayField,today,dateStartIndex=this._dateIndices.dd,regExpr,ffCount,lastDayOfMonth,monthStartIndex=this._dateIndices.MM,yearStartIndex=this._dateIndices.yy,hourStartIndex=this._dateIndices.hh,minuteStartIndex=this._dateIndices.mm,secondsStartIndex=this._dateIndices.ss,midDayStartIndex=this._dateIndices.tt,millisecondsStartIndex=this._dateIndices.ff,extractedDate="";if(value===""||value===null||$.type(value)==="date"){return extractedDate}if(dateStartIndex!==undefined&&dateStartIndex!==null){dateField=value.substring(dateStartIndex,dateStartIndex+2);if(dateField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");dateField=dateField.replace(regExpr,"")}if(dateField!==""){dateField=parseInt(dateField);if(dateField<=0){dateField=null}}else{dateField=null}}if(monthStartIndex!==undefined&&monthStartIndex!==null){monthField=value.substring(monthStartIndex,monthStartIndex+2);if(monthField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");monthField=monthField.replace(regExpr,"")}if(monthField!==""){monthField=parseInt(monthField);if(monthField<=0){monthField=null}else{monthField--}}else{monthField=null}}if(yearStartIndex!==undefined&&yearStartIndex!==null){if(this._dateIndices.fourDigitYear){yearField=value.substring(yearStartIndex,yearStartIndex+4)}else{yearField=value.substring(yearStartIndex,yearStartIndex+2)}if(yearField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");yearField=yearField.replace(regExpr,"")}if(yearField!==""){yearField=parseInt(yearField);yearField=this._fillCentury(yearField)}else{yearField=null}}if(midDayStartIndex!==undefined&&midDayStartIndex!==null){midDayField=value.substring(midDayStartIndex,midDayStartIndex+1);if(midDayField===this.options.unfilledCharsPrompt){midDayField=null}else{midDayField=midDayField.toLocaleLowerCase()}}if(hourStartIndex!==undefined&&hourStartIndex!==null){hourField=value.substring(hourStartIndex,hourStartIndex+2);if(hourField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");hourField=hourField.replace(regExpr,"")}if(hourField!==""){hourField=parseInt(hourField);if(this._dateIndices.hh24===false){if(midDayField&&midDayField==="p"){if(hourField!==12){hourField+=12}}else if(hourField===12){hourField=0}}}else{hourField=null}}if(minuteStartIndex!==undefined&&minuteStartIndex!==null){minutesField=value.substring(minuteStartIndex,minuteStartIndex+2);if(minutesField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");minutesField=minutesField.replace(regExpr,"")}if(minutesField!==""){minutesField=parseInt(minutesField)}else{minutesField=null}}if(secondsStartIndex!==undefined&&secondsStartIndex!==null){secondsField=value.substring(secondsStartIndex,secondsStartIndex+2);if(secondsField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");secondsField=secondsField.replace(regExpr,"")}if(secondsField!==""){secondsField=parseInt(secondsField)}else{secondsField=null}}if(millisecondsStartIndex!==undefined&&millisecondsStartIndex!==null){millisecondsField=value.substring(millisecondsStartIndex,millisecondsStartIndex+this._dateIndices.ffLength);if(millisecondsField.indexOf(this.options.unfilledCharsPrompt)!==-1){regExpr=new RegExp($.ig.util.escapeRegExp(this.options.unfilledCharsPrompt),"g");millisecondsField=millisecondsField.replace(regExpr,"")}if(millisecondsField!==""){if(millisecondsField.length<this._dateIndices.ffLength){ffCount=this._dateIndices.ffLength-millisecondsField.length;millisecondsField=parseInt(millisecondsField)*Math.pow(10,ffCount)}millisecondsField=parseInt(millisecondsField);if(this._dateIndices.ffLength===2){millisecondsField*=10}else if(this._dateIndices.ffLength===1){millisecondsField*=100}}else{millisecondsField=null}}if(!this._dateObjectValue){if(yearField!==null&&yearField!==undefined&&monthField!==null&&monthField!==undefined&&dateField!==null&&dateField!==undefined){if(this.options.enableUTCDates){extractedDate=new Date(Date.UTC(yearField,monthField,dateField))}else{extractedDate=new Date(yearField,monthField,dateField)}}else{if(this.options.enableUTCDates){today=new Date;extractedDate=new Date(Date.UTC(today.getFullYear(),today.getMonth(),today.getDate()))}else{extractedDate=new Date}if(yearField!==null&&yearField!==undefined){extractedDate=this._setDateField("year",extractedDate,yearField)}if(monthField!==null&&monthField!==undefined){extractedDate=this._setDateField("month",extractedDate,monthField)}if(dateField!==null&&dateField!==undefined){lastDayOfMonth=this._lastDayOfMonth(this._getDateField("year",extractedDate),this._getDateField("month",extractedDate)+1);if(dateField>lastDayOfMonth){dateField=lastDayOfMonth}extractedDate=this._setDateField("date",extractedDate,dateField)}}}else{extractedDate=new Date(this._dateObjectValue.getTime())}if(yearField!==null&&yearField!==undefined){extractedDate=this._setDateField("year",extractedDate,yearField)}if(monthField!==null&&monthField!==undefined){extractedDate=this._setDateField("month",extractedDate,monthField)}if(dateField!==null&&dateField!==undefined){lastDayOfMonth=this._lastDayOfMonth(this._getDateField("year",extractedDate),this._getDateField("month",extractedDate)+1);if(dateField>lastDayOfMonth){dateField=lastDayOfMonth}extractedDate=this._setDateField("date",extractedDate,dateField)}if(hourField!==null&&hourField!==undefined){extractedDate=this._setDateField("hours",extractedDate,hourField)}if(minutesField!==null&&minutesField!==undefined){extractedDate=this._setDateField("minutes",extractedDate,minutesField)}if(secondsField!==null&&secondsField!==undefined){extractedDate=this._setDateField("seconds",extractedDate,secondsField)}if(millisecondsField!==null&&millisecondsField!==undefined){extractedDate=this._setDateField("milliseconds",extractedDate,millisecondsField)}return extractedDate},_getDisplayValue:function(newDate){var maskVal,dateObject=newDate?newDate:this._dateObjectValue;if(!dateObject){return""}maskVal=this.options.dateDisplayFormat;maskVal=maskVal.replace(/\x08/g," ").replace(/\x09/g," ");maskVal=maskVal.replace(/\\f/g,"").replace(/\\d/g,"").replace(/\\s/g,"").replace(/\\m/g,"").replace(/\\t/g,"").replace(/\\H/g,"").replace(/\\h/g,"").replace(/\\M/g,"\b").replace(/\\y/g,"	");maskVal=maskVal.replace(/fff/g,"030").replace(/ff/g,"031").replace(/f/g,"032");maskVal=maskVal.replace(/dddd/g,"033").replace(/ddd/g,"034").replace(/dd/g,"035").replace(/d/g,"036").replace(/ss/g,"037").replace(/s/g,"038").replace(/mm/g,"039").replace(/m/g,"040");maskVal=maskVal.replace(/tt/g,"041").replace(/t/g,"042").replace(/HH/g,"043").replace(/H/g,"044").replace(/hh/g,"045").replace(/h/g,"046");maskVal=maskVal.replace(/MMMM/g,"047").replace(/MMM/g,"048").replace(/MM/g,"049").replace(/M/g,"050");maskVal=maskVal.replace(/yyyy/g,"051").replace(/yy/g,"052").replace(/y/g,"053");maskVal=maskVal.replace(/\x10030/g,this._getMilliseconds(this._getDateField("milliseconds",dateObject),1)).replace(/\x10031/g,this._getMilliseconds(this._getDateField("milliseconds",dateObject),10)).replace(/\x10032/g,this._getMilliseconds(this._getDateField("milliseconds",dateObject),100));maskVal=maskVal.replace(/\x10033/g,this._getDay(this._getDateField("day",dateObject),"dddd")).replace(/\x10034/g,this._getDay(this._getDateField("day",dateObject),"ddd")).replace(/\x10035/g,this._getDate(this._getDateField("date",dateObject),"dd")).replace(/\x10036/g,this._getDate(this._getDateField("date",dateObject),"d")).replace(/\x10037/g,this._getSeconds(this._getDateField("seconds",dateObject),"ss")).replace(/\x10038/g,this._getSeconds(this._getDateField("seconds",dateObject),"s")).replace(/\x10039/g,this._getMinutes(this._getDateField("minutes",dateObject),"mm")).replace(/\x10040/g,this._getMinutes(this._getDateField("minutes",dateObject),"m")).replace(/\x10041/g,this._getAMorPM(this._getDateField("hours",dateObject),"tt")).replace(/\x10042/g,this._getAMorPM(this._getDateField("hours",dateObject),"t")).replace(/\x10043/g,this._getHours(this._getDateField("hours",dateObject),"HH")).replace(/\x10044/g,this._getHours(this._getDateField("hours",dateObject),"H")).replace(/\x10045/g,this._getHours(this._getDateField("hours",dateObject),"hh")).replace(/\x10046/g,this._getHours(this._getDateField("hours",dateObject),"h"));maskVal=maskVal.replace(/\x10047/g,this._getMonth(this._getDateField("month",dateObject),"MMMM")).replace(/\x10048/g,this._getMonth(this._getDateField("month",dateObject),"MMM")).replace(/\x10049/g,this._getMonth(this._getDateField("month",dateObject),"MM")).replace(/\x10050/g,this._getMonth(this._getDateField("month",dateObject),"M"));maskVal=maskVal.replace(/\x10051/g,this._getYear(this._getDateField("year",dateObject),"yyyy")).replace(/\x10052/g,this._getYear(this._getDateField("year",dateObject),"yy")).replace(/\x10053/g,this._getYear(this._getDateField("year",dateObject),"y"));maskVal=maskVal.replace(/\x01/g,"g").replace(/\x02/g,"d").replace(/\x03/g,"s").replace(/\x04/g,"m").replace(/\x05/g,"t").replace(/\x06/g,"H").replace(/\x07/g,"h").replace(/\x08/g,"M").replace(/\x09/g,"y");return maskVal},_valueFromText:function(text){var dateFromText=this._parseDateFromMaskedValue(text),dataModeValue;switch(this.options.dataMode){case"date":{dataModeValue=dateFromText}break;case"displayModeText":{dataModeValue=this._getDisplayValue(dateFromText)}break;case"editModeText":{dataModeValue=this._getInternalMaskedValue(dateFromText)}break;default:{dataModeValue=dateFromText}}return dataModeValue},_getMilliseconds:function(milliseconds,flag){var result=parseInt(milliseconds/flag).toString();if(flag===10){if(result.length!==2){while(result.length<2){result="0"+result}}}else if(flag===1){if(result.length!==3){while(result.length<3){result="0"+result}}}return result},_getSeconds:function(seconds,flag){var result;if(flag==="ss"&&seconds<10){result="0"+seconds.toString()}else{result=seconds.toString()}return result},_getMinutes:function(minutes,flag){var result;if(flag==="mm"&&minutes<10){result="0"+minutes.toString()}else{result=minutes.toString()}return result},_getAMorPM:function(hours,flag){var result;if(hours>=12){result=this._getRegionalOption("pm")}else{result=this._getRegionalOption("am")}if(flag==="t"){result=result.charAt(0)}return result},_getHours:function(hours,flag){var result;switch(flag){case"h":{if(hours>12){hours-=12}if(hours===0){hours=12}result=hours.toString()}break;case"hh":{if(hours>12){hours-=12}if(hours===0){hours=12}if(hours<10){result="0"+hours.toString()}else{result=hours.toString()}}break;case"H":{result=hours.toString()}break;case"HH":{if(hours<10){result="0"+hours.toString()}else{result=hours.toString()}}break}return result},_getDate:function(date,flag){var result;switch(flag){case"dd":{if(date<10){result="0"+date.toString()}else{result=date}}break;case"d":{result=date.toString()}break}return result},_getDay:function(day,flag){var result;switch(flag){case"dddd":{result=this._getRegionalOption("dayNames")[day]}break;case"ddd":{result=this._getRegionalOption("dayNamesShort")[day]}break}return result},_getMonth:function(month,flag){var result;switch(flag){case"MMMM":{result=this._getRegionalOption("monthNames")[month]}break;case"MMM":{result=this._getRegionalOption("monthNamesShort")[month]}break;case"MM":{month++;if(month<10){result="0"+month.toString()}else{result=month}}break;case"M":{month++;result=month.toString()}break}return result},_getYear:function(year,flag){var result;if(flag==="yy"){result=year.toString().substring(2)}else if(flag==="y"){result=parseInt(year.toString().substring(2)).toString()}else{result=year.toString()}return result},_handleBackSpaceKey:function(){var cursorPosition;this._super();cursorPosition=this._getSelection(this._editorInput[0]).start;if(cursorPosition===this._dateIndices.tt||cursorPosition-1===this._dateIndices.tt){if(this._dateIndices._ttLength===2){if(cursorPosition===this._dateIndices.tt){this._setCursorPosition(cursorPosition+1);$.ui.igMaskEditor.prototype._handleDeleteKey.call(this);this._setCursorPosition(cursorPosition)}else{this._super()}}}},_handleDeleteKey:function(skipCursorPosition){var cursorPosition;this._super(skipCursorPosition);cursorPosition=this._getSelection(this._editorInput[0]).start;if(cursorPosition-2===this._dateIndices.tt||cursorPosition-1===this._dateIndices.tt){if(this._dateIndices._ttLength===2){if(cursorPosition-1===this._dateIndices.tt){this._super()}else{if(!skipCursorPosition){this._setCursorPosition(cursorPosition-1)}$.ui.igMaskEditor.prototype._handleBackSpaceKey.call(this);if(!skipCursorPosition){this._setCursorPosition(cursorPosition)}}}}},_setMillisecondsEditMode:function(mask,time,currentMilliseconds,delta){var isLimited=this.options.limitSpinToCurrentField,newMilliseconds,secondsUpdateDelta=0,currentSecond,timeSecond;if(currentMilliseconds+delta>=60){if(isLimited){newMilliseconds=currentMilliseconds}else{newMilliseconds=currentMilliseconds+delta-60;secondsUpdateDelta=1}}else if(currentMilliseconds+delta<0){if(isLimited){newMilliseconds=currentMilliseconds}else{if(currentMilliseconds+delta===0){newMilliseconds=0}else{newMilliseconds=60+(currentMilliseconds+delta);secondsUpdateDelta=-1}}}else{newMilliseconds=currentMilliseconds+delta}mask=this._setTimeEditMode(mask,time,currentMilliseconds,newMilliseconds);if(secondsUpdateDelta!==undefined&&secondsUpdateDelta!==0){timeSecond=this._createSecondsPosition();if(timeSecond!==null){currentSecond=parseInt(this._getStringRange(mask,timeSecond.startPosition,timeSecond.endPosition),10);mask=this._setSecondsEditMode(mask,timeSecond,currentSecond,secondsUpdateDelta)}else{if(!isLimited){this._setDateField("seconds",this._dateObjectValue,this._getDateField("seconds",this._dateObjectValue)+secondsUpdateDelta)}}}return mask},_setSecondsEditMode:function(mask,time,currentSecond,delta){var isLimited=this.options.limitSpinToCurrentField,newSecond,minuteUpdateDelta=0,currentMinute,timeMinute;if(currentSecond+delta>=60){if(isLimited){newSecond=currentSecond}else{newSecond=currentSecond+delta-60;minuteUpdateDelta=1}}else if(currentSecond+delta<1){if(isLimited){newSecond=currentSecond}else{if(currentSecond+delta===0){newSecond=0}else{newSecond=60+(currentSecond+delta);minuteUpdateDelta=-1}}}else{newSecond=currentSecond+delta}mask=this._setTimeEditMode(mask,time,currentSecond,newSecond);if(minuteUpdateDelta!==undefined&&minuteUpdateDelta!==0){timeMinute=this._createMinutesPosition();if(timeMinute!==null){currentMinute=parseInt(this._getStringRange(mask,timeMinute.startPosition,timeMinute.endPosition),10);mask=this._setMinutesEditMode(mask,timeMinute,currentMinute,minuteUpdateDelta)}else{if(!isLimited){this._setDateField("minutes",this._dateObjectValue,this._getDateField("minutes",this._dateObjectValue)+minuteUpdateDelta)}}}return mask},_setMinutesEditMode:function(mask,time,currentMinute,delta){var isLimited=this.options.limitSpinToCurrentField,newMinute,hourUpdateDelta=0,currentHour,timeHour;if(currentMinute+delta>=60){if(isLimited){newMinute=currentMinute}else{newMinute=currentMinute+delta-60;hourUpdateDelta=1}}else if(currentMinute+delta<1){if(isLimited){newMinute=currentMinute}else{if(currentMinute+delta===0){newMinute=0}else{newMinute=60+(currentMinute+delta);hourUpdateDelta=-1}}}else{newMinute=currentMinute+delta}mask=this._setTimeEditMode(mask,time,currentMinute,newMinute);if(hourUpdateDelta!==undefined&&hourUpdateDelta!==0){timeHour=this._createHoursPosition();if(timeHour!==null){currentHour=parseInt(this._getStringRange(mask,timeHour.startPosition,timeHour.endPosition),10);mask=this._setHoursEditMode(mask,timeHour,currentHour,hourUpdateDelta)}else{if(!isLimited){this._setDateField("hours",this._dateObjectValue,this._getDateField("hours",this._dateObjectValue)+hourUpdateDelta)}}}return mask},_setHoursEditMode:function(mask,time,currentHour,delta){var isLimited=this.options.limitSpinToCurrentField,is24format=this._dateIndices.hh24,dayUpdateDelta=false,amPmUpdateDelta=false,newHour=currentHour+delta,hours,wrapUpHours,wrapDownHours,currentDay,currentAmPm,timeDay,timeAmPm;if(is24format){hours=24;wrapUpHours=newHour>=hours;wrapDownHours=newHour<0}else{hours=12;wrapUpHours=newHour>hours;wrapDownHours=newHour<1;currentAmPm=mask.toLowerCase().indexOf(" pm")>=0?"pm":"am"}if(wrapUpHours){if(isLimited){newHour=currentHour}else{if(is24format){newHour-=hours;dayUpdateDelta=true}else{if(newHour===13){newHour=1}}}}else if(wrapDownHours){if(isLimited){newHour=currentHour}else{if(is24format){newHour+=hours;dayUpdateDelta=true}else{if(newHour===0){newHour=12}}}}else{if(!is24format){if(delta>0&&newHour===12){amPmUpdateDelta=true;if(currentAmPm==="pm"){dayUpdateDelta=true}}if(delta<0&&newHour===11){amPmUpdateDelta=true;if(currentAmPm==="am"){dayUpdateDelta=true}}}}mask=this._setTimeEditMode(mask,time,currentHour,newHour);if(amPmUpdateDelta){timeAmPm=this._createAmOrPmPosition();if(timeAmPm!==null){mask=this._setAmOrPmEditMode(mask,timeAmPm,currentAmPm)}}if(dayUpdateDelta){timeDay=this._createDayPosition();if(timeDay!==null){currentDay=parseInt(this._getStringRange(mask,timeDay.startPosition,timeDay.endPosition),10);mask=this._setDayEditMode(mask,timeDay,currentDay,delta)}else{if(!isLimited){this._setDateField("date",this._dateObjectValue,this._getDateField("date",this._dateObjectValue)+delta)}}}return mask},_setAmOrPmEditMode:function(mask,time,currentAmOrPm,noSwap){var newAmOrPm;if(noSwap){newAmOrPm=currentAmOrPm}else{if(currentAmOrPm.toLocaleLowerCase()==="am"){newAmOrPm="PM"}else{newAmOrPm="AM"}}mask=this._setTimeEditMode(mask,time,currentAmOrPm,newAmOrPm);return mask},_lastDayOfMonth:function(year,month){var day;if(month===1||month===3||month===5||month===7||month===8||month===10||month===12){day=31}else if(month===4||month===6||month===9||month===11){day=30}else if(month===2&&year%4===0){day=29}else if(month===2&&year%4!==0){day=28}return day},_setDayEditMode:function(mask,time,currentDay,delta){var isLimited=this.options.limitSpinToCurrentField,currentYear,currentMonth,lastDayOfMonth,lastDayOfPreviousMonth,newDay,monthUpdateDelta,timeYear,timeMonth;timeYear=this._createYearPosition();currentYear=parseInt(this._getStringRange(mask,timeYear.startPosition,timeYear.endPosition),10);timeMonth=this._createMonthPosition();currentMonth=parseInt(this._getStringRange(mask,timeMonth.startPosition,timeMonth.endPosition),10);lastDayOfMonth=this._lastDayOfMonth(currentYear,currentMonth);lastDayOfPreviousMonth=this._lastDayOfMonth(currentYear,currentMonth-1!==0?currentMonth-1:12);if(currentDay+delta>lastDayOfMonth){if(isLimited){newDay=currentDay}else{newDay=currentDay+delta-lastDayOfMonth;
monthUpdateDelta=1}}else if(currentDay+delta<1){if(isLimited){newDay=currentDay}else{newDay=lastDayOfPreviousMonth+(currentDay+delta);monthUpdateDelta=-1}}else{newDay=currentDay+delta}mask=this._setTimeEditMode(mask,time,currentDay,newDay);if(monthUpdateDelta!==undefined&&monthUpdateDelta!==0){timeMonth=this._createMonthPosition();if(timeMonth!==null){currentMonth=parseInt(this._getStringRange(mask,timeMonth.startPosition,timeMonth.endPosition),10);mask=this._setMonthEditMode(mask,timeMonth,currentMonth,monthUpdateDelta)}else{if(!isLimited){this._setDateField("month",this._dateObjectValue,this._getDateField("month",this._dateObjectValue)+monthUpdateDelta)}}}return mask},_setMonthEditMode:function(mask,time,currentMonth,delta){var isLimited=this.options.limitSpinToCurrentField,newMonth,yearUpdateDelta=0,currentYear,timeYear;if(currentMonth+delta>12){if(isLimited){newMonth=currentMonth}else{newMonth=currentMonth+delta-12;yearUpdateDelta=1}}else if(currentMonth+delta<1){if(isLimited){newMonth=currentMonth}else{newMonth=12+(currentMonth+delta);yearUpdateDelta=-1}}else{newMonth=currentMonth+delta}mask=this._setTimeEditMode(mask,time,currentMonth,newMonth);if(yearUpdateDelta!==undefined&&yearUpdateDelta!==0){timeYear=this._createYearPosition();if(timeYear!==null){currentYear=parseInt(this._getStringRange(mask,timeYear.startPosition,timeYear.endPosition),10);mask=this._setYearEditMode(mask,timeYear,currentYear,yearUpdateDelta)}else{if(!isLimited){this._setDateField("year",this._dateObjectValue,this._getDateField("year",this._dateObjectValue)+yearUpdateDelta)}}}return mask},_setYearEditMode:function(mask,time,currentYear,delta){var newYear;if(currentYear+delta<0){newYear=currentYear}else{newYear=currentYear+delta}mask=this._setTimeEditMode(mask,time,currentYear,newYear);return mask},_setTimeEditMode:function(mask,time,currentValue,newValue){var newValueAsString;newValueAsString=newValue.toString();if(newValueAsString.length===1){newValueAsString="0"+newValueAsString;if(time.name==="milliseconds"&&this._dateIndices.ffLength===3){newValueAsString="0"+newValueAsString}if(time.name==="year"&&this._dateIndices.fourDigitYear){newValueAsString="00"+newValueAsString}}else if(newValueAsString.length===2&&time.name==="year"&&this._dateIndices.fourDigitYear){newValueAsString="00"+newValueAsString}else if(newValueAsString.length===3&&time.name==="year"&&this._dateIndices.fourDigitYear){newValueAsString="0"+newValueAsString}mask=this._replaceStringRange(mask,newValueAsString,time.startPosition,time.endPosition-1);return mask},_createYearPosition:function(){var time=null;if(this._dateIndices.yy!==undefined){time={};time.name="year";time.startPosition=this._dateIndices.yy;time.length=this._dateIndices.fourDigitYear?4:2;time.endPosition=time.startPosition+time.length}return time},_createMonthPosition:function(){var time=null;if(this._dateIndices.MM!==undefined){time={};time.name="month";time.startPosition=this._dateIndices.MM;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createDayPosition:function(){var time=null;if(this._dateIndices.dd!==undefined){time={};time.name="day";time.startPosition=this._dateIndices.dd;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createAmOrPmPosition:function(){var time=null;if(this._dateIndices.tt!==undefined){time={};time.name="amOrPm";time.startPosition=this._dateIndices.tt;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createHoursPosition:function(){var time=null;if(this._dateIndices.hh!==undefined){time={};time.name="hours";time.startPosition=this._dateIndices.hh;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createMinutesPosition:function(){var time=null;if(this._dateIndices.mm!==undefined){time={};time.name="minutes";time.startPosition=this._dateIndices.mm;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createSecondsPosition:function(){var time=null;if(this._dateIndices.ss!==undefined){time={};time.name="seconds";time.startPosition=this._dateIndices.ss;time.length=2;time.endPosition=time.startPosition+time.length}return time},_createMillisecondsPosition:function(){var time=null;if(this._dateIndices.ff!==undefined){time={};time.name="milliseconds";time.startPosition=this._dateIndices.ff;time.length=this._dateIndices.ffLength;time.endPosition=time.startPosition+time.length}return time},_getTimePosition:function(){var cursorPosition=this._getCursorPosition(),indices=this._dateIndices,time=null;if(cursorPosition<0){cursorPosition=0}if(cursorPosition>=indices.yy&&(indices.fourDigitYear&&cursorPosition<=indices.yy+4||indices.fourDigitYear===undefined&&indices.yy+2)){time=this._createYearPosition()}else if(cursorPosition>=indices.MM&&cursorPosition<=indices.MM+2){time=this._createMonthPosition()}else if(cursorPosition>=indices.dd&&cursorPosition<=indices.dd+2){time=this._createDayPosition()}else if(cursorPosition>=indices.tt&&cursorPosition<=indices.tt+2){time=this._createAmOrPmPosition()}else if(cursorPosition>=indices.hh&&cursorPosition<=indices.hh+2){time=this._createHoursPosition()}else if(cursorPosition>=indices.mm&&cursorPosition<=indices.mm+2){time=this._createMinutesPosition()}else if(cursorPosition>=indices.ss&&cursorPosition<=indices.ss+2){time=this._createSecondsPosition()}else if(cursorPosition>=indices.ff&&cursorPosition<=indices.ff+indices.ffLength){time=this._createMillisecondsPosition()}return time},_updateTimeMask:function(mask,time,delta){var currentValueString,currentValue,range,index,unfilled=this.options.unfilledCharsPrompt;currentValueString=range=this._getStringRange(mask,time.startPosition,time.endPosition);for(index=0;index<range.length;index++){if(currentValueString.indexOf(unfilled)===index){currentValueString=currentValueString.replace(unfilled,"0")}else{break}}if(time.name!=="amOrPm"){currentValue=parseInt(currentValueString,10)}if(!this._dateObjectValue&&mask.indexOf(unfilled)>=0){mask=this._initEmptyMask(this._dateObjectValue);mask=mask.substring(0,time.startPosition)+currentValueString+mask.substring(time.endPosition,mask.length)}switch(time.name){case"year":mask=this._setYearEditMode(mask,time,currentValue,delta);break;case"month":mask=this._setMonthEditMode(mask,time,currentValue,delta);break;case"day":mask=this._setDayEditMode(mask,time,currentValue,delta);break;case"amOrPm":currentValue=this._getStringRange(mask,time.startPosition,time.endPosition);mask=this._setAmOrPmEditMode(mask,time,currentValue);break;case"hours":mask=this._setHoursEditMode(mask,time,currentValue,delta);break;case"minutes":mask=this._setMinutesEditMode(mask,time,currentValue,delta);break;case"seconds":mask=this._setSecondsEditMode(mask,time,currentValue,delta);break;case"milliseconds":mask=this._setMillisecondsEditMode(mask,time,currentValue,delta);break}return mask},_initEmptyMask:function(date){var mask=this._maskWithPrompts,today=new Date,timeYear,timeMonth,timeDay,timeHours,timeAmOrPM,timeMinutes,timeSeconds,timeMilliseconds,year,month,day,hours,amPM,minutes,seconds,milliseconds;if(!date){date=today}timeYear=this._createYearPosition();timeMonth=this._createMonthPosition();timeDay=this._createDayPosition();timeHours=this._createHoursPosition();timeAmOrPM=this._createAmOrPmPosition();timeMinutes=this._createMinutesPosition();timeSeconds=this._createSecondsPosition();timeMilliseconds=this._createMillisecondsPosition();year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();hours=date.getHours();amPM=!this._dateIndices.hh24&&hours>=12?"PM":"AM";hours=!this._dateIndices.hh24&&hours>12?hours-12:hours;minutes=date.getMinutes();seconds=date.getSeconds();milliseconds=date.getMilliseconds();if(timeYear){mask=this._setYearEditMode(mask,timeYear,year,0)}if(timeMonth){mask=this._setMonthEditMode(mask,timeMonth,month,0)}if(timeDay){mask=this._setDayEditMode(mask,timeDay,day,0)}if(timeHours){mask=this._setHoursEditMode(mask,timeHours,hours,0)}if(timeAmOrPM){mask=this._setAmOrPmEditMode(mask,timeAmOrPM,amPM,true)}if(timeMinutes){mask=this._setMinutesEditMode(mask,timeMinutes,minutes,0)}if(timeSeconds){mask=this._setSecondsEditMode(mask,timeSeconds,seconds,0)}if(timeMilliseconds){mask=this._setMillisecondsEditMode(mask,timeMilliseconds,milliseconds,0)}return mask},_spinEditMode:function(delta){var self=this,cursorPosition=this._getCursorPosition(),mask=this._editorInput.val(),time;time=this._getTimePosition();if(!time){return}if(mask===undefined){return}else if(mask===""||mask===this._maskWithPrompts){mask=this._initEmptyMask(this._dateObjectValue)}else{mask=this._updateTimeMask(mask,time,delta)}this._editorInput.val(mask);if($.ig.util.isChrome||$.ig.util.isSafari||$.ig.util.isFF){this._timeouts.push(setTimeout(function(){self._setCursorPosition(cursorPosition)},0))}else{self._setCursorPosition(cursorPosition)}},_setTimePeriod:function(periodName,delta){var date,period,newPeriod;date=this._dateObjectValue;period=parseInt(this._getDateField(periodName,date),10);if(period===null){period=this._getDateField(periodName,new Date);delta=0}newPeriod=period+delta;if(!date){date=new Date}if(newPeriod!==period){this._setDateField(periodName,date,newPeriod);this._triggerInternalValueChange(date);this._editorInput.val(this._getDisplayValue())}},_spinDisplayMode:function(delta){var indices=this._dateIndices,periodName;if(indices.dd!==undefined){periodName="date"}else if(indices.ff!==undefined){periodName="milliseconds";if(indices.ffLength===2){delta=delta*10}else if(indices.ffLength===1){delta=delta*100}}else if(indices.ss!==undefined){periodName="seconds"}else if(indices.mm!==undefined){periodName="minutes"}else if(indices.hh!==undefined){periodName="hours"}else if(indices.MM!==undefined){periodName="month"}else if(indices.yy!==undefined){periodName="year"}this._setTimePeriod(periodName,delta)},_spin:function(delta){this._currentInputTextValue=this._editorInput.val();if(this._editMode){this._spinEditMode(delta)}else{this._spinDisplayMode(delta)}this._processTextChanged()},_spinUpEditMode:function(delta){this._spinEditMode(delta?delta:this.options.spinDelta)},_spinDownEditMode:function(delta){this._spinEditMode(delta?-delta:-this.options.spinDelta)},value:function(newValue){if(newValue!==undefined){this._clearEditorNotifier();if(this._validateValue(newValue)){this._updateValue(newValue);this._updateMaskedValue()}this._editorInput.val(this._editMode?this._maskedValue:this._getDisplayValue())}else{if(this.options.value){return this._getValueByDataMode()}else{if(this.options.allowNullValue){return this.options.nullValue}else{return""}}}},getSelectedDate:function(){return this._dateObjectValue},selectDate:function(date){this._updateValue(date);this._exitEditMode()},spinUp:function(delta){this._spin(delta?delta:this.options.spinDelta)},spinDown:function(delta){this._spin(delta?-delta:-this.options.spinDelta)},spinUpButton:function(){return $.ui.igTextEditor.prototype.spinUpButton.call(this)},spinDownButton:function(){return $.ui.igTextEditor.prototype.spinDownButton.call(this)},isValid:function(){var value,valid;value=this.field().val();this._skipMessages=true;if(this._editMode){if(value===this._maskWithPrompts){valid=false}else{valid=this._validateValue(this._parseDateFromMaskedValue(value))}}else{valid=this._validateValue(this._dateObjectValue);if(value!==""&&!valid){valid=false;this._sendNotification("warning",$.ig.Editor.locale.dateMessage)}}this._skipMessages=false;return valid},dropDownButton:function(){throw $.ig.Editor.locale.datePickerNoSuchMethodDropDownContainer},dropDownContainer:function(){throw $.ig.Editor.locale.datePickerNoSuchMethodDropDownContainer},dropDownVisible:function(){throw $.ig.Editor.locale.datePickerNoSuchMethodDropDownContainer},findListItemIndex:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod},getSelectedListItem:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod},selectedListIndex:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod}});$.widget("ui.igDatePicker",$.ui.igDateEditor,{options:{regional:null,buttonType:"dropdown",datepickerOptions:null,dropDownAttachedToBody:false,isLimitedToListValues:false,listItemHoverDuration:0,listItems:null,listWidth:0},events:{dropDownListOpening:"dropDownListOpening",dropDownListOpened:"dropDownListOpened",dropDownListClosing:"dropDownListClosing",dropDownItemSelecting:"dropDownItemSelecting",dropDownItemSelected:"dropDownItemSelected",itemSelected:"itemSelected"},_setDropDownListWidth:function(){},_listMouseDownHandler:function(){},_disableEditor:function(applyDisabledClass){if(this.options.dropDownOnReadOnly){if(applyDisabledClass){this._editorInput.addClass(this.css.disabled)}this._detachEvents()}else{if(applyDisabledClass){this._editorContainer.addClass(this.css.disabled)}this._detachEvents()}if(this._dropDownButton&&!this.options.dropDownOnReadOnly){this._dropDownButton.addClass(this.css.disabled);this._detachButtonsEvents(this._dropDownButton)}if(this._clearButton){this._clearButton.addClass(this.css.disabled);this._detachButtonsEvents(this._clearButton)}if(this._spinUpButton){this._spinUpButton.addClass(this.css.disabled);this._detachButtonsEvents(this._spinUpButton)}if(this._spinDownButton){this._spinDownButton.addClass(this.css.disabled);this._detachButtonsEvents(this._spinDownButton)}},_pickerDefaults:function(){var self=this,pickerDefaults;pickerDefaults={showOn:"",duration:self.options.dropDownAnimationDuration?self.options.dropDownAnimationDuration:"normal",onSelect:function(dateText,inst){var date,dateFromPicker=$(this).datepicker("getDate");if(self._dateObjectValue){date=new Date(self._dateObjectValue)}else{date=new Date}date=self._setDateField("year",date,dateFromPicker.getFullYear());date=self._setDateField("month",date,dateFromPicker.getMonth());date=self._setDateField("date",date,dateFromPicker.getDate());self._processValueChanging(date);self._triggerItemSelected.call(self,inst.dpDiv.find(".ui-datepicker-calendar>tbody>tr>td .ui-state-hover"),dateFromPicker);self._processTextChanged();if(self.options.readOnly===true||self.options.disabled===true){self._exitEditMode()}else{self._editorInput.focus()}},onClose:$.proxy(self._triggerDropDownClosed,self)};return pickerDefaults},_renderList:function(){var self=this,options,regional;regional=$.extend(self._dpRegion(),self.options.datepickerOptions)||{};options=$.extend(regional,this._pickerDefaults());if(regional.onSelect){var igOnSelect=regional.onSelect;options.onSelect=function(dateText,inst){igOnSelect.call(this,dateText,inst);if(self.options.datepickerOptions&&self.options.datepickerOptions.onSelect){self.options.datepickerOptions.onSelect.call(this,dateText,inst)}}}if(regional.onClose){var igOnClose=regional.onClose;options.onClose=function(dateText,inst){igOnClose.call(this);if(self.options.datepickerOptions&&self.options.datepickerOptions.onClose){self.options.datepickerOptions.onClose.call(this,dateText,inst)}}}this._editorInput.datepicker(options);this._dropDownList=this._editorInput.datepicker("widget")},_renderDropDownButton:function(){var dropDownButton=$("<div role='button' tabindex='-1' id='"+this.id+"_calendarButton' aria-label='"+this._getLocaleOption("ariaCalendarButton")+"'></div>"),dropDownIcon=$("<div></div>");if(this._dropDownButton){return}dropDownButton.addClass(this.css.buttonCommon);dropDownButton.attr("title",this._getLocaleOption("datePickerButtonTitle"));this._editorContainer.prepend(dropDownButton.addClass(this.css.dropDownButton).append(dropDownIcon.addClass(this.css.dropDownImage)));this._dropDownButton=dropDownButton;this._attachButtonsEvents("dropdown",dropDownButton)},_dpRegion:function(){var reg=this.options.regional,lastRegional,regional;regional=$.datepicker&&typeof reg==="string"?$.datepicker.regional[reg==="defaults"||reg==="en-US"?"":reg]:null;if(regional===null&&$.datepicker){for(lastRegional in $.datepicker.regional){}if($.datepicker.regional[lastRegional]){regional=$.datepicker.regional[lastRegional]}}return regional},_create:function(){$.ui.igDateEditor.prototype._create.call(this)},_initialize:function(){this._super();this.options.listItems=["datePicker"]},_applyOptions:function(){this._super();if(!this.options.minValue&&this.options.datepickerOptions&&this.options.datepickerOptions.minDate){if(this._isValidDate(this.options.datepickerOptions.minDate)){this.options.minValue=this.options.datepickerOptions.minDate}}if(!this.options.maxValue&&this.options.datepickerOptions&&this.options.datepickerOptions.maxDate){if(this._isValidDate(this.options.datepickerOptions.minDate)){this.options.maxValue=this.options.datepickerOptions.maxDate}}},_setOption:function(option,value){var prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"datepickerOptions":{var pickerOptions=this._editorInput.data("datepicker").settings,settings,self=this;settings=$.extend(value,this._pickerDefaults());pickerOptions=$.extend(pickerOptions,settings);if(settings.onSelect){var igOnSelect=settings.onSelect;pickerOptions.onSelect=function(dateText,inst){igOnSelect.call(this);if(self.options.datepickerOptions&&self.options.datepickerOptions.onSelect){self.pickerOptions.datepickerOptions.onSelect.call(this,dateText,inst)}}}if(settings.onClose){var igOnClose=settings.onClose;pickerOptions.onClose=function(dateText,inst){igOnClose.call(this);if(self.options.datepickerOptions&&self.options.datepickerOptions.onClose){self.pickerOptions.datepickerOptions.onClose.call(this,dateText,inst)}}}this._editorInput.data("datepicker").settings=pickerOptions}break;default:{this.options[option]=prevValue;this._super(option,value)}break}},_triggerKeyDown:function(event){if(event.keyCode===38&&!event.altKey){if(!event.ctrlKey){this._spinUpEditMode()}}else if(event.keyCode===40&&!event.altKey){if(!event.ctrlKey){this._spinDownEditMode()}}else{this._super(event)}},_triggerDropDownOpened:function(){var args={owner:this,editorInput:this._editorInput,calendar:this._dropDownList};this._trigger(this.events.dropDownListOpened,null,args)},_triggerDropDownOpeninng:function(){var args={owner:this,editorInput:this._editorInput,calendar:this._dropDownList};return this._trigger(this.events.dropDownListOpening,null,args)},_toggleDropDown:function(){var noCancel;if(this._dropDownList.is(":visible")&&!!this._focused){this._hideDropDownList()}else{noCancel=this._triggerDropDownOpening();if(noCancel){this._editorInput.focus();this._showDropDownList()}}},_triggerItemSelected:function(htmlItem,dateFromPicker){var args={owner:this,dateFromPicker:dateFromPicker,item:htmlItem,calendar:this._dropDownList};this._trigger(this.events.itemSelected,args)},_showDropDownList:function(){var self=this,direction,currentDate=this._dateObjectValue,currentInputValue;this._cancelBlurDatePickerOpen=true;this._positionDropDownList();if(this._dropDownListOrientation==="up"){direction="up"}else{direction="down"}if(currentDate){if(this.options.enableUTCDates){currentDate=new Date(Date.UTC(currentDate.getUTCFullYear(),currentDate.getUTCMonth(),currentDate.getUTCDate()))}currentInputValue=this._editorInput.val();$(this._editorInput).datepicker("setDate",currentDate)}try{this._editorInput.datepicker("option","showOptions",{direction:direction});this._editorInput.datepicker("show");if(currentInputValue){this._editorInput.val(currentInputValue)}}catch(ex){this._editorInput.datepicker("show");if(currentInputValue){this._editorInput.val(currentInputValue)}}this._dropDownList.promise().done(function(){self._triggerDropDownOpened()})},_hideDropDownList:function(){this._editorInput.datepicker("hide");this._editorInput.attr("aria-expanded",false)},getCalendar:function(){return $.ui.igTextEditor.prototype.dropDownContainer.call(this)},dropDownContainer:function(){throw $.ig.Editor.locale.datePickerNoSuchMethodDropDownContainer},findListItemIndex:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod},getSelectedListItem:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod},selectedListIndex:function(){throw $.ig.Editor.locale.datePickerEditorNoSuchMethod},showDropDown:function(){$.ui.igTextEditor.prototype.showDropDown.call(this)},hideDropDown:function(){$.ui.igTextEditor.prototype.hideDropDown.call(this)},dropDownButton:function(){return $.ui.igTextEditor.prototype.dropDownButton.call(this)},dropDownVisible:function(){return $.ui.igTextEditor.prototype.dropDownVisible.call(this)},destroy:function(){this._editorInput.datepicker("destroy");this._super();return this}});$.widget("ui.igCheckboxEditor",$.ui.igBaseEditor,{options:{checked:false,size:"normal",iconClass:"ui-icon-check",tabIndex:0},css:{container:"ui-state-default ui-corner-all ui-widget ui-checkbox-container ui-igcheckbox-normal",containerChecked:"ui-state-checkbox-checked",checkboxIcon:"ui-icon",iconCentered:"ui-icon-custom",checked:"ui-igcheckbox-normal-on",unchecked:"ui-igcheckbox-normal-off",checkboxInput:"ui-helper-hidden"},events:{keydown:"keydown",keypress:"keypress",keyup:"keyup"},_triggerKeyUp:function(event){var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.keyup,event,args)},_triggerKeyPress:function(event){var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.keypress,event,args)},_triggerKeyDown:function(event){var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.keydown,event,args)},_create:function(){this._checkedClass=this.css.checked;this._uncheckedClass=this.css.unchecked;$.ui.igBaseEditor.prototype._create.call(this)},_render:function(){this._triggerRendering();if(this.element.is("div")){this._editorContainer=this.element;this._editorInput=$("<span></span>");this._valueInput=$("<input type='checkbox'></input>");this._editorContainer.prepend(this._editorInput);this._editorInput.after(this._valueInput)}else if(this.element.is("input")){this._valueInput=this.element;this._editorInput=$("<span></span>");this._editorContainer=this.element.wrap($("<div></div>")).parent();this._valueInput.before(this._editorInput)}else if(this.element.is("span")){this._editorInput=this.element;this._valueInput=$("<input type='checkbox'></input>");this._editorContainer=this.element.wrap($("<div></div>")).parent();this._editorInput.after(this._valueInput)}else{throw $.ig.Editor.locale.instantiateCheckBoxErrMsg}this._editorContainer.addClass(this.css.container).attr("role","checkbox");this._editorInput.addClass(this.css.checkboxIcon).addClass(this.options.iconClass).addClass(this.css.checked);this._valueInput.addClass(this.css.checkboxInput).attr("aria-hidden","true");if(!$.ig.util.isIE8&&this._valueInput.attr("type")!=="checkbox"){this._valueInput.attr("type","checkbox")}this._attachEvents();this._applyOptions();this._applyAria();this._triggerRendered()},_applyAria:function(){var ariaLabeledBy=this.element.attr("aria-labelledby");if(ariaLabeledBy){this.element.removeAttr("aria-labelledby");this._editorContainer.attr("aria-labelledby",ariaLabeledBy)}},_applyOptions:function(){var checked=this.options.checked;this._super();if(checked){this._initialState()}else{this.options.checked=false}if(this.options.value){this._inputValue=this.options.value;this.value(this.options.value)}this._size(this.options.size);this._setWidth(this.options.width);this._setHeight(this.options.height);this._updateState(checked&&checked!=="false"?true:false)},_setOption:function(option,value){var iconClass=this.options.iconClass;this._super(option,value);switch(option){case"checked":this._updateState(value&&value!=="false"?true:false);break;case"value":this._inputValue=value;this._updateState(this.options.checked);break;case"size":this._size(value);break;case"iconClass":this._setIconClass(iconClass,value);break;default:break}},_readAttributes:function(){var checked=this.element.attr("checked");this._super(this.element);if(checked){this.element.removeAttr("checked");this.options.checked=true}},_attachEvents:function(){var self=this;this._super();this._editorContainer.on({"click.editor":function(event){var internalChecked=self._inputValue!==undefined?self.options.checked:true;if(self._valueInput[0].checked!==internalChecked){self._valueInput[0].checked=internalChecked;this.focus()}self._toggleInternal(event)},"mousedown.editor":function(event){this.focus();event.preventDefault();return false},"focus.editor":function(event){self._setFocus(event,self._cancelFocusTrigger)},"blur.editor":function(event){self._setBlur(event)},"keyup.editor":function(event){var keyCode=event.keyCode||event.which||0;self._triggerKeyUp(event);if(keyCode===32){self._toggleInternal(event);event.preventDefault()}},"keydown.editor":function(event){self._triggerKeyDown(event)},"keypress.editor":function(event){var keyCode=event.keyCode||event.which||0;self._triggerKeyPress(event);if(keyCode===32){event.preventDefault()}}})},_triggerValueChanging:function(event,newState,newValue){var args={owner:this,element:event.target,editorInput:this._editorInput,oldState:this.options.checked,newState:newState,oldValue:this.value(),newValue:newValue};return this._trigger(this.events.valueChanging,event,args)},_triggerValueChanged:function(event){var args={owner:this,element:event.target,editorInput:this._editorInput,newState:this.options.checked,newValue:this.value()};this._trigger(this.events.valueChanged,event,args);this._trigger(this.options.checked?this.events.checked:this.events.unchecked,event,args)},_triggerFocus:function(event){var args={originalEvent:event,owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.focus,event,args)},_triggerBlur:function(event){var args={owner:this,element:event.target,editorInput:this._editorInput};this._trigger(this.events.blur,event,args)},_updateValue:function(value){this.options.value=value;this._valueInput.val(value)},_getState:function(){var state;if(this._inputValue!==undefined){state=this._valueInput[0].checked}else{var value=this._tryParseBool(this._valueInput[0].value);if(value.ret){state=value.p1}else{throw $.ig.Editor.locale.cannotParseNonBoolValue}}return state},_tryParseBool:function(value){if(typeof value==="boolean"){return{ret:true,p1:value}}else if(typeof value==="string"){return $.ig.Boolean.prototype.tryParse(value)}},_toggleInternal:function(event){var noCancel,newState,newVal;newState=!this._getState();newVal=this.value();if(this._inputValue===undefined){newVal=newState}noCancel=this._triggerValueChanging(event,newState,newVal);if(noCancel){this._updateState(newState);this._triggerValueChanged(event);if(this._validator){this._validator._validateInternal(this.element,event)}}},_initialState:function(){this._valueInput.attr("checked","checked")},_updateState:function(value){this.options.checked=value;this._editorContainer.attr("aria-checked",value);if(value){this._editorInput.removeClass(this._uncheckedClass);this._editorContainer.addClass(this.css.containerChecked)}else{this._editorInput.addClass(this._uncheckedClass);this._editorContainer.removeClass(this.css.containerChecked)}if(this._inputValue!==undefined){this._valueInput[0].checked=value;this._valueInput[0].value=this._inputValue}else{this._valueInput[0].checked=true;this._valueInput[0].value=value}},_removeDOM:function(){if(this.element.is("div")){this.element.empty()}else if(this.element.is("input")){this._editorInput.remove();this.element.unwrap()}else if(this.element.is("span")){this._valueInput.remove();this.element.unwrap()}},_detachEvents:function(){this._editorContainer.off("click.editor mousedown.editor focus.editor blur.editor keydown.editor");this._super()},_clearStyling:function(){this._editorContainer.removeClass(this.css.checkboxContainer).removeClass(this.css.containerChecked).removeAttr("role");this._editorInput.removeClass(this._checkedClass).removeClass(this._uncheckedClass).removeClass(this.css.checkboxIcon).removeClass(this.options.iconClass);this._valueInput.removeClass(this.css.checkboxInput).removeAttr("aria-hidden");this._super()},_deleteInternalProperties:function(){delete this._checkedClass;delete this._uncheckedClass;this._super()},_size:function(size){if(size){this._editorContainer.removeClass("ui-igcheckbox-verysmall ui-igcheckbox-small").removeClass("ui-igcheckbox-normal ui-igcheckbox-large");this._editorContainer.addClass("ui-igcheckbox-"+size);this._editorInput.removeClass(this._checkedClass).removeClass(this._uncheckedClass);this._checkedClass="ui-igcheckbox-"+size+"-on";this._uncheckedClass="ui-igcheckbox-"+size+"-off";this._editorInput.addClass(this._checkedClass)}},_setTabIndex:function(index){this._editorContainer.attr("tabIndex",index)},_setWidth:function(width){this._super(width);if(width){this._editorInput.addClass(this.css.iconCentered)}},_setHeight:function(height){this._super(height);if(height){this._editorInput.addClass(this.css.iconCentered)}},_setIconClass:function(oldIconClass,iconClass){this._editorInput.removeClass(oldIconClass).addClass(iconClass)},_setFocus:function(event,triggerEvent){this._editorContainer.addClass(this.css.focus);if(event&&!triggerEvent){this._triggerFocus(event)}else{delete this._cancelFocusTrigger}},_setFocusDelay:function(delay){var self=this;if(delay){this._timeouts.push(setTimeout(function(){self._cancelFocusTrigger=true;this._editorContainer.focus();self._setFocus()},delay))}else{this._cancelFocusTrigger=true;this._editorContainer.focus();this._setFocus()}},_setBlur:function(event){this._editorContainer.removeClass(this.css.focus);this._triggerBlur(event);if(this._validator){this._validator._validateInternal(this.element,event,true)}},isValid:function(){return true},value:function(newValue){if(newValue!==undefined){if(this._inputValue===undefined){var result=this._tryParseBool(newValue);if(result.ret){this._updateState(result.p1)}else{throw $.ig.Editor.locale.cannotSetNonBoolValue}}else{this.options.value=newValue;this._inputValue=newValue;this._updateState(this._getState())}}else{if(this._inputValue===undefined){return this._getState()}return this.options.value}},toggle:function(){if(this._getState()){this._updateState(false)}else{this._updateState(true)}}})})(jQuery);/*!@license
* Infragistics.Web.ClientUI shared localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.SharedLocale){$.ig.SharedLocale={};$.extend($.ig.SharedLocale,{locale:{}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI jQuery Shared 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.2.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.util.js
 */
(function($){$.widget("ui.igLoading",{options:{cssClass:null,includeVerticalOffset:true},_indicator:null,_create:function(){var offset,css;css=this.options.cssClass===null?"ui-igloadingmsg":this.options.cssClass;this._hgrid=this.element.closest(".ui-iggrid-root").closest(".ui-iggrid");if(this.element.children("."+css).length===0){this._indicator=$("<span></span>").appendTo(this.element).attr("id",this.element[0].id+"_loading").addClass(css);offset=this.element.offset();this.refreshPos()}this._yShift=this._indicator?Math.round(this._indicator.height()/2):0},indicatorElement:function(){return this._indicator},indicator:function(){return this},show:function(refresh){if(refresh!==false){this.refreshPos()}if(this._resId){clearInterval(this._resId)}this._resId=setInterval($.proxy(this._resizeContainer,this),300);this._indicator.css("display","").css("visibility","visible")},hide:function(){this._indicator.css("display","none").css("visibility","hidden");clearInterval(this._resId);this._resId=null},_resizeContainer:function(){var offset=this.element.offset();if(offset.top+this.element.innerHeight()/2-this._yShift!==this._indicator.css("top")){this.refreshPos()}},refreshPos:function(){var offset=this.element.offset(),top=offset.top+this.element.innerHeight()/2-this._yShift,left=offset.left+this.element.innerWidth()/2,verticalOffset,relativeOffset;if(this._hgrid.length>0&&top>this._hgrid.offset().top+this._hgrid.height()){return}if(this._hgrid.length>0&&left>this._hgrid.offset().left+this._hgrid.width()){return}if(this.options.includeVerticalOffset&&top>$(window).height()){verticalOffset=($(window).height()-offset.top-$(window).scrollTop())/2;top=$(window).height()-verticalOffset<offset.top?offset.top+verticalOffset:$(window).height()-verticalOffset}relativeOffset=$.ig.util.getRelativeOffset(this._indicator);top-=relativeOffset.top;left-=relativeOffset.left;this._indicator.css("left",left).css("top",top)},destroy:function(){clearInterval(this._resId);this._indicator.remove()}});$.extend($.ui.igLoading,{version:"16.1.20161.1009"});$.widget("ui.igSlider",$.ui.mouse,{options:{animate:false,max:100,min:0,orientation:"horizontal",step:1,value:0,bookmarks:[{value:0,title:"",disabled:false,css:""}],showBookmarkTitle:true,syncHandleWithBookmark:true},css:{baseClasses:"ui-igslider ui-widget ui-widget-content ui-corner-all",horizontalOrientationClass:"ui-igslider-horizontal",verticalOrientationClass:"ui-igslider-vertical",sliderDisabledClass:"ui-igslider-disabled ui-disabled",handleClass:"ui-igslider-handle",bookmarkClass:"ui-igslider-bookmark",bookmarkDisabledClass:"ui-igslider-bookmark-disabled",bookmarkTooltipClass:"ui-igslider-bookmark-tooltip"},events:{start:"start",slide:"slide",stop:"stop",change:"change",bookmarkHit:"bookmarkhit",bookmarkClick:"bookmarkclick"},_numpages:5,widget:function(){return this.element},_createWidget:function(){this.options.bookmarks=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var o=this.options,self=this,css=this.css;this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass(css.baseClasses);if(o.disabled){this.element.addClass(css.sliderDisabledClass)}if($(".ui-igslider-handle",this.element).length===0){$("<a href='#'></a>").appendTo(this.element).addClass(css.handleClass)}this.handles=$(".ui-igslider-handle",this.element).addClass("ui-state-default"+" ui-corner-all").bind({click:function(event){event.preventDefault()},mouseover:function(){if(!o.disabled){$(this).addClass("ui-state-hover")}},mouseout:function(){$(this).removeClass("ui-state-hover")},focus:function(){if(!o.disabled){$(".ui-igslider .ui-state-focus").removeClass("ui-state-focus");$(this).addClass("ui-state-focus")}else{$(this).blur()}},blur:function(){$(this).removeClass("ui-state-focus")},keydown:function(event){var ret=true,index=$(this).data("index.ui-igslider-handle"),allowed,curVal,newVal,step;if(self.options.disabled){return}switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:ret=false;if(!self._keySliding){self._keySliding=true;$(this).addClass("ui-state-active");allowed=self._start(event,index);if(allowed===false){return}}break}step=self.options.step;curVal=newVal=self.value();switch(event.keyCode){case $.ui.keyCode.HOME:newVal=self.options.min;break;case $.ui.keyCode.END:newVal=self.options.max;break;case $.ui.keyCode.PAGE_UP:newVal=self._trimValue(curVal+(self.options.max-self.options.min)/this._numpages);break;case $.ui.keyCode.PAGE_DOWN:newVal=self._trimValue(curVal-(self.options.max-self.options.min)/this._numpages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===self.options.max){return}newVal=self._trimValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===self.options.min){return}newVal=self._trimValue(curVal-step);break}self._slide(event,index,newVal);return ret},keyup:function(event){var index=$(this).data("index.ui-igslider-handle");if(self._keySliding){self._keySliding=false;self._stop(event,index);self._change(event,index);$(this).removeClass("ui-state-active")}}}).each(function(i){$(this).data("index.ui-igslider-handle",i)});this.handle=this.handles.eq(0);this._renderBookmarks();this._refreshValue();this._animateOff=false},_renderBookmarks:function(){if(this.options.bookmarks&&this.options.bookmarks.length>0){var len=this.options.bookmarks.length,i=0,o=this.options,css=this.css,mark,self=this;for(i;i<len;i++){mark=o.bookmarks[i];$("<a href='#'></a>").appendTo(this.element).data("index.ui-igslider-bookmark",i).addClass(mark.disabled?css.bookmarkDisabledClass:css.bookmarkClass).addClass(mark.css&&mark.css.length>0?mark.css:"").css("left",o.min!==o.max?(mark.value-o.min)/(o.max-o.min)*100+"%":"0%")}this.bookmarks=$(".ui-igslider-bookmark",this.element).addClass("ui-state-default").bind({mousedown:function(event){var noCancel=true,bookmarkIndex=$(this).data("index.ui-igslider-bookmark");event.preventDefault();event.stopPropagation();noCancel=self._bookmarkClicked(event,bookmarkIndex);if(self.options.syncHandleWithBookmark&&noCancel){self._slide(event,0,self.options.bookmarks[bookmarkIndex].value)}},mouseover:function(event){if(!o.disabled){$(this).addClass("ui-state-hover");if(self.options.showBookmarkTitle){self._showBookmarkTitle($(this),event)}}},mouseout:function(){if(!o.disabled){$(this).removeClass("ui-state-hover");if(self.options.showBookmarkTitle){self._hideBookmarkTitle($(this))}}},click:function(event){event.preventDefault()}});this._createBookmarkTooltip();this._buildBookmarkHit()}},destroy:function(){this.handles.remove();this.clearBookmarks();this.element.removeClass(this.css.baseClasses+" ui-igslider-horizontal"+" ui-igslider-vertical"+" ui-igslider-disabled").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_id:function(suffix){return this.element[0].id+suffix},_showBookmarkTitle:function(bookmark,browserEvent){var tooltip=$("#"+this._id("_tooltip")),title=this.options.bookmarks[bookmark.data("index.ui-igslider-bookmark")].title;if(title&&title.length>0){tooltip.igTooltip("option","text",title);tooltip.css("top",browserEvent.pageY-tooltip.outerHeight()-5).css("left",browserEvent.pageX-tooltip.width()/2+bookmark.width()/2).show()}},_hideBookmarkTitle:function(){$("#"+this._id("_tooltip")).hide()},_createBookmarkTooltip:function(){var html='<div id="'+this._id("_tooltip")+'" class="'+this.css.bookmarkTooltipClass+'"></div>';$(html).appendTo($(document.body)).igTooltip({arrowLocation:"bottom"}).hide()},clearBookmarks:function(){if(this.bookmarks){this.bookmarks.remove()}},_mouseCapture:function(event){var o=this.options,position,normValue,index=0,handle=this.handles.eq(index),self=this,offset,mouseOverHandle;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);this._mouseSliding=true;self._handleIndex=index;handle.addClass("ui-state-active");if(!$.ig.util.isOpera){handle.focus()}offset=handle.offset();mouseOverHandle=!$(event.target).parents().andSelf().is(".ui-igslider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-handle.width()/2,top:event.pageY-offset.top-handle.height()/2-(parseInt(handle.css("borderTopWidth"),10)||0)-(parseInt(handle.css("borderBottomWidth"),10)||0)+(parseInt(handle.css("marginTop"),10)||0)};this._slide(event,index,normValue);this._animateOff=true;this._mouseUpHandler=function(event){return self._mouseStop(event)};$(document).bind("mouseup."+this.widgetName,this._mouseUpHandler);return true},_mouseStart:function(event){$(document).unbind("mouseup."+this.widgetName,this._mouseUpHandler);return this._start(event,this._handleIndex)},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){var self=this;this.handles.removeClass("ui-state-active");setTimeout(function(){self._mouseSliding=false},1e3);this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){var o=this.options,css=this.css;if(o.orientation==="vertical"){this.orientation="vertical";this.element.removeClass(css.horizontalOrientationClass).addClass(css.verticalOrientationClass)}else{this.orientation="horizontal";this.element.removeClass(css.verticalOrientationClass).addClass(css.horizontalOrientationClass)}},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=pixelMouse/pixelTotal;if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this.options.max-this.options.min;valueMouse=this.options.min+percentMouse*valueTotal;return this._trimValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};return this._trigger(this.events.start,event,uiHash)},_slide:function(event,index,newVal){var allowed;if(newVal!==this.value()){allowed=this._trigger(this.events.slide,event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};this._trigger(this.events.stop,event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};this._trigger(this.events.change,event,uiHash);this._checkBookmarkHit(uiHash.value,event);if(uiHash.value===this.options.max&&this._marksHit&&this._marksHit.length===0){this._buildBookmarkHit()}}},_checkBookmarkHit:function(currentValue,event){if(this._marksHit&&this._marksHit.length>0&&currentValue>=this._marksHit[0].value){var index=this._marksHit[0].index;this._marksHit.shift();this._bookmarkHit(event,index)}},_buildBookmarkHit:function(){var b=this.options.bookmarks||[],i=b.length-1;this._marksHit=[];for(i;i>=0;i--){if(!b[i].disabled){this._marksHit.push({value:b[i].value,index:i})}}this._marksHit.sort(this._sortBookmarksJSON);this._marksHit=$.extend(true,[],this._marksHit)},_sortBookmarksJSON:function(a,b){return a.value-b.value},_bookmarkClicked:function(event,index){var uiHash={bookmarkElement:this.bookmarks[index],bookmark:this.options.bookmarks[index]};return this._trigger(this.events.bookmarkClick,event,uiHash)},_bookmarkHit:function(event,index){var uiHash={bookmarkElement:this.bookmarks[index],bookmark:this.options.bookmarks[index]};if(uiHash.bookmarkElement){this._trigger(this.events.bookmarkHit,event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimValue(newValue);this._refreshValue();this._change(null,0)}return this._value()},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"disabled":if(value){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this._refreshValue();break;case"value":if(this._mouseSliding===true){return}this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"bookmarks":this.clearBookmarks();this._renderBookmarks();break}},_value:function(){return this._trimValue(this.options.value)},_trimValue:function(val){if(val<this.options.min){return this.options.min}if(val>this.options.max){return this.options.max}var step=this.options.step>0?this.options.step:1,valModStep=val%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=valModStep>0?step:-step}return parseFloat(alignValue.toFixed(5))},_normPercentValue:function(val){var decrease=0,retVal=val;if(this.orientation==="vertical"){decrease=(this.handle.outerHeight()/this.element.outerHeight()).toFixed(2)*100}if(val-decrease>0){retVal=val-decrease}return retVal},_refreshValue:function(){var o=this.options,control=this,animate=!this._animateOff?o.animate:false,_set={},value=this.value(),valueMin=this.options.min,valueMax=this.options.max,valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0;_set[control.orientation==="horizontal"?"left":"bottom"]=this._normPercentValue(valPercent)+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate)}});$.extend($.ui.igSlider,{version:"16.1.20161.1009"});$.widget("ui.igProgressBar",{options:{animate:false,animateTimeout:100,max:100,min:0,orientation:"horizontal",value:0,width:"0px",height:"0px",range:false,queue:true,endValue:100},css:{baseClasses:"ui-igprogressbar ui-widget ui-widget-content ui-corner-all",horizontalOrientationClass:"ui-igprogressbar-horizontal",verticalOrientationClass:"ui-igprogressbar-vertical",disabledClass:"ui-igprogressbar-disabled ui-disabled",progressRangeClass:"ui-igprogressbar-range ui-widget-header ui-corner-all"},events:{change:"change"},_animationOff:true,widget:function(){return this.element},_detectOrientation:function(){var css=this.css;if(this.options.orientation==="vertical"){this.orientation="vertical";this.element.removeClass(css.horizontalOrientationClass).addClass(css.verticalOrientationClass)}else{this.orientation="horizontal";this.element.removeClass(css.verticalOrientationClass).addClass(css.horizontalOrientationClass)}},_id:function(suffix){return this.element[0].id+suffix},_create:function(){var o=this.options,css=this.css;this._detectOrientation();this.element.addClass(css.baseClasses);if(o.disabled){this.element.addClass(css.disabledClass)}if(o.width!=="0px"){this.element.css("width",o.width)}if(o.height!=="0px"){this.element.css("height",o.height)}if(o.orientation==="horizontal"){$('<div id="'+this._id("_progress")+'" class="'+css.progressRangeClass+'" style="height:100%; top:0px; left:0%; width:0%;"></div>').appendTo(this.element)}else{$('<div id="'+this._id("_progress")+'" class="'+css.progressRangeClass+'" style="height:0%; bottom:0%; left:0px; width:100%;"></div>').appendTo(this.element)}this._refreshValue()},destroy:function(){this.element.removeClass("ui-igprogressbar"+" ui-igprogressbar-horizontal"+" ui-igprogressbar-vertical"+" ui-igprogressbar-disabled"+" ui-widget"+" ui-widget-content"+" ui-corner-all").removeData("igProgressBar").unbind(".igProgressBar");$("#"+this._id("_progress")).remove();return this},_change:function(event){var uiHash={value:this.value()};this._trigger(this.events.change,event,uiHash)},value:function(newValue){if(arguments.length){this.options.value=this._trimValue(newValue);this._refreshValue();this._change(null)}return this.options.value},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);var o=this.options;switch(key){case"disabled":if(value){this.element.addClass(this.css.disabledClass)}else{this.element.removeClass(this.css.disabledClass)}break;case"orientation":this._detectOrientation();this._refreshValue();break;case"value":this._animationOff=true;o.value=this._trimValue(value);this._refreshValue();this._change(null);this._animationOff=false;break;case"endValue":o.endValue=this._trimValue(value);this._refreshValue();break;case"max":if(o.endValue>o.max){o.endValue=o.max;this._refreshValue()}break;case"width":this.element.css("width",value);break;case"height":this.element.css("height",value);break;case"animate":o.animate=value;break;case"animateTimeout":o.animateTimeout=value;break;default:break}},_trimValue:function(val){if(val<this.options.min){return this.options.min}if(val>this.options.max){return this.options.max}return parseInt(val,10)},_refreshValue:function(){var o=this.options,additionalOptions={duration:o.animateTimeout,queue:o.queue},value=o.value,valueMin=o.min,valueMax=o.max,valueEnd=o.endValue,valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,valueEndPercent=value!==valueEnd?(valueEnd-value)/(valueMax-valueMin)*100:0,progressBar=$("#"+this._id("_progress"));if(o.range){if(o.orientation==="horizontal"){progressBar.css("left",valPercent+"%").css("width",valueEndPercent+"%")}else{progressBar.css("bottom",valPercent+"%").css("height",valueEndPercent+"%")}}else{if(o.animate===true){if(o.orientation==="horizontal"){if(progressBar[0].style.width==="0%"){progressBar.css({width:"0px"})}if(progressBar.is(":hidden")===false){progressBar.animate({width:valPercent+"%"},additionalOptions)}else{progressBar.css("width",valPercent+"%")}}else{if(progressBar[0].style.height==="0%"){progressBar.css({height:"0px"})}if(progressBar.is(":hidden")===false){progressBar.animate({height:valPercent+"%"},o.animateTimeout)}else{progressBar.animate({height:valPercent+"%"},o.animateTimeout)}}}else{if(o.orientation==="horizontal"){progressBar.css("width",valPercent+"%")}else{progressBar.css("height",valPercent+"%")}}}}});$.extend($.ui.igProgressBar,{version:"16.1.20161.1009"});$.widget("ui.igButton",{options:{width:null,height:null,link:{href:null,target:null,title:null},labelText:"",centerLabel:false,css:null,onlyIcons:false,icons:{primary:null,secondary:null},title:false},_id:function(suffix){return this.element[0].id+suffix},_create:function(){var self=this,o=self.options,e=this.element,inputType,css={buttonClassIE6:"ui-ie6",buttonClasses:"ui-button ui-igbutton ui-widget "+"ui-widget-content ui-corner-all ui-state-default",buttonHoverClasses:"ui-state-hover",buttonActiveClasses:"ui-state-active",buttonFocusClasses:"ui-state-focus",buttonLabelClass:"ui-button-text",buttonDisabledClass:"ui-state-disabled",buttonPrimaryIconClass:"ui-button-icon-primary ui-icon",buttonMainElementPrimaryIconClass:" ui-button-text-icon-primary",buttonMainElementSecondaryIconClass:" ui-button-text-icon-secondary",buttonSecondaryIconClass:"ui-button-icon-secondary ui-icon",buttonIconsOnly:"ui-button-icons-only",buttonIconOnly:"ui-button-icon-only",buttonIcons:"ui-button-text-icons",buttonTextOnlyClass:"ui-button-text-only"};this._attached=false;o.css=$.extend(css,o.css);self._getInitValues();if(e.is("div")){self._renderDivButton()}else if(e.is("a")){self._renderAHref()}else if(e.is("input")){inputType=e.attr("type").toUpperCase();if(inputType==="BUTTON"||inputType==="SUBMIT"||inputType==="RESET"){self._renderInput()}else{return}}else if(e.is("button")){self._renderButton()}else{return}if(o.width!==null){self._setWidth(o.width)}if(o.height!==null){self._setHeight(o.height)}e.addClass(o.css.buttonClasses).addClass(o.css.buttonDefaultClasses);if(o.centerLabel===true){self._centerLabel()}if(o.disabled){self._disableButton()}else{self._enableButton()}self._setOnlyIcons();e.attr("role","button");e.attr("aria-disabled","false");self._attachButtonEvents();self.setTitle(o.title);return this},setTitle:function(title){var e=this.element;if(title===false){e.removeAttr("title")}else{e.attr("title",title)}},widget:function(){return this.element},_isRedirect:function(){return this.options.link.href!==null},_renderDivButton:function(){this._setLabel()},_renderAHref:function(){this._setLabel()},_renderInput:function(){var e=this.element;e.attr("value",this.options.labelText)},_renderButton:function(){this._setLabel()},_disableButton:function(){var self=this,e=self.element;e.addClass(self.options.css.buttonDisabledClass);if(e.is("a")===true){e.removeAttr("href");e.removeAttr("target");e.removeAttr("title")}else{e.attr("disabled","true")}},_enableButton:function(){var self=this,e=self.element,o=this.options;if(e.hasClass(o.css.buttonDisabledClass)){e.removeClass(o.css.buttonDisabledClass)}e.removeAttr("disabled");if(e.is("a")===true){self._setLinkOptions(true)}},_setLabel:function(){var e=this.element,o=this.options,icons=o.icons,css=o.css,html="",isSetPrimary=this._isSetPrimaryIcon(),isSetSecondary=this._isSetSecondaryIcon(),labelText=o.labelText===null||o.labelText===""?e.text():o.labelText;e.attr("title",o.labelText);if(e.is("input")){e.attr("value",o.labelText);return}if(isSetPrimary){html+='<span class="'+css.buttonPrimaryIconClass+" "+icons.primary+'" id="'+this._id("_picn")+'"></span>'}html+='<span class="'+o.css.buttonLabelClass+'" id="'+this._id("_lbl")+'">'+labelText+"</span>";if(isSetSecondary){html+='<span class="'+css.buttonSecondaryIconClass+" "+icons.secondary+'" id="'+this._id("_sicn'")+'"></span>'}if(isSetPrimary&&isSetSecondary&&!o.onlyIcons){e.addClass(css.buttonIcons)}else if(o.onlyIcons){this._setOnlyIcons()}else if(isSetPrimary){e.addClass(css.buttonMainElementPrimaryIconClass)}else if(isSetSecondary){e.addClass(css.buttonMainElementSecondaryIconClass)}else{e.addClass(css.buttonTextOnlyClass)}e.html(html)},_setOnlyIcons:function(){var e=this.element,css=this.options.css;if(this.options.onlyIcons===false){if(e.hasClass(css.buttonIconsOnly)){e.removeClass(css.buttonIconsOnly)}if(e.hasClass(css.buttonIconOnly)){e.removeClass(css.buttonIconOnly)}if(this._isSetPrimaryIcon()&&this._isSetSecondaryIcon()){e.addClass(css.buttonIcons)}}else{if(this._isSetPrimaryIcon()&&this._isSetSecondaryIcon()){e.addClass(css.buttonIconsOnly)}else{e.addClass(css.buttonIconOnly)}}},_setLinkOptions:function(isAHref){var self=this,e=self.element,o=this.options;if(isAHref){if(o.link!==null&&o.link.href!==null){e.attr("href",o.link.href)}else if(e.attr("href")!==undefined){e.removeAttr("href")}if(o.link!==null&&o.link.target!==null){e.attr("target",o.link.target)}else if(e.attr("target")!==undefined){e.removeAttr("target")}if(o.link!==null&&o.link.title!==null){e.attr("title",o.link.title)}else if(e.attr("title")!==undefined){e.removeAttr("title")}}},_setWidth:function(value){var e=this.element;if(value===null){e.css("width","")}else{e.css("width",value)}},_setHeight:function(value){var e=this.element;if(value===null){e.css("height","")}else{e.css("height",value)}},_setOption:function(key,val){var e=this.element,self=this;$.Widget.prototype._setOption.apply(this,[key,val]);switch(key){case"width":self._setWidth(val);break;case"height":self._setHeight(val);break;case"link":self._setLinkOptions(e.is("a")===true);break;case"disabled":val=Boolean(val);if(val===true){self._disableButton()}else{self._enableButton()}break;case"labelText":self._setLabel();break;case"centerLabel":val=Boolean(val);if(val){self._centerLabel()}else{self._removeCenterLabel()}break;case"onlyIcons":val=Boolean(val);self._setOnlyIcons();break;case"icons":self._setLabel();break;case"title":self.setTitle(val);break;default:break}},_centerLabel:function(){var self=this,e=self.element,l=$("#"+self._id("_lbl")),left=(e.width()-l.width())/2,top=(e.height()-l.height())/2;l.css({position:"relative",top:top+"px",left:left+"px"})},_removeCenterLabel:function(){var self=this,l=$("#"+self._id("_lbl"));if(l.length>0){l.css({position:"",top:"",left:""})}},_dettachEvents:function(){this._attached=false;this.element.unbind(this._events)},_onMouseOver:function(event){var noCancel;if(this.options.disabled===true){return}noCancel=this._trigger("mouseover",event);if(noCancel){this.element.addClass(this.options.css.buttonHoverClasses)}},_onMouseOut:function(event){var self=this,e=self.element,o=this.options,noCancel;if(o.disabled===true){return}noCancel=self._trigger("mouseout",event);if(noCancel){e.removeClass(o.css.buttonHoverClasses)}},_onClick:function(event){var e=this.element,self=this,o=this.options,noCancel;if(o.disabled===true){return}noCancel=self._trigger("click",event);if(noCancel){this.element.removeClass(o.css.buttonHoverClasses);if(self._isRedirect()===true&&e.is("a")===false){if(o.link.target==="_blank"){window.open(o.link.href)}else{window.location=o.link.href}}}},_onMouseDown:function(event){var e=this.element,o=this.options,noCancel;if(o.disabled===true){return}noCancel=this._trigger("mousedown",event);if(noCancel){e.removeClass(o.css.buttonHoverClasses);e.addClass(o.css.buttonActiveClasses)}},_onMouseUp:function(event){var o=this.options,noCancel;if(o.disabled===true){return}noCancel=this._trigger("mouseup",event);if(noCancel){this.element.removeClass(o.css.buttonHoverClasses);this.element.removeClass(o.css.buttonActiveClasses)}},_onFocus:function(event){var o=this.options,noCancel;if(o.disabled===true){return}noCancel=this._trigger("focus",event);if(noCancel){this.element.addClass(o.css.buttonFocusClasses)}},_onBlur:function(event){var o=this.options,noCancel;if(o.disabled===true){return}noCancel=this._trigger("blur",event);if(noCancel){this.element.removeClass(o.css.buttonActiveClasses);this.element.removeClass(o.css.buttonFocusClasses)}},_onKeyDown:function(event){var o=this.options;if(o.disabled===true){return}this._trigger("keydown",event)},_attachButtonEvents:function(){var self=this,e=self.element;if(this._attached===true){return}this._attached=true;this._events={mouseover:function(e){self._onMouseOver(e,self)},click:function(e){self._onClick(e)},mouseout:function(e){self._onMouseOut(e)},mousedown:function(e){self._onMouseDown(e)},mouseup:function(e){self._onMouseUp(e)},focus:function(e){self._onFocus(e)},blur:function(e){self._onBlur(e)},keydown:function(e){self._onKeyDown(e)}};e.bind(this._events)},_isSetPrimaryIcon:function(){var primary=this.options.icons.primary,isSet=false;if(primary!==undefined&&primary!==null){isSet=true}return isSet},_isSetSecondaryIcon:function(){var secondary=this.options.icons.secondary,isSet=false;if(secondary!==undefined&&secondary!==null){isSet=true}return isSet},destroy:function(){this._dettachEvents();this._rollbackInitValues();this._events=null;this._innerHTML=null;this._initialAttributes=null;$.Widget.prototype.destroy.apply(this,arguments)},_getInitValues:function(){var e=this.element,attr,i;this._innerHTML=e.html();this._initialAttributes=[];attr=e[0].attributes;for(i=0;i<attr.length;i++){if(attr[i].name!=="id"&&attr[i].name!=="type"){this._initialAttributes.push({name:attr[i].name,value:attr[i].value})}}},_rollbackInitValues:function(){var e=this.element,attr,a,i;if(this._innerHTML!==undefined){e.html(this._innerHTML)}attr=e[0].attributes;a=[];for(i=0;i<attr.length;i++){if(attr[i].name!=="id"&&attr[i].name!=="type"){a.push(attr[i].name)}}for(i=0;i<a.length;i++){e.removeAttr(a[i])}if(this._initialAttributes){for(i=0;i<this._initialAttributes.length;i++){if(this._initialAttributes[i].name!=="id"){e.attr(this._initialAttributes[i].name,this._initialAttributes[i].value)}}}}});$.extend($.ui.igButton,{version:"16.1.20161.1009"});$.widget("ui.igTooltip",{css:{baseClasses:"ui-widget ui-igpopover ui-igplayer-tooltip",arrowImageBaseClass:"ui-igpopover-arrow-"},options:{text:"",arrowLocation:"top"},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"text":$("div.ui-widget-content",this.element).html(value);break;case"arrowLocation":$("div",this.element).remove();this._renderTooltip();break}},_create:function(){if(this.element.is("div")){this._renderTooltip();this.element.addClass(this.css.baseClasses)}},_renderTooltip:function(){switch(this.options.arrowLocation){case"top":this._createArrowDiv();this._createContentDiv();break;case"bottom":this._createContentDiv();this._createArrowDiv();break;case"left":break;case"right":break}},_createContentDiv:function(){var t=this.options.text&&this.options.text.length>0?this.options.text:"";$('<div class="ui-widget-content ui-corner-all">'+t+"</div>").appendTo(this.element)},_createArrowDiv:function(){$('<div class="'+this.css.arrowImageBaseClass+this.options.arrowLocation+'"></div>').appendTo(this.element)},destroy:function(){this.element.children().remove();this.element.removeClass(this.css.baseClasses)}});$.extend($.ui.igTooltip,{version:"16.1.20161.1009"});$.widget("ui.mouseWrapper",$.ui.mouse,{options:{cancel:":input,option",distance:1,delay:0},events:{start:"start",drag:"drag",stop:"stop",capture:"capture"},_create:function(){var self=this,originalMouseDown=this._mouseDown;if($.ig.util.isIE9){this._mouseDown=function(event){var originalPreventDefault=event.preventDefault,result;event.preventDefault=function(){};result=originalMouseDown.apply(self,[event]);event.preventDefault=originalPreventDefault;return result}}this._mouseInit()},destroy:function(){this._mouseDestroy();return this},_mouseStart:function(event){return this._trigger(this.events.start,event)},_mouseDrag:function(event){return this._trigger(this.events.drag,event)},_mouseStop:function(event){return this._trigger(this.events.stop,event)},_mouseCapture:function(event){return this._trigger(this.events.capture,event)}});$.widget("ui.igResponsiveContainer",{options:{pollingInterval:500},_createWidget:function(options,element){this._callbacks=[];this._element=element;this._pollerHandler=$.proxy(this._pollerTick,this);this._startPoller();this._width=this._getCurrentWidth();this._height=this._getCurrentHeight();$.Widget.prototype._createWidget.apply(this,arguments)},destroy:function(){this._stopPoller();this._callbacks=[];$.Widget.prototype.destroy.call(this);return this},startPoller:function(){this._startPoller()},stopPoller:function(){this._stopPoller()},removeCallback:function(callbackId){if(callbackId>=0&&callbackId<this._callbacks.length){this._callbacks.splice(callbackId,1)}},addCallback:function(callback,owner,reactionStep,reactionDirection){return this._callbacks.push({callback:callback,owner:owner,step:reactionStep,left:reactionDirection==="xy"||reactionDirection==="x",top:reactionDirection==="xy"||reactionDirection==="y",cWidth:this._getCurrentWidth(),cHeight:this._getCurrentHeight()})-1},_startPoller:function(){this._intervalId=setInterval(this._pollerHandler,this.options.pollingInterval)},_stopPoller:function(){if(this._intervalId){clearInterval(this._intervalId);delete this._intervalId}},_pollerTick:function(){var nw=this._getCurrentWidth(),nh=this._getCurrentHeight(),cb,i,called=false;for(i=0;i<this._callbacks.length;i++){cb=this._callbacks[i];if(cb.left===true){if(Math.abs(cb.cWidth-nw)>cb.step){cb.callback.apply(cb.owner,[nw,nh]);cb.cWidth=nw;cb.cHeight=nh;called=true}}if(cb.top===true&&called===false){if(Math.abs(cb.cHeight-nh)>cb.step){cb.callback.apply(cb.owner,[nw,nh]);cb.cWidth=nw;cb.cHeight=nh}}}this._width=nw;this._height=nh},_getCurrentWidth:function(){return this._element.offsetWidth},_getCurrentHeight:function(){return this._element.offsetHeight}});$.extend($.ui.igResponsiveContainer,{version:"16.1.20161.1009"});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.ui.shared",["ig.util","jquery.ui.core","jquery.ui.widget"],function(){return $.ui.igLoading
})}})(jQuery);/*!@license
* Infragistics.Web.ClientUI Grid localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Grid){$.ig.Grid={};$.extend($.ig.Grid,{locale:{noSuchWidget:"{featureName} was not recognized. Verify that such a feature exists and the spelling is correct.",autoGenerateColumnsNoRecords:"autoGenerateColumns is enabled, but there are no records in the data source. Load a data source with records to be able to determine the columns.",optionChangeNotSupported:"{optionName} cannot be edited after initialization. Its value should be set during initialization.",optionChangeNotScrollingGrid:"{optionName} cannot be edited after initialization because your grid initially does not scroll and full re-rendering will be required. This option should be set during initialization.",noPrimaryKeyDefined:"There is no primary key defined for the grid. Define a primary key in order to use features such as Grid Editing.",indexOutOfRange:"The specified row index is out of range. A row index between 0 and {max} should be provided.",noSuchColumnDefined:"The specified column key is not valid. A column key that matches the key of one of the defined grid columns should be provided.",columnIndexOutOfRange:"The specified column index is out of range. A column index between 0 and {max} should be provided.",recordNotFound:"A record with id {id} could not be found in the data view. Verify the id used for the search and adjust it if necessary.",columnNotFound:"A column with key {key} could not be found. Verify the key used for the search and adjust it if necessary.",colPrefix:"Column ",columnVirtualizationRequiresWidth:"Virtualization and columnVirtualization require the width of the grid or its columns to be set. Provide a value for the grid width, defaultColumnWidth or the width of each column.",virtualizationRequiresHeight:"Virtualization requires the height of the grid to be set. A value for the grid height should be provided.",colVirtualizationDenied:"columnVirtualization requires a different virtualizationMode setting. The virtualizationMode should be set to 'fixed'.",noColumnsButAutoGenerateTrue:"autoGenerateColumns is disabled and no columns are defined for the grid. Either enable autoGenerateColumns or manually specify the columns.",noPrimaryKey:"igHierarchicalGrid requires a primary key to be defined. A primary key should be provided.",expandTooltip:"Expand Row",collapseTooltip:"Collapse Row",featureChooserTooltip:"Feature chooser",movingNotAllowedOrIncompatible:"The specified column could not be moved. Verify that such a column exists and its end position would not break the column layout.",allColumnsHiddenOnInitialization:"All columns cannot be hidden during initialization. At least one column should be configured as visible.",virtualizationNotSupportedWithAutoSizeCols:"Virtualization requires a different column width configuration than '*'. The column width should be set as a number in pixels.",columnVirtualizationNotSupportedWithPercentageWidth:"Column virtualization requires a different grid width configuration. The column width should be set as a number in pixels.",mixedWidthsNotSupported:"All columns are required to have their width set the same way. Set all column widths either as percentages or as number in pixels.",multiRowLayoutColumnError:"The column with key: {key1} could not be added to the multi-row-layout because its place in the layout has already been taken by the column with key: {key2} .",multiRowLayoutNotComplete:"The multi-row-layout is not complete. The column definition creates a layout that has empty spaces and cannot be rendered correctly.",multiRowLayoutMixedWidths:"Mixed widths (percentage and pixels) are not supported in the Multi-Row Layout. Please define all column widths in either pixels or percentage. ",scrollableGridAreaNotVisible:"Fixed header and footer areas are larger than the available grid height. The scrollable area is not visible.Please set a larger grid height."}});$.ig.GridFiltering=$.ig.GridFiltering||{};$.extend($.ig.GridFiltering,{locale:{startsWithNullText:"Starts with...",endsWithNullText:"Ends with...",containsNullText:"Contains...",doesNotContainNullText:"Does not contain...",equalsNullText:"Equals...",doesNotEqualNullText:"Does not equal...",greaterThanNullText:"Greater than...",lessThanNullText:"Less than...",greaterThanOrEqualToNullText:"Greater than or equal to...",lessThanOrEqualToNullText:"Less than or equal to...",onNullText:"On...",notOnNullText:"Not on...",afterNullText:"After",beforeNullText:"Before",emptyNullText:"Empty",notEmptyNullText:"Not empty",nullNullText:"Null",notNullNullText:"Not null",startsWithLabel:"Starts with",endsWithLabel:"Ends with",containsLabel:"Contains",doesNotContainLabel:"Does not contain",equalsLabel:"Equals",doesNotEqualLabel:"Does not equal",greaterThanLabel:"Greater than",lessThanLabel:"Less than",greaterThanOrEqualToLabel:"Greater than or equal to",lessThanOrEqualToLabel:"Less than or equal to",trueLabel:"True",falseLabel:"False",afterLabel:"After",beforeLabel:"Before",todayLabel:"Today",yesterdayLabel:"Yesterday",thisMonthLabel:"This month",lastMonthLabel:"Last month",nextMonthLabel:"Next month",thisYearLabel:"This year",lastYearLabel:"Last year",nextYearLabel:"Next year",clearLabel:"Clear Filter",noFilterLabel:"No",onLabel:"On",notOnLabel:"Not on",advancedButtonLabel:"Advanced",filterDialogCaptionLabel:"ADVANCED FILTER",filterDialogConditionLabel1:"Show records matching ",filterDialogConditionLabel2:" of the following criteria",filterDialogConditionDropDownLabel:"Filtering condition",filterDialogOkLabel:"Search",filterDialogCancelLabel:"Cancel",filterDialogAnyLabel:"ANY",filterDialogAllLabel:"ALL",filterDialogAddLabel:"Add",filterDialogErrorLabel:"You reached the maximum number of filters supported.",filterDialogCloseLabel:"Close filtering dialog",filterSummaryTitleLabel:"Search results",filterSummaryTemplate:"${matches} matching records",filterDialogClearAllLabel:"Clear ALL",tooltipTemplate:"${condition} filter applied",featureChooserText:"Hide Filter",featureChooserTextHide:"Show Filter",featureChooserTextAdvancedFilter:"Advanced Filter",virtualizationSimpleFilteringNotAllowed:"Column virtualization requires a different type of filtering. Set filtering mode to 'advanced' or disable advancedModeEditorsVisible",multiRowLayoutSimpleFilteringNotAllowed:"Multi-row-layout requires a different type of filtering. Set filtering mode to 'advanced'",featureChooserNotReferenced:"A reference to Feature Chooser is missing. Include infragistics.ui.grid.featurechooser.js in your project, use a loader or one of the combined script files.",conditionListLengthCannotBeZero:"The conditionList array in columnSettings is empty. A suitable array for the conditionList should be provided.",conditionNotValidForColumnType:"The condition '{0}' is not valid for the current configuration. It should be replaced with a condition suitable for {1} column type.",defaultConditionContainsInvalidCondition:"defaultExpression for the '{0}' column contains a condition that is not allowed. It should be replaced it with a condition suitable for {0} column type."}});$.ig.GridGroupBy=$.ig.GridGroupBy||{};$.extend($.ig.GridGroupBy,{locale:{emptyGroupByAreaContent:"Drag a column here or {0} to Group By",emptyGroupByAreaContentSelectColumns:"select columns",emptyGroupByAreaContentSelectColumnsCaption:"select columns",expandTooltip:"Expand Grouped Row",collapseTooltip:"Collapse Grouped Row",removeButtonTooltip:"Remove Grouped Column",modalDialogCaptionButtonDesc:"Sort ascending",modalDialogCaptionButtonAsc:"Sort descending",modalDialogCaptionButtonUngroup:"Ungroup",modalDialogGroupByButtonText:"Group By",modalDialogCaptionText:"Add to Group By",modalDialogDropDownLabel:"Showing:",modalDialogClearAllButtonLabel:"Clear ALL",modalDialogRootLevelHierarchicalGrid:"Root",modalDialogDropDownButtonCaption:"Show/Hide",modalDialogButtonApplyText:"Apply",modalDialogButtonCancelText:"Cancel",fixedVirualizationNotSupported:"Group By requires another virtualization setting. The virtualizationMode should be set to 'continuous'.",summaryRowTitle:"Grouping summary row"}});$.ig.GridHiding=$.ig.GridHiding||{};$.extend($.ig.GridHiding,{locale:{columnChooserDisplayText:"Column Chooser",hiddenColumnIndicatorTooltipText:"Hidden Column(s)",columnHideText:"Hide",columnChooserCaptionLabel:"Column Chooser",columnChooserCloseButtonTooltip:"Close",hideColumnIconTooltip:"Hide",featureChooserNotReferenced:"A reference to Feature Chooser is missing. Include infragistics.ui.grid.featurechooser.js in your project or use one of the combined script files.",columnChooserShowText:"Show",columnChooserHideText:"Hide",columnChooserResetButtonLabel:"Reset",columnChooserButtonApplyText:"Apply",columnChooserButtonCancelText:"Cancel"}});$.ig.GridResizing=$.ig.GridResizing||{};$.extend($.ig.GridResizing,{locale:{noSuchVisibleColumn:"There is no visible column for the specified key. The showColumn() method should be used on the column before trying to resize it.",resizingAndFixedVirtualizationNotSupported:"Resizing columns requires a different virtualization setting. Use rowVirtualization and set the virtualizationMode to 'continuous'."}});$.ig.GridPaging=$.ig.GridPaging||{};$.extend($.ig.GridPaging,{locale:{pageSizeDropDownLabel:"Show ",pageSizeDropDownTrailingLabel:"records",nextPageLabelText:"Next",prevPageLabelText:"Prev",firstPageLabelText:"",lastPageLabelText:"",currentPageDropDownLeadingLabel:"Pg",currentPageDropDownTrailingLabel:"of ${count}",currentPageDropDownTooltip:"Choose page index",pageSizeDropDownTooltip:"Choose number of records per page",pagerRecordsLabelTooltip:"Current records range",prevPageTooltip:"Previous page",nextPageTooltip:"Next page",firstPageTooltip:"First page",lastPageTooltip:"Last page",pageTooltipFormat:"Page ${index}",pagerRecordsLabelTemplate:"${startRecord} - ${endRecord} of ${recordCount} records",invalidPageIndex:"The specified page index is not valid. Provide a page index that is greater than or equal to 0 and less than the total number of pages."}});$.ig.GridSelection=$.ig.GridSelection||{};$.extend($.ig.GridSelection,{locale:{persistenceImpossible:"Persisting selection requires a different configuration. The primary key option of the grid should be configured."}});$.ig.GridRowSelectors=$.ig.GridRowSelectors||{};$.extend($.ig.GridRowSelectors,{locale:{selectionNotLoaded:"igGridSelection has not been initialized. Selection should be enabled for the grid.",columnVirtualizationEnabled:"Row Selectors require a different virtualization setting. Use rowVirtualization and set the virtualizationMode to 'continuous'.",selectedRecordsText:"You have selected ${checked} records.",deselectedRecordsText:"You have deselected ${unchecked} records.",selectAllText:"Select all ${totalRecordsCount} records",deselectAllText:"Deselect all ${totalRecordsCount} records",requireSelectionWithCheckboxes:"Selection is required when there are checkboxes enabled"}});$.ig.GridSorting=$.ig.GridSorting||{};$.extend($.ig.GridSorting,{locale:{sortedColumnTooltipFormat:"Sorted ${direction}",unsortedColumnTooltip:"Sort column",ascending:"ascending",descending:"descending",modalDialogSortByButtonText:"Sort by",modalDialogResetButton:"Reset",modalDialogCaptionButtonDesc:"Click to sort descending",modalDialogCaptionButtonAsc:"Click to sort ascending",modalDialogCaptionButtonUnsort:"Click to remove sorting",featureChooserText:"Sort on Multiple",modalDialogCaptionText:"Sort on Multiple",modalDialogButtonApplyText:"Apply",modalDialogButtonCancelText:"Cancel",sortingHiddenColumnNotSupport:"The specified column could not be sorted because it is hidden. Use the showColumn() method on it before trying to sort it.",featureChooserSortAsc:"Sort ascending",featureChooserSortDesc:"Sort descending"}});$.ig.GridSummaries=$.ig.GridSummaries||{};$.extend($.ig.GridSummaries,{locale:{featureChooserText:"Hide Summaries",featureChooserTextHide:"Show Summaries",dialogButtonOKText:"OK",dialogButtonCancelText:"Cancel",emptyCellText:"",summariesHeaderButtonTooltip:"Show/Hide summaries",defaultSummaryRowDisplayLabelCount:"Count",defaultSummaryRowDisplayLabelMin:"Min",defaultSummaryRowDisplayLabelMax:"Max",defaultSummaryRowDisplayLabelSum:"Sum",defaultSummaryRowDisplayLabelAvg:"Avg",defaultSummaryRowDisplayLabelCustom:"Custom",calculateSummaryColumnKeyNotSpecified:"Column key is missing. A column key should be specified to calculate summaries.",featureChooserNotReferenced:"A reference to Feature Chooser is missing. Include infragistics.ui.grid.featurechooser.js in your project or use one of the combined script files."}});$.ig.GridUpdating=$.ig.GridUpdating||{};$.extend($.ig.GridUpdating,{locale:{doneLabel:"Done",doneTooltip:"Stop editing and update",cancelLabel:"Cancel",cancelTooltip:"Stop editing without updating",addRowLabel:"Add new row",addRowTooltip:"Start adding a new row",deleteRowLabel:"Delete row",deleteRowTooltip:"Delete row",igTextEditorException:"It is currently not possible to update string columns in the grid. ui.igTextEditor should be loaded first.",igNumericEditorException:"It is currently not possible to update numeric columns in the grid. ui.igNumericEditor should be loaded first.",igCheckboxEditorException:"It is currently not possible to update checkbox columns in the grid. ui.igCheckboxEditor should be loaded first.",igCurrencyEditorException:"It is currently not possible to update numeric columns with currency format in the grid. ui.igCurrencyEditor should be loaded first.",igPercentEditorException:"It is currently not possible to update numeric columns with percent format in the grid. ui.igPercentEditor should be loaded first.",igDateEditorException:"It is currently not possible to update date columns in the grid. ui.igDateEditor should be loaded first.",igDatePickerException:"It is currently not possible to update date columns in the grid. ui.igDatePicker should be loaded first.",igComboException:"It is currently not possible to use a combo in the grid. ui.igCombo should be loaded first.",igRatingException:"It is currently not possible to use igRating as an editor in the grid. ui.igRating should be loaded first.",igValidatorException:"It is currently not possible to support validation with the options defined in igGridUpdating. ui.igValidator should be loaded first.",editorTypeCannotBeDetermined:"Updating did not have enough information to properly determine the type of editor to use for column: ",noPrimaryKeyException:"In order to support update operations after a row was deleted, application should define primaryKey in options of igGrid.",hiddenColumnValidationException:"Cannot edit row which has a hidden column with enabled validation.",dataDirtyException:"Grid has pending transactions which may affect rendering of data. To prevent exception, application may enable autoCommit option of igGrid, or it should process dataDirty event of igGridUpdating and return false. While processing that event, application also may do commit() data in igGrid.",recordOrPropertyNotFoundException:"The specified record or property was not found. Verify the criteria for your search and adjust them if necessary.",rowEditDialogCaptionLabel:"Edit row data",excelNavigationNotSupportedWithCurrentEditMode:"Excel Navigation requires a different configuration. editMode should be set to 'cell' or 'row'",columnNotFound:"The specified column key was not found in the visible columns' collection or the specified index was out of range.",rowOrColumnSpecifiedOutOfView:"Editing the specified row or column is currently not possible. It should be in view on the current page and virtualization frame.",editingInProgress:"A row or cell is currently being edited. Another updating procedure cannot start before the current editing is finished.",undefinedCellValue:"Undefined cannot be set as a cell value.",addChildTooltip:"Add a child row",multiRowGridNotSupportedWithCurrentEditMode:"When the grid has multi-row-layout enabled only dialog edit mode is supported."}});$.ig.ColumnMoving=$.ig.ColumnMoving||{};$.extend($.ig.ColumnMoving,{locale:{movingDialogButtonApplyText:"Apply",movingDialogButtonCancelText:"Cancel",movingDialogCaptionButtonDesc:"Move down",movingDialogCaptionButtonAsc:"Move up",movingDialogCaptionText:"Move Columns",movingDialogDisplayText:"Move Columns",movingDialogDropTooltipText:"Move here",movingDialogCloseButtonTitle:"Close moving dialog",dropDownMoveLeftText:"Move left",dropDownMoveRightText:"Move right",dropDownMoveFirstText:"Move first",dropDownMoveLastText:"Move last",featureChooserNotReferenced:"A reference to Feature Chooser is missing. Include infragistics.ui.grid.featurechooser.js in your project or use one of the combined script files.",movingToolTipMove:"Move",featureChooserSubmenuText:"Move To"}});$.ig.ColumnFixing=$.ig.ColumnFixing||{};$.extend($.ig.ColumnFixing,{locale:{headerFixButtonText:"Fix this column",headerUnfixButtonText:"Unfix this column",featureChooserTextFixedColumn:"Fix column",featureChooserTextUnfixedColumn:"Unfix column",groupByNotSupported:"Column Fixing requires a different configuration. The Group By functionality should be disabled.",virtualizationNotSupported:"Column Fixing requires a different virtualization setting. rowVirtualization should be used instead.",columnVirtualizationNotSupported:"Column Fixing requires a different virtualization setting. columnVirtualization should be disabled.",columnMovingNotSupported:"Column Fixing requires a different configuration. Column Moving should be disabled.",hidingNotSupported:"Column Fixing requires a different configuration. The Hiding functionality should be disabled.",hierarchicalGridNotSupported:"igHierarchicalGrid does not support Column Fixing. Column Fixing should be disabled.",responsiveNotSupported:"Column Fixing requires a different configuration. The Responsive functionality should be disabled.",noGridWidthNotSupported:"Column Fixing requires a different configuration. The grid width should be set either as percentages or as number in pixels.",gridHeightInPercentageNotSupported:"Column Fixing requires a different configuration. The grid height should be set in pixels.",defaultColumnWidthInPercentageNotSupported:"Column Fixing requires a different configuration. The default column width should be set as a number in pixels.",columnsWidthShouldBeSetInPixels:"Column Fixing requires a different column width setting. The width of column with key {key} should be set in pixels.",unboundColumnsNotSupported:"Column Fixing requires a different configuration. Unbound Columns should be disabled.",excelNavigationNotSupportedWithCurrentEditMode:"Excel Navigation requires a different configuration. editMode should be set to 'cell' or 'row'.",initialFixingNotApplied:"Initial fixing could not be applied for column with key: {0}. Reason: {1}",setOptionGridWidthException:"Incorrect value for option grid width. When there are fixed columns width of the visible area of unfixed column(s) should be greater that or equal to value of minimalVisibleAreaWidth.",internalErrors:{none:"Your grid configuration is successful!",notValidIdentifier:"The specified column key is not valid. Provide a column key that matches the key of one of the defined grid columns.",fixingRefused:"Fixing this column is not currently supported. Unfix another visible column or use the showColumn() method on any hidden unfixed column first.",fixingRefusedMinVisibleAreaWidth:"This column cannot be fixed. Its width exceeds the available space for fixing a column in the grid.",alreadyHidden:"Fixing/Unfixing this column is currently not possible. The showColumn() method should be used on the column first.",alreadyUnfixed:"This column is already unfixed.",alreadyFixed:"This column is already fixed.",unfixingRefused:"Unfixing this column is currently not possible. The showColumn() method should be used on any hidden fixed column first.",targetNotFound:"Target column with key {key} could not be found. Verify the key used for the search and adjust it if necessary."}}});$.ig.GridAppendRowsOnDemand=$.ig.GridAppendRowsOnDemand||{};$.extend($.ig.GridAppendRowsOnDemand,{locale:{loadMoreDataButtonText:"Load more data",appendRowsOnDemandRequiresHeight:"Append Rows On Demand requires a different configuration. The grid height should be set.",groupByNotSupported:"Append Rows On Demand requires a different configuration. Group By should be disabled.",pagingNotSupported:"Append Rows On Demand requires a different configuration. Paging should be disabled.",cellMergingNotSupported:"Append Rows On Demand requires a different configuration. Cell Merging should be disabled.",virtualizationNotSupported:"Append Rows On Demand requires a different configuration. Virtualization should be disabled."}});$.ig.igGridResponsive=$.ig.igGridResponsive||{};$.extend($.ig.igGridResponsive,{locale:{fixedVirualizationNotSupported:'The Responsive functionality requires a different virtualization setting. virtualizationMode should be set to "continuous".'}});$.ig.igGridMultiColumnHeaders=$.ig.igGridMultiColumnHeaders||{};$.extend($.ig.igGridMultiColumnHeaders,{locale:{multiColumnHeadersNotSupportedWithColumnVirtualization:"Multi-column headers require a different configuration. columnVirtualization should be disabled."}})}})(jQuery);/*!@license
* Infragistics.Web.ClientUI Grid 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on: 
*	jquery-1.4.4.js
*	jquery.ui.core.js
*	jquery.ui.widget.js
*	infragistics.dataSource.js
*	infragistics.ui.shared.js
*	infragistics.templating.js
*	infragistics.util.js
*/
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){var _hovTR,_aNull=function(val){return val===null||val===undefined};$.widget("ui.igGrid",{css:{baseClass:"ui-widget ui-helper-clearfix ui-corner-all",baseContentClass:"ui-widget-content",gridClasses:"ui-iggrid",recordClass:"ui-ig-record ui-iggrid-record",recordAltClass:"ui-ig-altrecord ui-iggrid-altrecord",headerClass:"ui-iggrid-header ui-widget-header",headerTextClass:"ui-iggrid-headertext",headerCellFeatureEnabledClass:"ui-iggrid-headercell-featureenabled",baseHeaderClass:"ui-widget-header",gridTableClass:"ui-iggrid-table ui-widget-content",mrlGridTableClass:"ui-iggrid-table-mrl ui-widget-content",gridHeaderTableClass:"ui-iggrid-headertable",mrlGridHeaderTableClass:"ui-iggrid-headertable-mrl",gridFooterTableClass:"ui-iggrid-footertable ui-widget-footer",gridFooterClass:"",gridCaptionTableClass:"ui-iggrid-captiontable",gridHeaderCaptionClass:"ui-iggrid-headercaption ui-widget-header ui-corner-top",gridTableBodyClass:"ui-iggrid-tablebody",gridScrollDivClass:"ui-iggrid-scrolldiv ui-widget-content",gridVirtualScrollDivClass:"ui-iggrid-virtualscrolldiv",gridFooterCaptionClass:"ui-iggrid-footercaption",deletedRecord:"ui-iggrid-deletedrecord",modifiedRecord:"ui-iggrid-modifiedrecord",rtl:"ui-iggrid-rtl"},options:{width:null,height:null,autoAdjustHeight:true,avgRowHeight:25,avgColumnWidth:null,defaultColumnWidth:null,autoGenerateColumns:true,virtualization:false,virtualizationMode:"fixed",requiresDataBinding:true,rowVirtualization:false,columnVirtualization:false,virtualizationMouseWheelStep:null,adjustVirtualHeights:false,rowTemplate:null,jQueryTemplating:false,templatingEngine:"infragistics",columns:[{headerText:null,key:null,formatter:null,format:null,dataType:"string",width:null,hidden:false,template:null,unbound:false,group:[],formula:null,unboundValues:null,unboundValuesUpdateMode:"auto",headerCssClass:null,columnCssClass:null,mapper:null,rowIndex:null,columnIndex:null,colSpan:1,rowSpan:1}],dataSource:null,dataSourceUrl:null,dataSourceType:null,responseDataKey:null,responseTotalRecCountKey:null,requestType:"GET",responseContentType:"application/json; charset=utf-8",showHeader:true,showFooter:true,fixedHeaders:true,fixedFooters:true,caption:null,features:[{name:null}],tabIndex:0,accessibilityRendering:false,localSchemaTransform:true,primaryKey:null,serializeTransactionLog:true,autoCommit:false,aggregateTransactions:false,autoFormat:"date",renderCheckboxes:false,updateUrl:null,restSettings:{create:{url:null,template:null,batch:false},update:{url:null,template:null,batch:false},remove:{url:null,template:null,batch:false},encodeRemoveInRequestUri:true,contentSerializer:null,contentType:"application/json; charset=utf-8"},alternateRowStyles:true,autofitLastColumn:true,enableHoverStyles:true,enableUTCDates:false,mergeUnboundColumns:false,jsonpRequest:false,enableResizeContainerCheck:true,featureChooserIconDisplay:"desktopOnly"},events:{cellClick:"cellClick",cellRightClick:"cellRightClick",dataBinding:"dataBinding",dataBound:"dataBound",rendering:"rendering",rendered:"rendered",dataRendering:"dataRendering",dataRendered:"dataRendered",headerRendering:"headerRendering",headerRendered:"headerRendered",footerRendering:"footerRendering",footerRendered:"footerRendered",headerCellRendered:"headerCellRendered",rowsRendering:"rowsRendering",rowsRendered:"rowsRendered",schemaGenerated:"schemaGenerated",columnsCollectionModified:"columnsCollectionModified",requestError:"requestError",created:"igcontrolcreated",destroyed:"igcontroldestroyed"},resizeTimeout:300,maxScrollContainerHeight:10737418,cloneChildElements:false,widget:function(){return this.element},_persistVirtualScrollTop:false,_createWidget:function(options){var cols;this.options.columns=null;this.options.features=null;if(options){if(options.dataSource&&($.type(options.dataSource)==="array"||$.type(options.dataSource)==="object")){this.tmpDataSource=options.dataSource;options.dataSource=null;this._originalOptions=options}if(options.autoGenerateColumns===undefined){cols=options.columns;if($.type(cols)==="array"&&cols.length){options.autoGenerateColumns=false}}}$.Widget.prototype._createWidget.apply(this,arguments)},_execSetOptionCallbacks:function(key,value){var callbacks=this._setOptionCallbacks||[],i,len=callbacks.length;for(i=0;i<len;i++){callbacks[i].func(key,value)}},_setOption:function(key,value){var header,isScrolling,hasWidthInPercent=this._gridHasWidthInPercent(),caption,width,id,tmp,hasFixedCols,cols,$col;if(value===this.options[key]){return}isScrolling=this.options.height!==null||this.options.width!==null;$.Widget.prototype._setOption.apply(this,arguments);if(key==="virtualization"||key==="autoGenerateColumns"||key==="rowVirtualization"||key==="columnVirtualization"||key==="fixedHeaders"||key==="scrollbars"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}this._execSetOptionCallbacks(key,value);if(key==="width"){if(isScrolling===true){width=value;hasFixedCols=this.hasFixedColumns();if(hasFixedCols){width=parseInt(value,10)-this.fixedBodyContainer().outerWidth()}this.container().css("width",value);this.element.css("width",width);if(this.options.fixedHeaders){this.headersTable().css("width",width)}if(!this._allColumnWidthsInPercentage||!hasWidthInPercent){if(this.options.virtualization===true||this.options.columnVirtualization===true||this.options.rowVirtualization===true){width=hasFixedCols?width:parseInt(value,10);id=this.id();this.container().find("#"+id+"_headers_v").css("max-width","").css("width",width);this.element.css("width",width-this._scrollbarWidth());this._vdisplaycontainer().css("max-width","").css("width",width-this._scrollbarWidth());this._virtualcontainer().css("width",value);cols=this._virtualcontainer().find("> colgroup > col");$col=hasFixedCols&&this.fixingDirection()==="left"?cols.eq(1):cols.first();$col.attr("width",width-this._scrollbarWidth());this.container().find("#"+id+"_footer_container").css("max-width","").css("width",width);this.container().find("#"+id+"_footers").css("max-width","").css("width",width);this._vhorizontalcontainer().css("width",width);this._gridInnerWidth=this._vdisplaycontainer().width()+this._scrollbarWidth()}else{this._gridInnerWidth=this.scrollContainer().width()}}if(this.options.width!==null||this.options.height!==null){this._updateGridContentWidth()}}else{throw new Error($.ig.Grid.locale.optionChangeNotScrollingGrid.replace("{optionName}",key))}}else if(key==="height"){if(isScrolling===true){this.scrollContainer().css("overflow-y","auto");if(this.options.autoAdjustHeight){this.container().css("height",value);this._virtualHeightReset=true;this._initializeHeights()}else{this.scrollContainer().css("height",value)}if(this.options.virtualization||this.options.rowVirtualization||this.options.columnVirtualization){if(this.options.virtualizationMode==="fixed"){this._buildVirtualDom();this.virtualScrollTo(this._startRowIndex)}else{tmp=this._persistVirtualScrollTop;this._persistVirtualScrollTop=true;this._saveFirstVisibleTRIndex();this._renderVirtualRecords();this._persistVirtualScrollTop=tmp}}this._fireInternalEvent("_heightChanged")}else{throw new Error($.ig.Grid.locale.optionChangeNotScrollingGrid.replace("{optionName}",key))}}else if(key==="dataSource"){this.options.dataSource=value;this.dataBind();if(this._inferOpType()!=="remote"){this.autoSizeColumns()}}else if(key==="showHeader"){header=this.headersTable();if(header.length>0&&header.is("table")&&header.find("tbody").length===0){if(value===true){header.show()}else{header.hide()}}else{header=this.element.find("thead tr");if(value===true){header.show()}else{header.hide()}}}else if(key==="caption"){caption=this._caption();if(caption.length===0){this._renderCaption();if(this.options.autoAdjustHeight){this._initializeHeights()}}else{caption.text(value)}}else if(key==="alternateRowStyles"){this._renderData()}},_initialized:false,_headersInitialized:false,_footerInitialized:false,_mouseClickEventHandler:function(event,eventToTrigger){var $et=$(event.target),row=$et.closest("tr"),key=row.attr("data-id"),describedBy,colKey,$td,res,currGrid,colIndex=$et.closest("td").index(),rowIndex=row.index(),grid=this;if(grid.element.closest(".ui-iggrid-root").data("igGrid")){currGrid=$et.closest(this._isMultiRowGrid()?".ui-iggrid-table-mrl":".ui-iggrid-table").data("igGrid");if(currGrid&&grid.id()!==currGrid.id()){return}}if(key===""||key===null||key===undefined){key=rowIndex}$td=$(event.target);if(!$td.is("td")){$td=$(event.target).closest("td")}describedBy=$td.attr("aria-describedBy");if(describedBy){colKey=describedBy.slice(describedBy.indexOf(this.id()+"_")+this.id().length+1)}else{return}if(this._isMultiRowGrid()){colIndex=this.columnByKey(colKey).columnIndex}if(grid.hasFixedColumns()){if($td.length===1){res=grid.getColumnByTD($td);if(res!==null){colKey=res.column.key;colIndex=res.index}}}if(!$et.closest("tr").parent().is("thead")&&($et.is("td")||$et.closest("td").length===1&&$et.closest("td").parent().attr("data-container")!=="true")){key=grid._fixPKValue(key);if(grid.hasFixedColumns()){row=grid._isFixedElement(row)?row.add(this.rowAt(rowIndex)):row.add(this.fixedRowAt(rowIndex))}grid._trigger(eventToTrigger,event,{rowIndex:rowIndex,rowKey:key,row:row,colIndex:colIndex,colKey:colKey,cellElement:$td[0],owner:grid})}},_create:function(){var grid=this,i,container,attr;this._mouseClickEventHandlers={click:function(event){grid._mouseClickEventHandler(event,grid.events.cellClick)},contextmenu:function(event){grid._mouseClickEventHandler(event,grid.events.cellRightClick)}};this._isHierarchicalGrid=false;this._hasUnboundColumns=false;if(this.options._isHierarchicalGrid===true){this._isHierarchicalGrid=true}if(this.cloneChildElements&&this.element.is("table")&&this.element.children().length>0){this._initialChildren=this.element.children().clone(true)}this._initialAttributes=[];attr=this.element[0].attributes;for(i=0;i<attr.length;i++){if(attr[i].name!=="id"){this._initialAttributes.push({name:attr[i].name,value:attr[i].value})}}this._rtl=this.element[0].style.direction==="rtl";this._padding=this._rtl?"padding-left":"padding-right";if(this.tmpDataSource!==null&&this.tmpDataSource!==undefined){this.options.dataSource=this.tmpDataSource;this._originalOptions.dataSource=this.tmpDataSource}this._testInnerHtml();this._setOptionCallbacks=[];this._headerInitCallbacks=[];this._footerInitCallbacks=[];this._cellStyleSubscribers=[];this._firstBind=true;this._isMultiColumnGrid=false;this._unboundValues={};if(!this.options.columns){this.options.columns=[]}if(!this.options.features){this.options.features=[]}if(this._isMultiColumnHeader()===true){this._isMultiColumnGrid=true;this._generateColumnFlatStructure(this.options.columns);this._headerCells=[]}if(this.options.rowVirtualization===true&&this.options.virtualizationMode==="continuous"){this.options.virtualization=true}if(this.options.columnVirtualization===true){this.options.virtualization=true;if(this.options.virtualizationMode==="continuous"){throw new Error($.ig.Grid.locale.colVirtualizationDenied)}this.options.virtualizationMode="fixed"}if(this.options.virtualization===true||this.options.columnVirtualization===true||this.options.rowVirtualization===true){if(this.options.virtualizationMode===undefined||this.options.virtualizationMode===""){this.options.virtualizationMode="fixed"}if(this.options.virtualizationMode==="fixed"){this.options.fixedHeaders=true;this.options.fixedFooters=true}}if(this.options.virtualization===true||this.options.rowVirtualization===true){if(this.options.defaultColumnWidth==="*"){throw new Error($.ig.Grid.locale.virtualizationNotSupportedWithAutoSizeCols)}for(i=0;i<this.options.columns.length;i++){if(this.options.columns[i].width==="*"){throw new Error($.ig.Grid.locale.virtualizationNotSupportedWithAutoSizeCols)}}}if(this.options.virtualization===true&&this.options.virtualizationMode==="continuous"){this.options.fixedHeaders=true}if((this.options.height===null||parseInt(this.options.height,10)<=0)&&this.options.fixedHeaders===true){this.options.fixedHeaders=false}if((this.options.height===null||parseInt(this.options.height,10)<=0)&&this.options.fixedFooters===true){this.options.fixedFooters=false}this._analyzeMultiRowLayout();this.dataBind(true);this.element.bind(this._mouseClickEventHandlers);if(this.options.enableResizeContainerCheck&&(this.options.height!==null&&this.options.height.indexOf&&this.options.height.indexOf("%")!==-1||this.options.width!==null&&this.options.width.indexOf&&this.options.width.indexOf("%")!==-1||!this.element.is(":visible"))){if(!this.element.is(":visible")){this._recheckVisibility=true}if($.ig.util.isIE){container=this.container();if(container.length>0&&container[0].attachEvent){this._resizeContainerHandler=$.proxy(this.resizeContainer,this);container[0].attachEvent("onresize",this._resizeContainerHandler)}}if(!this._resizeContainerHandler){this._resId=setInterval($.proxy(this.resizeContainer,this),this.resizeTimeout)}}for(i=0;i<this.options.columns.length;i++){if(this.options.columns[i].hidden===undefined){this.options.columns[i].hidden=false}}this._uiSoftDirtyHandler=$.proxy(this._onFeaturesSoftDirty,this);this.element.bind("iggriduisoftdirty",this._uiSoftDirtyHandler);this._oldScrollTop=0;this.element.trigger(this.events.created,{owner:this});if(this._rtl){this.container().addClass(this.css.rtl)}},_fixPKValue:function(val){var col,data,pk=this.options.primaryKey;if(_aNull(val)){return null}if(pk){col=this.columnByKey(pk);if(col&&col.dataType){if(col.dataType==="number"||col.dataType==="numeric"){val=parseInt(val,10)}}else{data=this.dataSource._data;if(data&&data.length>0){if(typeof data[0][pk]==="number"){val=parseInt(val,10)}}}}else{data=this.dataSource._data;if(data&&data.length>0){if(typeof data[0].ig_pk==="number"){val=parseInt(val,10)}}}return val},hasFixedDataSkippedColumns:function(){return!!this._hasFixedDataSkippedColumns},hasFixedColumns:function(){return this._hasFixedColumns},fixingDirection:function(){return this._fixingDirection},isFixedColumn:function(colKey){var isFixed=false,typeColKey=$.type(colKey),cols;if(!this.hasFixedColumns()){return false}if(typeColKey==="string"){$.each(this._fixedColumns,function(ind,c){if(c.key===colKey){isFixed=true;return false}})}else if(typeColKey==="number"){cols=this._visibleColumns();if(colKey<0||colKey>=cols.length){return false}isFixed=cols[colKey].fixed===true}return isFixed},_onFixedColumnsChanged:function(obj){this._fireInternalEvent("_fixedColumnsChanged",obj)},_onGroupedColumnsChanging:function(groupedColumns){this._fireInternalEvent("_groupedColumnsChanging",{groupedColumns:groupedColumns})},_onGroupedColumnsChanged:function(groupedColumns){this._fireInternalEvent("_groupedColumnsChanged",{groupedColumns:groupedColumns})},_testInnerHtml:function(){var t=document.createElement("table");try{t.innerHTML="<tr><td> t </td></tr>";this._canreplaceinner=true}catch(e){this._canreplaceinner=false}},resizeContainer:function(){var scrollContainerWidth,o=this.options,visibilityChanged=false,v=o.virtualization===true||o.rowVirtualization===true||o.columnVirtualization===true;if(this._recheckVisibility&&this.element.is(":visible")){this._prevContainerHeight=0;visibilityChanged=true;this._recheckVisibility=false;if(this._resId&&!(this.options.height!==null&&this.options.height.indexOf&&this.options.height.indexOf("%")!==-1||this.options.width!==null&&this.options.width.indexOf&&this.options.width.indexOf("%")!==-1)){clearInterval(this._resId)}}if(o.autoAdjustHeight&&this.container().height()!==this._prevContainerHeight){this._initializeHeights();if(v&&visibilityChanged){this._avgRowHeight=null;if(!this.container().find("#"+this.id()+" > tbody > tr:not([data-container]):visible:first").length){delete this._virtualDom;this._renderVirtualRecords()}this._updateVirtualScrollContainer();this._onVirtualVerticalScroll()}}if(o.width!==null&&o.height!==null){if(v===false){scrollContainerWidth=this.scrollContainer().width()}else{scrollContainerWidth=this._vdisplaycontainer().width()+this._scrollbarWidth()}if(this._gridInnerWidth!==scrollContainerWidth&&(this._gridInnerWidth>0||scrollContainerWidth>0)){this._gridInnerWidth=scrollContainerWidth;this._updateHScrollbarVisibility()}if(v===false&&this.scrollContainer().get(0).scrollHeight>this.scrollContainer().get(0).clientHeight!==this._hasVerticalScrollbar){this._adjustLastColumnWidth()}}},_isMultiColumnHeader:function(){var cols=this.options.columns,i;for(i=0;i<cols.length;i++){if(cols[i].group!==undefined&&cols[i].group!==null){return true}}return false},isGroupHeader:function(colKey){if(this._isMultiColumnGrid&&!this.columnByKey(colKey)){return true}return false},_analyzeColumnByKey:function(key){if(_aNull(key)){return null}var res,isGroupHeader=this.isGroupHeader(key),children=isGroupHeader?this._getMultiHeaderColumnById(key).children:[this.columnByKey(key)],colInfo=this._getColumnInfo(children[0].key,this.options.columns),colMCHInfo=this._isMultiColumnGrid?this._getColumnInfo(key):null;res={key:key,vIndex:this.getVisibleIndexByKey(children[0].key,true),vIndexNonDataCols:this.getVisibleIndexByKey(children[0].key,false),dIndex:colInfo.index,children:children,colObj:colInfo.column};if(colMCHInfo){res=$.extend(res,{dMCHIndex:colMCHInfo.index,colMCHObj:colMCHInfo.column,isGroupHeader:isGroupHeader})}return res},_analyzeColumnMovingObjects:function(colKey,targetKey,after,isToFix){var isMCH=this._isMultiColumnGrid,i,fCols,cols=this.options.columns,at={dIndex:-1,dMCHIndex:-1,vIndex:-1},fdLeft=this.fixingDirection()==="left",target=this._analyzeColumnByKey(targetKey),resObj={from:this._analyzeColumnByKey(colKey),at:at,target:target};if(target){at.dIndex=after?target.dIndex+target.children.length:target.dIndex;at.vIndex=after?target.vIndex+target.children.length:target.dIndex;if(isMCH){at.dMCHIndex=after?target.dMCHIndex+1:target.dMCHIndex}}else{fCols=this._fixedColumns||[];if(isToFix){at.dIndex=fdLeft?fCols.length:cols.length;at.vIndex=this.getVisibleIndexByKey(cols[at.dIndex],true);if(isMCH){for(i=0;i<this._oldCols.length;i++){at.dMCHIndex=i;if(!this._oldCols[i].fixed&&fdLeft||this._oldCols[i].fixed&&!fdLeft){at.dMCHIndex=i;break}}at.dMCHIndex=fdLeft?at.dMCHIndex:at.dMCHIndex+1}}else{at.dIndex=fdLeft?fCols.length-resObj.from.children.length-1:0;at.vIndex=this.getVisibleIndexByKey(cols[at.dIndex],true);if(isMCH){for(i=0;i<this._oldCols.length;i++){if(!this._oldCols[i].fixed&&fdLeft||this._oldCols[i].fixed&&!fdLeft){at.dMCHIndex=i-1;break}}}}}return resObj},_analyzeMultiColumnHeaders:function(cols,newCols,level,oldCols,children,isHidden){var i,j,res,colsLength=cols.length,colspan=0,ind=[],groupChildren=[],identifier,hidden;for(i=0;i<colsLength;i++){if(cols[i].group!==undefined&&cols[i].group!==null){if(cols[i].key!==undefined&&cols[i].key!==null){identifier=cols[i].key.toString()}else{identifier=(this._multiColumnIdentifier++).toString()}if(!cols[i].identifier){cols[i].identifier=identifier}groupChildren=[];hidden=false;if(isHidden===true||cols[i].hidden===true){hidden=true}res=this._analyzeMultiColumnHeaders(cols[i].group,newCols,level+1,oldCols[i].group,groupChildren,hidden);oldCols[i].colspan=res.colspan;oldCols[i].children=groupChildren;for(j=0;j<groupChildren.length;j++){children.push(groupChildren[j])}ind.push(i);colspan+=res.colspan}else{colspan++;oldCols[i].level=0;oldCols[i].level0=true;if(isHidden===true){cols[i].hidden=true}children.push(cols[i]);newCols.push(cols[i])}}for(j=0;j<ind.length;j++){oldCols[ind[j]].level=this._maxLevel-level}return{colspan:colspan}},_analyzeMultiRowLayout:function(){var i,j,cols=this.options.columns,ri,ci,col,t,res,hasWidths=false;if(!cols.length){return}for(i=0;i<cols.length;i++){ri=cols[i].rowIndex;ci=cols[i].columnIndex;if(ci===null||ri===null||isNaN(ri-0)||isNaN(ci-0)){return}}this._rlm=[];for(i=0;i<cols.length;i++){this._addColumnToLayout(cols[i]);if(cols[i].width){hasWidths=true}}this._mrl=$.extend(true,[],this._rlm);t=this._mrl;for(i=0;i<t.length;i++){for(j=0;j<t[i].length;j++){if(!t[i][j]){throw new Error($.ig.Grid.locale.multiRowLayoutNotComplete)}}}if(hasWidths){this._analyzeMCLWidths()}this._rlp=[];for(i=0;i<t.length;i++){this._rlp.push([]);for(j=0;j<t[i].length;j++){if(t[i][j]&&$.type(t[i][j])==="string"){col=this.columnByKey(t[i][j]);res=this._getSizeOfMultiSpanCol(i,j,t);this._rlp[i].push({col:col,rs:res.rs,cs:res.cs})}}}this._maxCols=this._rlm[0].length},_analyzeMCLWidths:function(){var t=this._rlm,i,j,col,colKey,minColSpan,colSpan,isPercentage=false;this._colGroupWidths=[];isPercentage=this._checkForPercentageWidths();for(i=0;i<t.length;i++){for(j=0;j<t[i].length;j++){colKey=t[i][j];col=this.columnByKey(colKey);if(col.width===undefined){col.width=this._resolveWidth(col)}colSpan=col.colSpan?col.colSpan:1;if(colSpan===1){this._colGroupWidths[col.columnIndex]=col.width}}}if(isPercentage){$(this.options.columns).each(function(){if(this.width&&(typeof this.width!=="string"||!this.width.contains("%"))){this.width=parseInt(this.width)+"%"}})}for(j=0;j<t[0].length;j++){if(!this._colGroupWidths[j]){for(i=0;i<t.length;i++){col=this.columnByKey(t[i][j]);if(col.width&&(minColSpan===undefined||minColSpan<col.colSpan)){this._colGroupWidths[j]=parseInt(col.width)/col.colSpan}}}if(isPercentage&&this._colGroupWidths[j]&&(typeof this._colGroupWidths[j]!=="string"||!this._colGroupWidths[j].contains("%"))){this._colGroupWidths[j]=parseInt(this._colGroupWidths[j])+"%"}}},_checkForPercentageWidths:function(){var isPercentage=false,isPixels=false;$(this.options.columns).each(function(){if(this.width){if(typeof this.width==="string"&&this.width.contains("%")){isPercentage=true}else if(this.width&&typeof this.width==="number"||this.width.contains("px")){isPixels=true}}});if(isPixels&&isPercentage){throw new Error($.ig.Grid.locale.multiRowLayoutMixedWidths)}return isPercentage},_resolveWidthMultiCol:function(col,resolveCol){var subCol,subColsWidths=[],currCol,t=this._rlm,sum,cInd,rInd,ind,nullWidths,currSum,nullInd;for(cInd=0;cInd<col.colSpan;cInd++){for(rInd=0;rInd<t.length;rInd++){if(rInd===col.rowIndex){continue}currCol=this.columnByKey(t[rInd][col.columnIndex+cInd]);if(!currCol.width||resolveCol===currCol.key){continue}if(this._colGroupWidths[col.columnIndex+cInd]){subColsWidths[cInd]=this._colGroupWidths[col.columnIndex+cInd]}else{if(currCol.colSpan===1){subColsWidths[cInd]=parseInt(currCol.width);this._colGroupWidths[col.columnIndex+cInd]=subColsWidths[cInd];break}sum=0;for(ind=currCol.columnIndex;ind<currCol.columnIndex+currCol.colSpan;ind++){if(ind===col.columnIndex+cInd){continue}subCol={key:currCol.key+ind,rowIndex:currCol.rowIndex,columnIndex:ind,colSpan:1};subCol.width=this._resolveWidth(subCol,col.key);if(subCol.width){sum+=parseInt(subCol.width)}else{sum=0;subColsWidths[cInd]=null;break}}if(sum>0){this._colGroupWidths[col.columnIndex+cInd]=parseInt(currCol.width)-sum;subColsWidths[cInd]=this._colGroupWidths[col.columnIndex+cInd]}else{subColsWidths[cInd]=null}}}if(subColsWidths[cInd]===undefined){subColsWidths[cInd]=null}}nullWidths=$(subColsWidths).filter(function(index){return subColsWidths[index]===null||subColsWidths[index]===undefined});if(nullWidths.length===1){currSum=0;$(subColsWidths).each(function(index){if(subColsWidths[index]!==undefined&&subColsWidths[index]!==null){currSum+=parseInt(subColsWidths[index])}else{nullInd=index}});subColsWidths[nullInd]=parseInt(col.width)-currSum;this._colGroupWidths[col.columnIndex+nullInd]=subColsWidths[nullInd]}return subColsWidths},_resolveWidth:function(col,resolveCol){var t=this._rlm,colSpan=col.colSpan===undefined||col.colSpan===null?1:col.colSpan,columnIndex=col.columnIndex,rowIndex=col.rowIndex,rInd=0,cInd=0,currWidth,sum,subPartsCount=0,currCol,relColumn,commonPart,width=null;if(col.width!==undefined){return col.width}if(col.colSpan===1&&this._colGroupWidths[col.columnIndex]){return this._colGroupWidths[col.columnIndex]}for(rInd=0;rInd<t.length;rInd++){if(rInd===rowIndex){continue}currCol=this.columnByKey(t[rInd][columnIndex]);currCol.colSpan=currCol.colSpan===undefined||currCol.colSpan===null?1:currCol.colSpan;if(!currCol.width||resolveCol===currCol.key){continue}commonPart=this._getCommonColIndexes(col,currCol);if(currCol.colSpan===colSpan&&commonPart.length===currCol.colSpan){width=currCol.width;break}else if(commonPart.length<currCol.colSpan&&commonPart.length===colSpan){sum=0;for(cInd=currCol.columnIndex;cInd<currCol.columnIndex+currCol.colSpan;cInd++){if(t[rowIndex][cInd]!==col.key){relColumn=this.columnByKey(t[rowIndex][cInd]);relColumn.colSpan=relColumn.colSpan===undefined||relColumn.colSpan===null?1:relColumn.colSpan;currWidth=relColumn.width;if(!currWidth){if(resolveCol===relColumn.key){return null}currWidth=this._resolveWidth(relColumn,col.key);if(!currWidth){return null}relColumn.width=currWidth}if(relColumn.colSpan){cInd+=relColumn.colSpan-1}commonPart=this._getCommonColIndexes(currCol,relColumn);if(commonPart.length!==relColumn.colSpan&&commonPart.length>0){currWidth=this._calcCommonPartSum(relColumn,commonPart,resolveCol);if(!currWidth){return null}subPartsCount+=this._getCommonColIndexes(col,currCol).length}else{subPartsCount+=this._getCommonColIndexes(col,currCol).length}if(!currWidth){break}sum+=parseInt(currWidth,10)}}if(sum!==0&&subPartsCount===currCol.colSpan-commonPart.length){width=parseInt(currCol.width)-sum;break}}else if(commonPart.length<colSpan&&currCol.colSpan===commonPart.length){sum=0;subPartsCount=0;for(cInd=col.columnIndex;cInd<col.columnIndex+col.colSpan;cInd++){relColumn=this.columnByKey(t[currCol.rowIndex][cInd]);relColumn.colSpan=relColumn.colSpan===undefined||relColumn.colSpan===null?1:relColumn.colSpan;currWidth=relColumn.width;if(!currWidth){currWidth=this._resolveWidth(relColumn,col.key);if(!currWidth){continue}relColumn.width=currWidth}if(relColumn.colSpan){cInd+=relColumn.colSpan-1}commonPart=this._getCommonColIndexes(col,relColumn);if(commonPart.length!==relColumn.colSpan&&commonPart.length>0){if(resolveCol!==currCol.key&&resolveCol!==relColumn.key){currWidth=this._calcCommonPartSum(relColumn,commonPart,resolveCol);if(!currWidth){break}subPartsCount+=commonPart.length}else{break}}else{subPartsCount+=relColumn.colSpan}if(!currWidth){break}sum+=parseInt(currWidth,10)}if(sum!==0&&subPartsCount===colSpan){width=sum;break}}else if(commonPart.length<colSpan&&commonPart.length<currCol.colSpan){subPartsCount=0;sum=this._calcCommonPartSum(currCol,commonPart,resolveCol);if(!sum){return null}subPartsCount+=commonPart.length;for(cInd=col.columnIndex;cInd<col.columnIndex+col.colSpan;cInd++){relColumn=this.columnByKey(t[currCol.rowIndex][cInd]);relColumn.colSpan=relColumn.colSpan===undefined||relColumn.colSpan===null?1:relColumn.colSpan;if(relColumn.key===currCol.key){continue}currWidth=relColumn.width;if(!currWidth){currWidth=this._resolveWidth(relColumn,col.key);if(!currWidth){continue}relColumn.width=currWidth}commonPart=this._getCommonColIndexes(col,relColumn);if(commonPart.length!==relColumn.colSpan&&commonPart.length>0){if(resolveCol!==currCol.key&&resolveCol!==relColumn.key){currWidth=this._calcCommonPartSum(relColumn,commonPart,resolveCol);if(currWidth===null){return null}subPartsCount+=commonPart.length}else{break}}else{subPartsCount+=relColumn.colSpan}if(!currWidth){break}sum+=parseInt(currWidth,10);if(sum!==0&&subPartsCount===colSpan){width=sum;break}}}}return width},_getCommonColIndexes:function(col1,col2){var t=this._rlm,indexes=[],i;if(col1.colSpan===1&&t[col2.rowIndex][col1.columnIndex]===col2.key){indexes[0]=col1.columnIndex;return indexes}for(i=0;i<t[col1.rowIndex].length;i++){if(t[col1.rowIndex][i]===col1.key&&t[col2.rowIndex][i]===col2.key){indexes.push(i)}}return indexes},_calcCommonPartSum:function(relColumn,commonPart,resolveCol){var currSum=0,ind,w,hasNulls=false,widthDistribution=this._resolveWidthMultiCol(relColumn,resolveCol);if(widthDistribution.length!==relColumn.colSpan){return null}for(ind=0;ind<commonPart.length;ind++){w=widthDistribution[commonPart[ind]-relColumn.columnIndex];if(w){currSum+=parseInt(w,10)}else{currSum=0;hasNulls=true;break}}if(hasNulls){currSum=0;for(ind=0;ind<widthDistribution.length;ind++){if(!commonPart.contains(ind+relColumn.columnIndex)){currSum+=widthDistribution[ind]}}if(currSum){currSum=relColumn.width-currSum}}return currSum},_addColumnToLayout:function(col){var t=this._rlm,x,y,colLen,totalWidth,totalHeight,colSpan,rowSpan;colLen=t.length?t[0].length:0;colSpan=col.colSpan?col.colSpan:1;rowSpan=col.rowSpan?col.rowSpan:1;totalWidth=col.columnIndex+colSpan-1;totalHeight=col.rowIndex+rowSpan-1;if(totalHeight>=t.length){x=t.length-1;while(++x<=totalHeight){t.push(Array.apply(null,new Array(colLen)).map(function(){return null}))}}if(totalWidth>=colLen){for(x=0;x<t.length;x++){for(y=colLen;y<=totalWidth;y++){t[x].push(null)}}}for(x=col.rowIndex;x<=totalHeight;x++){for(y=col.columnIndex;y<=totalWidth;y++){if(t[x][y]){throw new Error($.ig.Grid.locale.multiRowLayoutColumnError.replace("{key1}",col.key).replace("{key2}",t[x][y]))}t[x][y]=col.key}}return true},_isMultiRowGrid:function(){return!!this._rlm},_multiRowLayoutRenderingHelper:function(fixed){return this._rlp},getElementInfo:function(elem){var column=null,rowId=null,rowIndex=null,recordIndex=null;if(!(elem instanceof jQuery)){elem=$(elem)}if(elem.is("td")){column=this.getColumnByTD(elem).column;rowIndex=elem.parent("tr").index();recordIndex=parseInt(rowIndex/this._recordVerticalSize(),10);if(this.options.primaryKey){rowId=this.dataSource.getCellValue(this.options.primaryKey,this.dataSource.dataView()[recordIndex])}}else if(elem.is("tr")){rowIndex=elem.index();recordIndex=parseInt(rowIndex/this._recordVerticalSize(),10);if(this.options.primaryKey){rowId=this.dataSource.getCellValue(this.options.primaryKey,this.dataSource.dataView()[recordIndex])}}return{column:column,rowId:rowId,rowIndex:rowIndex,recordIndex:recordIndex}},_recordHorizontalSize:function(){return this._rlm&&this._rlm.length?this._rlm[0].length:this._visibleColumns().length},_recordVerticalSize:function(){return this._rlm?this._rlm.length:1},_getRowsByRecordIndex:function(recIndex){var rows=[],i,tbody=this.element.find("tbody")[0];for(i=0;i<this._recordVerticalSize();i++){rows.push(tbody.rows[recIndex*this._recordVerticalSize()+i])}return $(rows)},_getSizeOfMultiSpanCol:function(x,y,rlm){var w=1,h=1,i=x+1,j=y+1,t=rlm,key=t[x][y];while(j<t[x].length&&t[x][j]===key){t[x][j]=-1;w++;j++}while(i<t.length&&t[i][y]===key){t[i][y]=-1;h++;i++}for(i=x+1;i<x+h;i++){for(j=y+1;j<y+w;j++){t[i][j]=-1}}return{cs:w,rs:h}},_getMultiHeaderColumnById:function(id,level,cols){var i,colsLength,res=null;if(cols===null||cols===undefined){if(this._oldCols===null||this._oldCols===undefined){return null}cols=this._oldCols}colsLength=cols.length;for(i=0;i<colsLength;i++){if(cols[i].identifier===id&&(level===undefined||cols[i].level===level)){return cols[i]}if(cols[i].group!==null&&cols[i].group!==undefined){res=this._getMultiHeaderColumnById(id,level,cols[i].group);if(res!==null){return res}}}return null},_getMaxLevelRecursive:function(level,cols){var i,colsLength=cols.length,ml=level,l,rowspan;for(i=0;i<colsLength;i++){rowspan=1;if(cols[i].rowspan!==null&&cols[i].rowspan!==undefined&&cols[i].rowspan>0){rowspan=cols[i].rowspan}if(cols[i].group!==undefined&&cols[i].group!==null){l=this._getMaxLevelRecursive(level+rowspan,cols[i].group);if(l>ml){ml=l}}else if(rowspan>0){l=level+rowspan-1;if(l>ml){ml=l}}}return ml},_headerInit:function(tr,colgroup,prepend){var i;for(i=0;i<this._headerInitCallbacks.length;i++){this._headerInitCallbacks[i].func(tr,colgroup,prepend)}},_footerInit:function(tr,colgroup,prepend,cssClass){var i;for(i=0;i<this._footerInitCallbacks.length;i++){this._footerInitCallbacks[i].func(tr,colgroup,prepend,cssClass)}},id:function(){return this.element[0].id},_caption:function(){return this.container().find("caption")},_rootContainer:function(){var rootElement;if(!this._rContainer||this._rContainer.length===0){rootElement=this.element.closest(".ui-iggrid-root");this._rContainer=rootElement.length===1?rootElement.data("igGrid").container():this.container()
}return this._rContainer},container:function(){if(!this._container||this._container.length===0){this._container=this.element.closest("div[id="+this.id()+"_container]")}return this._container},headersTable:function(){if(this.options.fixedHeaders===true&&this.options.height!==null){return this.container().find("#"+this.id()+"_headers")}return this.element},footersTable:function(){if(this.options.fixedFooters===true&&this.options.height!==null){return this.container().find("#"+this.id()+"_footers")}return this.element},scrollContainer:function(){return this.container().children("#"+this.id()+"_scroll")},fixedContainer:function(){return this.container().find("#"+this.id()+"_mainFixedContainer")},fixedBodyContainer:function(){return this.container().find("#"+this.id()+"_fixedBodyContainer")},fixedFooterContainer:function(){return this.container().find("#"+this.id()+"_fixedFooterContainer")},fixedHeaderContainer:function(){return this.container().find("#"+this.id()+"_fixedHeaderContainer")},fixedHeadersTable:function(){if(this.options.fixedHeaders===true&&this.options.height!==null){return this.container().find("#"+this.id()+"_headers_fixed")}return this.container().find("#"+this.id()+"_fixed")},fixedFootersTable:function(){if(this.options.fixedFooters===true&&this.options.height!==null){return this.container().find("#"+this.id()+"_footers_fixed")}return this.container().find("#"+this.id()+"_fixed")},_vdisplaycontainer:function(){return this.container().find("#"+this.id()+"_displayContainer")},_virtualcontainer:function(){return this.container().find("#"+this.id()+"_virtualContainer")},_vhorizontalcontainer:function(){return this.container().find("#"+this.id()+"_horizontalScrollContainer")},_fixedfooters:function(){return this.container().find("#"+this.id()+"_footer_container")},cellAt:function(x,y,isFixed){var i,row,colKey,recDataIndex;if(x===undefined||y===undefined){return null}if(this.table===undefined){this.table=this.element[0]}if(this._isMultiRowGrid()){colKey=this._rlm[y%this._recordVerticalSize()][x];recDataIndex=parseInt(y/this._recordVerticalSize(),10);return this._getRowsByRecordIndex(recDataIndex).find("td[aria-describedby ='"+this.id()+"_"+colKey+"']")[0]}i=this._dataRowIndex(y);if(isFixed===true){if(this._fixedTable===undefined){this._fixedTable=this.element}return this._fixedTable[0].rows[i].cells[x]}row=this.table.rows[i];if(!row){return null}return row.cells[x]},cellById:function(rowId,columnKey){var colIndex,i,rows,isFixed=this.isFixedColumn(columnKey);if(_aNull(rowId)||_aNull(columnKey)){return null}if(this.table===undefined){this.table=this.element[0]}if(isFixed){rows=this.fixedBodyContainer().find("tbody").first().children("[data-id='"+rowId+"']")}else{rows=this.element.children("tbody").children("[data-id='"+rowId+"']")}return rows.children("td[aria-describedby = '"+this.id()+"_"+columnKey+"']")},fixedTable:function(){if(this._fixedTable===undefined){this._fixedTable=this.element}return this._fixedTable},_calculateHeaderFooterRows:function(){var theadCount=0,tfootCount=0;theadCount=this.element.children("thead").children("tr").length;if($.ig.util.isOpera){tfootCount=this.element.children("tfoot").children("tr").length}return theadCount+tfootCount},_dataRowIndex:function(i){var extrahr,j;if(this.table===undefined){this.table=this.element[0]}if(this._additionalTrCount===undefined||this._additionalTrCount===null){this._additionalTrCount=this._calculateHeaderFooterRows()}if(this._hc===true){extrahr=this.element.children("tbody").children("tr[data-container]");for(j=0;j<extrahr.length;j++){if($(extrahr[j]).index()<=i){i+=1}}}i=i+this._additionalTrCount;if(i>=this.table.rows.length){i=this.table.rows.length-1}else if(i<0){i=0}return i},immediateChildrenWidgets:function(){return this.element.children("tbody").children("tr").children(".ui-iggrid-childarea").children("div").children("div").map(function(){if($(this).children(".ui-iggrid-scrolldiv").length>0){return $(this).children(".ui-iggrid-scrolldiv").children(".ui-iggrid-table").data("igGrid")}return $(this).children(".ui-iggrid-table").data("igGrid")})},childrenWidgets:function(){return this.element.find("tbody > tr > .ui-iggrid-childarea").find(".ui-iggrid-table").map(function(){return $(this).data("igGrid")})},children:function(){return this.element.find("tbody > tr > .ui-iggrid-childarea").find(".ui-iggrid-table")},immediateChildren:function(){return this.element.children("tbody").children("tr").children(".ui-iggrid-childarea").children("div").children("div").map(function(){if($(this).children(".ui-iggrid-scrolldiv").length>0){return $(this).children(".ui-iggrid-scrolldiv").children(".ui-iggrid-table")}return $(this).children(".ui-iggrid-table")})},rowAt:function(i){i=this._dataRowIndex(i);return this.table.rows[i]},rowById:function(rowId,isFixed){if(_aNull(rowId)){return null}if(isFixed){return this.fixedBodyContainer().find("tbody").first().children("[data-id='"+rowId+"']")}return this.element.children("tbody").children("[data-id='"+rowId+"']")},fixedRowAt:function(i){var rows=this.fixedBodyContainer().find("tbody>tr");if(rows.length>0){return rows[i]}return null},fixedRows:function(){return this.fixedBodyContainer().find("tbody>tr")},rows:function(){return this.element.children("tbody").children("tr")},allFixedRows:function(){return this.fixedBodyContainer().find("tbody tr")},allRows:function(){return this.element.find("tbody tr")},_getColumnInfo:function(id,cols){var aCols=cols||this._oldCols||this.options.columns,i;for(i=0;i<aCols.length;i++){if(aCols[i].key===id||aCols[i].identifier===id){return{column:aCols[i],index:i}}}return null},columnByKey:function(key){var cols=this.options.columns,i;for(i=0;i<cols.length;i++){if(String(cols[i].key)===String(key)){return cols[i]}}return null},columnByText:function(text){var cols=this.options.columns,i;for(i=0;i<cols.length;i++){if(cols[i].headerText===text){return cols[i]}}return null},selectedCells:function(){if(this._selection.settings.owner!==this){return[]}return this._selection.settings.multipleSelection?this._selection.selectedCells():null},selectedRows:function(){if(this._selection.settings.owner!==this){return[]}return this._selection.settings.multipleSelection?this._selection.selectedRows():null},selectedCell:function(){var selectedCells;if(this._selection.settings.owner!==this){return null}selectedCells=this._selection.selectedCells();return this._selection.settings.multipleSelection?null:selectedCells.length===1?selectedCells[0]:null},selectedRow:function(){var selectedRows;if(this._selection.settings.owner!==this){return null}selectedRows=this._selection.selectedRows();return this._selection.settings.multipleSelection?null:selectedRows.length===1?selectedRows[0]:null},activeCell:function(){if(this._selection instanceof $.ig.SelectedRowsCollection){return null}if(this._selection.settings.owner!==this){return null}return this._selection.activeCell()},activeRow:function(){if(this._selection instanceof $.ig.SelectedCellsCollection){return null}if(this._selection.settings.owner!==this){return null}return this._selection.activeRow()},getCellValue:function(rowId,colKey){var id=parseInt(rowId,10),i,cols=this.options.columns,colFound=false,rec,primaryKeyCol,tx;tx=this.dataSource.pendingTransactions();if(this.options.autoCommit===false&&tx.length>0){for(i=0;i<tx.length;i++){if(tx[i].rowId===rowId){if(tx[i].type==="cell"&&tx[i].col===colKey){rec=$.extend(true,{},this.dataSource.findRecordByKey(rowId));rec[colKey]=tx[i].value;return this.dataSource.getCellValue(colKey,rec)}if(tx[i].type==="row"||tx[i].type==="newrow"){return this.dataSource.getCellValue(colKey,tx[i].row)}}}}if($.type(colKey)==="string"){for(i=0;i<cols.length;i++){if(cols[i].key===colKey){colFound=true;break}}if(colFound===false){throw new Error($.ig.Grid.locale.noSuchColumnDefined)}}if(this.options.primaryKey!==null){primaryKeyCol=this.columnByKey(this.options.primaryKey);if(primaryKeyCol.dataType==="number"||primaryKeyCol.dataType==="numeric"){rec=this.dataSource.findRecordByKey(parseInt(rowId,10))}else{rec=this.dataSource.findRecordByKey(rowId)}if(rec===null||rec===undefined){throw new Error($.ig.Grid.locale.recordNotFound.replace("{id}",rowId))}return this.dataSource.getCellValue(colKey,rec)}if(id>=this.dataSource.dataView().length){throw new Error($.ig.Grid.locale.indexOutOfRange.replace("{max}",this.dataSource.dataView().length))}if($.type(colKey)==="string"){return this.dataSource.getCellValue(colKey,this.dataSource.dataView()[id])}if(cols.length<=colKey){throw new Error($.ig.Grid.locale.columnIndexOutOfRange.replace("{max}",cols.length))}return this.dataSource.getCellValue(colKey,this.dataSource.dataView()[id])},getCellText:function(rowId,colKey){var colIndex;if($.type(colKey)==="string"){if(this.columnByKey(colKey)===null){throw new Error($.ig.Grid.locale.columnNotFound.replace("{key}",colKey))}if(this.options.primaryKey!==null){return this.element.find("tr[data-id='"+rowId+"']>td[aria-describedBy='"+this.id()+"_"+colKey+"']").text()}else{return this._getRowsByRecordIndex(rowId).find("td[aria-describedBy='"+this.id()+"_"+colKey+"']").text()}}else{if(this._isMultiRowGrid()){return null}colIndex=colKey}if(colIndex===undefined){throw new Error($.ig.Grid.locale.columnNotFound.replace("{key}",colKey))}if(this.options.primaryKey!==null){return this.element.find("tr[data-id='"+rowId+"']>td:nth-child("+(colIndex+1)+")").text()}return $(this.cellAt(colIndex,parseInt(rowId,10))).text()},setColumnTemplate:function(col,tmpl,render){var colIdx=this._getColIdxById(this.options.columns,col);if(colIdx===null||colIdx===undefined){return}col=this.options.columns[colIdx];col.template=tmpl;render=render===null||render===undefined?true:render;if(render&&!col.hidden){this._renderData()}},commit:function(rowId){var key=this._normalizedKey(rowId),row,idx;this.dataSource.commit(key);if(this._fireInternalEvent("_gridCommit")){return}this._isToSetUnboundColumns=true;if(this.options.virtualization||this.options.rowVirtualization||this.options.columnVirtualization){if(this.options.virtualizationMode==="continuous"){this._renderVirtualRecords()}else{this._buildVirtualDom();this.virtualScrollTo(this._startRowIndex)}}else if(key!==null){row=this.rowById(key);if(row&&row.length){if(row.hasClass(this.css.deletedRecord)){idx=row.index();row.remove();this._reapplyZebraStyle(idx)}else{row.removeClass(this.css.modifiedRecord)}}}else{this._renderData()}},rollback:function(rowId,updateUI){var key=this._normalizedKey(rowId),transactions=this.dataSource.rollback(key),transaction,content,i,tridx,rec,tr,td,index,col;if(updateUI===true){if(!_aNull(rowId)){if(transactions.length===0){return}i=transactions.length;while(i-->0){transaction=transactions[i];tr=this.element.find("tr[data-id='"+transaction.rowId+"']");switch(transaction.type){case"newrow":tridx=this.element.children("tbody").children("tr:not([data-container],[data-grouprow])").index(tr);tr.remove();this._reapplyZebraStyle(tridx);break;case"deleterow":tr.removeClass(this.css.deletedRecord);break;case"cell":col=this.columnByKey(transaction.col);tr.removeClass(this.css.modifiedRecord);td=this.cellById(transaction.rowId,transaction.col);rec=this.dataSource.findRecordByKey(transaction.rowId);if(col.template&&col.template.length){content=this._renderTemplatedCell(rec,col);index=content.indexOf(">");content=content.substring(index+1,content.length);td.html(content)}else{td.html(String(this._renderCell(rec[transaction.col],col,rec)))}break;case"row":tr.removeClass(this.css.modifiedRecord);rec=this.dataSource.findRecordByKey(transaction.rowId);this._renderRow(rec,tr[0],rec[this.options.primaryKey]);break}}}else{this.dataBind()}}},findRecordByKey:function(key){return this.dataSource.findRecordByKey(key)},getDetachedRecord:function(t){return this.dataSource.getDetachedRecord(t)},pendingTransactions:function(){return this.dataSource.pendingTransactions()},allTransactions:function(){return this.dataSource.allTransactions()},transactionsAsString:function(){return this.dataSource.transactionsAsString()},_normalizedKey:function(id){var key,primaryKeyCol;if(id===undefined||id===null){return null}key=id;if(this.options.primaryKey!==null){primaryKeyCol=this.columnByKey(this.options.primaryKey);if(primaryKeyCol.dataType==="number"||primaryKeyCol.dataType==="numeric"){key=parseInt(id,10)}}else{key=parseInt(id,10)}return key},saveChanges:function(success,error){this.dataSource.saveChanges(success,error)},_renderRow:function(rec,tr){var i,tds,td,cols,col,cs,cl,content,cv=this._isColumnVirtualizationEnabled();tr=$(tr);tds=tr.children("td:not([data-skip='true'],[data-parent])");cols=this._visibleColumns();cs=this._startColIndex||0;cl=cv?this._virtualColumnCount+cs:cols.length;for(i=cs;i<cl;i++){col=cols[i];td=tds.filter("[aria-describedby='"+this.id()+"_"+col.key+"']");if(col.template&&col.template.length){content=this._renderTemplatedCell(rec,col);if(content.indexOf("<td")===0){td.html($(content).html())}else{td.html(content)}}else{td.html(String(this._renderCell(rec[col.key],col,rec)))}}return tr},renderNewRow:function(rec){var tbody=this.element.children("tbody"),index,self=this,virt=this.options.virtualization===true||this.options.rowVirtualization===true,fv=this.options.virtualizationMode==="fixed";if(virt){if(fv){this._buildVirtualDom()}else{this._renderVirtualRecordsContinuous();this._startRowIndex=0}this.virtualScrollTo(this._totalRowCount)}else{index=tbody.children('[data-container!="true"]').length;MSApp.execUnsafeLocalFunction(function(){if(self._isMultiRowGrid()){tbody.append(self._renderRecordFromLayout(rec,index))}else{tbody.append(self._renderRecord(rec,index))}})}},_findTableRowByKey:function(key){var primaryKeyIndex,cols=this.options.columns,r,i;if(this.options.primaryKey!==null){for(i=0;i<cols.length;i++){if(cols[i].key===this.options.primaryKey){primaryKeyIndex=i;break}}if(primaryKeyIndex===undefined){throw new Error($.ig.Grid.locale.columnNotFound.replace("{key}",this.options.primaryKey))}r=this.element.find("td:nth-child('"+(primaryKeyIndex+1)+"'):contains('"+key+"')").parent();return r.length===0?null:r[0]}return this.rowAt(parseInt(key,10))},dataSourceObject:function(dataSource){if(dataSource!==undefined){this.options.dataSource=dataSource}else{return this.options.dataSource}},totalRecordsCount:function(){return this.dataSource.totalRecordsCount()},_wrapElementDiv:function(){this._isWrapped=true;this.element=$("<table role='grid'></table>").appendTo(this.element).attr("id",this.id()+"_table");this.element.data("igGrid",this)},dataBind:function(internal){var dataOptions,i,noCancel=true,noCancelRendering=true,customFunc,dataSource;if(!this._initialized){noCancelRendering=this._trigger(this.events.rendering,null,{owner:this})}if(noCancelRendering){dataOptions=this._generateDataSourceOptions(this.options);dataSource=this._createDataSource(dataOptions);noCancel=this._trigger(this.events.dataBinding,null,{owner:this,dataSource:dataSource});if(internal===undefined){this.options.requiresDataBinding=true}if(noCancel){if(this.options.requiresDataBinding){if(this._hasUnboundColumns){this._rebindUnboundColumns=true}this._dataOptions=dataOptions;this.dataSource=dataSource;if(this.dataSource){customFunc=this.dataSource.settings.sorting.customConvertFunc;this.dataSource.settings.sorting.customConvertFunc=$.proxy(this._convertSortingDataSourceValue,this);if(customFunc&&(customFunc.guid===undefined||customFunc.guid!==this.dataSource.settings.sorting.customConvertFunc.guid)){this._oSortingCustomConvertFunc=customFunc}}if(!this._initialized){if(this.element.is("div")){this._wrapElementDiv()}for(i=0;i<this.options.features.length;i++){this._initFeature(this.options.features[i],dataOptions)}if(this.options.autoGenerateColumns!==true){this._captureInitiallyHiddenColumns()}this._visibleColumnsArray=undefined}else{this._isDataBoundCalled=true;this.element.trigger("iggriduidirty",{owner:this});for(i=0;i<this.options.features.length;i++){this._initFeatureSettings(this.options.features[i])}}this._renderGrid();if(this._loadingIndicator===undefined){this._initLoadingIndicator()}if(this._loadingIndicator){this._loadingIndicator.show()}this.dataSource.dataBind();this.options.requiresDataBinding=false}else{this._renderGrid()}}}else{this._cancelRendering=true}},_mergeUnboundValues:function(){var i,primaryKeyCol,metadataUC,rec,ucLength,primaryKeyColIsNumber,col,schema,type,dataLength,data,key,val,j,pk=this.options.primaryKey,metadata=this.dataSource.metadata("unboundValues"),self=this,hasPrimaryKey=pk!==null&&pk!==undefined,metaDataMergeFunction;if(metadata===undefined||metadata===null||metadata.length===0||!this._unboundColumns){return}if(hasPrimaryKey){metaDataMergeFunction=function(ind,val){if(primaryKeyColIsNumber){rec=self.dataSource.findRecordByKey(parseInt(ind,10))}else{rec=self.dataSource.findRecordByKey(ind)}if(rec===null||rec===undefined){return true}if(schema!==undefined&&schema!==null){val=schema._convertType(type,val,rec[pk],key)}self._addUnboundColumnValue(key,val);rec[key]=val};primaryKeyCol=this.columnByKey(pk);primaryKeyColIsNumber=primaryKeyCol.dataType==="number"}ucLength=this._unboundColumns.length;schema=this.dataSource.schema();for(i=0;i<ucLength;i++){key=this._unboundColumns[i].key;metadataUC=metadata[key];if(metadataUC===null||metadataUC===undefined){continue}col=this.getUnboundColumnByKey(key);type=null;if(col!==null&&col.dataType){type=col.dataType}if(hasPrimaryKey){$.each(metadataUC,metaDataMergeFunction)}else{self._renderUnboundValues(metadataUC,key)}if(type==="bool"||type==="boolean"){data=this.dataSource.data();val=schema._convertType(type,undefined);dataLength=data.length;if(dataLength<=metadataUC.length){continue}for(j=0;j<dataLength;j++){if(data[j][key]===undefined){data[j][key]=val}}}}},_convertSortingDataSourceValue:function(val,key){var o=this.options,enableUTCDates=o.enableUTCDates,format,rowTemplate,col,dsFunc=this._oSortingCustomConvertFunc;if($.type(val)==="date"){rowTemplate=!o.rowTemplate||o.rowTemplate.length<=0;col=this.columnByKey(key);if(col!==undefined&&col!==null){format=col.format}if(format){if(format==="time"||format==="timeLong"||format==="h:mm:ss tt"){val=new Date("January 01, 2000 "+$.ig.formatter(val,"date",format,rowTemplate,enableUTCDates))}}}if($.isFunction(dsFunc)){if(dsFunc.guid===undefined||dsFunc.guid!==this.dataSource.settings.sorting.customConvertFunc.guid){val=dsFunc(val,key)}}return val},_generateDataSourceOptions:function(){var schema,dataOptions,t,headers,i,instanceOfDs;if(!this.options.dataSource&&!this.options.dataSourceUrl&&this.element.is("table")&&this.element.find("tbody").children().length>0){this.options.dataSource=this.element[0]}if(this.options.dataSource){if(this.options.dataSource.tagName&&this.options.dataSource.nodeType){t=$(this.options.dataSource)}else if($.type(this.options.dataSource.type)==="function"&&this.options.dataSource.type()==="htmlTableString"&&$.type(this.options.dataSource.dataSource)==="function"){t=$(this.options.dataSource.dataSource())}if(t&&t.is("table")&&t.find("thead th").length>0){headers=t.find("thead tr th");this._tb_h=true;this._tb_h_arr=[];for(i=0;i<headers.length;i++){this._tb_h_arr.push($(headers[i]).text())}}}dataOptions={callback:$.proxy(this._renderData,this),callee:this,responseDataKey:this.options.responseDataKey,responseTotalRecCountKey:this.options.responseTotalRecCountKey,dataSource:this.options.dataSource,requestType:this.options.requestType,responseContentType:this.options.responseContentType,primaryKey:this.options.primaryKey,localSchemaTransform:this.options.localSchemaTransform,autoCommit:this.options.autoCommit,aggregateTransactions:this.options.aggregateTransactions,serializeTransactionLog:this.options.serializeTransactionLog,updateUrl:this.options.updateUrl,restSettings:this.options.restSettings,enableUTCDates:this.options.enableUTCDates};if(this.options.dataSourceType!==null){dataOptions.type=this.options.dataSourceType}if(!this.options.dataSource||!this.options.dataSource.schema||!this.options.dataSource.schema()||this.options.dataSource.schema()._type!=="xml"){schema=this._generateDataSourceSchema()}instanceOfDs=this.options.dataSource&&typeof this.options.dataSource._xmlToArray==="function"&&typeof this.options.dataSource._encodePkParams==="function";if(instanceOfDs&&(this.options.dataSource.settings.schema===null||!this.options.dataSource.settings.schema.fields||this.options.dataSource.settings.schema.fields&&this.options.dataSource.settings.schema.fields.length>=0)||!instanceOfDs){dataOptions=$.extend(dataOptions,{schema:schema})}return dataOptions},_insertUnboundColumn:function(column){if(this._unboundColumns===null||this._unboundColumns===undefined){this._unboundColumns=[]}this._unboundColumns.push(column);if(column.key&&(this._unboundValues[column.key]===null||this._unboundValues[column.key]===undefined)){this._unboundValues[column.key]=[]}if(column.unboundValues&&column.unboundValues.length>0){this._isToSetUnboundColumns=true}this._hasUnboundColumns=true},_addUnboundColumnValue:function(key,value,index){if(this._unboundValues[key]===null||this._unboundValues[key]===undefined){this._unboundValues[key]=[]}if(index!==undefined&&index!==null){this._unboundValues[key][index]=value}else{this._unboundValues[key].push(value)}},_generateDataSourceSchema:function(){var schema,schemaType,dsSchema,i,rec,prop,count=0,cols=this.options.columns,ds=this.options.dataSource,cl,counter=0;if(ds&&typeof ds._xmlToArray==="function"&&typeof ds._encodePkParams==="function"){dsSchema=ds.schema();if(dsSchema&&$.type(dsSchema)==="object"&&typeof dsSchema.schema==="object"&&typeof dsSchema.isObjEmpty==="function"&&dsSchema._type){schemaType=dsSchema._type;if(schemaType&&schemaType!==ds.settings.type){ds.settings.type=schemaType}}else{dsSchema=null}if($.type(ds.settings.dataSource)==="array"||$.type(ds.settings.dataSource)==="object"){ds=ds.settings.dataSource}else if($.type(ds.settings.dataSource)!=="string"){ds=ds.data()}else{ds=[]}}if($.type(ds)==="object"&&this.options.responseDataKey){ds=$.ig.findPath(ds,this.options.responseDataKey)}schema={};schema.fields=[];schema.searchField=this.options.responseDataKey;this._unboundColumns=null;if(cols.length>0&&!this.options.autoGenerateColumns){for(i=0;i<cols.length;i++){if(cols[i].unbound===true||cols[i].unboundDS===true){this._insertUnboundColumn(cols[i]);if(cols[i].unbound===true){continue}}schema.fields[counter]={};schema.fields[counter].name=cols[i].key;schema.fields[counter].type=cols[i].dataType;schema.fields[counter].mapper=cols[i].mapper;counter++}}else if(this.options.autoGenerateColumns){if(ds&&ds.tagName&&$(ds).is("table")&&$(ds).find("tbody tr").length>0){rec=$(ds).find("tbody tr")[0];$(rec).find("td").each(function(){if(cols.length>count){schema.fields.push({name:cols[count].key||count+1,type:cols[count].dataType||"string"})}else{schema.fields.push({name:count+1,type:"string"})}count++})}else if(ds&&ds.length&&ds.length>0&&$.type(ds)==="array"){for(i=0;i<ds.length;i++){rec=ds[i];for(prop in rec){if(rec.hasOwnProperty(prop)){if(this.columnByKey(prop)===null&&!this._fieldExists(prop,schema)&&$.type(rec[prop])!=="object"&&$.type(rec[prop])!=="array"){schema.fields.push({name:prop,type:$.ig.getColType(rec[prop])})}else if(this.columnByKey(prop)!==null){schema.fields.push({name:prop,type:this.columnByKey(prop).dataType})}count++}}if(!this.options._recurseSchema){break}}}else if(dsSchema&&dsSchema.fields().length){schema.fields=dsSchema.fields()}for(i=0;i<cols.length;i++){if(cols[i].unbound===true||cols[i].unboundDS===true){this._insertUnboundColumn(cols[i])}}}this._trigger(this.events.schemaGenerated,null,{owner:this,schema:schema,dataSource:ds});cl=this.options.columnLayouts;if(cl&&cl.length&&cl.length>0){for(i=0;i<cl.length;i++){if(cl[i].key===undefined){continue}schema.fields.push({name:cl[i].key})}}return schema},_fieldExists:function(prop,schema){var i;for(i=0;i<schema.fields.length;i++){if(schema.fields[i].name===prop){return true}}return false},_createDataSource:function(dataOptions){var callee,dataSource;if(!this.options.dataSource||typeof this.options.dataSource._xmlToArray!=="function"||typeof this.options.dataSource._encodePkParams!=="function"){if($.type(dataOptions.dataSource)==="string"&&(this.options.jsonpRequest||$.ig.util.isJsonpUrl(dataOptions.dataSource))){dataSource=new $.ig.JSONPDataSource(dataOptions)}else if(this.options.restSettings.update.url!==null||this.options.restSettings.update.template!==null||this.options.restSettings.create.url!==null||this.options.restSettings.create.template!==null||this.options.restSettings.remove.url!==null||this.options.restSettings.remove.template!==null){dataSource=new $.ig.RESTDataSource(dataOptions)}else{dataSource=new $.ig.DataSource(dataOptions)}}else{dataSource=this.options.dataSource;if(dataSource.settings.responseDataKey!==null){delete dataOptions.responseDataKey;if(dataOptions.schema){dataOptions.schema.searchField=dataSource.settings.responseDataKey}}if(dataOptions.responseTotalRecCountKey===null&&dataSource.settings.responseTotalRecCountKey!==null){delete dataOptions.responseTotalRecCountKey}this._tds=dataSource.settings.dataSource;dataSource.settings.dataSource=null;if($.ig.util.isIE8&&dataOptions.callee){callee=dataOptions.callee;dataOptions.callee=null}dataSource.settings=$.extend(true,{},dataSource.settings,dataOptions);if($.ig.util.isIE8&&callee){dataSource.settings.callee=callee}dataSource.settings.dataSource=this._tds;this._tds=null;if(dataOptions.schema){dataSource._initSchema()}}return dataSource},_generateColumns:function(){var r,key,i,hasExplicitCols=this.options.columns.length>0,hasHeaders=false,len,col,isTable=false,arr=[],ds=this.options.dataSource,cdp=this.options.childrenDataProperty,newDs,colType,dsHtmlTableString=false;if(ds&&typeof ds._xmlToArray==="function"&&typeof ds._encodePkParams==="function"){if(this.options.dataSource.type()==="htmlTableString"&&this.options.autoGenerateColumns){dsHtmlTableString=true}ds=ds.data()}else if(typeof ds==="string"){ds=this.dataSource.data()}if($.type(ds)==="object"&&this.options.responseDataKey){newDs=$.ig.findPath(ds,this.options.responseDataKey);if($.type(newDs)==="array"){ds=newDs}}if(ds&&ds.tagName&&$(ds).is("table")){len=$(ds).find("tbody tr").length;isTable=true}else if(ds&&ds.length){len=ds.length}if(ds&&len&&len===0&&this.options.columns.length===0){throw new Error($.ig.Grid.locale.autoGenerateColumnsNoRecords)}if(ds&&len&&len>0){if(isTable){r=$(ds).find("tbody tr")[0]}else{r=ds[0]}if($.type(r)==="array"||isTable){hasHeaders=this._tb_h;if(isTable){$(r).find("td").each(function(){arr.push($(this).text())});r=arr}for(i=0;i<r.length;i++){if(this.columnByKey(i+1)===null&&$.ig.getColType(r[i])!=="object"){col={headerText:hasHeaders?this._tb_h_arr[i]:$.ig.Grid.locale.colPrefix+(i+1),key:String(i+1),dataType:$.ig.getColType(r[i]),hidden:false};if(dsHtmlTableString){col.key=String(i)}col.headerText=(col.headerText||"").toString().trim();if(this._isMultiColumnGrid){col.level0=true;col.level=0;this._oldCols.push(col)}this.options.columns.push(col);this._visibleColumnsArray=undefined}else if(hasHeaders&&!this.columnByKey(i+1).headerText){this.columnByKey(i+1).headerText=this._tb_h_arr[i]}}}else{for(key in r){if(r.hasOwnProperty(key)&&this.columnByKey(key)===null){colType=$.ig.getColType(r[key]);if((cdp&&cdp!==key||!cdp)&&(colType!=="object"||r[key]===null)&&key!=="ig_pk"){col={headerText:key,key:key,dataType:$.ig.getColType(r[key]),hidden:false};this.options.columns.push(col);if(this._isMultiColumnGrid){col.level0=true;col.level=0;this._oldCols.push(col)}this._visibleColumnsArray=undefined}}}}}this._trigger("_columnsgenerated",null,{owner:this,key:this.options.key});if((this.dataSource.schema()===null||this.dataSource.schema().fields().length===0)&&!hasExplicitCols){this.dataSource.settings.schema=this._generateDataSourceSchema();this.dataSource._initSchema()}if(this.options.width===null){this._setContainerWidth(this.container())}this._trigger("columnsgenerated",null,{owner:this,key:this.options.key})},_renderGrid:function(){var gridElement=this.element[0],containerId,containerDiv,tbody=this.element.children("tbody");this._cancelRendering=false;if(!this._initialized){this.element.attr("role","grid");if(this.options.virtualization===true||this.options.rowVirtualization===true||this.options.columnVirtualization===true){if(this.options.height===undefined||this.options.height===null){throw new Error($.ig.Grid.locale.virtualizationRequiresHeight)}if(this._isColumnVirtualizationEnabled()&&this.options.width.indexOf&&this.options.width.indexOf("%")>0){throw new Error($.ig.Grid.locale.columnVirtualizationNotSupportedWithPercentageWidth)}this._createVirtualGrid()}else if(this.options.height!==null||this.options.width!==null){this._createScrollingGrid()}else{containerId=gridElement.id+"_container";containerDiv='<div id="'+containerId+'" class="'+this.css.gridClasses+" "+this.css.baseClass+'" style="position: relative"> </div>';this.element.wrap(containerDiv);this.element.addClass(this._isMultiRowGrid()?this.css.mrlGridTableClass:this.css.gridTableClass);this.element.attr("aria-describedby",containerId);this._setContainerWidth(this.container());this.container().attr("tabIndex",this.options.tabIndex);if(this.options.height!==null){this.container().css("overflow-y","hidden")}}this._touch();if(this.options.columns.length>0&&this.options.virtualization!==true&&this.options.rowVirtualization!==true&&this.options.columnVirtualization!==true&&this.options.autogenerateColumns===false&&this.options.columns.length>0){this._renderColgroup(this.element[0],false,false,this.options.autofitLastColumn)}$(gridElement).attr("cellpadding","0");$(gridElement).attr("cellspacing","0");$(gridElement).attr("border","0");$(gridElement).css("table-layout","fixed");$(gridElement).addClass(this._isMultiRowGrid()?this.css.mrlGridTableClass:this.css.gridTableClass);if(this.options.autoGenerateColumns===false&&this.options.columns.length>0&&this._headerRenderCancel!==true){this._renderHeader()}this._renderCaption();if(this.options.autoAdjustHeight){this._initializeHeights()}}if(tbody.length===0){tbody=$('<tbody role="rowgroup"></tbody>').appendTo(gridElement).addClass(this.css.baseContentClass).addClass(this.css.gridTableBodyClass).addClass(this.css.recordClass)}if(this.dataSource.type()!=="htmlTableDom"&&this.dataSource.type()!=="htmlTableId"){tbody.attr("role","rowgroup").empty();if(this.hasFixedColumns()){this.fixedBodyContainer().children("table").children("tbody").attr("role","rowgroup").empty()}}},_setContainerWidth:function(element,rendered){var cols=this._visibleColumns(),i,w,width=0,inPerc;if(cols.length>0){inPerc=false;for(i=0;i<cols.length;i++){w=cols[i].width;if(w!==0&&w!=="0"){w=w||this.options.defaultColumnWidth}if(_aNull(w)||w&&w.indexOf&&w.indexOf("%")>0){inPerc=true}else{inPerc=false;break}}if(inPerc){return}this._scrollWidthAddedToContainerWidth=!!this.options.height;width=this._calculateContainerWidth(this._scrollWidthAddedToContainerWidth);if(width>0){if(rendered){width=0;this.container().find(".ui-iggrid-header").each(function(){width+=$(this).outerWidth()});element.width(width)}else{width+=this._calculateSpecialColumnsWidth();element.css("width",width)}}}else if(this.options.width!==null){element.css("width",this.options.width)}},_calculateContainerWidth:function(addScrollWidth){var width=0,cols=this.options.columns,i;for(i=0;i<cols.length;i++){if(cols[i].hidden!==true&&cols[i].fixed!==true&&(this._initialHiddenColumns===undefined||$.inArray(cols[i],this._initialHiddenColumns)===-1)){width+=cols[i].width?parseInt(cols[i].width,10):this.options.defaultColumnWidth===null?0:parseInt(this.options.defaultColumnWidth,10)}}if(this.options.height!==null&&width>0&&addScrollWidth===true){width+=this._scrollbarWidth()}return width},_createScrollingGrid:function(){var self=this,id=this.id()+"_scroll",dataContainer,scrollDiv='<div id="'+id+'"></div>';this.element.wrap(scrollDiv);dataContainer=this.element.parent();this.element.attr("aria-describedby",id);dataContainer.addClass(this.css.gridScrollDivClass).wrap("<div id='"+this.id()+"_container'></div>");
if($.ig.util.isIE7){dataContainer.css("padding-bottom",this._scrollbarWidth())}this.container().attr("tabIndex",this.options.tabIndex).addClass(this.css.baseClass).addClass(this.css.gridClasses);if(this.options.width!==null){this.container().css("width",this.options.width);if(this.options.width.indexOf&&this.options.width.indexOf("%")!==-1){this.element.css("width","100%")}if(this.options.height!==null){this._addHorizontalScrollBar(dataContainer);this.scrollContainer().css("overflow-x","hidden")}}else{this._setContainerWidth(this.container());this.scrollContainer().css("overflow-x","hidden")}this.container().css("position","relative");if(this.options.height!==null){this.scrollContainer().css("overflow-y","auto");if(this.options.autoAdjustHeight){this.container().css("height",this.options.height)}else{this.scrollContainer().css("height",this.options.height)}}if(this._persistVirtualScrollTop){this.scrollContainer().bind({scroll:function(){self._prevFirstVisibleTROffset=self.scrollContainer().scrollTop()}})}this.scrollContainer().bind({wheel:function(event){self._hscrollbarcontent().scrollLeft(self._hscrollbarcontent().scrollLeft()+event.originalEvent.deltaX)}})},_touch:function(){var id=this.id(),div=this.scrollContainer();if(div.length!==1){div=this._vdisplaycontainer()}if(div.length){div.attr("data-scroll","true").attr("data-oneDirection","true");if(this._hscrollbarcontent()[0]){div.attr("data-xScroller","#"+id+"_hscroller")}else if(this._vhorizontalcontainer()[0]){div.attr("data-xScroller","#"+id+"_horizontalScrollContainer")}if(this._scrollContainer()[0]){div.attr("data-yScroller","#"+id+"_scrollContainer")}if($.ig.util.isTouch&&this.element.igScroll!==undefined){this._scrollbarWidthResolved=0;div.css("overflow-y","hidden")}}},_createVirtualGrid:function(){var id=this.id(),$vCont,evnts,$vDsplCntnr,grid,newW,percWidthStr=$.ig.util.isWebKit?"width=100%":"",totalWidth,scrollContainerInner,scrollbarWidth,w=0,virtualGridMarkup='<div id="'+id+'_container" style="margin:0px; border:0px; padding:0px;"><table border="0" cellspacing="0" cellpadding="0" class="ui-iggrid-layout-helper" style="border-spacing:0px" id="'+id+'_virtualContainer" ><tbody role="rowgroup"><tr><td colspan="2" style="border-width:0px"><div id="'+id+'_headers_v" style="overflow:hidden;"></div></td></tr><tr><td style="border-width:0px;"><div id="'+id+'_displayContainer"></td>$verticalMarkup$</tr>$horizontalMarkup$</tbody></table></div>',verticalMarkup,horizontalMarkup='<tr><td colspan="2" style="border-width: 0px"><div id="'+id+'_horizontalScrollContainer"></div></td></tr>';scrollbarWidth=this._scrollbarWidth();if($.ig.util.isIE){scrollbarWidth+=1}if(parseInt(this.options.height,10)>0){verticalMarkup='<td style="border-width: 0px;"><div id="'+id+'_scrollContainer" style="overflow:scroll; overflow-x:hidden; width: '+scrollbarWidth+"px; height:"+this.options.height+';"></div></td>'}else{verticalMarkup='<td style="border-width: 0px;"><div id="'+id+'_scrollContainer" style="overflow:scroll; overflow-x:hidden; width: '+scrollbarWidth+'px;"></div></td>'}if(this.options.virtualization===true){virtualGridMarkup=virtualGridMarkup.replace("$verticalMarkup$",verticalMarkup).replace("$horizontalMarkup$",horizontalMarkup)}else if(this.options.rowVirtualization===true){virtualGridMarkup=virtualGridMarkup.replace("$verticalMarkup$",verticalMarkup).replace("$horizontalMarkup$","")}else if(this.options.columnVirtualization===true){virtualGridMarkup=virtualGridMarkup.replace("$horizontalMarkup$",horizontalMarkup).replace("$verticalMarkup$","")}if(this.options.virtualization===true||this.options.columnVirtualization===true){this.element.css("width","100%")}this.element.wrap(virtualGridMarkup);this.container().attr("tabIndex",this.options.tabIndex).addClass(this.css.baseClass).addClass(this.css.gridClasses);if(this.options.width!==null){this.container().width(this.options.width)}else{this._setContainerWidth(this.container())}this._vdisplaycontainer().addClass(this.css.gridScrollDivClass).addClass(this.css.gridVirtualScrollDivClass).append(this.element[0]);grid=this;totalWidth=this._calculateContainerWidth(false);if(this.options.width!==null){w=parseInt(this.options.width,10)}else{w=totalWidth}if(this.options.height!==null&&this.options.width!==null){w-=this._scrollbarWidth()}if(w<=0){w=undefined}if(w>0&&this.options.expandColWidth&&!this.options.width){w+=this.options.expandColWidth}$("<colgroup><col "+(this._gridHasWidthInPercent()?"":w<=0?percWidthStr:'width="'+w+'"')+'></col><col width="'+this._scrollbarWidth()+'"></col></colgroup>').prependTo(this._virtualcontainer());newW=this.options.width;if(newW&&newW.indexOf&&newW.indexOf("%")!==-1){newW="100%"}this._virtualcontainer().css("width",newW).css("max-width",newW);scrollContainerInner='<div style="width:1px; overflow:hidden; height:'+this._totalRowCount*parseInt(this.options.avgRowHeight,10)+'px;"></div>';this._scrollContainer().append(scrollContainerInner);if((this.options.virtualization===true||this.options.rowVirtualization===true)&&this.options.width&&this.options.width.indexOf&&this.options.width.indexOf("%")>0){this._addHorizontalScrollBar(this._virtualcontainer());this._virtualcontainer().css("table-layout","fixed")}else if((this.options.virtualization===true||this.options.columnVirtualization===true)&&this.options.width&&totalWidth>parseInt(this.options.width,10)){this._renderHorizontalScrollContainer(totalWidth)}if(parseInt(this.options.height,10)>0){this._vdisplaycontainer().css("height",this.options.height).css("vertical-align","top")}this._vdisplaycontainer().css("position","relative").css("width",w).css("maxWidth",w);if(this.options.virtualization===true){this.container().find("#"+id+"_headers_v").append("<a href='#' id='"+id+"_displayContainer_a' tabindex='-1' style='position:absolute;top:-100px;left:-100px'>&nbsp;</a>")}if(this.options.width&&this.options.virtualization===false&&this.options.columnVirtualization===false){this._vdisplaycontainer().css({"overflow-y":"hidden","overflow-x":"auto"})}else{this._vdisplaycontainer().css("overflow","hidden")}this._vdisplaycontainer().parent().bind({mouseenter:function(){grid._isMouseOverVirtualTable=true},mouseleave:function(){grid._isMouseOverVirtualTable=false}});this._documentEvents={DOMMouseScroll:function(event){var dir="down",delta,step,deltaX;step=grid.options.virtualizationMouseWheelStep===null?parseInt(grid.options.avgRowHeight,10):grid.options.virtualizationMouseWheelStep;delta=-event.originalEvent.detail/3;if(delta>0){dir="up"}if(grid._isMouseOverVirtualTable){if(event.originalEvent.axis===2){grid._onVirtualVerticalScroll(event,step,dir)}deltaX=event.originalEvent.offsetX;if(event.originalEvent.axis===1){grid._vdisplaycontainer().scrollLeft(grid._vdisplaycontainer().scrollLeft()-delta)}event.preventDefault()}},mousewheel:function(event){var dir="down",delta,step;step=grid.options.virtualizationMouseWheelStep===null?parseInt(grid.options.avgRowHeight,10):grid.options.virtualizationMouseWheelStep;delta=(event.originalEvent.wheelDeltaY===undefined?event.originalEvent.wheelDelta:event.originalEvent.wheelDeltaY)/120;if(delta>0){dir="up"}if(grid._isMouseOverVirtualTable){if(delta!==0){grid._onVirtualVerticalScroll(event,step,dir)}grid._vdisplaycontainer().scrollLeft(grid._vdisplaycontainer().scrollLeft()-event.originalEvent.wheelDeltaX);event.preventDefault()}},wheel:function(event){var dir="down",step,delta;step=grid.options.virtualizationMouseWheelStep===null?parseInt(grid.options.avgRowHeight,10):grid.options.virtualizationMouseWheelStep;delta=-event.originalEvent.deltaY;if(delta>0){dir="up"}if(grid._isMouseOverVirtualTable){if(delta!==0){grid._onVirtualVerticalScroll(event,step,dir)}grid._vdisplaycontainer().scrollLeft(grid._vdisplaycontainer().scrollLeft()+event.originalEvent.deltaX);event.preventDefault()}}};evnts={};$vDsplCntnr=this._vdisplaycontainer();if(this.options.virtualizationMode==="fixed"){evnts["keydown.virtualizationEvents"]=function(e){if(e.keyCode===$.ui.keyCode.TAB){grid._syncScrollPositionFixedVirt(e,e.shiftKey?"up":"down",$vDsplCntnr)}}}else{evnts["keydown.virtualizationEvents"]=function(e){if(e.keyCode===$.ui.keyCode.TAB){grid._syncScrollPosition(e,e.shiftKey?"up":"down",$vDsplCntnr)}}}$vDsplCntnr.bind(evnts);this._documentEvents["keydown."+this.id()]=function(event){var keyCode=event.keyCode,$sc,dir=null,step;if(grid._isMouseOverVirtualTable){if(keyCode===$.ui.keyCode.DOWN){dir=1}else if(keyCode===$.ui.keyCode.UP){dir=-1}if(dir&&grid._isMouseOverVirtualTable){step=grid.options.virtualizationMouseWheelStep===null?parseInt(grid.options.avgRowHeight,10):grid.options.virtualizationMouseWheelStep;$sc=grid._scrollContainer();$sc.scrollTop($sc.scrollTop()+step*dir)}}};$(document).bind(this._documentEvents);if(this.options.virtualization===true||this.options.rowVirtualization===true){this._scrollContainer().bind({scroll:function(event){grid._onVirtualVerticalScroll(event);grid._virtualScrollMouseDown=false},mousedown:function(){grid._virtualScrollMouseDown=true}})}if(this.options.virtualization===true||this.options.columnVirtualization===true){$vCont=this._vhorizontalcontainer();$vCont.data("containerName","vScrollbar").bind({scroll:function(event){grid._onVirtualHorizontalScroll(event)}});if(this.options.virtualizationMode==="continuous"){this._registerScrllCntnrToSync($vCont)}}if(this._vhorizontalcontainer().length===0&&this.options.width!==null){if(!this.options.width.indexOf||this.options.width.indexOf("%")===-1){this._addHorizontalScrollBar(this._virtualcontainer())}this._vdisplaycontainer().css("overflow-x","hidden")}this.element.height(this._scrollContainer().height());if(this.options.width&&this.options.width.indexOf&&this.options.width.indexOf("%")!==-1){this.container().find("#"+id+"_virtualContainer > colgroup > col:first").css("width","100%");this._vhorizontalcontainer().css("width","100%");this._vdisplaycontainer().css("width","100%").css("max-width","100%")}},_syncScrollPositionFixedVirt:function(e,dir,$vDsplCntnr){$vDsplCntnr=$vDsplCntnr||this._vdisplaycontainer();var $ae=$(document.activeElement),$next,isDown=dir==="down",scrlTop,$scrlCntnr,h,selFirstLastChild=isDown?":last-child":":first-child";$next=isDown?$ae.closest("tr").next():$ae.closest("tr").prev();if(!$ae.is("td, th")||!$ae.is(selFirstLastChild)||$next.length){return}$scrlCntnr=this._scrollContainer();scrlTop=$scrlCntnr.scrollTop();h=parseInt(this.options.avgRowHeight,10);scrlTop+=isDown?h:-h;$scrlCntnr.scrollTop(scrlTop);if(scrlTop<=0||scrlTop+$vDsplCntnr.outerHeight()>=$scrlCntnr.children("div").outerHeight()){return}e.preventDefault()},_syncScrollPosition:function(e,dir,$vDsplCntnr){$vDsplCntnr=$vDsplCntnr||this._vdisplaycontainer();var $ae=$(document.activeElement),$next,focus=false,h,isDown=dir==="down",selFirstLastChild=isDown?":last-child":":first-child";if(!$ae.is("td, th")||!$ae.is(selFirstLastChild)){return}$next=$ae.closest("tr");$next=isDown?$next.next():$next.prev();h=$next.outerHeight();if(!$next.length){if(isDown){this._scrollContainer().scrollTop(0)}else{this._scrollContainer().scrollTop(1e6)}return}if($vDsplCntnr.offset().top+$vDsplCntnr.outerHeight()<=$ae.offset().top+$ae.outerHeight()+h||$vDsplCntnr.offset().top>=$ae.offset().top-h){if($next.is(selFirstLastChild)){focus=true;h=isDown?h+2:h-2}this._onVirtualVerticalScroll({},h,dir);if(focus){e.preventDefault();$vDsplCntnr.find("tr[data-row-idx="+$next.attr("data-row-idx")+"]").focus()}}},_renderHorizontalScrollContainer:function(totalWidth){var horizontalScrollContainerInner,w=this.options.width;if(w&&w.indexOf&&w.indexOf("%")!==-1&&(this.options.virtualization===true||this.options.rowVirtualization===true)){return}this._vhorizontalcontainer().css("height",this._scrollbarWidth()+"px").css("overflow","scroll");w=this.hasFixedColumns()?parseFloat(w)-this.fixedBodyContainer().outerWidth():w;if($.ig.util.isIE){this._vhorizontalcontainer().css("width",parseInt(w,10)+1).css("height",this._vhorizontalcontainer().outerHeight()+1+"px")}else{this._vhorizontalcontainer().css("width",w)}horizontalScrollContainerInner='<div style="width:'+totalWidth+'px;height:1px;"></div>';this._vhorizontalcontainer().append(horizontalScrollContainerInner)},_onVirtualVerticalScroll:function(event,offset,dir){this._isHorizontal=false;var newSri,scrollContainer=this._scrollContainer(),scrollTopDiff,isIE=$.ig.util.isIE,scrollerHeight,avgRowHeight=parseInt(this.options.avgRowHeight,10),current=scrollContainer.scrollTop(),mode=this.options.virtualizationMode;if(offset!==undefined){if(dir==="down"){scrollContainer.scrollTop(current+offset)}else{scrollContainer.scrollTop(current-offset)}current=scrollContainer.scrollTop()}scrollTopDiff=scrollContainer.scrollTop()-this._oldScrollTop;if(Math.abs(scrollTopDiff)<5&&$.ig.util.isFF&&!isIE){return}if(mode===undefined||mode===""){mode="continuous"}if(mode==="fixed"){newSri=Math.ceil(scrollContainer.scrollTop()/avgRowHeight);if($.ig.util.isIE){scrollerHeight=this._getScrollContainerHeight();if(this._totalRowCount*avgRowHeight>=scrollerHeight+2){if(current+5>scrollerHeight-scrollContainer.innerHeight()){newSri=this._getDataView().length-this._virtualRowCount}else{newSri=Math.ceil(current/scrollerHeight*this._totalRowCount)}}}else if(newSri===this._startRowIndex&&this._virtualScrollMouseDown){if(scrollTopDiff>0&&scrollTopDiff<avgRowHeight){newSri++;scrollContainer.scrollTop(scrollContainer.scrollTop()-scrollTopDiff+avgRowHeight)}else if(scrollTopDiff<0&&Math.abs(scrollTopDiff)<avgRowHeight){newSri--;scrollContainer.scrollTop(scrollContainer.scrollTop()-scrollTopDiff-avgRowHeight)}}if(newSri>this._totalRowCount-this._virtualRowCount){newSri=this._totalRowCount-this._virtualRowCount}if(newSri<0){newSri=0}if(newSri!==this._startRowIndex){this._trigger("virtualrendering");this._startRowIndex=newSri;this._renderVirtualRecords()}}else if(mode==="continuous"){this._virtualScrollToInternal(current)}this._oldScrollTop=scrollContainer.scrollTop();if(this._persistVirtualScrollTop){this._saveFirstVisibleTRIndex()}},_scrollContainer:function(){if(!this._scrollContainerObj||this._scrollContainerObj.length===0){this._scrollContainerObj=this.container().find("#"+this.id()+"_scrollContainer")}return this._scrollContainerObj},_onVirtualHorizontalScroll:function(event){var newSci,internallyTriggered=event===undefined,horizontalScrollContainer=this._vhorizontalcontainer(),scrollLeft=horizontalScrollContainer.scrollLeft(),hiddenContentWidth=horizontalScrollContainer[0].scrollWidth-horizontalScrollContainer[0].offsetWidth;if(this.options.virtualization===true&&this.options.virtualizationMode==="continuous"){this._onScrollContainer(event);return}this._isHorizontal=true;if(hiddenContentWidth>0){newSci=Math.ceil(scrollLeft*this._totalColumnCount/hiddenContentWidth);newSci=Math.min(newSci,this._totalColumnCount-this._virtualColumnCount)}else{newSci=0}if(internallyTriggered||newSci!==this._startColIndex){this._trigger("virtualrendering");this._startColIndex=newSci;this._renderVirtualRecords();this._trigger("virtualhorizontalscroll",null,{startColIndex:this._startColIndex,endColIndex:this._startColIndex+this._virtualColumnCount-1})}},_initLoadingIndicator:function(){var widget;if(this.container().data("igLoading")){this._loadingIndicator=this.container().data("igLoading").indicator()}else{widget=this.container().igLoading().data("igLoading");if(widget){this._loadingIndicator=widget.indicator()}}},_addHorizontalScrollBar:function(parent){this._outerHScrollbar=true;var sb=$("<div id='"+this.id()+"_hscroller_container' ></div>").css("height",this._scrollbarWidth()+"px").css("position","relative").css("display","none").css("overflow","hidden").append($("<div id='"+this.id()+"_hscroller' ></div>").data("containerName","hScrollbar").css("width","100%").css("position","absolute").css("bottom","0px").css("overflow-x","scroll").css("overflow-y","scroll").append($("<div id='"+this.id()+"_hscroller_inner' data-scroller ></div>").css("height","1px")).bind("scroll",$.proxy(this._onScrollContainer,this)));if(parent){sb.insertAfter(parent)}this._registerScrllCntnrToSync($("#"+this.id()+"_hscroller"))},_updateVirtualHorizontalScrollbar:function(){var horizontalScrollContainerInner,horizontalScrollContainer,isVisible;horizontalScrollContainerInner=this.container().find("#"+this.id()+"_horizontalScrollContainer div");horizontalScrollContainerInner.css("width",this._calculateContainerWidth(false));horizontalScrollContainer=this._vhorizontalcontainer();isVisible=horizontalScrollContainer.is(":visible");if(horizontalScrollContainer.width()>horizontalScrollContainerInner.width()){horizontalScrollContainer.css("display","none")}else{horizontalScrollContainer.css("display","")}if(isVisible!==horizontalScrollContainer.is(":visible")){this._initializeHeights()}},_generateColumnFlatStructure:function(treeStructure){var cols,oldCols,newCols=[];cols=treeStructure.slice(0);oldCols=treeStructure.slice(0);this._multiColumnIdentifier=0;this._maxLevel=this._getMaxLevelRecursive(0,cols);this._hiddenColumns={};this._analyzeMultiColumnHeaders(cols,newCols,0,oldCols,[]);this._oldCols=oldCols;this.options.columns=newCols},moveColumn:function(column,target,after,inDom,callback){var grid=this,found,nColArray,movingParams,hcPreserve,isFixed,cCols=this._oldCols?jQuery.extend(true,[],this._oldCols):jQuery.extend(true,[],this.options.columns);after=after===null||after===undefined?true:after;inDom=inDom===null||inDom===undefined?true:inDom;movingParams={column:column,target:target,after:after};if(this._oldCols){found=this._performInternalMove(movingParams,this._oldCols);hcPreserve=jQuery.extend(true,{},this._hiddenColumns);this._generateColumnFlatStructure(this._oldCols);this._hiddenColumns=hcPreserve;this._preserveColspans(this._oldCols)}else{found=this._performInternalMove(movingParams,this.options.columns)}if(found===false){throw new Error($.ig.Grid.locale.movingNotAllowedOrIncompatible)}if(movingParams.columnFixed===movingParams.targetFixed){nColArray=this._buildColumnLayoutArray(cCols,movingParams.columnFixed)}else{return movingParams}column=movingParams.column;target=movingParams.target;after=movingParams.after;isFixed=movingParams.columnFixed;if(inDom===true){this._loadingIndicator.show();setTimeout(function(){grid._columnMovingResets();grid._performDomColumnMove(column,target,after,nColArray,isFixed);grid._updateVerticalScrollbarCellPadding(true);grid._loadingIndicator.hide();if(callback){$.ig.util.invokeCallback(callback,[grid.options.columns])}},0)}else{this._columnMovingResets();this._performColumnMove(column,target,after,nColArray,isFixed);if(callback){$.ig.util.invokeCallback(callback,[grid.options.columns])}}},_columnMovingResets:function(){var i,$th;this._updateHeaderColumnIndexes();delete this._virtualDom;delete this._visibleColumnsArray;this._headerCells=[];for(i=0;i<this.options.columns.length;i++){$th=this.container().find("#"+this.id()+"_"+this.options.columns[i].key).data("columnIndex",i);$th.data("data-mch-order",i);if($th.is(":visible")){this._headerCells.push($th)}}},_preserveColspans:function(cols){var i,cs=0,col,res;for(i=0;i<cols.length;i++){col=cols[i];if(col.group!==undefined&&col.group!==null){res=this._preserveColspans(col.group);col.colspan=res;cs+=res}else{if(col.hidden!==true){cs++}}}return cs},_columnVisible:function(col){return!col.hidden},_buildColumnLayoutArray:function(cCols,fixed){var i=0,j=0,col,id,colrs,l,x=0,nCols,level=0,colgrp=fixed?this.fixedBodyContainer().find("colgroup:first"):this.element.find("colgroup:first"),width=colgrp.children("col:not([data-skip=true])").length,htbl=fixed?this.fixedHeadersTable():this.headersTable(),height=htbl.find("thead tr").length,array=[];if(height===0&&this.options.showHeader===false){height=1}for(i=0;i<width;i++){array[i]=[]}i=0;while(level<height){nCols=[];while(i<cCols.length){col=cCols[i];if(col.hidden===true||this._isSubsetFixed(col)!==fixed){i++;continue}colrs=col.rowspan||1;id=this._getColMarkForLevel(col);l=col.colspan||1;for(j=0;j<l;j++){array[x+j][level]=id}if(col.crs===colrs&&col.group){nCols.push.apply(nCols,$.grep(col.group,this._columnVisible).slice(0))}else{nCols.push(col)}x+=l;i++}cCols=nCols;level++;x=0;i=0}return array},_getColMarkForLevel:function(col){if(!col.crs){col.crs=0}col.crs++;if(col.crs>1){return-1}return col.key||col.identifier},_performInternalMove:function(movingParams,subset){var i=0,j,success=true;i=this._getColIdxById(subset,movingParams.column);if(typeof movingParams.column==="number"){movingParams.column=subset[i].key||subset[i].identifier}if(i||i===0){movingParams.columnFixed=this._isSubsetFixed(subset[i]);j=this._getColIdxById(subset,movingParams.target);if(typeof movingParams.target==="number"){movingParams.target=subset[j].key||subset[j].identifier;movingParams.after=j>=i}if(j||j===0){movingParams.targetFixed=this._isSubsetFixed(subset[j]);success=success&&this._rearrangeArray(subset,i,1,movingParams.after===true?j+1:j);success=success||movingParams.targetFixed!==movingParams.columnFixed;return success}return false}for(i=0;i<subset.length;i++){if(subset[i].group){if(this._performInternalMove(movingParams,subset[i].group)===true){return true}}}return false},_getColIdxById:function(array,id){var i,col;if(typeof id==="number"){return id}for(i=0;i<array.length;i++){col=array[i];if(col.key){if(col.key===id){return i}}else if(col.identifier){if(col.identifier===id){return i}}}},_isSubsetFixed:function(subset){var mchc;if(subset.group){mchc=this._getMultiHeaderColumnById(subset.identifier);return!!mchc.children[0].fixed}return!!subset.fixed},_getCellIndexByColumnKey:function(key){var i=this.getVisibleIndexByKey(key);return i===-1?i:i+this.element.find("tbody>tr:not([data-grouprow='true']):first").children("th,td[data-skip='true'],td[data-parent]").length},_findColAreaInLayout:function(col,nColArray,depth){var i,j,res={};for(i=0;i<nColArray.length;i++){if(nColArray[i][depth]===col){res.start=i;for(j=i;j<nColArray.length;j++){if(nColArray[j][depth]!==col){break}}res.length=j-i;return res}}return null},_rearrangeArray:function(array,start,length,at){var col,targetAfter=start<at,n;if(start===at||start<0||at<0||start>=array.length||at>array.length){return false}col=array.splice(start,length);for(n=0;n<col.length;n++){array.splice(targetAfter?at-length+n:at+n,0,col[n])}return true},_moveColumnInHeader:function(column,target,after,nColArray,fixed){var rmil,movedColumn,targetColumn,targetIndex,targetObject,spStart,spEnd,i,j,cols,n,header;if(fixed){header=this.fixedHeadersTable().children("thead")}else{header=this.headersTable().children("thead")}for(j=0;j<nColArray[0].length;j++){movedColumn=this._findColAreaInLayout(column,nColArray,j);if(movedColumn){targetColumn=this._findColAreaInLayout(target,nColArray,j);if(targetColumn){break}}}rmil=[movedColumn,targetColumn];if(this.options.showHeader===false){return rmil}this._moveThs({from:header},column,target,after);while(++j<nColArray[0].length){cols=[];n=null;for(i=movedColumn.start;i<movedColumn.start+movedColumn.length;i++){if(nColArray[i][j]===-1){continue}if(nColArray[i][j]!==n){n=nColArray[i][j];cols.push(n)}}targetIndex=after===true?targetColumn.start+targetColumn.length-1:targetColumn.start;if(nColArray[targetIndex][j]!==-1){this._moveThs({from:header},cols,nColArray[targetIndex][j],after);continue}if(after===true){spStart=targetColumn.start+targetColumn.length;spEnd=movedColumn.start>targetColumn.start+targetColumn.length-1?movedColumn.start:nColArray.length;targetObject=this._findTargetRight(spStart,spEnd,j,nColArray);if(!targetObject){spStart=targetColumn.start+targetColumn.length-2;spEnd=movedColumn.start>targetColumn.start+targetColumn.length-1?-1:movedColumn.start+movedColumn.length;targetObject=this._findTargetLeft(spStart,spEnd,j,nColArray)}}else{spStart=targetColumn.start-1;spEnd=movedColumn.start>targetColumn.start+targetColumn.length-1?-1:movedColumn.start+movedColumn.length;targetObject=this._findTargetLeft(spStart,spEnd,j,nColArray);if(!targetObject){spStart=targetColumn.start+1;spEnd=movedColumn.start>targetColumn.start+targetColumn.length-1?movedColumn.start:nColArray.length;targetObject=this._findTargetRight(spStart,spEnd,j,nColArray)}}if(targetObject&&targetObject.pos&&targetObject.left!==undefined&&targetObject.left!==null){this._moveThs({from:header},cols,nColArray[targetObject.pos][j],targetObject.left)}}return rmil},_moveColumnInBodyFooter:function(area,movedColumn,targetColumn,after){var i,j,trs,$tr,tds,tar,skip=0,trsTo,$trTo,children,len,areaFrom=area.from||area;trs=area.trsFrom||areaFrom.find(">tr:not([data-container='true'],[data-grouprow='true'])");if(area.to||area.trsTo){trsTo=area.trsTo||area.to.find(">tr:not([data-container='true'],[data-grouprow='true'])")}if(trs.length>0&&!area.ignoreDataSkip){skip=trs.eq(0).find("[data-parent],[data-skip='true'],th").length}len=trs.length;for(j=0;j<len;j++){tds=$();$tr=trs.eq(j);$trTo=trsTo?trsTo.eq(j):$tr;children=$tr.children();for(i=movedColumn.start;i<movedColumn.start+movedColumn.length;i++){tds=tds.add(children.eq(i+skip))}if(targetColumn.start===-1){tds.appendTo($trTo);continue}if(after===true){tar=$trTo.children().eq(targetColumn.start+targetColumn.length+skip-1);tds.insertAfter(tar)}else{tar=$trTo.children().eq(targetColumn.start+skip);tds.insertBefore(tar)}}},_findTargetRight:function(start,end,level,nColArray){var i,colFound={};for(i=start;i>=0&&i<end&&i<nColArray.length;i++){if(nColArray[i][level]!==-1){colFound.pos=i;colFound.left=false;return colFound}}},_findTargetLeft:function(start,end,level,nColArray){var i,colFound={};for(i=start;i>=0&&i>end&&i<nColArray.length;i--){if(nColArray[i][level]!==-1){colFound.pos=i;colFound.left=true;return colFound}}},_moveCols:function(area,movedColumn,targetColumn,after){var i,cols=$(),tCol,areaFrom=area.from||area,areaTo=area.to||areaFrom,skip=!area.ignoreDataSkip?areaFrom.children("[data-skip='true']").length:0;for(i=movedColumn.start;i<movedColumn.start+movedColumn.length;i++){cols=cols.add(areaFrom.children().eq(i+skip))}if(targetColumn.start===-1){cols.detach().appendTo(areaTo);return}if(after===true){tCol=areaTo.children().eq(targetColumn.start+targetColumn.length+skip-1);cols.detach().insertAfter(tCol)}else{tCol=areaTo.children().eq(targetColumn.start+skip);cols.detach().insertBefore(tCol)}},_moveThs:function(header,ids,tar,after){var $tar,$ids=$(),$id,i,$pid,headerFrom=header.from||header,headerTo=header.to||headerFrom;$tar=headerTo.find("th[data-mch-id='"+tar+"'],th[id='"+this.id()+"_"+tar+"']");if(typeof ids==="object"){for(i=0;i<ids.length;i++){$id=headerFrom.find("th[data-mch-id='"+ids[i]+"'],th[id='"+this.id()+"_"+ids[i]+"']");if($id.attr("data-vscr-padding-icrement")){$pid=$id}$ids=$ids.add($id)}}else{$ids=headerFrom.find("th[data-mch-id='"+ids+"'],th[id='"+this.id()+"_"+ids+"']");if($ids.attr("data-vscr-padding-icrement")){$pid=$ids}}$ids.detach();if(after){$ids.insertAfter($tar)}else{$ids.insertBefore($tar)}if($tar.attr("data-vscr-padding-icrement")&&after===true){$ids.last().css(this._padding,$tar.css(this._padding)).attr("data-vscr-padding-icrement",$tar.attr("data-vscr-padding-icrement"));$tar.css(this._padding,"");$tar.removeAttr("data-vscr-padding-icrement")}else if($pid){$pid.parent().children(":last").css(this._padding,$pid.css(this._padding)).attr("data-vscr-padding-icrement",$pid.attr("data-vscr-padding-icrement"));$pid.css(this._padding,"");$pid.removeAttr("data-vscr-padding-icrement")}},_moveSpecialThs:function(movedColumn,targetColumn,after,fixed){var i,j,spTrs,header,skip,ths,$tr,tar;if(fixed){header=this.fixedHeadersTable().children("thead")}else{header=this.headersTable().children("thead")}spTrs=header.find(">tr[data-role]");if(spTrs.length>0){skip=spTrs.eq(0).find("[data-parent],[data-skip='true']").length}for(j=0;j<spTrs.length;j++){ths=$();$tr=$(spTrs[j]);for(i=movedColumn.start;i<movedColumn.start+movedColumn.length;i++){ths=ths.add($tr.children("td,th").eq(i+skip))}if(after===true){tar=$tr.children().eq(targetColumn.start+targetColumn.length+skip-1);ths.detach().insertAfter(tar)}else{tar=$tr.children().eq(targetColumn.start+skip);ths.detach().insertBefore(tar)}}},_performDomColumnMove:function(column,target,after,nColArray,fixed){var rmil=this._moveColumnInHeader(column,target,after,nColArray,fixed),movedColumn=rmil[0],targetColumn=rmil[1],body,footer,indexMod=0;this._moveSpecialThs(movedColumn,targetColumn,after,fixed);if(this.options.fixedHeaders===true){this._moveCols({from:fixed?this.fixedHeadersTable().children("colgroup"):this.headersTable().children("colgroup")},movedColumn,targetColumn,after)}if(fixed){body=this.fixedBodyContainer().children("table")}else{body=this.element}this._moveColumnInBodyFooter({from:body.children("tbody")},movedColumn,targetColumn,after);this._moveCols({from:body.children("colgroup")},movedColumn,targetColumn,after);if(this.options.fixedFooters===true){footer=fixed?this.fixedFootersTable():this.footersTable();this._moveColumnInBodyFooter({from:footer.children("tfoot")},movedColumn,targetColumn,after);this._moveCols({from:footer.children("colgroup")},movedColumn,targetColumn,after)}else{this._moveColumnInBodyFooter({from:body.children("tfoot")},movedColumn,targetColumn,after)}if(!fixed&&this.fixingDirection()==="left"||fixed&&this.fixingDirection()==="right"){indexMod=this._fixedColumns?this._fixedColumns.length:0}this._trigger("_columnsmoved",null,{owner:this,start:movedColumn.start+indexMod,len:movedColumn.length,index:after===true?targetColumn.start+targetColumn.length+indexMod:targetColumn.start+indexMod,isFixed:fixed})},_performColumnMove:function(column,target,after,nColArray,fixed){var rmil=this._moveColumnInHeader(column,target,after,nColArray,fixed),movedColumn=rmil[0],targetColumn=rmil[1];if(this.options.fixedHeaders===true){this._moveCols({from:fixed?this.fixedHeadersTable().children("colgroup"):this.headersTable().children("colgroup")},movedColumn,targetColumn,after)}this._renderData();this._renderFooter();this._rerenderColgroups()},showColumn:function(column,callback){var grid=this;this._loadingIndicator.show();if(!this._isShowingAllowed([column])){return false}setTimeout(function(){var col;col=grid._setHidden(column,false);grid._loadingIndicator.hide();if(callback){$.ig.util.invokeCallback(callback,[[col],false])}},0);return true},hideColumn:function(column,callback){var grid=this;if(!this._isHidingAllowed([column])){return false}if(grid._visibleColumns().length===1){return false}this._loadingIndicator.show();setTimeout(function(){var col;col=grid._setHidden(column,true);grid._loadingIndicator.hide();if(callback){$.ig.util.invokeCallback(callback,[[col],true])}},0);return true},_setHidden:function(column,hidden){var col,applied=false;if(typeof column==="number"){col=this.options.columns[column]}else{col=this.columnByKey(column)}if(col&&col.hidden!==hidden){this._setHiddenColumns([col],hidden,false);applied=true}if(applied){return col}return null},_visibleAreaWidth:function(w){if(w!==undefined){this._minVAreaWidth=w}else{return this._minVAreaWidth}},_isShowingAllowed:function(columns){if(!this.hasFixedColumns()){return true}var i,columnsLength=columns.length,totalW=0,w,gridW,colType,col;for(i=0;i<columnsLength;i++){colType=typeof columns[i];if(colType==="string"){col=this.columnByKey(columns[i])}else if(colType==="number"){col=this.options.columns[columns[i]]}else{col=columns[i]}if(!col||!col.hidden){continue}if(col.fixed&&(col.width||col.oWidth)){w=col.width||col.oWidth;w=parseInt(w,10);totalW+=w}}if(totalW!==0){gridW=this.container().outerWidth();if(gridW-parseInt(this.fixedContainer().outerWidth(),10)-totalW<this._visibleAreaWidth()){return false}}return true},_isHidingAllowed:function(columns){if(!this.hasFixedColumns()){return true}var i,columnsLength=columns.length,col,colType,fixed=[],unfixed=[];for(i=0;i<columnsLength;i++){colType=typeof columns[i];if(colType==="string"){col=this.columnByKey(columns[i])}else if(colType==="number"){col=this.options.columns[columns[i]]}else{col=columns[i]}if(!col||col.hidden){continue}if(col.fixed){fixed.push(col)}else{unfixed.push(col)}}if(fixed.length!==0&&this._visibleColumns(true).length<=fixed.length||this._visibleColumns(false).length<=unfixed.length){return false
}return true},_setHiddenColumns:function(columns,hidden,initial){var columnNumberChanged=false,visibleColumnsWithWidthLength,gridWidth,self=this,inPerc,visibleColumnsLength,hasVirtualization=this.options.virtualization===true||this.options.columnVirtualization===true||this.options.rowVirtualization===true,hasColumnVirtualization=this.options.virtualizationMode!=="continuous"&&(this.options.virtualization===true&&this.options.width||this.options.columnVirtualization===true),isContinuos=false;if(columns.length===0){return}this._fireInternalEvent("_hidingFinishing",{columns:columns,hidden:hidden});if(hasVirtualization){isContinuos=this.options.virtualizationMode==="continuous";self._updateVirtColCounters();if(!isContinuos){$.each(columns,function(index,col){var oldVirtualColumnCount=self._virtualColumnCount;col.hidden=hidden;self._visibleColumnsArray=undefined;self._updateVirtColCounters();if(self._virtualColumnCount!==oldVirtualColumnCount){if(self._virtualColumnCount<oldVirtualColumnCount){self._detachColumn(col)}else if(self._virtualColumnCount>oldVirtualColumnCount){self._attachColumn(col)}columnNumberChanged=true;self._resetVirtualDom()}});if(hasColumnVirtualization){this._vheaders=undefined;this._updateVirtualHorizontalScrollbar();this._onVirtualHorizontalScroll();if(!this._initialized){this._adjustLastColumnWidth(true)}}this._renderVirtualRecords()}}if(!hasVirtualization||isContinuos){$.each(columns,function(index,col){var pos;col.hidden=hidden;self._visibleColumnsArray=undefined;if(col.hidden){pos=self._detachColumn(col);self.element.find("colgroup>col").not("[data-skip]").eq(pos).attr("data-hiding",true)}else{self._attachColumn(col);$('<col data-showing="true">').appendTo(self.element.find("colgroup"))}});if(this._isHierarchicalGrid){this.element.children("tbody").children("tr[data-container]").empty()}this._cleanupTBody();if(this.hasFixedColumns()){this._rerenderColgroups()}columnNumberChanged=true;if(hasVirtualization){this._updateVirtColCounters();if(this._initialized){this._renderVirtualRecords()}}else{this._renderRecords()}self.element.find("colgroup>col[data-showing]").remove();self.element.find("colgroup>col[data-hiding]").removeAttr("data-hiding")}if(columnNumberChanged){if(!this._initialized){if(this._visibleColumns().length===0){throw new Error($.ig.Grid.locale.allColumnsHiddenOnInitialization)}this._rerenderColgroups(initial);this._adjustLastColumnWidth(true);if(hasVirtualization){this._renderVirtualRecords()}}else{if(this._visibleColumns().length>0){this._rerenderColgroups(initial);this._adjustLastColumnWidth(true);visibleColumnsLength=this._visibleColumns().length;visibleColumnsWithWidthLength=$.grep(this._visibleColumns(),function(col){return col.width}).length;if(visibleColumnsWithWidthLength===visibleColumnsLength){if(this.options.width&&parseInt(this.options.width,10)>0){this._updateGridContentWidth()}else{this._setContainerWidth(this.container());if(hasVirtualization){gridWidth=this._calculateContainerWidth(true);if(this.options.height!==null){gridWidth-=this._scrollbarWidth()}this._vdisplaycontainer().css("width",gridWidth).css("max-width",gridWidth)}}}}}}this.element.trigger("iggriduisoftdirty",{owner:this});this._trigger(this.events.columnsCollectionModified,null,{owner:this});if(columnNumberChanged&&hasVirtualization&&this._visibleColumns().length>0&&visibleColumnsWithWidthLength===visibleColumnsLength){if(this.options.virtualizationMode==="continuous"){if(!isNaN(gridWidth)){gridWidth+=this._calculateSpecialColumnsWidth();this._vdisplaycontainer().css("width",gridWidth).css("max-width",gridWidth)}}if(!isNaN(gridWidth)){this.container().find("#"+this.id()+"_virtualContainer>colgroup col").eq(0).attr("width",gridWidth)}if(this.options.width===null||this.options.width===undefined){this._setContainerWidth(this.container().find("#"+this.id()+"_headers_v"))}}this._origWidth=parseInt(this.container().css("width"),10);if(columnNumberChanged&&$.ig.util.isSafari&&this.options.showHeader){self.headersTable().find("[data-header-row]").hide();setTimeout(function(){self.headersTable().find("[data-header-row]").show();if(self.options.height){self._initializeHeights()}},0)}if(columnNumberChanged&&($.ig.util.isFF||$.ig.util.isIE8)){inPerc=this.options.width===null||typeof this.options.width==="string"&&this.options.width.indexOf("%")!==-1;if(inPerc){if($.ig.util.isIE8){this._refreshUI()}this._refreshTableUI(this.element);if(this.options.showHeader){this._refreshTableUI(this.headersTable())}if(this.options.fixedFooters===true&&this.options.height!==null){this._refreshTableUI(this.footersTable())}}}if(columnNumberChanged){this._checkAndReinitializeContainersHeights()}this._fireInternalEvent("_hidingFinished",{columns:columns,hidden:hidden})},_refreshTableUI:function($tbl){if(!$tbl.length){return}var overflow;overflow=$tbl[0].style.overflow;$tbl[0].style.overflow="hidden";setTimeout(function(){$tbl[0].style.overflow=overflow},0)},_checkAndReinitializeContainersHeights:function(initH){var c;if(_aNull(this.options.height)||!this.options.height||$.type(this.options.height)==="string"&&this.options.height.indexOf("%")>0){return}c=this.container();if(!c.length){return}if(_aNull(initH)){initH=c.height()}if(c[0].scrollHeight-initH>1){this._initializeHeights()}},_calculateSpecialColumnsWidth:function(){var width=0;this.headersTable().find("> colgroup > col[data-skip=true]").each(function(){var colWidth=this.style.width;if(colWidth){width+=parseInt(colWidth,10)}});return width},_allSpecialColumnsInPercentage:function(){var specCols=this.headersTable().find("> colgroup > col[data-skip=true]"),i;for(i=0;i<specCols.length;i++){if(!specCols[i].style.width.endsWith("%")){return false}}return true},_synchronizeHScroll:function(){var hasFixedHeaders=this.options.showHeader&&this.options.fixedHeaders===true&&this.options.height!==null,hasFixedFooters=this.options.showFooter&&this.options.fixedFooters===true&&this.options.height!==null,scroller=this._hscrollbarcontent(),scrollContainer=this.scrollContainer(),$vContainer,horizontalScrollContainer,scrLeft=scroller.scrollLeft(),headers,footers;if(scroller.length===0){horizontalScrollContainer=$("#"+this.id()+"_horizontalScrollContainer");if(horizontalScrollContainer.length===1){scrLeft=horizontalScrollContainer.scrollLeft();this._vdisplaycontainer().scrollLeft(scrLeft)}else{return}}else if(scrollContainer.length>0){scrollContainer.scrollLeft(scrLeft);if(scrollContainer.scrollLeft()!==0||this.element.height()!==0){scrLeft=scrollContainer.scrollLeft();scroller.scrollLeft(scrLeft)}}else{$vContainer=this._vdisplaycontainer();if($vContainer.length){$vContainer.scrollLeft(scrLeft)}}if(hasFixedHeaders){headers=this.headersTable().parent();headers.scrollLeft(scrLeft)}if(hasFixedFooters){footers=this._fixedfooters();footers.scrollLeft(scrLeft)}},_updateGridContentWidth:function(){var gridWidth=0,hasWidthInPixels=this._gridHasWidthInPixels(),scroller,scrLeft,hasFixedHeader=this.options.height!==null&&this.options.fixedHeaders===true&&this.options.showHeader&&this._headerParent;$.each(this._visibleColumns(),function(index,col){if(col.fixed===true){return true}if(gridWidth!==undefined&&col.width&&!(col.width.charAt&&col.width.endsWith("%"))){gridWidth+=parseInt(col.width,10)}else{gridWidth=undefined}});if(gridWidth===undefined){return}gridWidth+=this._calculateSpecialColumnsWidth();if(!hasFixedHeader&&this._hasVerticalScrollbar&&(!hasWidthInPixels||hasWidthInPixels&&gridWidth<=parseInt(this.options.width,10))){gridWidth-=this._scrollbarWidth()}if(this.options.width!==null&&this.options.height!==null){scroller=this._hscrollbarcontent();scrLeft=scroller.scrollLeft()}this._setGridContentWidth(gridWidth);if(this.options.height!==null&&this.options.width!==null&&!this.options.virtualization&&!this.options.rowVirtualization&&!this.options.columnVirtualization){this._updateVerticalScrollbarCellPadding()}if(this.options.width!==null&&this.options.height!==null){scroller.scrollLeft(scrLeft);this._synchronizeHScroll()}},_updateVerticalScrollbarCellPadding:function(skipHeaderFooters){var hasFixedHeaders=this.options.showHeader&&this.options.fixedHeaders===true&&this.options.height!==null,hasFixedFooters=this.options.showFooter&&this.options.fixedFooters===true&&this.options.height!==null,emptySpace,paddingIncrement;if(this.options.height===null){return}if(!hasFixedHeaders&&!hasFixedFooters){return}if(this._gridInnerWidth===undefined||this._gridContentWidth===undefined){emptySpace=0}else{emptySpace=this._gridInnerWidth-this._gridContentWidth}if(this._hasVerticalScrollbar){paddingIncrement=this._scrollbarWidth()}else{paddingIncrement=0}if(emptySpace>=0){paddingIncrement-=emptySpace}if(paddingIncrement<0){paddingIncrement=0}this._updateVScrollbarCellPaddingHelper(paddingIncrement,skipHeaderFooters);return paddingIncrement},_updateVScrollbarCellPaddingHelper:function(paddingIncrement,skipHeaderFooters){var hasFixedHeaders=this.options.showHeader&&this.options.fixedHeaders===true&&this.options.height!==null,hasFixedFooters=this.options.showFooter&&this.options.fixedFooters===true&&this.options.height!==null;if(hasFixedHeaders&&!skipHeaderFooters){this._increaseLastHeaderCellVScrollbarPadding(this.headersTable(),paddingIncrement)}if(!skipHeaderFooters){if(hasFixedFooters){this._increaseLastCellVScrollbarPadding(this.footersTable(),"tfoot","td",paddingIncrement)}else{this._increaseLastCellVScrollbarPadding(this.element,"tfoot","td",paddingIncrement)}}this._increaseLastCellVScrollbarPadding(this.element,"tbody","td",paddingIncrement)},_getLastCellsInMCH:function(headerTable){var $thead,ml=this._maxLevel,$tr,lastCells=$(),i,$th,rowspan;if(!headerTable){headerTable=this.headersTable()}$thead=headerTable.find("thead");if(!ml||!$thead.length){return lastCells}for(i=ml;i>=0;i--){$tr=$thead.children("tr[data-mch-level="+i+"]");if(!$tr.length){continue}$th=$tr.children("th:last-child").not("[data-skip=true]");lastCells=lastCells.add($th);rowspan=parseInt($th.attr("rowspan"),10);if(!isNaN(rowspan)&&rowspan>1){i-=rowspan-1}}lastCells=lastCells.add($thead.children("tr:not([data-mch-level])").not("[data-skip=true]").children("th:last-child").not("[data-skip=true]"));return lastCells},_increaseLastHeaderCellVScrollbarPadding:function(table,paddingIncrement){var lastCells,currIncrement,paddingValue,selector="",i=0;if(this._isMultiColumnHeader){lastCells=this._getLastCellsInMCH(table)}else if(this._isMultiRowGrid()){for(i=0;i<this._rlm.length;i++){selector+="#"+this.id()+"_"+this._rlm[i][this._maxCols-1]+", "}selector=selector.slice(0,selector.lastIndexOf(", "));lastCells=table.find(selector)}else{lastCells=table.children("thead").children("tr").not("[data-skip=true]").children("th:last-child").not("[data-skip=true]")}currIncrement=parseInt(lastCells.first().attr("data-vscr-padding-icrement"),10);paddingValue=parseInt(lastCells.first().css(this._padding),10);if(currIncrement){paddingValue-=currIncrement}this._removeHeaderCellPadding(table);lastCells.css(this._padding,paddingValue+paddingIncrement);lastCells.first().attr("data-vscr-padding-icrement",paddingIncrement);lastCells.find("[data-nonpaddedindicator=right]").css(this._rtl?"margin-left":"margin-right",-parseInt(lastCells.css(this._padding),10)+"px")},_removeHeaderCellPadding:function(table,removeAllPaddings){var withoutLastCell=":not(:last)";if(removeAllPaddings===true){withoutLastCell=""}table.find("thead > tr > th"+withoutLastCell+"[data-vscr-padding-icrement],thead > tr > td:not(:last)[data-vscr-padding-icrement]").removeAttr("data-vscr-padding-icrement").css(this._padding,"")},_removeCellPadding:function(table,tableGroup,rowElement,removeAllPaddings){var i,$cell,cells,withoutLastCell=":not(:last)";if(removeAllPaddings===true){withoutLastCell=""}cells=table.find(" > "+tableGroup+" > tr:first > "+rowElement+withoutLastCell+"[data-vscr-padding-icrement]");for(i=0;i<cells.length;i++){$cell=$(cells[i]);$cell.removeAttr("data-vscr-padding-icrement");table.find(" > "+tableGroup+" > tr > "+rowElement+":nth-child("+($cell.index()+1)+")").css(this._padding,"")}},_increaseLastCellVScrollbarPadding:function(table,tableGroup,rowElement,paddingIncrement){var paddingValue,lastCells=table.find(" > "+tableGroup+" > tr > "+rowElement+":last-child"),currIncrement=parseInt(lastCells.first().attr("data-vscr-padding-icrement"),10),selector="",i=0;if(this._isMultiRowGrid()){for(i=0;i<this._rlm.length;i++){selector+="td[aria-describedBy ='"+this.id()+"_"+this._rlm[i][this._maxCols-1]+"'] , "}selector=selector.slice(0,selector.lastIndexOf(", "));lastCells=table.find(selector);currIncrement=parseInt(lastCells.first().attr("data-vscr-padding-icrement"),10)}this._removeCellPadding(table,tableGroup,rowElement);paddingValue=parseInt(lastCells.first().css(this._padding),10);paddingValue=paddingValue||0;if(currIncrement){paddingValue-=currIncrement}lastCells.css(this._padding,paddingValue+paddingIncrement);lastCells.first().attr("data-vscr-padding-icrement",paddingIncrement)},_updateHScrollbarVisibility:function(){var o=this.options,$hScrollCntnrInner=this._getHScrollContainerInner(),scrollerContainer=this._hscrollbar(),visibleScroller=scrollerContainer.is(":visible"),shouldInitHeights=false;if(!scrollerContainer.length&&o.virtualizationMode==="continuous"){scrollerContainer=this._vhorizontalcontainer();visibleScroller=scrollerContainer.is(":visible")}scrollerContainer.css("display","");if(!scrollerContainer.is(":visible")&&scrollerContainer.length>0){scrollerContainer.css("display","none");return}if(this._gridInnerWidth<this._gridContentWidth){if(o.virtualizationMode==="continuous"&&(scrollerContainer.length===0||$hScrollCntnrInner.length===0)){this._vhorizontalcontainer().empty();this._renderHorizontalScrollContainer(this._calculateContainerWidth(false));shouldInitHeights=true}else if(o.virtualization||o.rowVirtualization){if((!o.width||o.width.indexOf&&o.width.indexOf("%")>0)&&!this._allColumnWidthsInPercentage&&!this._allColumnWidthsInPixels){scrollerContainer.css("display","none")}}}else{if(o.virtualizationMode==="continuous"&&scrollerContainer.length===0&&$hScrollCntnrInner.length){this._vhorizontalcontainer().empty().attr("style","");shouldInitHeights=true}scrollerContainer.css("display","none")}shouldInitHeights=shouldInitHeights||scrollerContainer.is(":visible")!==visibleScroller;if(o.autoAdjustHeight&&shouldInitHeights){this._initializeHeights()}},_applyAutofitLastColInVirtGrid:function(gridContentWidth){var o=this.options,widthInPerc,widthInPx;if(!o.rowVirtualization||o.columnVirtualization||o.autofitLastColumn){return true}gridContentWidth=gridContentWidth||this._gridContentWidth;widthInPx=this._gridHasWidthInPixels()&&gridContentWidth<parseFloat(o.width)&&gridContentWidth;widthInPerc=this._allColumnWidthsInPixels&&this._gridHasWidthInPercent();return!(widthInPx||widthInPerc)},_setGridContentWidth:function(gridContentWidth){var o=this.options,w,$hscrlbar,$parent,v=o.virtualization===true||o.rowVirtualization===true||o.columnVirtualization===true;if(this.options.height!==null){if(gridContentWidth){this._gridContentWidth=gridContentWidth}if(this._gridContentWidth){w=(this._hasVerticalScrollbar||this.options.rowVirtualization||this.options.virtualizationMode==="continuous"&&this.options.virtualization)&&this.options.fixedHeaders?this._gridContentWidth-this._scrollbarWidth():this._gridContentWidth;$hscrlbar=this._getHScrollContainerInner();if(!v&&!$hscrlbar.length){$parent=this.element.parent();this._addHorizontalScrollBar($parent);if($parent.css("overflow-x")!=="hidden"){$parent.css("overflow-x","hidden")}$hscrlbar=this._getHScrollContainerInner()}$hscrlbar.css("width",w)}this._updateHScrollbarVisibility()}if(v===false||o.rowVirtualization&&!this._applyAutofitLastColInVirtGrid(gridContentWidth)){this._setGridTablesWidth(gridContentWidth);if(v){this._avgRowHeight=this._calculateAvgRowHeight()}}},_setGridTablesWidth:function(width){var hasFixedHeaders=this.options.showHeader&&this.options.fixedHeaders===true&&this.options.height!==null,hasFixedFooters=this.options.showFooter&&this.options.fixedFooters===true&&this.options.height!==null;this.element.css("width",width);if(hasFixedHeaders){this.headersTable().css("width",width)}if(hasFixedFooters){this.footersTable().css("width",width)}},_detachHiddenColumns:function(){var col,i;for(i=0;i<this.options.columns.length;i++){col=this.options.columns[i];if(col.hidden){this._detachColumn(col)}}},_rerenderColgroups:function(){var hasFixedHeader=this.options.height!==null&&this.options.fixedHeaders===true&&this.options.showHeader,hasFixedFooter=this.options.height!==null&&this.options.fixedFooters===true&&this.options.showFooter,initial=this.options.autofitLastColumn;if(hasFixedHeader){this.headersTable().children("colgroup").remove();this._renderColgroup(this.headersTable()[0],true,false,initial)}if(hasFixedFooter){this.footersTable().children("colgroup").remove();this._renderColgroup(this.footersTable()[0],false,true,initial)}this.element.children("colgroup").remove();this._renderColgroup(this.element[0],false,false,initial)},_detachColumn:function(col){var position,cols,headerCells,isMultiColumnGrid=this._isMultiColumnGrid;col.hidden=false;this._visibleColumnsArray=undefined;cols=this._visibleColumns();position=$.inArray(col,cols);col.hidden=true;this._visibleColumnsArray=undefined;this._initializeDetachedContainers();headerCells=this.headersTable().children("thead").children("tr").not("[data-skip=true]");if(isMultiColumnGrid){this._hideMultiHeaderCells(this._headerCells,col.key);headerCells=this.headersTable().children("thead").children("tr:not([data-mch-level])").not("[data-skip=true]");this._detachCells(headerCells,function(row){return row.filter(":not([data-new-row],[data-add-row])").children("th, td").not("[data-skip=true]")},position,this._detachedHeaderCells,col.key)}else{this._detachCells(headerCells,function(row){return row.filter(":not([data-new-row],[data-add-row])").children("th, td").not("[data-skip=true]")},position,this._detachedHeaderCells,col.key)}this._detachCells(this.footersTable().children("tfoot").children("tr"),function(row){return row.children("td").not("[data-skip=true]")},position,this._detachedFooterCells,col.key);return position},_attachColumn:function(col){var headerCells,visibleCols=this._visibleColumns(),position=$.inArray(col,visibleCols);this._initializeDetachedContainers();if(this._isMultiColumnGrid){this._showMultiHeaderCells(col.key);headerCells=this.headersTable().children("thead").children("tr:not([data-mch-level])").not("[data-skip=true]");this._attachCells(headerCells,function(row){return row.children("th, td").not("[data-skip=true]")},position,this._detachedHeaderCells,col.key)}else{this._attachCells(this.headersTable().children("thead").children("tr").not("[data-skip=true]"),function(row){return row.children("th, td").not("[data-skip=true]")},position,this._detachedHeaderCells,col.key)}this._attachCells(this.footersTable().children("tfoot").children("tr"),function(row){return row.children("td").not("[data-skip=true]")},position,this._detachedFooterCells,col.key);return position},_initializeDetachedContainers:function(){if(!this._detachedContainersInitialized){this._detachedHeaderCells={};this._detachedFooterCells={};this._detachedContainersInitialized=true}},_getParentsMultiHeader:function(key){var i,cols=this._oldCols,colsLength=cols.length,arr=[];for(i=0;i<colsLength;i++){if(cols[i].key===key||cols[i].identifier===key){arr.push(cols[i]);break}if(cols[i].group){if(this._getParentsMultiHeaderRecursive(key,cols[i].group,arr)===true){arr.push(cols[i]);break}}}return arr},_getParentsMultiHeaderRecursive:function(key,arr,resArr){var i,cols=arr,colsLength=arr.length,res=false;for(i=0;i<colsLength;i++){if(cols[i].key===key||cols[i].identifier===key){resArr.push(cols[i]);res=true;break}if(cols[i].group&&this._getParentsMultiHeaderRecursive(key,cols[i].group,resArr)===true){resArr.push(cols[i]);res=true;break}}return res},_hideMultiHeaderCells:function(headerCells,key){var i,currentCell,parents=this._getParentsMultiHeader(key),parent,colspan,$th,headersTable=this.headersTable().find("thead > tr"),$tr,position=-1;for(i=0;i<headerCells.length;i++){if(this.id()+"_"+key===headerCells[i].attr("id")){position=i;break}}if(position===-1){return}currentCell=headerCells[position];this._headerCells.splice(position,1);$tr=currentCell.closest("tr");if($tr[0].style.height===""){$tr[0].style.height=$tr.outerHeight()+"px"}currentCell.css("display","none");this._hiddenColumns[key]=currentCell;if(parents.length>0){for(i=0;i<parents.length;i++){parent=parents[i];if(parent.level===0){continue}$th=headersTable.find("th[data-mch-id="+parent.identifier+"]");if($th.length===0){$th=this.fixedHeadersTable().find("thead > tr").find("th[data-mch-id="+parent.identifier+"]")}colspan=parseInt($th.attr("colspan"),10);if(colspan>1){$th.attr("colspan",--colspan);parent.colspan=colspan}else{$tr=$th.closest("tr");if($tr[0].style.height===""){$tr[0].style.height=$tr.outerHeight()+"px"}$th.attr("ishidden",1);$th.css("display","none");parent.hidden=true;parent.colspan=0}}}},_detachCells:function(rows,cellSelectorFunction,position,container,key){var detachedCells=[],i,cells,currentCell;if(rows.length>0){for(i=0;i<rows.length;i++){cells=cellSelectorFunction(rows.eq(i));currentCell=cells.eq(position);if(cells.length===1){currentCell.after($("<"+currentCell[0].tagName+"></"+currentCell[0].tagName+">").attr("data-hiddenreplacement","true").css("height",currentCell.height()).attr("class",currentCell.attr("class")))}detachedCells.push(currentCell.detach())}container[key]=detachedCells}},_showMultiHeaderCells:function(key){var i,currentCell=this._hiddenColumns[key],parents=this._getParentsMultiHeader(key),parent,colspan,$th,currentOrder,order,headerCellsLength=this._headerCells.length,headersTable=this.headersTable().find("thead > tr"),isHidden;if(currentCell===null||currentCell===undefined){return}currentOrder=currentCell.data("data-mch-order");for(i=0;i<headerCellsLength;i++){order=this._headerCells[i].data("data-mch-order");if(currentOrder<order){this._headerCells.splice(i,0,currentCell);break}}if(i===headerCellsLength){this._headerCells.push(currentCell)}currentCell.css("display","");currentCell.removeAttr("ishidden");if(parents.length>0){for(i=0;i<parents.length;i++){parent=parents[i];if(parent.level===0){continue}$th=headersTable.find("th[data-mch-id="+parent.identifier+"]");if($th.length===0){$th=this.fixedHeadersTable().find("thead > tr").find("th[data-mch-id="+parent.identifier+"]")}isHidden=$th.attr("ishidden")==="1";colspan=parseInt($th.attr("colspan"),10);if(!isHidden){$th.attr("colspan",++colspan);parent.colspan=colspan}else{$th.removeAttr("ishidden");$th.css("display","");parent.hidden=false;parent.colspan=1}}}},_attachCells:function(rows,cellSelectorFunction,position,container,key){var detachedCells,i,cells,replacementCell,storedKey;if(rows.length>0){if(this.options.virtualization===true||this.options.columnVirtualization===true){detachedCells=container[key];if(detachedCells===null||detachedCells===undefined){for(storedKey in container){if(container.hasOwnProperty(storedKey)){detachedCells=container[storedKey];delete container[storedKey];break}}}else{delete container[key]}}else{detachedCells=container[key];delete container[key]}if(detachedCells===undefined||detachedCells===null){return}for(i=0;i<rows.length;i++){cells=cellSelectorFunction(rows.eq(i)).not("[data-hiddenreplacement=true]");if(position===0){if(cells.length===0){replacementCell=rows.eq(i).find("[data-hiddenreplacement=true]");replacementCell.after(detachedCells[i]);replacementCell.remove()}else{cells.eq(0).before(detachedCells[i])}}else{cells.eq(position-1).after(detachedCells[i])}}}},_cleanupTBody:function(){this._fireInternalEvent("_cleanupTBody");return this.element.children("tbody").empty()},_captureInitiallyHiddenColumns:function(){this._initialHiddenColumns=$.grep(this.options.columns,function(column){var hidden=column.hidden;column.hidden=false;return hidden})},getUnboundValues:function(key){var res;if(key===undefined||key===null){return this._unboundValues}res=this._unboundValues[key];if(res===undefined||res===null){if(this.getUnboundColumnByKey(key)!==null){res=[]}else{res=null}}return res},setUnboundValues:function(key,values,removeOldValues){var i,column=this.getUnboundColumnByKey(key),uVals,data,len,reRenderData=false;if(column&&!column.formula){uVals=column.unboundValues;if(removeOldValues){column.unboundValues=values;data=this.dataSource.data();len=data.length;for(i=0;i<len;i++){if(data[i][key]!==null&&data[i][key]!==undefined){reRenderData=true;delete data[i][key]}}if(reRenderData){this._renderData()}}else{len=values.length;if(uVals&&uVals.length>len){for(i=0;i<len;i++){column.unboundValues[i]=values[i]}}else{column.unboundValues=values}}}if(!this._hasInitialUnboundValues){this._hasInitialUnboundValues={}}this._hasInitialUnboundValues[key]=true;this._renderUnboundValues(values,key)},setUnboundValueByPK:function(col,rowId,val,notToRender){var data=this.dataSource.data(),pkCol,rec,tr,f,pk=this.options.primaryKey,colKey,pkVal;if($.type(col)==="string"){colKey=col;col=this.columnByKey(colKey)}else{colKey=col.key}if(!col||!col.unbound){return false}if(pk===null){pkVal=parseInt(rowId,10);rec=data[pkVal]}else{pkCol=this.columnByKey(this.options.primaryKey);if(pkCol){pkVal=rowId;if(pkCol.dataType==="number"||pkCol.dataType==="numeric"){pkVal=parseInt(rowId,10);rec=this.dataSource.findRecordByKey(rowId)}else{rec=this.dataSource.findRecordByKey(rowId)}}else{return false}}if(!rec){return false}if(val===undefined){if(col.formula){f=this._getUnboundColumnFormula(col);if(f){val=f.apply(col,[rec,this.element])}}}if(this.dataSource&&this.dataSource.schema){rec[colKey]=this.dataSource.schema()._convertType(col.type,val,pkVal,colKey)}else{rec[colKey]=val}if(!notToRender){tr=this.rowById(rowId,col.isFixed);if(tr.length){this._renderRow(rec,tr[0])}}return rec},_getUnboundColumnFormula:function(col){if(!col){return null}var f=null,colType=typeof col;if(colType==="string"){col=this.getUnboundColumnByKey(col);if(!col){return null}colType=typeof col}if(!col.formula||colType!=="object"){return null}f=col.formula;if(typeof f==="function"){return f}else if(window[f]&&typeof window[f]==="function"){return window[f]}return null},_renderUnboundValues:function(values,key,notToRender){var i,data=this.dataSource.data(),dataLength=data.length,valuesLength=values.length,isToConvert=false,type="string",pk=this.options.primaryKey,col,schema,pkVal;if(valuesLength===0){return}col=this.getUnboundColumnByKey(key);if(col===null){return}if(this.dataSource&&this.dataSource.schema){if(col.dataType){type=col.dataType;isToConvert=true;schema=this.dataSource.schema()}}if(pk===undefined){pk=null}for(i=0;i<valuesLength;i++){if(data[i]===undefined||data[i]===null){break}if(isToConvert){if(pk===null){pkVal=i}else{pkVal=data[i][pk]}values[i]=schema._convertType(type,values[i],pkVal,key)}data[i][key]=values[i];this._addUnboundColumnValue(key,values[i],i)}if((type==="bool"||type==="boolean")&&valuesLength<dataLength){for(i=valuesLength;i<dataLength;i++){data[i][key]=schema._convertType(type,null,pkVal,key)}}if(this.options.virtualization===true||this.options.rowVirtualization===true&&this._persistVirtualScrollTop){this._scrollTo(0)}if(notToRender!==true){this._renderColumnData(key,this.dataSource.dataView())}},getUnboundColumnByKey:function(key){if(this._unboundColumns===undefined||this._unboundColumns===null||this._unboundColumns.length===0||key===null||key===undefined){return null}var column=null;$.each(this._unboundColumns,function(ind,col){if(col.key===key){column=col;return false}});return column},_renderColumnData:function(key,values){if(values.length===0){return}var visibleColumns=this._visibleColumns(),grid=this,tdIndex,index,tds,column,ds,isToConvertToString=false,hasTemplate,temp;index=this.getVisibleIndexByKey(key);column=visibleColumns[index];hasTemplate=column.template&&column.template.length>0;if(column===undefined||column===null){return}isToConvertToString=column.dataType==="bool";if(hasTemplate){ds=this.dataSource.dataView()}tdIndex=index+this.headersTable().find(">thead>tr:eq(0)>th[data-skip=true]").length;tds=this.element.find(">tbody> tr > td:not([data-skip]):nth-child("+(tdIndex+1)+")");$.each(values,function(ind,val){var innerHtml;if(val[key]===undefined){return true}if(hasTemplate){temp=grid._renderTemplatedCell(ds[ind],column);if(temp.indexOf("<td")===0){innerHtml=$(temp).html()}else{innerHtml=temp}}else{innerHtml=grid._renderCell(val[key],column,val);if(isToConvertToString===true){innerHtml=innerHtml.toString()}}if(!tds[ind]){return false}$(tds[ind]).html(innerHtml)})},_renderData:function(success,errmsg,response){if(success!==undefined||!this._isDataBoundCalled){this._trigger(this.events.dataBound,null,{owner:this,dataSource:this.dataSource});this._isDataBoundCalled=false}var gridElement=this.element,div,self=this,noCancel=true,sum=0,cols,colsToUnbound,colsLength,data,key,j,i,f,diff=0,isTable=false,noCancelError=true,isRemoteDS=this._inferOpType()==="remote",ucFormulaFunction,tbody,newW,totalWidth,isToRefreshUI=false,jsrnd=String(this.options.templatingEngine).toLowerCase()==="jsrender",displayCont;if((this.options.requiresDataBinding===true||this._isToSetUnboundColumns===true||isRemoteDS)&&this._hasUnboundColumns){this._isToSetUnboundColumns=false;if(this._hasInitialUnboundValues===null||this._hasInitialUnboundValues===undefined){this._hasInitialUnboundValues={}}cols=this.options.columns;colsLength=cols.length;data=this.dataSource.data();ucFormulaFunction=function(data,f,col){$.each(data,function(ind,val){val[key]=f.apply(col,[val,gridElement]);self._addUnboundColumnValue(key,val[key],ind)})};colsToUnbound=[];if(isRemoteDS){this._unboundValues={}}for(i=0;i<colsLength;i++){if(cols[i].unbound===true){key=cols[i].key;if(cols[i].unboundValues!==null&&cols[i].unboundValues!==undefined&&$.type(cols[i].unboundValues)==="array"){if(this._rebindUnboundColumns===true||cols[i].unboundValues.length>0&&this._hasInitialUnboundValues[key]===undefined){this._hasInitialUnboundValues[key]=true;this._renderUnboundValues(cols[i].unboundValues,key,true)}}else if(cols[i].formula!==null&&cols[i].formula!==undefined){f=this._getUnboundColumnFormula(cols[i]);if(f){ucFormulaFunction(data,f,cols[i])}}else if(this._unboundValues[key]&&this._unboundValues[key].length>0){colsToUnbound.push(key)}}}this._rebindUnboundColumns=false;if(this.options.localSchemaTransform===true&&colsToUnbound.length>0&&data.length>0){for(i=0;i<colsToUnbound.length;i++){key=colsToUnbound[i];if(data[0][key]===undefined){this._renderUnboundValues(this._unboundValues[key],key)}}}if(this.options.mergeUnboundColumns===false){this._mergeUnboundValues()}}if(success===false){noCancelError=this._trigger(this.events.requestError,null,{owner:this,message:errmsg,response:response});if(noCancelError){throw new Error(errmsg)}}if(this._cancelRendering===true){this._cancelRendering=false;return}this.element.trigger("iggriduisoftdirty",{owner:this});if(!this._initialized){if(this.options.autoGenerateColumns===true){this._generateColumns();if((this.options.virtualization===true||this.options.columnVirtualization===true)&&this.options.width){totalWidth=this._calculateContainerWidth(false);if(totalWidth>parseInt(this.options.width,10)&&$("#"+this.id()+"_horizontalScrollContainer").children().length===0){this._renderHorizontalScrollContainer(totalWidth)}}for(i=0;i<this.options.features.length;i++){this._initFeature(this.options.features[i],this._dataOptions)}}}tbody=gridElement.children("tbody");noCancel=this._trigger(this.events.dataRendering,null,{owner:this,tbody:tbody});if(noCancel){if(!(this.options.dataSource&&this.options.dataSource.tagName&&$(this.options.dataSource).is("table"))){tbody=this._cleanupTBody()}else{isTable=true}this._resetVirtualDom();if(!this._initialized){if(this.options.autoGenerateColumns===true){this._captureInitiallyHiddenColumns();this._visibleColumnsArray=undefined;this._updateVirtColCounters()}if(isTable){tbody.empty()
}if(this._renderHeaderCalled!==true){this._renderHeader();this._renderCaption()}else{if(this.options.width!==null&&this.options.height===null){this.scrollContainer().css("overflow-y","hidden").css("overflow-x","auto")}}if(this._rmvClgrpOnInitRenderData&&!this.element.find("colgroup[data-cols-injected]").length){this.element.find("colgroup").remove()}if(this.element.find("colgroup").length===0||this.element.find("colgroup").children().length===0){this._renderColgroup(this.element[0],false,false,this.options.autofitLastColumn)}this._renderFooter();div=this.scrollContainer();if(!div.length){div=this._vdisplaycontainer()}div.data("containerName","dataContainer").bind("scroll.syncScrollContainers",$.proxy(this._onScrollContainer,this));this._registerScrllCntnrToSync(div);this._trigger("_gridContainersRendered",null,{owner:this,tbody:tbody})}this._trigger("dataEmpty",null,{owner:this,tbody:tbody});if(this.options.autoGenerateColumns===false&&(this.options.columns&&this.options.columns.length===0||!this.options.columns)){throw new Error($.ig.Grid.locale.noColumnsButAutoGenerateTrue)}this._tmplWrappers=jsrnd?$.render:{};this._setTemplateDefinition(jsrnd);if(this._initialHiddenColumns===undefined||this._initialHiddenColumns.length===0){if(this.options.columns.length>0){if(this.options.virtualization===true||this.options.rowVirtualization===true||this.options.columnVirtualization===true){if(!this._persistVirtualScrollTop){this._scrollContainer()[0].scrollTop=0}this._renderVirtualRecords()}else{this._renderRecords()}if(this._initialized){this._adjustLastColumnWidth(false);if(this.options.width!==null&&this.options.height!==null){this._synchronizeHScroll()}}else{if(this.options.height!==null&&this.options.autoAdjustHeight){this._initializeHeights()}this._adjustLastColumnWidth(true)}}}if(!this._initialized){if(this.options.autoAdjustHeight){this._initializeHeights()}}if(this._initialHiddenColumns!==undefined&&this._initialHiddenColumns.length>0){this._setHiddenColumns(this._initialHiddenColumns,true,true);if(this._initialHiddenCells!==undefined&&this._initialHiddenCells.length>0){$.each(this._initialHiddenCells,function(index,cell){cell.css("display","")})}$.each(this._initialHiddenColumns,function(index,column){column._initiallyHidden=true});this._initialHiddenCells=undefined;this._initialHiddenColumns=undefined;if($.ig.util.isFF){isToRefreshUI=true}}this._registerAdditionalEvents();this._updateVirtualScrollContainer();this._fireInternalEvent("_dataRendered");if(!this._initialized){this.autoSizeColumns()}this._trigger(this.events.dataRendered,null,{owner:this});if(this._loadingIndicator===undefined){this._initLoadingIndicator()}this._loadingIndicator.hide()}if(this._fixScrollY){this.scrollContainer().css("overflow-y",this.rows().length>1?"hidden":"visible")}if(this.options.width===null){this._updateContainersWidthOnGridWidthNull()}if(this.options.dataSourceUrl!==null&&this._firstBind){this.options.dataSource=this.options.dataSourceUrl;this.dataSource.settings.dataSource=this.options.dataSourceUrl;this.dataSource.settings.type="remoteUrl";this.dataSource._runtimeType=this.dataSource.analyzeDataSource();this._firstBind=false}if(!this._initialized){this._trigger(this.events.rendered,null,{owner:this});this._hc=this.container().find(".ui-iggrid-expandheadercell").length>0;this._initialized=true;if(document.documentMode===7||$.ig.util.isIE7){$.each($("#"+this.id()+"_container colgroup col"),function(){var $col=$(this),styleWidth=parseInt(this.style.width,10),width=$col.outerWidth();if(styleWidth&&styleWidth<width){$col.width(2*styleWidth-width)}})}}this._fireInternalEvent("_gridRendered",this.container());if(this._isMultiRowGrid()&&this.scrollContainer()&&this.scrollContainer().height()===0){throw new Error($.ig.Grid.locale.scrollableGridAreaNotVisible)}if(isToRefreshUI){this._refreshUI()}},_updateContainersWidthOnGridWidthNull:function(){var $cntnr=this.container(),sum=0,j,cols,diff,displayCont;if(this.options.width===null&&$cntnr[0]&&$cntnr[0].style.width){cols=this.element.find("colgroup > col");if(cols.index("[data-skip]")>-1){for(j=0;j<cols.length;j++){sum+=parseInt(cols[j].style.width,10)||0}}else{sum=parseInt($cntnr[0].style.width,10)}$cntnr.css("width",sum);displayCont=this._vdisplaycontainer();if(displayCont.length>0){$cntnr.find("#"+this.id()+"_headers_v").css("width",sum+this._scrollbarWidth());$cntnr.css("width",sum+this._scrollbarWidth());displayCont.css("width",sum).css("max-width",sum);this._fixedfooters().css("width",sum+this._scrollbarWidth());this._virtualcontainer().find(">colgroup>col:first").attr("width",sum)}}},_refreshUI:function(){var self=this;self.container().hide();setTimeout(function(){self.container().show()},0)},_updateVirtualScrollContainer:function(){var h,e=this.element;this._totalRowCount=this._getTotalRowCount();if((this.options.virtualization||this.options.rowVirtualization)&&this._totalRowCount){if(this._avgRowHeight===undefined||this._avgRowHeight===null){this._avgRowHeight=this._calculateAvgRowHeight()}h=this._totalRowCount*this._avgRowHeight;if(this._scrollContainer().height()>=h){e.height("");if(this.options.virtualizationMode==="fixed"){e.find(".ui-iggrid-virtualrow").height(this._avgRowHeight)}this._setScrollContainerHeight(h)}else{if(this.options.virtualizationMode==="continuous"){e.height("");this._setScrollContainerHeight(h)}else{e.height(this._initialVirtualHeight)}}}},_hasColumnTemplates:function(){var i,hasTemplates=false,t;for(i=0;i<this.options.columns.length;i++){t=this.options.columns[i].template;if(t!==null&&t!==undefined&&t!==""&&t.length>0){hasTemplates=true;break}}return hasTemplates},_gridHasWidthInPixels:function(){if(typeof this.options.width==="string"&&this.options.width.indexOf("%")!==-1){return false}return parseInt(this.options.width,10)>0},_gridHasWidthInPercent:function(){if(typeof this.options.width==="string"&&this.options.width.indexOf("%")!==-1){return true}return false},_isColumnVirtualizationEnabled:function(){var i,w,o=this.options,cols,allColsInPercentage=true;if(!o.virtualization||o.virtualizationMode==="continuous"||o.width===null){return false}if(o.columnVirtualization){return true}cols=o.columns;for(i=0;i<cols.length;i++){if(cols[i].width){w=cols[i].width}w=_aNull(w)?o.defaultColumnWidth:w;if(!_aNull(w)&&($.type(w)!=="string"||!w.endsWith("%"))){allColsInPercentage=false;break}}if(!allColsInPercentage){return true}return false},hasVerticalScrollbar:function(){var hasVScrollbar;hasVScrollbar=this.options.autoAdjustHeight&&this.element.height()<=this.scrollContainer().height()||!this.options.autoAdjustHeight&&this.options.avgRowHeight*this.element[0].rows.length<parseInt(this.options.height,10);return!hasVScrollbar},_adjustLastColumnWidth:function(colgroupsRerendered){var grid=this,calcGridWidth,hasFixedHeader=this.options.height!==null&&this.options.fixedHeaders===true&&this.options.showHeader&&this._headerParent,hasFixedFooter=this.options.height!==null&&this.options.fixedFooters===true&&this.options.showFooter&&this._footerParent,hasHeight=this.options.height&&parseInt(this.options.height,10)>0,hasWidthInPixels=this._gridHasWidthInPixels(),hasWidthInPercent=this._gridHasWidthInPercent(),hasVirtualization=this.options.virtualization===true||this.options.columnVirtualization===true||this.options.rowVirtualization===true,gridWidth,specialColumnsWidth;if(hasHeight&&!hasVirtualization){if(this.hasVerticalScrollbar()){this._hasVerticalScrollbar=true}else{this._hasVerticalScrollbar=false;if(this._scrollWidthAddedToContainerWidth){this.container().width(this._calculateContainerWidth(false))}}}if(colgroupsRerendered){if(hasVirtualization){if(hasFixedHeader){this._headerParent.css(this._padding,this._scrollbarWidth())}if(hasFixedFooter){this._footerParent.css(this._padding,this._scrollbarWidth())}}if(hasWidthInPixels||hasWidthInPercent){if(this._allColumnWidthsInPixels){gridWidth=this._totalColPixelWidth;specialColumnsWidth=this._calculateSpecialColumnsWidth();if(specialColumnsWidth>0){if(this._autoadjustedColumn&&this._lastColPixelWidth){if(this._autoadjustedColumn.difference<specialColumnsWidth){this._lastColPixelWidth-=this._autoadjustedColumn.difference;gridWidth-=this._autoadjustedColumn.difference-specialColumnsWidth}else{this._lastColPixelWidth-=specialColumnsWidth}this._autoadjustedColumn.width=this._lastColPixelWidth;if(hasFixedHeader){this._lastHeaderCol.css("width",this._lastColPixelWidth+"px")}if(hasFixedFooter){this._lastFooterCol.css("width",this._lastColPixelWidth+"px")}this._lastDataCol.css("width",this._lastColPixelWidth+"px")}else{gridWidth+=specialColumnsWidth}}if(!hasFixedHeader&&this._gridWidthGTColWidth&&this._hasVerticalScrollbar){gridWidth-=this._scrollbarWidth();this._lastColPixelWidth-=this._scrollbarWidth();this._lastDataCol.css("width",this._lastColPixelWidth+"px")}}else if(this._allColumnWidthsInPercentage){gridWidth=this.container().width();specialColumnsWidth=this._calculateSpecialColumnsWidth();if(this._allSpecialColumnsInPercentage()===true&&specialColumnsWidth>0){this._lastColPercentWidth=this._lastColPercentWidth-specialColumnsWidth}this._lastDataCol.css("width",this._lastColPercentWidth+"%");if(hasFixedHeader){this._lastHeaderCol.css("width",this._lastColPercentWidth+"%")}if(hasFixedFooter){this._lastFooterCol.css("width",this._lastColPercentWidth+"%")}}else if(hasWidthInPixels){calcGridWidth=this._calculateContainerWidth(false);gridWidth=parseInt(grid.options.width,10);if(calcGridWidth>gridWidth){gridWidth=calcGridWidth}}else if(hasWidthInPercent){gridWidth=this.container().width()}if(!this._allColumnWidthsInPercentage||!hasWidthInPercent){if(hasVirtualization===false){this._gridInnerWidth=this.scrollContainer().width()}else{this._gridInnerWidth=this._vdisplaycontainer().width()+this._scrollbarWidth()}grid._setGridContentWidth(gridWidth);if(!this._hasVerticalScrollbar&&this.hasVerticalScrollbar()&&hasHeight&&!hasVirtualization){this._hasVerticalScrollbar=true;grid._setGridContentWidth(gridWidth)}}}}else{this._setGridContentWidth()}if(hasHeight&&!hasVirtualization){if(this.options.width!==null&&this.options.height!==null){if(this._hasVerticalScrollbar){this._hscrollbarcontent().css("overflow-y","scroll")}else{this._hscrollbarcontent().css("overflow-y","hidden")}}if(this._allColumnWidthsInPercentage&&hasWidthInPercent||!(hasWidthInPixels||hasWidthInPercent)){if(this._hasVerticalScrollbar){if(hasFixedHeader){this._headerParent.css(this._padding,this._scrollbarWidth())}if(hasFixedFooter){this._footerParent.css(this._padding,this._scrollbarWidth())}}else{if(hasFixedHeader){this._headerParent.css(this._padding,"")}if(hasFixedFooter){this._footerParent.css(this._padding,"")}}}else{this._updateVerticalScrollbarCellPadding()}}},_initializeHeights:function(){var initialHeight,hscrollerContainerHeight;if(this.options.height===null||this.options.height===undefined){return}initialHeight=parseInt(this.options.height,10);if(this.hasFixedColumns()){if(this.options.showHeader&&this.options.fixedHeaders===true&&this.options.height!==null){initialHeight-=this.fixedHeadersTable().height()}hscrollerContainerHeight=this._hscrollbar().height();if(this.fixedBodyContainer().height()<initialHeight+hscrollerContainerHeight){initialHeight-=hscrollerContainerHeight}}if(this.options.height.indexOf&&this.options.height.indexOf("%")!==-1){this.scrollContainer().height("100%")}else{this.scrollContainer().height(initialHeight)}this._initializeHeightsInternal()},_initializeHeightsInternal:function(){var children,height,i,$child,ch,heightChanged=false,dc=this._vdisplaycontainer(),sc=this._scrollContainer();ch=this.container().height();this._prevContainerHeight=ch;if(this.options.height!==null){children=this.container().children(":visible");height=0;for(i=0;i<children.length;i++){$child=$(children[i]);if(($child.attr("id")!==undefined&&!$child.attr("id").endsWith("_scroll")&&!$child.attr("data-fixed-container")&&!$child.attr("id").endsWith("_virtualContainer")&&!$child.attr("id").endsWith("_loading")||!$child.attr("id"))&&$child.is(":visible")&&$child.data("efh")!=="1"){if($child.is("table")&&$child.children().first().is("caption")){height+=$child.children().first().outerHeight()}else{if($child.css("position")!=="absolute"){height+=$child.outerHeight()}}}}if(height>0){this._trigger("_heightChanging",null,{ch:ch,h:height});this.scrollContainer().height(ch-height);heightChanged=true}if(this.options.virtualization||this.options.rowVirtualization){if($.type(this.options.height)==="string"&&this.options.height.indexOf("%")!==-1||ch!==parseInt(this.options.height,10)){this.container().height(this.options.height);if($.type(this.options.height)==="string"&&this.options.height.indexOf("%")!==-1){ch=parseInt(this.container().height(),10)}}height+=this.container().find("#"+this.id()+"_headers_v").outerHeight();height+=this.container().find("#"+this.id()+"_footers_v").outerHeight();height+=this._fixedfooters().outerHeight();height+=this._vhorizontalcontainer().outerHeight();if(!this._virtualHeightReset){height=height*2;this._virtualHeightReset=true}if(height>0&&dc.height()!==ch-height){if(!heightChanged){this._trigger("_heightChanging",null,{ch:ch,h:height})}dc.height(ch-height);sc.height(ch-height);if(!this.options.rowVirtualization||this.options.virtualizationMode!=="continuous"){this.element.height(ch-height)}this._initialVirtualHeight=ch-height;heightChanged=true}}if(heightChanged){this._trigger("_heightChanged",null,{ch:ch,h:height})}}},_registerAdditionalEvents:function(){if(this._hovEvts){return}var self=this;if(this.options.enableHoverStyles){this._hovEvts={mousemove:function(e){var par,tag,tr=e.target;while(tr){par=tr.parentNode;tag=tr.nodeName;if(tag==="TR"&&par.nodeName==="TBODY"){break}tr=tag==="TABLE"?null:par}self._mousemoveTr(tr,e)},mouseleave:function(){self._mouseleaveTr()}};this.element.bind(this._hovEvts)}},_mousemoveTr:function(tr,e){var css="ui-state-hover",topmostGrid,$tr=$(tr);if(_hovTR!==tr){if(_hovTR&&$(_hovTR).attr("data-container")!=="true"){$("td",_hovTR).removeClass(css)}if(tr&&$tr.attr("data-container")!=="true"&&e.target.id.indexOf("_scrollContainer")===-1&&e.target.parentNode.id.indexOf("_scrollContainer")===-1){topmostGrid=this.element.closest(".ui-iggrid-root").data("igGrid")||this;tr=$tr.add($tr.siblings("[data-id='"+$tr.attr("data-id")+"']"));if(!topmostGrid._cancelHoveringEffects){$("td",tr).addClass(css)}}_hovTR=tr}},_mouseleaveTr:function(){var css="ui-state-hover";if(_hovTR){$("td",_hovTR).removeClass(css);_hovTR=null}},_renderColgroup:function(table,isHeader,isFooter,autofitLastColumn,md){var colgroup,hasFixedColumns=this.hasFixedColumns(),i,lc,fixed=!!(md&&md.fixed),f,cols=this._visibleColumns(),col,defWidth=this.options.defaultColumnWidth,totalColWidth=0,totalGridWidth,hasWidthInPixels=this._gridHasWidthInPixels(),hasWidthInPercent=this._gridHasWidthInPercent(),hasWidth=hasWidthInPixels||hasWidthInPercent,hasVirtualization=this.options.virtualization===true||this.options.columnVirtualization===true||this.options.rowVirtualization===true,hasColumnVirtualization=this.options.virtualization===true&&this.options.virtualizationMode==="fixed"||this.options.columnVirtualization===true,hasColumnsWithNoWidth=false,isPercentage=true,desiredColWidth,desiredColWidthNumber,lastCol,lastColWidth,difference;colgroup=$(table).find("colgroup");if(colgroup.length===0){colgroup=$("<colgroup></colgroup>").prependTo(table)}if(hasVirtualization&&this.options.virtualizationMode==="fixed"||hasColumnVirtualization){this._updateVirtColCounters();cols=cols.slice(0,this._virtualColumnCount)}for(i=0;i<cols.length;i++){if(this._isMultiRowGrid()){col=$.extend(true,{},cols[i])}else{col=cols[i]}f=!!col.fixed;if(f!==fixed){continue}if(this._rlp&&i>=this._maxCols){break}if(this._colGroupWidths){col.width=this._colGroupWidths[i]}if(col.width||col.width===0){if(col.oWidth){desiredColWidth=col.oWidth}else{desiredColWidth=col.width}}else{desiredColWidth=defWidth;col.width=defWidth}if(desiredColWidth||desiredColWidth===0){if(!desiredColWidth.charAt||!desiredColWidth.endsWith("%")){isPercentage=false}desiredColWidthNumber=parseInt(desiredColWidth,10);if(desiredColWidthNumber<0||isNaN(desiredColWidthNumber)){desiredColWidthNumber=undefined}}else{desiredColWidthNumber=undefined;isPercentage=false}if(!_aNull(desiredColWidthNumber)){lastCol=$("<col></col>").appendTo(colgroup).css("width",desiredColWidth);lastColWidth=desiredColWidthNumber;totalColWidth+=desiredColWidthNumber;if($.type(col.width)==="string"&&col.width.endsWith("px")){col.width=desiredColWidthNumber+"px"}else{col.width=desiredColWidthNumber}if(desiredColWidth&&desiredColWidth.charAt&&desiredColWidth.endsWith("%")){col.width=col.width+"%"}}else{lastCol=$("<col></col>").appendTo(colgroup);lastColWidth=undefined;hasColumnsWithNoWidth=true}lc=col}if((!hasColumnVirtualization||this._vhorizontalcontainer().find("div").length===0)&&autofitLastColumn&&hasWidth&&!hasColumnsWithNoWidth&&lastColWidth){if(isPercentage){if(totalColWidth<100){lastColWidth+=100-totalColWidth;lastCol.css("width",lastColWidth+"%");this._autoadjustedColumn=cols.slice(-1)[0];if(!this._autoadjustedColumn.oWidth){this._autoadjustedColumn.oWidth=this._autoadjustedColumn.width}this._autoadjustedColumn.width=lastColWidth+"%";lc.width=lastColWidth+"%"}}else{if(hasWidthInPixels){totalGridWidth=parseInt(this.options.width,10)}else if(hasWidthInPercent){totalGridWidth=this.container().width()}if(hasFixedColumns&&totalGridWidth){totalGridWidth-=this.fixedContainer().outerWidth();totalGridWidth-=hasVirtualization?parseFloat(this._virtualcontainer().children("colgroup").children("[data-fixed-col]").css("width")):0;totalGridWidth-=hasVirtualization&&this.fixingDirection()==="right"&&!fixed?parseFloat(this._virtualcontainer().children("colgroup").children().last().css("width")):0}this._gridWidthGTColWidth=false;if(totalGridWidth&&totalGridWidth>totalColWidth){difference=totalGridWidth-totalColWidth;lastColWidth+=difference;totalColWidth+=difference;lastCol.css("width",lastColWidth+"px");this._autoadjustedColumn=lc;if(!this._autoadjustedColumn.oWidth){this._autoadjustedColumn.oWidth=this._autoadjustedColumn.width}this._autoadjustedColumn.width=lastColWidth+"px";this._autoadjustedColumn.difference=difference;lc.width=lastColWidth+"px";this._gridWidthGTColWidth=true}else{this._autoadjustedColumn=undefined}}}else{this._autoadjustedColumn=undefined}this._allColumnWidthsInPercentage=isPercentage&&!hasColumnsWithNoWidth&&cols.length>0;this._allColumnWidthsInPixels=!isPercentage&&!hasColumnsWithNoWidth&&cols.length>0;if(hasWidth&&hasVirtualization&&!hasColumnsWithNoWidth&&lastColWidth){if(!isPercentage&&(!hasFixedColumns||!fixed&&this.fixingDirection()==="left")){if(this.options.autofitLastColumn||!this.options.rowVirtualization||this._applyAutofitLastColInVirtGrid(totalColWidth)){lastColWidth-=this._scrollbarWidth();lastCol.css("width",lastColWidth+"px")}}}if(isHeader){this._lastHeaderCol=lastCol}if(isFooter){this._lastFooterCol=lastCol}if(!isHeader&&!isFooter){this._lastDataCol=lastCol}if(this._allColumnWidthsInPixels){this._lastColPixelWidth=lastColWidth;this._totalColPixelWidth=totalColWidth}else if(this._allColumnWidthsInPercentage){this._lastColPercentWidth=lastColWidth;this._totalColPixelWidth=undefined}else{this._lastColPixelWidth=undefined;this._totalColPixelWidth=undefined}},_renderRecordsForTable:function(start,end,table,tbody,isFixed){var i,d="",ds=this._getDataView(),grid=this,tbodytmp,ph,rrFunc;if(this._rlp){rrFunc=grid._renderRecordFromLayout}else{rrFunc=grid._renderRecord}tbody=tbody||table.children("tbody");if(!tbody.length){return}for(i=start;i<=end;i++){d+=rrFunc.apply(this,[ds[i],i,isFixed])}if(!this._canreplaceinner||$.ig.util.isWebKit){ph=document.createElement("div");ph.innerHTML="<table><tbody class='"+this.css.baseContentClass+" "+this.css.gridTableBodyClass+" "+this.css.recordClass+"' role='rowgroup'>"+d+"</tbody></table>";tbodytmp=ph.firstChild.firstChild;table[0].replaceChild(tbodytmp,tbody[0])}else if(this._canreplaceinner){MSApp.execUnsafeLocalFunction(function(){tbody[0].innerHTML=d})}d=""},_renderRecords:function(start,end){var tbody=this.element.children("tbody"),noCancelInternal=true,ds=this._getDataView(),noCancel=true;noCancelInternal=this._trigger("_rowsRendering",null,{owner:this,tbody:tbody,vrtWnd:{start:start,end:end}});if(noCancelInternal){noCancel=this._trigger(this.events.rowsRendering,null,{owner:this,tbody:tbody,vrtWnd:{start:start,end:end}});if(start===undefined){start=0;end=ds.length-1}if(start!==undefined&&end===undefined){end=start;if(end>ds.length-1){end=ds.length-1}start=0}if(start<0){start=0}if(end>ds.length-1){end=ds.length-1}if(noCancel){this._renderRecordsForTable(start,end,this.element);this._buildVirtualDomForContinuousVirtualization();this._trigger(this.events.rowsRendered,null,{owner:this,tbody:tbody});if((this.options.virtualization===false||this.options.rowVirtualization===false)&&this._persistVirtualScrollTop&&this._prevFirstVisibleTROffset&&this.scrollContainer().length>0){this.scrollContainer()[0].scrollTop=this._prevFirstVisibleTROffset}}}},autoSizeColumns:function(){var cols=this._visibleColumns(),colsToResize=[];$.each(cols,function(ind,col){if((col.width==="*"||col._oWidth==="*")&&!col.hidden){colsToResize.push({column:col,visibleIndex:ind})}});if(colsToResize.length>0){this._calculateAutoResizableWidths(colsToResize);this._rerenderColgroups(false);this._updateGridContentWidth()}},_calculateAutoResizableWidths:function(columns){if(!columns||!columns.length){return[]}var rowsContainer=this.element,$parentDiv,col,cell,w,clientRect,cols,i,index,$firstRowCells,$table,$measureDiv,html,$thead,$tfoot;$parentDiv=rowsContainer.closest("div");html=$parentDiv.html();$measureDiv=$("<div></div>").attr("style",$parentDiv.attr("style")).attr("class",$parentDiv.attr("class")+" "+this.container().attr("class"));$measureDiv.css({position:"absolute",resize:"both",visibility:"hidden",height:"auto",width:"auto",left:-6e3,top:-6e3}).appendTo($(document.body));$measureDiv.html(html);$table=$measureDiv.find(">table");if(this._initialized){cols=$table.find(">colgroup>col:not([data-skip])");if(cols.length){for(i=0;i<columns.length;i++){index=columns[i].visibleIndex;$(cols[index]).css("width","")}}}if(this.options.fixedHeaders&&this.options.showHeader){$thead=this.headersTable().find(">thead");if($thead.length){$($thead[0].outerHTML).appendTo($table)}}if(this.options.fixedFooters&&this.options.showFooter){$tfoot=this.footersTable().find(">tfoot");if($tfoot.length){$($tfoot[0].outerHTML).appendTo($table)}}$table.css("width","auto").attr("id",$table.attr("id")+"__");$firstRowCells=$table.find("tbody>tr:not([data-grouprow='true']):first").children("td:not([data-skip]):not([data-parent])");if(!$firstRowCells.length){$firstRowCells=$table.find("tr:visible:not([data-grouprow='true']):first").children("th:not([data-skip]):not([data-parent]), td:not([data-skip]):not([data-parent])")}if(!$firstRowCells.length){return}for(i=0;i<columns.length;i++){col=columns[i].column;index=columns[i].visibleIndex;cell=$firstRowCells[index];clientRect=cell.getBoundingClientRect();w=clientRect.width;if(w!==undefined){col.width=Math.ceil(w)}else{col.width=Math.ceil(clientRect.right-clientRect.left)}col._oWidth="*"}$measureDiv.remove();return columns},calculateAutoFitColumnWidth:function(columnIndex){var rows,isFixed,columnKey,col,hasFixedCols=this.hasFixedColumns(),rowsContainer=this.element,visibleColumns,cells=[],visibleIndex=columnIndex,maxWidth=0,measureDiv,i;if(hasFixedCols){visibleColumns=this._visibleColumns();col=visibleColumns[columnIndex];if(!col){return-1}isFixed=col.fixed===true;columnKey=col.key;visibleIndex=this.getVisibleIndexByKey(columnKey);if(isFixed){rowsContainer=this.fixedBodyContainer().find("table")}}rows=rowsContainer.find("> tbody > tr").not("[data-container=true]").not("[data-grouprow=true]");for(i=0;i<rows.length;i++){cells.push(rows.eq(i).children("td").not("[data-skip=true]").not(".ui-iggrid-rowselector-class").not(".ui-iggrid-expandcolumn").eq(visibleIndex))}if(cells.length>0){measureDiv=$("<div></div>").css({position:"absolute",visibility:"hidden",height:"auto",width:"auto",left:-1e3,top:-1e3,"font-family":cells[0].css("fontFamily"),"font-size":cells[0].css("fontSize"),"font-size-adjust":cells[0].css("fontSizeAdjust"),"font-stretch":cells[0].css("fontStretch"),"font-style":cells[0].css("fontStyle"),"font-variant":cells[0].css("fontVariant"),"font-weight":cells[0].css("fontWeight")}).appendTo($(document.body));for(i=0;i<cells.length;i++){measureDiv.html(cells[i][0].innerHTML);maxWidth=Math.max(maxWidth,measureDiv[0].offsetWidth)}maxWidth=maxWidth+cells[0].outerWidth()-cells[0].width();if($.ig.util.isIE){maxWidth+=1}measureDiv.remove();return maxWidth}return-1},_reapplyZebraStyle:function(from){var dataRows,toChange;if(!this.options.alternateRowStyles){return}dataRows=this.element.children("tbody").children("tr:not([data-container],[data-grouprow],[data-new-row])");from=from||0;toChange=dataRows.slice(from);toChange.filter(from%2===0?":odd":":even").addClass(this.css.recordAltClass);toChange.filter(from%2===0?":even":":odd").removeClass(this.css.recordAltClass);if(this.hasFixedColumns()){dataRows=this.fixedContainer().find("tbody").children("tr:not([data-container],[data-grouprow])");toChange=dataRows.slice(from);toChange.filter(from%2===0?":odd":":even").addClass(this.css.recordAltClass);toChange.filter(from%2===0?":even":":odd").removeClass(this.css.recordAltClass)}},_buildFormatters:function(){var i,cols=this.options.columns,ret={};for(i=0;i<cols.length;i++){if(cols[i].formatter!==undefined){if($.type(cols[i].formatter)==="function"){ret[cols[i].key+"Formatter"]=cols[i].formatter}else if(window[cols[i].formatter]&&typeof window[cols[i].formatter]==="function"){ret[cols[i].key+"Formatter"]=window[cols[i].formatter]}}}return ret},getVisibleIndexByKey:function(columnKey,includeDataSkip){var hasFixedColumns=this.hasFixedColumns(),fixedCounters,unfixedCounters,prevColumn,cols=this._visibleColumns(),index=-1,fixed=false,$colgroup;if(hasFixedColumns){fixedCounters=0;unfixedCounters=0;prevColumn=null;$.each(cols,function(ind,value){var isFixed=value.fixed===true,prevColumnFixed=prevColumn&&prevColumn.fixed===true;if(prevColumn===null||prevColumnFixed!==isFixed){if(value.fixed===true){fixedCounters=0}else{unfixedCounters=0}}prevColumn=value;if(value.hidden){return true}if(isFixed!==true){unfixedCounters++}else{fixedCounters++}if(value.key===columnKey){if(isFixed){fixed=true;index=fixedCounters-1}else{index=unfixedCounters-1}if(index===-1){index=0}return false}})}else{$.each(cols,function(ind,value){if(value.key===columnKey){index=ind;return false}})}if(index===-1){return-1}if(includeDataSkip){if(fixed){$colgroup=$("#"+this.id()+"_fixed").find("colgroup:first")}else{$colgroup=this.element.find("colgroup:first")}index+=$colgroup.children("col[data-skip]").length}return index},_isColumnHidden:function(columnKey){var cols=this.options.columns,i=cols.length;while(i-->=0){if(cols[i].key===columnKey){return cols[i].hidden||false}}return true},_visibleColumns:function(isFixed,cols){cols=cols||this.options.columns;if(isFixed!==undefined){return $.grep(cols,function(col){var fixed=col.fixed===true;return!col.hidden&&fixed===isFixed})}if(this._visibleColumnsArray===undefined){this._visibleColumnsArray=$.grep(cols,function(col){return!col.hidden})}return this._visibleColumnsArray},_visibleMchColumns:function(curLvl){var vmch=[],cl=curLvl||this._oldCols,self=this;if(!cl){return null}$.each(cl,function(){if(!this.hidden||this.hidden===false){vmch.push($.extend({},this));if(this.group){vmch[vmch.length-1].group=self._visibleMchColumns(this.group)}}});return vmch},_renderVirtualRecordsFixed:function(){var noVirtualDom=this._virtualDom===null||this._virtualDom===undefined;if(this.hasFixedColumns()){this._updateVirtColCounters(true);this._renderVirtualRecordsFixedInternal(true);this._updateVirtColCounters(false)}this._renderVirtualRecordsFixedInternal(false);this._trigger("virtualrecordsrender",null,{owner:this,tbody:this.element.children("tbody"),dom:this._virtualDom,isBuiltVirtualDom:!noVirtualDom})},_renderVirtualRecordsFixedInternal:function(isFixed){var i,j,row,c,headerText,vheaderNode,trs,iRow,tr,ds=this.dataSource,data=ds.dataView(),key=this.options.primaryKey,vd=this._getVirtualDom(isFixed),col,noVirtualDom=vd===null||vd===undefined,visibleCols=this._visibleColumns(isFixed);if(this._startRowIndex===undefined||this._startRowIndex===null){this._startRowIndex=0}if(this._startColIndex===undefined||this._startColIndex===null){this._startColIndex=0}if(noVirtualDom){if(!this._persistVirtualScrollTop&&!this._startRowIndex){this._scrollTo(0,true)}this._buildVirtualDom();if(this._startRowIndex){this._updateVirtColCounters(isFixed)}vd=this._getVirtualDom(isFixed);if(this.options.adjustVirtualHeights===true){this._adjustVirtualHeights()}}if(!noVirtualDom||noVirtualDom&&this._startRowIndex>0){if(this._virtualColumnCount){for(i=0;i<this._virtualRowCount&&i<this._totalRowCount&&this._startRowIndex+i<data.length;i++){if($.type(data[i])==="array"){row=$(this._renderRecord([data[this._startRowIndex+i]],i,isFixed))}else{row=$(this._renderRecord(data[this._startRowIndex+i],i,isFixed))}c=row.children();for(j=0;j<this._virtualColumnCount;j++){vd[i][j].innerHTML=c[j+this._startColIndex].innerHTML;vd[i][j].className=c[j+this._startColIndex].className;vd[i][j].setAttribute("aria-describedby",c[j+this._startColIndex].getAttribute("aria-describedby"));vd[i][j].setAttribute("aria-readonly",c[j+this._startColIndex].getAttribute("aria-readonly"))}iRow=this._startRowIndex+i;tr=vd[i][0].parentNode;tr.className=i%2===0&&this.options.alternateRowStyles?"ui-iggrid-virtualrow ui-ig-altrecord":"ui-iggrid-virtualrow";if(data[iRow]){if(!_aNull(key)){tr.setAttribute("data-id",this._kval_from_key(key,data[iRow]))}else if(!_aNull(data[iRow].ig_pk)){tr.setAttribute("data-id",data[iRow].ig_pk)}}}}else if(isFixed){trs=this.fixedBodyContainer().find("tbody>tr");for(i=0;i<this._virtualRowCount&&i<this._totalRowCount&&this._startRowIndex+i<data.length;i++){iRow=this._startRowIndex+i;tr=trs.eq(i)[0];if(_aNull(tr)){continue}tr.className=i%2===0&&this.options.alternateRowStyles?"ui-iggrid-virtualrow ui-ig-altrecord":"ui-iggrid-virtualrow";if(data[iRow]){if(!_aNull(key)){tr.setAttribute("data-id",this._kval_from_key(key,data[iRow]))}else if(!_aNull(data[iRow].ig_pk)){tr.setAttribute("data-id",data[iRow].ig_pk)}}}}}if(this._isHorizontal){this._isHorizontal=false;if((this.options.virtualization===true||this.options.columnVirtualization===true)&&parseInt(this.options.width,10)>0){if(!this._vheaders){this._vheaders=this.headersTable().find("thead > tr > th > span.ui-iggrid-headertext")}for(i=0;i<visibleCols.length;i++){col=visibleCols[i];if(col.headerCssClass){this.headersTable().find("th."+col.headerCssClass).removeClass(col.headerCssClass)}}for(j=0;j<this._virtualColumnCount;j++){headerText=visibleCols[j+this._startColIndex].headerText;vheaderNode=$(this._vheaders[j]);vheaderNode.closest("th").attr("id",this.element[0].id+"_"+visibleCols[j+this._startColIndex].key);vheaderNode.parent().addClass(visibleCols[j+this._startColIndex].headerCssClass||"");vheaderNode.html(headerText)}}}},_updateVirtColCounters:function(isFixed){var visibleColsLength=this._visibleColumns(isFixed).length;if(this.options.columns){this._totalColumnCount=visibleColsLength;this._maxVirtualColumnCount=this.options.columns.length}else{this._totalColumnCount=this.dataSource.dataView()[0].length;this._maxVirtualColumnCount=this._totalColumnCount}if(this.options.columnVirtualization===false&&this.options.virtualization===false){this._virtualColumnCount=visibleColsLength}else{if(this.options.width===null){this._virtualColumnCount=this._totalColumnCount}else{this._virtualColumnCount=Math.ceil(parseInt(this.options.width,10)/this._avgColumnWidth());this._maxVirtualColumnCount=Math.min(this._maxVirtualColumnCount,this._virtualColumnCount);this._virtualColumnCount=Math.min(this._totalColumnCount,this._virtualColumnCount);
this._vhorizontalcontainer().children().first().css("width",this._calculateContainerWidth(false))}}if(this.options.virtualizationMode==="continuous"){this._virtualColumnCount=undefined}},_getVirtualDom:function(isFixed){if(!isFixed){return this._virtualDom}return this._fixedVirtualDom},_resetVirtualDom:function(){this._virtualDom=null;this._fixedVirtualDom=null},_buildVirtualDom:function(){var fixed,trs,fixedTrs;if(this.hasFixedColumns()){fixedTrs=this._buildVirtualDomInternal(true);fixed=false}trs=this._buildVirtualDomInternal(fixed);this._trigger("virtualdombuilt",null,{rows:trs,fixedRows:fixedTrs})},_buildVirtualDomInternal:function(isFixed){var grid=this,markup="",row,i,j,dataLinkFn,shouldHide=false,$tbody,visibleCols=this._visibleColumns(isFixed),key=this.options.primaryKey,data=this.dataSource.dataView(),temp,vd=this._getVirtualDom(isFixed),startIndex=0;if(this._startRowIndex===undefined||this._startRowIndex===null){this._startRowIndex=0;this._startColIndex=0}vd=[];if(!isFixed){this._virtualDom=vd}else{this._fixedVirtualDom=vd}this._totalRowCount=data.length;if(this.options.height===null){this._virtualRowCount=this._totalRowCount}else{if(this.options.height.indexOf&&this.options.height.indexOf("%")!==-1){this._virtualRowCount=Math.floor(this._vdisplaycontainer().innerHeight()/parseInt(this.options.avgRowHeight,10))}else{this._virtualRowCount=Math.floor(this._vdisplaycontainer().innerHeight()/parseInt(this.options.avgRowHeight,10))}}this._updateVirtColCounters(isFixed);if(this.options.height!==null){this._setScrollContainerHeight(this._totalRowCount*parseInt(this.options.avgRowHeight,10))}dataLinkFn=function(row,i,vc){for(j=0;j<vc;j++){if(j<grid._totalColumnCount){vd[i][j]=row[0].cells[j]}}};if(this._persistVirtualScrollTop){if(this._startRowIndex>this.dataSource.dataView().length-this._virtualRowCount){if(this.dataSource.dataView().length-this._virtualRowCount>0){this._startRowIndex=this.dataSource.dataView().length-this._virtualRowCount}else{this._startRowIndex=0}}startIndex=this._startRowIndex}if(isFixed){this.element.children("tbody").empty();$tbody=this.fixedBodyContainer().find("tbody")}else{$tbody=this.element.children("tbody")}$tbody.empty();for(i=0;i<this._virtualRowCount;i++){shouldHide=false;vd[i]=[];markup="";for(j=this._startColIndex;j<this._virtualColumnCount+this._startColIndex;j++){if(j>=this._totalColumnCount){break}markup+='<td role="gridcell" aria-readonly="'+!!visibleCols[j].readOnly+'" aria-describedby="'+this.id()+"_"+visibleCols[j].key+'" tabindex="'+this.options.tabIndex+'"';if(!data[startIndex+i]){shouldHide=true;markup+="></td>"}else{if(this.options.autoFormat!==false){if(visibleCols[j].template&&visibleCols[j].template.length){temp=this._renderTemplatedCell(data[startIndex+i],visibleCols[j]);if(temp.indexOf("<td")===0){markup+=temp.substring(3)}else{markup+=">"+temp}markup=grid._editCellStyle(markup,data[startIndex+i],visibleCols[j].key||j)}else{markup+=grid._addCellStyle(data[startIndex+i],visibleCols[j].key||j,visibleCols[j])+">"+this._renderCell(data[startIndex+i][visibleCols[j].key],visibleCols[j],data[startIndex+i])}}else{markup+=grid._addCellStyle(data[startIndex+i],visibleCols[j].key,visibleCols[j])+">"+data[i][visibleCols[j].key]}markup+="</td>"}}row=$("<tr>"+markup+"</tr>").appendTo($tbody);if(shouldHide){row.css("visibility","hidden")}if(i%2===0&&this.options.alternateRowStyles){row.addClass("ui-ig-altrecord")}row.addClass("ui-iggrid-virtualrow");if(i%2===0&&this.options.alternateRowStyles){row.addClass("ui-ig-altrecord")}row.attr("role","row");row.attr("tabindex",this.options.tabIndex);if(data[i+startIndex]){if(!_aNull(key)){row.attr("data-id",this._kval_from_key(key,data[i+startIndex]))}else if(!_aNull(data[i+startIndex].ig_pk)){row.attr("data-id",data[i+startIndex].ig_pk)}}dataLinkFn(row,i,this._virtualColumnCount);if(i===data.length-1){break}}this._updateVirtualScrollContainer();return $tbody.children("tr")},_adjustVirtualHeights:function(){var c=this._vdisplaycontainer(),tbody=c.find("tbody"),h=tbody.children().first().height();if(this.options.height===null){return}if(this.options.avgRowHeight!==h){this.options.avgRowHeight=h;this._buildVirtualDom()}},_verticalScroller:function(){if(!this._verticalScrollerObj||this._verticalScrollerObj.length===0){this._verticalScrollerObj=this._scrollContainer().children().first()}return this._verticalScrollerObj},_hscrollbar:function(){return this.container().find("#"+this.id()+"_hscroller_container")},_hscrollbarcontent:function(){return this.container().find("#"+this.id()+"_hscroller")},_hscrollbarinner:function(){return this.container().find("#"+this.id()+"_hscroller_inner")},_avgColumnWidth:function(){var width=0,cols=this.options.columns,count=cols.length,def=this.options.defaultColumnWidth,i;if(this.options.avgColumnWidth!==null){return parseInt(this.options.avgColumnWidth,10)}for(i=0;i<count;i++){width+=parseInt(cols[i].width,10)}if((count===0||isNaN(width))&&def){return parseInt(def,10)}if(count>0&&this.options.autoGenerateColumns&&isNaN(width)){if(this.options.width===null||this.options.width===undefined){throw new Error($.ig.Grid.locale.columnVirtualizationRequiresWidth)}return parseInt(this.options.width,10)/count}if(width===0||width<def){return def}if(isNaN(width)){width=100}return width/count},_registerScrllCntnrToSync:function($container){var name=$container.data("containerName");this._scrllCntrsToSync=this._scrllCntrsToSync||{};this._scrllCntrsToSync[name]=$container},_syncScrollLeft:function(scrLeft,ignoreContainer){var name,$container,containers=this._scrllCntrsToSync;for(name in containers){if(containers.hasOwnProperty(name)){if(name===ignoreContainer){continue}$container=containers[name];$container.scrollLeft(scrLeft)}}},_onScrollContainer:function(event){var $container=$(event.target),containerName,$hScrollBar,scrLeft=$container.scrollLeft();if(scrLeft!==this._scrollLeft){containerName=$container.data("containerName");this._syncScrollLeft(scrLeft,containerName);if($.ig.util.isIE&&containerName!=="hScrollbar"&&containerName!=="vScrollbar"){$hScrollBar=this._scrllCntrsToSync.vScrollbar||this._scrllCntrsToSync.hScrollbar;if($hScrollBar&&$hScrollBar.scrollLeft()!==scrLeft){this._synchronizeHScroll();return}}this._scrollLeft=scrLeft}},_renderCaption:function(){var colgroup,caption,tbl,scrollc;if(this.options.caption!==null){if(this.container().find(".ui-iggrid-headercaption").length>0){return}if(this.options.fixedHeaders===true&&this.options.showHeader===true){colgroup=this.headersTable().children("colgroup").first();if(colgroup.length===0){caption=$("<caption></caption>").prependTo(this.headersTable())}else{caption=$("<caption></caption>").insertAfter(colgroup)}caption.text(this.options.caption).attr("id",this.id()+"_caption").addClass(this.css.gridHeaderCaptionClass)}else{scrollc=this.scrollContainer();if(scrollc.length===0){tbl=$("<table></table>").prependTo(this.container())}else{tbl=$("<table></table>").insertBefore(scrollc)}caption=$("<caption></caption>").appendTo(tbl.css("width","100%").addClass(this.css.captionTable)).text(this.options.caption).attr("id",this.id()+"_caption").addClass(this.css.gridHeaderCaptionClass)}caption.parent().css("margin",0)}},_renderFixedCaption:function(){var colgroup,caption;if(this.options.caption!==null){if(this.options.fixedHeaders===true&&this.options.showHeader===true){colgroup=this.fixedHeadersTable().children("colgroup").first();if(colgroup.length===0){caption=$("<caption></caption>").prependTo(this.fixedHeadersTable())}else{caption=$("<caption></caption>").insertAfter(colgroup)}caption.css("white-space","nowrap").text(this.options.caption).attr("id",this.id()+"_caption_fixed").addClass(this.css.gridHeaderCaptionClass)}caption.parent().css("margin",0)}},_createHeaderColumnMarkup:function(column,index){var headerClass=this.css.headerClass,customClass=column.headerCssClass?column.headerCssClass:"",headerText=$("<span>"+column.headerText+"</span>").addClass(this.css.headerTextClass),markup="<th></th>";return $(markup).append(headerText).attr({id:this.id()+"_"+column.key,role:"columnheader","aria-label":column.headerText,tabIndex:this.options.tabIndex}).addClass(headerClass).addClass(customClass).data("columnIndex",index)},_updateHeaderColumnIndexes:function(){var grid=this,cols=this.options.columns;if(this.options.virtualization===true&&this.options.virtualizationMode==="fixed"||this.options.columnVirtualization===true){cols=cols.slice(0,this._maxVirtualColumnCount)}grid._initialHiddenCells=this._initialized?[]:grid._initialHiddenCells;$(cols).each(function(i){grid.container().find("#"+grid.id()+"_"+this.key).data("columnIndex",i)})},_renderHeaderColumns:function(header){var grid=this,cols=this.options.columns;if(this.options.virtualization===true&&this.options.virtualizationMode==="fixed"||this.options.columnVirtualization===true){cols=cols.slice(0,this._maxVirtualColumnCount)}grid._initialHiddenCells=[];$(cols).each(function(i){var headerCell,key=this.key;if(key){headerCell=grid._createHeaderColumnMarkup(this,i);header.append(headerCell);grid._trigger(grid.events.headerCellRendered,null,{owner:grid,th:headerCell,columnKey:this.key});$.each(grid._initialHiddenColumns,function(){if(this.key===key){grid._initialHiddenCells.push(headerCell);headerCell.css("display","none");return false}})}})},renderMultiColumnHeader:function(cols){var topmostGrid,layout;this.options.columns=cols;this.destroy(true);this._initialized=false;this.options.requiresDataBinding=true;this._renderHeaderCalled=false;if(this._isHierarchicalGrid){topmostGrid=this.element.closest(".ui-iggrid-root").data("igHierarchicalGrid");if(topmostGrid){if(topmostGrid.element[0].id!==this.element[0].id&&this.options.key){layout=topmostGrid._findLayout(topmostGrid.options.columnLayouts,this.options.key);layout.columns=cols;topmostGrid._setOption("columnLayouts",topmostGrid.options.columnLayouts);topmostGrid._create();return}topmostGrid._regevents(topmostGrid.element,topmostGrid)}}this._create()},_renderHeaderLayout:function(thead){var i,j,t=this._rlp,l,cell,hrow,col,headerCell;thead.empty();for(i=0;i<t.length;i++){l=t[i];hrow=$("<tr></tr>").attr("data-header-row",true).attr("role","row").appendTo(thead);for(j=0;j<l.length;j++){cell=l[j];if(cell.col){col=cell.col}else{col=this.columnByKey(cell.key);cell.col=col}headerCell=this._createHeaderColumnMarkup(col,i*j+j).attr("colspan",cell.cs).attr("rowspan",cell.rs);hrow.append(headerCell);this._trigger(this.events.headerCellRendered,null,{owner:this,th:headerCell,columnKey:col.key})}}},_renderHeader:function(){var w,header,id,headerDom,headerMarkup="",scrollc=this.scrollContainer(),noCancel=true,fHeader=false,headerParent=this.element[0],width,headerScrollDiv,existingHeader,o=this.options,v=o.virtualization===true||o.rowVirtualization===true||o.columnVirtualization===true;this._renderHeaderCalled=true;if(this.options.showHeader){noCancel=this._trigger(this.events.headerRendering,null,{owner:this});if(noCancel){this._rmvClgrpOnInitRenderData=true;id=this.id();headerMarkup="<thead role='rowgroup'><tr data-header-row role='row'></tr></thead>";headerParent=this.container();width=scrollc.css("width");if(this.options.fixedHeaders&&this.options.height!==null){if(v===false){if(headerParent.length===0){scrollc.removeClass(this.css.gridClasses).removeClass(this.css.baseClasses).css("width","").wrap("<div id='"+id+"_container'></div>");headerParent=this.container().addClass(this.css.baseClasses).addClass(this.css.gridClasses).css("width",width);this._isWrapped=true}}else{width=this.element.parents(".ui-widget").css("width");headerParent=this.container().find("#"+id+"_headers_v");if(o.width!==null){w=o.width;w=w.indexOf&&w.indexOf("%")!==-1?"100%":w;headerParent.css("width",w).css("max-width",w).css("overflow-x","hidden")}}headerParent=$("<table id='"+id+"_headers'></table>").prependTo(headerParent).addClass(this._isMultiRowGrid()?this.css.mrlGridHeaderTableClass:this.css.gridHeaderTableClass).attr("cellpadding",0).attr("cellspacing",0).attr("border","0");if(v===false){headerScrollDiv=$("<div></div>").prependTo(headerParent.parent());headerScrollDiv.css("overflow","hidden").css("position","relative").css("white-space","nowrap");headerScrollDiv.addClass("ui-widget-header ui-helper-reset");headerScrollDiv.append(headerParent)}else if(this.options.rowVirtualization===true){headerParent.addClass("ui-widget-header ui-helper-reset")}this.headersTable().parent().data("containerName","headerContainer").bind("scroll.syncScrollContainers",$.proxy(this._onScrollContainer,this));this._registerScrllCntnrToSync(this.headersTable().parent());fHeader=true;this._rmvClgrpOnInitRenderData=false}else if(this.options.fixedHeaders!==true){headerParent=this.element}if(this.options.width===null&&this.options.height===null){headerParent=this.element}if(this.options.width!==null&&this.options.height===null){this._fixScrollY=1;scrollc.css("overflow-y","hidden").css("overflow-x","auto");headerParent=this.element}if(!headerParent.find("colgroup").length){this._renderColgroup(headerParent,fHeader,false,this.options.autofitLastColumn)}if(this._isMultiColumnGrid===true){this._headerParent=headerParent;this._fireInternalEvent("_renderingMultiColumnHeader");if(this.options.virtualization===true||this.options.rowVirtualization===true){this.container().find("#"+id+"_headers_v").css("position","relative").addClass("ui-widget-header ui-helper-reset").addClass(this.css.baseClasses);headerParent.addClass(this._isMultiRowGrid()?this.css.mrlGridHeaderTableClass:this.css.gridHeaderTableClass).attr("cellpadding",0).attr("cellspacing",0).attr("border","0")}}else{if(this.options.headerTemplate===null||this.options.headerTemplate===undefined){if(this.options.virtualization===true||this.options.rowVirtualization===true){this.container().find("#"+id+"_headers_v").css("position","relative").addClass("ui-widget-header ui-helper-reset").addClass(this.css.baseClasses);headerParent.addClass(this._isMultiRowGrid()?this.css.mrlGridHeaderTableClass:this.css.gridHeaderTableClass).attr("cellpadding",0).attr("cellspacing",0).attr("border","0")}this.element.find(">thead").remove();existingHeader=headerParent.find(">thead");if(existingHeader.length===0){header=$(headerMarkup).appendTo(headerParent).children().first()}else{existingHeader.empty();header=$('<tr data-header-row role="row"></tr>').appendTo(existingHeader)}if(this._rlp){this._renderHeaderLayout(header.parent())}else{this._renderHeaderColumns(header)}}else{headerDom=this.options.headerTemplate;if(this.options.virtualization===true||this.options.rowVirtualization===true){$(headerDom).children().each(function(){this.appendTo(this.container().find("#"+id+"_headers"))});header=this.headersTable().addClass(this.css.gridClasses)}else{header=$(headerMarkup).appendTo(headerParent).append(headerDom)}}this._headerParent=headerParent;this._trigger(this.events.headerRendered,null,{owner:this,table:this.headersTable()});this._headerRenderCancel=false}}else{this._headerRenderCancel=true}}this._trigger("headerRenderedInternal",null,{owner:this,table:this.headersTable()})},_renderFooter:function(){var gridId=this.id(),w,o=this.options,elemParent,footerId=gridId+"_footer_container",footerMarkup='<tfoot role="rowgroup" class="'+this.css.gridFooterClass+'"></tfoot>',$footer=this.container().find("#"+footerId),$table,width,noCancel,tableGrid=this.element,$tableGridContainer;if(tableGrid.length===0){return}if($footer.length===0&&o.showFooter){noCancel=this._trigger(this.events.footerRendering,null,{owner:this});if(noCancel){if((o.virtualization===true||o.rowVirtualization===true||o.columnVirtualization===true)&&(o.height!==null&&o.height!==undefined||o.width!==null&&o.width!==undefined)){$tableGridContainer=this._vdisplaycontainer();this.options.fixedFooters=true;w=o.width;if(w&&w.indexOf&&w.indexOf("%")!==-1){w="100%"}$tableGridContainer=$('<tr><td colspan="2" style="border-width: 0px;"></td></tr>').insertAfter($tableGridContainer.closest("tr"));$footer=$("<div></div>").attr("id",footerId).css({overflow:"hidden",position:"relative"}).addClass("ui-widget-footer").addClass(this.css.footerContainer).width(w).appendTo($tableGridContainer.find("td"));$table=$("<table></table>").attr("cellpadding",0).attr("cellspacing",0).attr("border",0).appendTo($footer).addClass(this.css.gridFooterTableClass).width(w).attr("id",gridId+"_footers");this._renderColgroup($table,false,true,this.options.autofitLastColumn);$(footerMarkup).appendTo($table);if(this.options.showFooter&&this.options.fixedFooters===true&&this.options.height!==null){elemParent=this.element.parents(".ui-widget:first");if(elemParent.length===1&&elemParent[0].style){width=elemParent[0].style.width;if(width&&(!width.indexOf||width.indexOf("%")===-1)){$footer.css("width",width)}}}if(o.expandColWidth&&!o.width){$footer.css("width",parseInt($footer.width(),10)+o.expandColWidth+"px")}}else if(o.fixedFooters===true&&o.height!==null){if(o.width!==null){$tableGridContainer=this._hscrollbar()}else{$tableGridContainer=this.scrollContainer()}if($tableGridContainer.length===0){$tableGridContainer=tableGrid}$footer=$("<div></div>").attr("id",footerId).css({overflow:"hidden",position:"relative","white-space":"nowrap"}).addClass(this.css.footerContainer).addClass("ui-widget-footer").insertAfter($tableGridContainer);$table=$("<table></table>").attr("cellpadding",0).attr("cellspacing",0).attr("border",0).appendTo($footer).addClass(this.css.gridFooterTableClass).attr("id",gridId+"_footers");this._renderColgroup($table,false,true,this.options.autofitLastColumn);$(footerMarkup).appendTo($table)}else{$tableGridContainer=tableGrid;$footer=$(footerMarkup).attr("id",footerId).insertAfter($tableGridContainer.find("tbody:eq(0)"))}$footer.data("containerName","footerContainer").bind("scroll.syncScrollContainers",$.proxy(this._onScrollContainer,this));this._registerScrllCntnrToSync($footer);$footer.css("display","none");this._footer=$footer;this._footerParent=$table;this._trigger(this.events.footerRendered,null,{owner:this,table:this.footersTable()})}}return $footer},_renderRecord:function(data,rowIndex,isFixed){var key=this.options.primaryKey,gridId=this.id(),grid=this,dstr="",cols=this.options.columns,noVisibleColumns,temp;dstr+="<tr";if(rowIndex%2!==0&&this.options.alternateRowStyles){dstr+=' class="'+grid.css.recordAltClass+'"'}if(!_aNull(key)){dstr+=' data-id="'+this._kval_from_key(key,data)+'"'}else if(!_aNull(data.ig_pk)){dstr+=' data-id="'+data.ig_pk+'"'}if(this.options.virtualization&&this.options.virtualizationMode==="continuous"){dstr+=' data-row-idx="'+rowIndex+'"'}dstr+=' role="row" tabindex="'+this.options.tabIndex+'">';noVisibleColumns=true;isFixed=!!isFixed;$(cols).each(function(colIndex){var col=cols[colIndex],f=!!col.fixed;if(col.hidden||f!==isFixed){return}noVisibleColumns=false;dstr+='<td role="gridcell" aria-readonly="'+!!this.readOnly+'" aria-describedby="'+gridId+"_"+this.key+'" tabindex="'+grid.options.tabIndex+'"';if(col.template&&col.template.length){temp=grid._renderTemplatedCell(data,this);if(temp.indexOf("<td")===0){dstr+=temp.substring(3)}else{dstr+=">"+temp}dstr=grid._editCellStyle(dstr,data,this.key)}else{dstr+=grid._addCellStyle(data,this.key||colIndex,col)+">"+grid._renderCell(data[this.key||colIndex],this,data)}dstr+="</td>"});if(noVisibleColumns&&!isFixed){dstr+='<td role="gridcell"></td>'}dstr+="</tr>";return dstr},_renderRecordFromLayout:function(data,rowIndex,isFixed){var t=this._rlp,l,cell,key=this.options.primaryKey,dstr="",col,noVisibleColumns,temp,i,j,alt=rowIndex%2!==0&&this.options.alternateRowStyles;for(i=0;i<t.length;i++){l=t[i];dstr+="<tr"+(alt?' class="'+this.css.recordAltClass+'"':"");if(!_aNull(key)){dstr+=' data-id="'+this._kval_from_key(key,data)+'"'}else if(!_aNull(data.ig_pk)){dstr+=' data-id="'+data.ig_pk+'"'}if(this.options.virtualization&&this.options.virtualizationMode==="continuous"){dstr+=' data-row-idx="'+rowIndex+'"'}dstr+=' role="row" tabindex="'+this.options.tabIndex+'">';noVisibleColumns=true;for(j=0;j<l.length;j++){cell=l[j];if(cell.col){col=cell.col}else{col=this.columnByKey(cell.key);cell.col=col}if(col.hidden||col.fixed===true&&!isFixed||col.fixed!==true&&isFixed){return}noVisibleColumns=false;dstr+='<td role="gridcell" aria-readonly="'+!!col.readOnly+'" '+(cell.cs>0?'colspan="'+cell.cs+'" ':"")+(cell.rs>0?'rowspan="'+cell.rs+'" ':"")+'aria-describedby="'+this.id()+"_"+col.key+'" tabindex="'+this.options.tabIndex+'"';if(col.template&&col.template.length){temp=this._renderTemplatedCell(data,col);if(temp.indexOf("<td")===0){dstr+=temp.substring(3)}else{dstr+=">"+temp}dstr=this._editCellStyle(dstr,data,col.key)}else{dstr+=this._addCellStyle(data,col.key,col)+">"+this._renderCell(data[col.key],col,data)}dstr+="</td>"}if(noVisibleColumns){dstr+='<td role="gridcell"></td>'}dstr+="</tr>"}return dstr},_editCellStyle:function(dstr,data,col,isFixed){var lastCellIdx,lastCellClose,lastCellClass,start,end,nc="",i;if(!this._cellStyleSubscribers||this._cellStyleSubscribers.length===0){return dstr}for(i=0;i<this._cellStyleSubscribers.length;i++){nc+=this._cellStyleSubscribers[i](data,col,isFixed)+" "}nc=nc.trim();if(nc.length===0){return dstr}lastCellIdx=dstr.lastIndexOf("<td");lastCellClose=dstr.indexOf(">",lastCellIdx);if(lastCellClose>0){lastCellClass=dstr.substring(lastCellIdx,lastCellClose).indexOf("class");if(lastCellClass>0){lastCellClass+=lastCellIdx}}else{lastCellClass=dstr.indexOf("class",lastCellIdx)}if(lastCellClass>0){start=dstr.substring(0,lastCellClass+7);end=dstr.substring(lastCellClass+7);dstr=start+nc+" "+end}else{start=dstr.substring(0,lastCellIdx+3);end=dstr.substring(lastCellIdx+3);dstr=start+' class="'+nc+'"'+end}return dstr},_addCellStyle:function(data,colId,col,isFixed){var dstr="",i,hasSubs=this._cellStyleSubscribers&&this._cellStyleSubscribers.length,hasColClasses=col?col.columnCssClass:false;if(hasSubs){for(i=0;i<this._cellStyleSubscribers.length;i++){dstr+=this._cellStyleSubscribers[i](data,colId,isFixed)+" "}}if(hasColClasses){dstr+=col.columnCssClass}dstr=dstr.trim();return dstr.length>0?' class="'+dstr+'"':dstr},_getCellStyle:function(data,col,isFixed){var dstr="",i;if(!this._cellStyleSubscribers||this._cellStyleSubscribers.length===0){return dstr}for(i=0;i<this._cellStyleSubscribers.length;i++){dstr+=this._cellStyleSubscribers[i](data,col,isFixed)+" "}return dstr.trim()},_enableHeaderCellFeature:function(th){var $th;if($.type(th)==="string"){$th=this.container().find("#"+this.id()+"_"+th)}else{$th=th}$th.addClass(this.css.headerCellFeatureEnabledClass)},_renderRecordInArray:function(darr,tbody,data,rowIndex){var key=this.options.primaryKey,grid=this,appendBehavior=false,cols=this.options.columns,temp;if(darr===null){darr=[];appendBehavior=true}darr.push("<tr");if(rowIndex%2!==0&&this.options.alternateRowStyles){darr.push(' class="'+grid.css.recordAltClass+'"')}if(!_aNull(key)){darr.push(' data-id="'+this._kval_from_key(key,data)+'"')}else if(!_aNull(data.ig_pk)){darr.push(' data-id="'+data.ig_pk+'"')}darr.push(' role="row" tabindex="'+this.options.tabIndex+'">');$(cols).each(function(colIndex){if(cols[colIndex].hidden){return}darr.push('<td role="gridcell" aria-readonly='+!!this.readOnly+' aria-describedby="'+grid.id()+"_"+this.key+'" tabindex="'+grid.options.tabIndex+'"');if(data[this.key]===undefined){if(cols[colIndex].template&&cols[colIndex].template.length){temp=grid._renderTemplatedCell(data,this);if(temp.indexOf("<td")===0){darr[darr.length-1]=temp.replace("<td",darr[darr.length-1])}else{darr.push(">"+temp)}darr[darr.length-1]=grid._editCellStyle(darr[darr.length-1],data,colIndex)}else{darr.push(grid._addCellStyle(data,colIndex,cols[colIndex])+">"+grid._renderCell(data[colIndex],this,data))}darr.push("</td>")}else{if(cols[colIndex].template&&cols[colIndex].template.length){temp=grid._renderTemplatedCell(data,this);if(temp.indexOf("<td")===0){darr[darr.length-1]=temp.replace("<td",darr[darr.length-1])}else{darr.push(">"+temp)}darr[darr.length-2]=grid._editCellStyle(darr[darr.length-2],data,this.key)}else{darr.push(grid._addCellStyle(data,this.key,cols[colIndex])+">"+grid._renderCell(data[this.key],this,data))}darr.push("</td>")}});darr.push("</tr>");if(appendBehavior){tbody.append(darr.join(""))}},_fixDate:function(val,col){var d,i;if(!col||!val){return val}if(col.dataType==="date"&&!val.getTime){i=val.indexOf?val.indexOf("ate("):-1;if(i>0){d=val.substring(i+4);i=d.indexOf(")");if(i>0){d=parseInt(d.substring(0,i),10);if(!isNaN(d)){val=new Date(d)}}}}return val},_renderCell:function(val,col,record,displayStyle,returnObject){var type=col.dataType,format=col.format,o=this.options,auto=o.autoFormat;if(record&&!returnObject){val=this.dataSource.getCellValue(col.key,record)}val=this._fixDate(val,col);if(col.formatter){return col.formatter(val,record)}if(!format&&type==="bool"&&o.renderCheckboxes){format="checkbox"}if(format==="checkbox"&&type!=="bool"){format=null}type=type==="date"||type==="number"?type:"";if(format||(auto===true||auto==="dateandnumber")&&type||auto&&auto===type){return $.ig.formatter(val,type,format,true,o.enableUTCDates,displayStyle,col.headerText,this.options.tabIndex)}if(returnObject){return val}return val||val===0||val===false?val.toString():"&nbsp;"},_renderTemplatedCell:function(val,col){var v,d=$.extend({},val);if(val===undefined||val===null||val[col.key]===undefined){if(col.unbound===true){v="&nbsp;"}else{v=this._renderCell(val,col,val,null,true)}}else{v=this._renderCell(val[col.key],col,val,null,true)}d[col.key]=v;return this._tmplWrappers[this.id()+"_"+col.key](d,this._jsrnd?undefined:col.template)},_defaultTemplateFunc:function(d,tmpl){return $.ig.tmpl(tmpl,d)},_setTemplateDefinition:function(jsrnd){var i,key;for(i=0;i<this.options.columns.length;i++){if(this.options.columns[i].template&&this.options.columns[i].template.length){key=this.id()+"_"+this.options.columns[i].key;if(jsrnd){$.templates(key,this.options.columns[i].template);this._jsrnd=true}else{this._tmplWrappers[key]=this._defaultTemplateFunc}}}},_scrollbarWidth:function(){if(this._scrollbarWidthResolved===null||this._scrollbarWidthResolved===undefined){var $parent,$div=$('<div id="'+this.id()+'_tmp"></div>').css({width:50,height:50,position:"absolute",top:-500,left:-500}).prependTo("body").append("<div></div>").find("div").css({height:100}),w1,w2;if(document.documentMode===7||$.ig.util.isIE7){w1=$div.innerWidth();$div.parent().css("overflow-y","scroll");w2=$div.innerWidth();this._scrollbarWidthResolved=w1-w2}else{$parent=$div.parent();$parent.css({overflow:"auto"});$div.css({width:"100%"});this._scrollbarWidthResolved=$parent.width()-$div.width()}$("#"+this.id()+"_tmp").remove()}return this._scrollbarWidthResolved},_fireInternalEvent:function(name,args){var i,f,featureName,feature;for(i=0;i<this.options.features.length;i++){f=this.options.features[i];if(f!==undefined&&f!==null&&f.name!==undefined){featureName="igGrid"+f.name;feature=this.element.data(featureName);if(feature!==null&&feature!==undefined&&feature[name]){if(args){feature[name](args)}else{feature[name]()}}}}},_initFeature:function(featureObject){if(!featureObject){return}if(featureObject.name===undefined){return}var widget="igGrid"+featureObject.name;if($.type(this.element[widget])!=="function"){throw new Error($.ig.Grid.locale.noSuchWidget.replace("{featureName}",widget))}if(this.element.data(widget)){this.element[widget]("destroy")}this.element[widget](featureObject);this.element.data(widget)._injectGrid(this)},_initFeatureSettings:function(featureObject){if(!featureObject){return}if(featureObject.name===undefined){return}var widget="igGrid"+featureObject.name;if($.type(this.element[widget])!=="function"){throw new Error($.ig.Grid.locale.noSuchWidget.replace("{featureName}",widget))}if(this.element.data(widget)){this.element.data(widget)._injectGrid(this,true)}},_onFeaturesSoftDirty:function(e,args){var i,feature;if(args.owner.options.type!=="remote"){return}for(i=0;i<this.options.features.length;i++){feature=this.element.data("igGrid"+this.options.features[i].name);if(feature&&feature!==args.owner&&feature.options&&feature.options.type==="local"){if(feature._onUIDirty&&$.type(feature._onUIDirty)==="function"){feature._onUIDirty(e,args)}}}},_kval_from_key:function(key,data){var k,k_val="",i;if(key.indexOf(",")!==-1){k=key.split(",");for(i=0;i<k.length;i++){k_val+=data[k[i]];if(i<k.length-1){k_val+=","}}}else{k_val=data[key]}return k_val},_rowId:function(rec,index){var key=this.options.primaryKey;key=key?this._kval_from_key(key,rec):null;if(!key){key=index;if(key!==0){key=this.rows().length-1}}return key},_inferOpType:function(){if(this.options.dataSourceUrl||this.dataSource.type()==="remoteUrl"){return"remote"}return"local"},_renderVirtualRecords:function(){var mode=this.options.virtualizationMode;if(mode===undefined||mode===""){mode="continuous"}if(mode==="fixed"||this.options.columnVirtualization===true){if(this._persistVirtualScrollTop){this._startRowIndex=Math.ceil(this._scrollContainer().scrollTop()/parseInt(this.options.avgRowHeight,10));if(this._startRowIndex>this.dataSource.dataView().length-this._virtualRowCount){if(this.dataSource.dataView().length-this._virtualRowCount>0){this._startRowIndex=this.dataSource.dataView().length-this._virtualRowCount}else{this._startRowIndex=0}}}this._renderVirtualRecordsFixed()}else if(mode==="continuous"){this._renderVirtualRecordsContinuous();this._trigger("virtualrecordsrender",null,{owner:this,dom:this._virtualDom})}},_getHScrollContainerInner:function(){var ret=this._hscrollbarinner();if(ret.length===0&&this.options.virtualizationMode==="continuous"){ret=this.container().find("#"+this.id()+"_horizontalScrollContainer div")}return ret},_getScrollContainerHeight:function(){return this._scrollContainer().children(":first-child").height()},_getDisplayContainerHeight:function(){return this._vdisplaycontainer().height()},_getDisplayContainerWidth:function(){return this._vdisplaycontainer().width()},_setDisplayContainerWidth:function(width){if(width===undefined){return}this._vdisplaycontainer().css("max-width",width);this._vdisplaycontainer().width(width)},_getVHeadersWidth:function(){return this.container().find("#"+this.id()+"_headers_v").width()},_setVHeadersWidth:function(width){if(width===undefined){return}this.container().find("#"+this.id()+"_headers_v").width(width)},_setScrollContainerHeight:function(height){var sc=this._scrollContainer();if(height===undefined){return}if($.ig.util.isIE&&height>this.maxScrollContainerHeight){this._setMaxHeightForScrollCntnr=true;height=this.maxScrollContainerHeight}sc.children(":first-child").height(height)},_setScrollContainerScrollTop:function(top){if(top===undefined){return}this._scrollContainer().scrollTop(top)},_getScrollContainerScrollTop:function(){return this._scrollContainer().scrollTop()},_setDisplayContainerScrollTop:function(top){if(top===undefined){return}this._vdisplaycontainer().scrollTop(top)},_getDisplayContainerScrollTop:function(){return this._vdisplaycontainer().scrollTop()},_setDisplayContainerScrollLeft:function(left){if(left===undefined){return}this._vdisplaycontainer().scrollLeft(left)},_getDisplayContainerScrollLeft:function(){return this._vdisplaycontainer().scrollLeft()},_calculateAvgRowHeight:function(){var rowHeightSum=this.container().find("#"+this.id()+" > tbody").height();if(rowHeightSum===0){rowHeightSum=parseInt(this.options.height,10)}if(this.options.virtualizationMode==="fixed"){if(this._fixedAvgRowHeight){return this._fixedAvgRowHeight}this._fixedAvgRowHeight=rowHeightSum/this._virtualRowCount}return rowHeightSum/this._virtualRowCount},_getDisplayContainerVisibleArea:function(){var scrollTop=this._getDisplayContainerScrollTop(),height=this._getDisplayContainerHeight();return{top:scrollTop,bottom:scrollTop+height}},virtualScrollTo:function(scrollerPosition){var avgRowHeight,$scrollContainer=this._scrollContainer(),pos=parseInt(scrollerPosition,10);if($.type(scrollerPosition)!=="string"){if(this.options.virtualizationMode==="fixed"){avgRowHeight=parseInt(this.options.avgRowHeight,10)}else{if(this._avgRowHeight){avgRowHeight=this._avgRowHeight
}else{avgRowHeight=this._calculateAvgRowHeight()}}scrollerPosition--;pos=avgRowHeight*scrollerPosition;pos=Math.ceil(pos);this._virtualScrollToIndex=scrollerPosition}$scrollContainer.scrollTop(pos)},_virtualScrollToInternal:function(virtualScrollerY){var tableId,firstRow,lastRow,scrollData,scrollResult;if(virtualScrollerY===this._oldScrollTop){return}tableId="#"+this.id();firstRow=this.container().find(tableId+" > tbody > tr:not([data-container]):visible:first");lastRow=this.container().find(tableId+" > tbody > tr:not([data-container]):visible:last");if(firstRow.length===0||lastRow.length===0){return}scrollData={virtualScrollerY:this._getScrollContainerScrollTop(),deltaScroll:virtualScrollerY-this._oldScrollTop,firstRow:firstRow,lastRow:lastRow,firstRowDataIndex:parseInt(firstRow.attr("data-row-idx"),0),lastRowDataIndex:parseInt(lastRow.attr("data-row-idx"),0),visibleArea:this._getDisplayContainerVisibleArea()};scrollResult={action:"SA_INITIAL"};if(!this._tryScroll(scrollData,scrollResult)){this._trigger("virtualrendering");this._rebuildVirtualRows(scrollData,scrollResult)}this._correctScrollPosition(this._getTotalRowsCount())},_getTotalRowsCount:function(){return this._getDataView().length},_tryScroll:function(scrollData,scrollResult){var deltaScroll,firstRow,lastRow,displayContainerHeight,displayContainerScrollTop;if(scrollResult===undefined){throw new Error("scrollResult parameter should be provided")}deltaScroll=scrollData.deltaScroll;firstRow=scrollData.firstRow;lastRow=scrollData.lastRow;displayContainerHeight=this._getDisplayContainerHeight();displayContainerScrollTop=this._getDisplayContainerScrollTop();if(this._rlp&&this._isScrolledToBottomInVirtGrid()&&scrollData.lastRowDataIndex<this._totalRowCount){scrollResult.action="SA_NEED_LAST_PAGE";return false}if(deltaScroll>0){if(lastRow[0].offsetTop+lastRow.outerHeight()>=displayContainerScrollTop+deltaScroll+displayContainerHeight||isNaN(scrollData.lastRowDataIndex)||scrollData.lastRowDataIndex>=this._getLastVisibleDataRecordIndex()){this._setDisplayContainerScrollTop(displayContainerScrollTop+deltaScroll);scrollResult.action="SA_SUCCESSFUL";return true}if(deltaScroll<=this._avgRowHeight*this._virtualRowCount){if(deltaScroll+displayContainerHeight>this._avgRowHeight*this._virtualRowCount){scrollResult.action="SA_NEED_SOME_PAGE";return false}scrollResult.action="SA_NEED_NEXT_PAGE";return false}}if(deltaScroll<0){if(firstRow[0].offsetTop<=displayContainerScrollTop+deltaScroll||scrollData.firstRowDataIndex===0){this._setDisplayContainerScrollTop(displayContainerScrollTop+deltaScroll);scrollResult.action="SA_SUCCESSFUL";return true}if(Math.abs(deltaScroll)<=this._avgRowHeight*this._virtualRowCount){scrollResult.action="SA_NEED_PREV_PAGE";return false}}scrollResult.action="SA_NEED_SOME_PAGE";return false},_getDataView:function(){return this.dataSource.dataView()},_isScrolledToBottomInVirtGrid:function(){var scrlCntnr=this._scrollContainer();return this._getScrollContainerScrollTop()+5>=scrlCntnr[0].scrollHeight-scrlCntnr.innerHeight()},_rebuildVirtualRows:function(scrollData,scrollResult){var noCancel,virtualScrollerY,deltaScroll,tableId,visibleArea,tbody,scrlCntnr,expandedRowsHeight,trs,i,scrollerHeight,firstVisibleTR,firstVisibleTRRelativeOffset,startIndexToBeLoaded,newFirstVisibleRow,displayContainerScrollTop,maxScrollPos,avgRowHeight,tr,lastVisibleTR,lastVisibleTRIndex,firstVisibleTRIndex,endIndexToBeLoaded,dataRowIndexToBeFirst,hasOverflow;noCancel=this._trigger("rebuildingvirtualrows",null,{owner:this,scrollData:scrollData,scrollResult:scrollResult});if(noCancel===false){return}virtualScrollerY=scrollData.virtualScrollerY;deltaScroll=scrollData.deltaScroll;tableId="#"+this.id();visibleArea=scrollData.visibleArea;tbody=this.container().find(tableId+" > tbody");expandedRowsHeight=0;trs=this.container().find(tableId+" > tbody > tr[data-container='true']");for(i=0;i<trs.length;i++){expandedRowsHeight+=$(trs[i]).outerHeight()}if(expandedRowsHeight>0){scrollerHeight=this._getScrollContainerHeight();this._setScrollContainerHeight(scrollerHeight-expandedRowsHeight)}if(deltaScroll>0&&scrollResult.action==="SA_NEED_LAST_PAGE"){startIndexToBeLoaded=this._getDataView().length-this._virtualRowCount;endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount-1;tbody.empty();this._startRowIndex=startIndexToBeLoaded;this._startColIndex=0;this._renderRecords(startIndexToBeLoaded,endIndexToBeLoaded);if(!this._persistVirtualScrollTop){this._setDisplayContainerScrollTop(1e4)}}if(deltaScroll>0&&scrollResult.action==="SA_NEED_NEXT_PAGE"){firstVisibleTR=this._getFirstVisibleTR(visibleArea);firstVisibleTRRelativeOffset=Math.abs(firstVisibleTR[0].offsetTop-visibleArea.top);startIndexToBeLoaded=parseInt(firstVisibleTR.attr("data-row-idx"),0);dataRowIndexToBeFirst=startIndexToBeLoaded;endIndexToBeLoaded=parseInt(this._virtualRowCount,0)+startIndexToBeLoaded-1;hasOverflow=false;if(endIndexToBeLoaded>this._getDataView().length-1){endIndexToBeLoaded=this._getDataView().length-1;startIndexToBeLoaded=endIndexToBeLoaded-this._virtualRowCount+1;hasOverflow=true}tbody.empty();this._startRowIndex=startIndexToBeLoaded;this._startColIndex=0;this._renderRecords(startIndexToBeLoaded,endIndexToBeLoaded);if(hasOverflow){tr=this.container().find(tableId+" > tbody > tr[data-row-idx='"+dataRowIndexToBeFirst+"']");firstVisibleTRRelativeOffset=tr[0].offsetTop+firstVisibleTRRelativeOffset}this._setDisplayContainerScrollTop(firstVisibleTRRelativeOffset+deltaScroll)}if(deltaScroll<0&&scrollResult.action==="SA_NEED_PREV_PAGE"){lastVisibleTR=this._getLastVisibleTR(visibleArea);lastVisibleTRIndex=parseInt(lastVisibleTR.attr("data-row-idx"),0);firstVisibleTR=this._getFirstVisibleTR(visibleArea);firstVisibleTRIndex=parseInt(firstVisibleTR.attr("data-row-idx"),0);endIndexToBeLoaded=lastVisibleTRIndex;startIndexToBeLoaded=endIndexToBeLoaded-parseInt(this._virtualRowCount,0)+1;if(startIndexToBeLoaded<0){startIndexToBeLoaded=0;endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount-1}tbody.empty();this._startRowIndex=startIndexToBeLoaded;this._renderRecords(startIndexToBeLoaded,endIndexToBeLoaded);tableId="#"+this.id();newFirstVisibleRow=this.container().find(tableId+' > tbody > tr[data-row-idx="'+firstVisibleTRIndex+'"]');this._setDisplayContainerScrollTop(newFirstVisibleRow[0].offsetTop+deltaScroll)}if(scrollResult.action==="SA_NEED_SOME_PAGE"){startIndexToBeLoaded=Math.floor(virtualScrollerY/this._avgRowHeight);scrollerHeight=this._getScrollContainerHeight();if(($.ig.util.isIE||this._setMaxHeightForScrollCntnr||this._rlp)&&this._totalRowCount*this._avgRowHeight>=scrollerHeight+2){if(this._isScrolledToBottomInVirtGrid()){startIndexToBeLoaded=this._getDataView().length-this._virtualRowCount}else{startIndexToBeLoaded=Math.ceil(virtualScrollerY/scrollerHeight*this._totalRowCount)}}endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount-1;if(startIndexToBeLoaded<0){startIndexToBeLoaded=0;endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount-1}if(endIndexToBeLoaded>=this._getDataView().length-1){endIndexToBeLoaded=this._getDataView().length-1;startIndexToBeLoaded=endIndexToBeLoaded-this._virtualRowCount+1}tbody.empty();this._startRowIndex=startIndexToBeLoaded;this._renderRecords(startIndexToBeLoaded,endIndexToBeLoaded);displayContainerScrollTop=0;maxScrollPos=scrollerHeight-this._getDisplayContainerHeight();if(maxScrollPos-3<=virtualScrollerY&&virtualScrollerY<=maxScrollPos+3){displayContainerScrollTop=1e4}if(!this._persistVirtualScrollTop){this._setDisplayContainerScrollTop(displayContainerScrollTop)}}avgRowHeight=this._calculateAvgRowHeight();if(avgRowHeight>this._avgRowHeight){this._avgRowHeight=avgRowHeight}this._trigger("virtualrecordsrender",null,{owner:this,tbody:tbody,dom:this._virtualDom})},_correctScrollPosition:function(totalRowCount){var scrollTop,maxScrollPos,tableId,firstRow,firstRowDataIndex,lastRow,lastRowDataIndex,visibleArea,tbody,rowsLeft,displayContainerScrollTop,targetRow,delta;scrollTop=this._getScrollContainerScrollTop();maxScrollPos=this._getScrollContainerHeight()-this._getDisplayContainerHeight();tableId="#"+this.id();firstRow=this.container().find(tableId+" > tbody > tr:first");firstRowDataIndex=parseInt(firstRow.attr("data-row-idx"),0);lastRow=this.container().find(tableId+" > tbody > tr:last");lastRowDataIndex=parseInt(lastRow.attr("data-row-idx"),0);visibleArea=this._getDisplayContainerVisibleArea();tbody=this.container().find(tableId+" > tbody");if(scrollTop===0){if(visibleArea.top>0){this._scrollTo(visibleArea.top,true)}else if(firstRowDataIndex>0){this._scrollTo(firstRowDataIndex*this._avgRowHeight,true)}}else if(scrollTop>=maxScrollPos-3&&scrollTop<=maxScrollPos+3){if(visibleArea.bottom<tbody.height()&&lastRowDataIndex===totalRowCount-1){this._scrollTo(this._getScrollContainerScrollTop()-(tbody.height()-visibleArea.bottom),true)}else if(lastRowDataIndex<totalRowCount-1){rowsLeft=totalRowCount-lastRowDataIndex;this._setScrollContainerHeight(this._getScrollContainerHeight()+rowsLeft*this._avgRowHeight)}}displayContainerScrollTop=this._getDisplayContainerScrollTop();if(displayContainerScrollTop===0&&firstRowDataIndex===0&&this._getScrollContainerScrollTop()!==0){if(!this._persistVirtualScrollTop){this._setScrollContainerHeight(this._totalRowCount*this._avgRowHeight);this._scrollTo(this._getScrollContainerScrollTop(),false)}else{this._scrollTo(0,true)}}if(displayContainerScrollTop===tbody.height()-this._getDisplayContainerHeight()&&lastRowDataIndex===totalRowCount-1){this._scrollTo(this._getScrollContainerHeight(),true)}if(this._virtualScrollToIndex!==undefined&&this._virtualScrollToIndex!==null){targetRow=this.container().find(tableId+" > tbody > tr[data-row-idx="+this._virtualScrollToIndex+"]");delta=0;if(targetRow.length===1&&firstRowDataIndex!==this._virtualScrollToIndex){delta=targetRow.offset().top-firstRow.offset().top}this._virtualScrollToIndex=null;if(delta>0){this._vdisplaycontainer().scrollTop(delta)}}},_scrollTo:function(scrollTop,suppressScrollEvent){if(suppressScrollEvent){this._suppressScroll=true}this._setScrollContainerScrollTop(scrollTop)},_getFirstVisibleTR:function(visibleArea){var tableId="#"+this.element[0].id,firstVisibleTR,visibleAreaTop=visibleArea.top;$(tableId+" > tbody > tr:visible").each(function(){firstVisibleTR=$(this);if(this.offsetTop+firstVisibleTR.height()>visibleAreaTop){return false}});return firstVisibleTR},_getLastVisibleTR:function(visibleArea){var tableId="#"+this.id(),lastVisibleTR;lastVisibleTR=this.container().find(tableId+" > tbody > tr:visible").filter(function(){return this.offsetTop<visibleArea.bottom}).last();return lastVisibleTR},_determineVirtualRowCount:function(){var div,rowNumber=10,ds,rows="",html,i,height,rrFunc,avgRowHeight,displayContainerHeight,rowsPerPage,result,$colgroup;ds=this._getDataView();if(rowNumber>ds.length){rowNumber=ds.length}div=$('<div class="'+this.css.gridClasses+" "+this.css.baseClass+'"></div>)').appendTo("body").css({position:"absolute",top:-1800,left:-1800,visibility:"hidden"});if(this._rlp){rrFunc=this._renderRecordFromLayout}else{rrFunc=this._renderRecord}for(i=0;i<rowNumber;i++){rows+=rrFunc.apply(this,[ds[i],i])}html='<table cellpadding="0" cellspacing="0" border="0" class="'+(this._isMultiRowGrid()?this.css.mrlGridTableClass:this.css.gridTableClass)+'">';$colgroup=this.element.children("colgroup");if($colgroup.length){html+=$colgroup[0].outerHTML}html+='<tbody role="rowgroup">'+rows+"</tbody></table>";div.html(html);height=div.height();avgRowHeight=height/rowNumber;displayContainerHeight=this._getDisplayContainerHeight();rowsPerPage=displayContainerHeight/avgRowHeight;result=Math.ceil(rowsPerPage*3);div.remove();this._fireInternalEvent("_virtRowCountDetermined",result);return result},_getTotalRowCount:function(){return this.dataSource.dataView().length},_renderVirtualRecordsContinuous:function(){var dvLen,firstVisibleTRIndex,endIndexToBeLoaded,lastVisibleRow,isScrolledToBottom;this._totalRowCount=this._getTotalRowCount();this._oldScrollTop=0;if(this._totalRowCount===0){this._setScrollContainerHeight(0);this._virtualDom=[];return}this._virtualRowCount=this._determineVirtualRowCount();if(this._virtualRowCount>this._totalRowCount){this._virtualRowCount=this._totalRowCount}if(!this._persistVirtualScrollTop){this._scrollTo(0,true);this._renderRecords(this._virtualRowCount-1);this._avgRowHeight=this._calculateAvgRowHeight();this._setScrollContainerHeight(this._totalRowCount*this._avgRowHeight)}else{dvLen=this._getDataView().length;if(this._prevFirstVisibleTRIndex||this._prevFirstVisibleTRIndex===0){firstVisibleTRIndex=this._prevFirstVisibleTRIndex}else{firstVisibleTRIndex=0}if(firstVisibleTRIndex>=dvLen-1){endIndexToBeLoaded=dvLen-1;firstVisibleTRIndex=dvLen-this._virtualRowCount-1}else{endIndexToBeLoaded=parseInt(this._virtualRowCount,0)+firstVisibleTRIndex}if(endIndexToBeLoaded>dvLen-1){endIndexToBeLoaded=dvLen-1;firstVisibleTRIndex=dvLen-this._virtualRowCount-1}if(firstVisibleTRIndex<0){firstVisibleTRIndex=0}this._renderRecords(firstVisibleTRIndex,endIndexToBeLoaded);lastVisibleRow=this.container().find("#"+this.id()+" > tbody > tr:visible:last");isScrolledToBottom=this._getScrollContainerScrollTop()+5>this._scrollContainer()[0].scrollHeight-this._scrollContainer().innerHeight();if(endIndexToBeLoaded===dvLen-1&&isScrolledToBottom){this._setDisplayContainerScrollTop(lastVisibleRow[0].offsetTop)}else{this._setDisplayContainerScrollTop(this._prevFirstVisibleTROffset)}}},_rerenderVirtualRecordsContinuous:function(){var tableId="#"+this.id(),lastRow,lastRowDataIndex;lastRow=this.container().find(tableId+" > tbody > tr:last");lastRowDataIndex=parseInt(lastRow.attr("data-row-idx"),0);this._startRowIndex=this._startRowIndex||0;this._renderRecords(this._startRowIndex,lastRowDataIndex);this._trigger("virtualrecordsrender",null,{owner:this,tbody:this.element.children("tbody"),dom:this._virtualDom})},_buildVirtualDomForContinuousVirtualization:function(){var rows,cells,i,j;if(this.options.virtualization===true&&this.options.virtualizationMode==="continuous"){this._virtualDom=[];rows=this.container().find("#"+this.id()+" > tbody > tr");for(i=0;i<rows.length;i++){this._virtualDom[i]=[];cells=rows[i].children;for(j=0;j<cells.length;j++){this._virtualDom[i][j]=cells[j]}}this._updateVirtualScrollContainer()}},_isFixedElement:function($td){if(this.hasFixedColumns()&&$td.closest("div").attr("data-fixed-container")!==undefined){return true}return false},getColumnByTD:function($td){if(!$td instanceof jQuery){$td=$($td)}var $tr=$td.closest("tr"),describedBy=$td.attr("aria-describedBy"),column,res={},visibleInd;if($tr.length===0){return null}if($td.attr("data-parent")||$td.attr("data-skip")){return null}if(!describedBy){return{column:this._visibleColumns()[0],index:0}}column=this.columnByKey(describedBy.slice(describedBy.indexOf(this.id()+"_")+this.id().length+1));visibleInd=this.getVisibleIndexByKey(column.key,true);res={column:column,index:visibleInd};return res},_savePersistenceData:function(data,feature,layout){var topmostGrid=this,featureId=feature;if($.type(layout)==="string"&&layout.length>0){topmostGrid=this.element.closest(".ui-iggrid-root").data("igGrid")||this;if(layout!==topmostGrid.element[0].id){featureId=feature+"_"+layout}}topmostGrid.persistenceData=topmostGrid.persistenceData||{};topmostGrid.persistenceData[featureId]=data},_getPersistenceData:function(feature,layout){var topmostGrid=this,featureId=feature;if($.type(layout)==="string"&&layout.length>0){topmostGrid=this.element.closest(".ui-iggrid-root").data("igGrid")||this;if(layout!==topmostGrid.element[0].id){featureId=feature+"_"+layout}}topmostGrid.persistenceData=topmostGrid.persistenceData||{};return topmostGrid.persistenceData[featureId]},_saveFirstVisibleTRIndex:function(){var fvtr=this._getFirstVisibleTR(this._getDisplayContainerVisibleArea());if(fvtr){this._prevFirstVisibleTRIndex=parseInt(fvtr.attr("data-row-idx"),10);this._prevFirstVisibleTROffset=this._getDisplayContainerScrollTop()-fvtr[0].offsetTop}},_getLastVisibleDataRecordIndex:function(){return this._getDataView().length-1},_revertToInitialState:function(){var i,a,attr;if(this.element.is("table")&&this._initialChildren){this._initialChildren.appendTo(this.element)}attr=this.element[0].attributes;a=[];for(i=0;i<attr.length;i++){if(attr[i].name!=="id"){a.push(attr[i].name)}}for(i=0;i<a.length;i++){this.element.removeAttr(a[i])}for(i=0;i<this._initialAttributes.length;i++){if(this._initialAttributes[i].name!=="id"){this.element.attr(this._initialAttributes[i].name,this._initialAttributes[i].value)}}},_removeDetachedDOM:function(container){if(!container){return}var colKey,arr,i;for(colKey in container){if(container.hasOwnProperty(colKey)){arr=container[colKey];for(i=0;i<arr.length;i++){if(arr[i]&&arr[i].length){arr[i].remove()}}}}},_detachEvents:function(){var container;if(this._cellClickHandler){this.element.unbind({click:this._cellClickHandler});this._cellClickHandler=null}if(this._mouseClickEventHandlers){this.element.unbind(this._mouseClickEventHandlers);delete this._mouseClickEventHandlers}if(this._uiSoftDirtyHandler){this.element.unbind("iggriduisoftdirty",this._uiSoftDirtyHandler);this._uiSoftDirtyHandler=null}if(this._hovEvts){this.element.unbind(this._hovEvts);this._hovEvts=null}if(this._documentEvents){$(document).unbind(this._documentEvents);this._documentEvents=null}container=this.scrollContainer();if(!container.length){container=this._vdisplaycontainer()}container.unbind(".syncScrollContainers");this.headersTable().parent().unbind(".syncScrollContainers");container=this.footersTable().closest("div");container.unbind(".syncScrollContainers")},_destroyFeatures:function(){var i,features=this.options.features,e=this.element;for(i=0;i<features.length;i++){if(e.data("igGrid"+features[i].name)){e["igGrid"+features[i].name]("destroy")}}},destroy:function(notToCallDestroy){var prev=this.container().prev(),prepend=false;if(this._scrollHeader&&this._hscrollbarcontent().length>0){this._hscrollbarcontent().unbind("scroll",$.proxy(this._scrollHeader,this))}if(this.scrollContainer()){this.scrollContainer().unbind("scroll");this.scrollContainer().unbind("wheel")}if(this.dataSource._ajaxRequest&&this.dataSource._ajaxRequest.readyState!==4){this.dataSource._ajaxRequest.abort()}this._headerInitCallbacks=[];this._footerInitCallbacks=[];this.tmpDataSource=null;if(this._resId){clearInterval(this._resId)}this._destroyFeatures();if(this._detachedContainersInitialized){this._removeDetachedDOM(this._detachedHeaderCells);delete this._detachedHeaderCells;this._removeDetachedDOM(this._detachedFooterCells);delete this._detachedFooterCells;delete this._detachedContainersInitialized}this._detachEvents();if(this._isWrapped&&this.container().parent().data("igGrid")){this.element=this.container().parent();this.element.empty();if(notToCallDestroy!==true){$.Widget.prototype.destroy.call(this)}this._revertToInitialState();this.element.trigger(this.events.destroyed,{owner:this});return this}if(prev.length===0){prev=this.container().parent();prepend=true}this.element.empty();if(prepend){prev.prepend(this.element)}else{this.element.insertAfter(prev)}if(notToCallDestroy!==true){$.Widget.prototype.destroy.call(this)}this.container().remove();this._container=null;this._revertToInitialState();if(notToCallDestroy===true){return this}this.element.trigger(this.events.destroyed,{owner:this});return this}});$.extend($.ui.igGrid,{version:"16.1.20161.1009"})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Tree localization resources 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
(function($){$.ig=$.ig||{};if(!$.ig.Tree){$.ig.Tree={};$.extend($.ig.Tree,{locale:{invalidArgumentType:"Invalid argument type provided.",errorOnRequest:"An error has occurred while retrieving data: ",noDataSourceUrl:"The igTree control requires a dataSourceUrl provided in order to initiate a request for data to that URL.",incorrectPath:"A node was not found at the provided path: ",incorrectNodeObject:"The provided argument is not a jQuery node element.",setOptionError:"Runtime changes are not allowed for the following option: ",moveTo:"<strong>Move to</strong> {0}",moveBetween:"<strong>Move between</strong> {0} and {1}",moveAfter:"<strong>Move after</strong> {0}",moveBefore:"<strong>Move before</strong> {0}",copyTo:"<strong>Copy to</strong> {0}",copyBetween:"<strong>Copy between</strong> {0} and {1}",copyAfter:"<strong>Copy after</strong> {0}",copyBefore:"<strong>Copy before</strong> {0}",and:"and"}})}})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Tree 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 *	jquery.ui.droppable.js
 *	infragistics.templating.js
 *	infragistics.dataSource.js
 *  infragistics.ui.shared.js
 *	infragistics.util.js
 *	infragistics.ui.tree-en.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.ui.keyCode.NUMPAD_ADD=$.ui.keyCode.NUMPAD_ADD||107;$.ui.keyCode.NUMPAD_SUBTRACT=$.ui.keyCode.NUMPAD_SUBTRACT||109;$.widget("ui.igTree",{_const:{dragCursorAt:{top:-10,left:-10}},css:{tree:"ui-widget ui-igtree",treeCollection:"ui-igtree-collection",treeNode:"ui-igtree-node",treeRoot:"ui-igtree-root ui-widget-content",treeRootNode:"ui-igtree-noderoot",nodeNoChildren:"ui-igtree-node-nochildren",parentNode:"ui-igtree-parentnode",collapseIcon:"ui-icon ui-icon-triangle-1-s",expandIcon:"ui-icon ui-icon-triangle-1-e",nodeAnchor:"ui-corner-all",nodeExpander:"ui-igtree-expander",nodeNormal:"ui-state-default",nodeHightlight:"ui-state-highlight",nodeHovered:"ui-state-hover",nodeSelected:"ui-state-active",nodeActive:"ui-state-focus",checkbox:"ui-state-default ui-corner-all ui-igcheckbox-normal",checkboxOff:"ui-icon ui-icon-check ui-igcheckbox-normal-off",checkboxOn:"ui-icon ui-icon-check ui-igcheckbox-normal-on",checkboxPartial:"ui-icon ui-icon-check ui-state-disabled ui-igcheckbox-normal-on",invalidDropIndicator:"ui-widget ui-igtree-dropindicator ui-state-error ui-corner-all",dropIndicator:"ui-widget ui-igtree-dropindicator ui-state-highlight ui-corner-all",moveMarkupIcon:"ui-icon ui-icon-arrowthick-1-e",invalidMoveMarkupIcon:"ui-icon ui-icon-cancel",copyMarkupIcon:"ui-icon ui-icon-plus",insertLine:"ui-state-default ui-igtree-insertline"},options:{width:null,height:null,checkboxMode:"off",singleBranchExpand:false,hotTracking:true,parentNodeImageUrl:null,parentNodeImageClass:null,parentNodeImageTooltip:null,leafNodeImageUrl:null,leafNodeImageClass:null,leafNodeImageTooltip:null,animationDuration:200,pathSeparator:"_",dataSource:null,dataSourceUrl:null,dataSourceType:null,responseDataKey:null,responseDataType:null,requestType:"GET",responseContentType:null,initialExpandDepth:-1,loadOnDemand:false,bindings:{textKey:"Text",textXPath:"@Text",valueKey:"Value",valueXPath:"@Value",imageUrlKey:"ImageUrl",imageUrlXPath:"@ImageUrl",navigateUrlKey:"NavigateUrl",navigateUrlXPath:"@NavigateUrl",targetKey:"Target",expandedKey:"Expanded",primaryKey:null,nodeContentTemplate:null,childDataProperty:"Nodes",childDataXPath:"Children",searchFieldXPath:"Nodes",bindings:{}},defaultNodeTarget:"_self",dragAndDrop:false,updateUrl:null,dragAndDropSettings:{allowDrop:false,dragAndDropMode:"default",dragOpacity:.75,revert:true,revertDuration:500,zIndex:10,dragStartDelay:200,expandOnDragOver:true,expandDelay:1e3,helper:"default",customDropValidation:null,containment:false,invalidMoveToMarkup:"<div><p><span></span><strong>{0}</strong></p></div>",moveToMarkup:"<div><p><span></span><strong>Move to</strong> {0}</p></div>",moveBetweenMarkup:"<div><p><span></span><strong>Move between</strong> {0} and {1}</p></div>",moveAfterMarkup:"<div><p><span></span><strong>Move after</strong> {0}</p></div>",moveBeforeMarkup:"<div><p><span></span><strong>Move before</strong> {0}</p></div>",copyToMarkup:"<div><p><span></span><strong>Copy to</strong> {0}</p></div>",copyBetweenMarkup:"<div><p><span></span><strong>Copy between</strong> {0} and {1}</p></div>",copyAfterMarkup:"<div><p><span></span><strong>Copy after</strong> {0}</p></div>",copyBeforeMarkup:"<div><p><span></span><strong>Copy before</strong> {0}</p></div>"}},events:{dataBinding:"dataBinding",dataBound:"dataBound",rendering:"rendering",rendered:"rendered",selectionChanging:"selectionChanging",selectionChanged:"selectionChanged",nodeCheckstateChanging:"nodeCheckstateChanging",nodeCheckstateChanged:"nodeCheckstateChanged",nodePopulating:"nodePopulating",nodePopulated:"nodePopulated",nodeCollapsing:"nodeCollapsing",nodeCollapsed:"nodeCollapsed",nodeExpanding:"nodeExpanding",nodeExpanded:"nodeExpanded",nodeClick:"nodeClick",nodeDoubleClick:"nodeDoubleClick",dragStart:"dragStart",drag:"drag",dragStop:"dragStop",nodeDropping:"nodeDropping",nodeDropped:"nodeDropped"},widget:function(){return this.element},_createWidget:function(){this.options.bindings=null;this.options.dragAndDropSettings.moveToMarkup="<div><p><span></span>"+$.ig.Tree.locale.moveTo+"</p></div>";this.options.dragAndDropSettings.moveBetweenMarkup="<div><p><span></span>"+$.ig.Tree.locale.moveBetween+"</p></div>";this.options.dragAndDropSettings.moveAfterMarkup="<div><p><span></span>"+$.ig.Tree.locale.moveAfter+"</p></div>";this.options.dragAndDropSettings.moveBeforeMarkup="<div><p><span></span>"+$.ig.Tree.locale.moveBefore+"</p></div>";this.options.dragAndDropSettings.copyToMarkup="<div><p><span></span>"+$.ig.Tree.locale.copyTo+"</p></div>";this.options.dragAndDropSettings.copyBetweenMarkup="<div><p><span></span>"+$.ig.Tree.locale.copyBetween+"</p></div>";this.options.dragAndDropSettings.copyAfterMarkup="<div><p><span></span>"+$.ig.Tree.locale.copyAfter+"</p></div>";this.options.dragAndDropSettings.copyBeforeMarkup="<div><p><span></span>"+$.ig.Tree.locale.copyBefore+"</p></div>";$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var opt=this.options;this.dataBind();this.element.addClass(this.css.tree);this._attachEvents();if($.ig.util.isIE&&$.ig.util.browserVersion===7&&this.element.css("position")==="static"){this.element.css("position","relative")}if(opt.width){this.element.css("width",opt.width)}if(opt.height){this.element.css("height",opt.height)}},_setOption:function(option,value){var css=this.css,elements,prevValue=this.options[option];if(prevValue===value){return}$.Widget.prototype._setOption.apply(this,arguments);switch(option){case"width":this.element.css("width",value);break;case"height":this.element.css("height",value);break;case"parentNodeImageUrl":elements=this.element.find("img[data-role=parent-node-image]");if(elements.length>0){elements.attr("src",value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"parentNodeImageTooltip":elements=this.element.find("img[data-role=parent-node-image]");if(elements.length<=0){elements=this.element.find("span[data-role=parent-node-image]")}if(elements.length>0){elements.attr("title",value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"parentNodeImageClass":elements=this.element.find("span[data-role=parent-node-image]");if(elements.length>0){elements.removeClass();elements.addClass(value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"leafNodeImageUrl":elements=this.element.find("img[data-role=leaf-node-image]");if(elements.length>0){elements.attr("src",value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"leafNodeImageTooltip":elements=this.element.find("img[data-role=leaf-node-image]");if(elements.length<=0){elements=this.element.find("span[data-role=leaf-node-image]")}if(elements.length>0){elements.attr("title",value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"leafNodeImageClass":elements=this.element.find("span[data-role=leaf-node-image]");if(elements.length>0){elements.removeClass();elements.addClass(value)}else{throw new Error($.ig.Tree.locale.setOptionError+option)}break;case"hotTracking":if(value){this.element.delegate("a",{mouseover:function(event){$(event.target).addClass(css.nodeHovered)},mouseout:function(event){$(event.target).removeClass(css.nodeHovered)}})}else{this.element.undelegate("a","mouseover");this.element.undelegate("a","mouseout")}break;case"checkboxMode":if(value.toLowerCase()==="off"){this._removeCheckboxes()}else if(prevValue==="off"){this._addCheckboxes()}break;case"dataSource":this.dataBind();break;case"dragAndDrop":if(value){this._initDragAndDrop()}else{this._destroyDragAndDrop()}break;case"updateUrl":this.options.dataSource.root().settings.updateUrl=value;break;case"bindings":case"loadOnDemand":case"pathSeparator":case"initialExpandDepth":case"defaultNodeTarget":throw new Error($.ig.Tree.locale.setOptionError+option);default:break}},_removeCheckboxes:function(){this.element.find("span[data-role=checkbox]").remove()},_addCheckboxes:function(){var self=this;this.element.find("li[data-role=node]").each(function(){var $this=$(this);if($this.children("span[data-role=expander]").length>0){$this.children("span[data-role=expander]").after(self._renderCheckbox())}else{$this.prepend(self._renderCheckbox())}})},_initDataOptions:function(){var dataOptions,ul,s;s=this._initDataSourceSchema();if(!this.options.dataSource&&!this.options.dataSourceUrl){if(!this.element.is("ul")){ul=this.element.children("ul");this.options.dataSource=ul[0]}else{this.options.dataSource=this.element[0]}}else if(!this.options.dataSource&&this.options.dataSourceUrl){this.options.dataSource=this.options.dataSourceUrl}else if($.type(this.options.dataSource)==="object"&&typeof this.options.dataSource._encodeHierarchicalUrlParams!=="function"&&typeof this.options.dataSource._xmlToArray!=="function"&&!this.options.dataSourceType){this.options.dataSource=[this.options.dataSource]}dataOptions={callback:this._constructFromData,callee:this,dataSource:this.options.dataSource,requestType:this.options.requestType,responseContentType:this.options.responseContentType,defaultChildrenDataProperty:this.options.bindings.childDataProperty,responseDataType:this.options.responseDataType,primaryKey:this.options.primaryKey,localSchemaTransform:this.options.dataSourceType&&this.options.dataSourceType==="xml"?true:false,schema:s,updateUrl:this.options.updateUrl};if(this.options.dataSourceType){dataOptions.type=this.options.dataSourceType}if(this.options.responseDataKey){dataOptions.responseDataKey=this.options.responseDataKey}return dataOptions},_initDataSourceSchema:function(){var schema={},opt=this.options,bindings=opt.bindings;if(bindings===null){opt.bindings={};schema.text={name:"Text",type:"string"};opt.bindings.textKey="Text";schema.value={name:"Value",type:"string"};opt.bindings.valueKey="Value";schema.imageUrl={name:"ImageUrl",type:"string"};opt.bindings.imageUrlKey="ImageUrl";schema.navigateUrl={name:"NavigateUrl",type:"string"};opt.bindings.navigateUrlKey="NavigateUrl";schema.childData={name:"Nodes",type:"object"};opt.bindings.childDataProperty="Nodes";schema.target={name:"Target",type:"string"};opt.bindings.targetKey="Target";bindings=opt.bindings}else if(opt.dataSourceType==="xml"){if(bindings.searchFieldXPath){schema.searchField=bindings.searchFieldXPath}}schema.fields=[];if(bindings.textKey){schema.fields.push({name:bindings.textKey,type:"string",xpath:bindings.textXPath});schema.textKey=bindings.textKey}if(bindings.valueKey){schema.fields.push({name:bindings.valueKey,type:"string",xpath:bindings.valueXPath});schema.valueKey=bindings.valueKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,type:"string",xpath:bindings.navigateUrlXPath});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,type:"string",xpath:bindings.imageUrlXPath});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.targetKey){schema.fields.push({name:bindings.targetKey,type:"string"});schema.targetKey=bindings.targetKey}if(bindings.expandedKey){schema.fields.push({name:"Expanded",type:"boolean"});schema.expandedKey=bindings.expandedKey}if(bindings.primaryKey){schema.fields.push({name:bindings.primaryKey,type:"string"});schema.primaryKey=bindings.primaryKey}if(bindings.childDataProperty){schema.fields.push({name:bindings.childDataProperty,type:"object",xpath:bindings.childDataXPath});schema.childDataProperty=bindings.childDataProperty}if(!schema.searchField&&opt.responseDataKey){schema.searchField=opt.responseDataKey}return schema},_initDataSource:function(dataOptions){var opt=this.options;if(!opt.dataSource||typeof opt.dataSource._encodeHierarchicalUrlParams!=="function"){opt.dataSource=new $.ig.HierarchicalDataSource(dataOptions)}},_helper:null,_insertLine:{html:null},_originalHelper:{html:null},_sourceNode:{data:null,element:null,owner:null},_validationObject:{valid:true,dropAfter:true,expandTimeout:null,target:null},_helperDirty:false,_dropAfter:true,_initDragOptions:function(){var self=this,dragAndDropSettings=self.options.dragAndDropSettings,helper=dragAndDropSettings.helper==="default"?function(event){var target=$(event.target).closest("li[data-role=node]"),markup=$(self.options.dragAndDropSettings.invalidMoveToMarkup.replace("{0}",target.children("a").text()));markup.addClass(self.css.invalidDropIndicator).find("span").addClass(self.css.invalidMoveMarkupIcon);return markup}:dragAndDropSettings.helper,opt={revert:dragAndDropSettings.revert?"invalid":false,opacity:dragAndDropSettings.dragOpacity,zIndex:dragAndDropSettings.zIndex,cursorAt:this._const.dragCursorAt,helper:helper,revertDuration:dragAndDropSettings.revertDuration,appendTo:self.element,delay:dragAndDropSettings.dragStartDelay,containment:dragAndDropSettings.containment,start:function(event,ui){var node=self.nodeFromElement($(this)),noCancel;noCancel=self._triggerDragStart(event,ui,node.element);if(noCancel){self._originalHelper.html=ui.helper.html();self._sourceNode.data=$.extend(false,{},node.data);self._sourceNode.owner=self;self._sourceNode.element=$(this)}else{return false}},drag:function(event,ui){var noCancel=self._triggerDrag(event,ui,self._sourceNode.element);if(noCancel){self._performDrag(event,ui)}else{self._resetSourceNode();self._resetValidationObject();return false}},stop:function(event,ui){self._triggerDragStop(event,ui);$(document).find("div[data-role=insert-line]").remove();self._helperDirty=false;self._resetSourceNode();self._resetValidationObject()}};return opt},_performDrag:function(event,ui){var target=$(event.originalEvent.target),markup,copy=event.ctrlKey&&this.options.dragAndDropSettings.dragAndDropMode==="default"||this.options.dragAndDropSettings.dragAndDropMode==="copy",targetTop,dragTop,self=this;if(target.is("div[data-role=insert-line]")){return}this._validationObject.valid=this._accept(this._sourceNode.element,target);$(document).find("div[data-role=insert-line]").remove();if(this.options.dragAndDropSettings.expandOnDragOver){if((target.is("a")||target.closest("a").parent().is("li[data-role=node]"))&&this._validationObject.target!==target.closest("li[data-role=node]")){clearTimeout(this._validationObject.expandTimeout);this._validationObject.target=target.closest("li[data-role=node]");if(this._validationObject.target.hasClass("ui-igtree-parentnode")){this._validationObject.expandTimeout=setTimeout(function(){self.expand(self._validationObject.target)},this.options.dragAndDropSettings.expandDelay)}}else{clearTimeout(this._validationObject.expandTimeout);this._validationObject.expandTimeout=null;this._validationObject.target=null}}if((target.is("a")||target.closest("a").parent().is("li[data-role=node]"))&&this._validationObject.valid){if(copy){markup=$(this.options.dragAndDropSettings.copyToMarkup.replace("{0}",target.text()));markup.find("span").addClass(this.css.copyMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.moveToMarkup.replace("{0}",target.text()));markup.find("span").addClass(this.css.moveMarkupIcon)}this._helper=markup.html();ui.helper.removeClass(this.css.invalidDropIndicator).addClass(this.css.dropIndicator).html(this._helper);this._helperDirty=true}else if(target.is("li[data-role=node]")&&this._validationObject.valid){targetTop=target.offset().top+target.height()/2;dragTop=ui.offset.top+this._const.dragCursorAt.top;if(dragTop>targetTop){this._validationObject.dropAfter=true;if(copy){if(target.next("li[data-role=node]").length>0){markup=$(this.options.dragAndDropSettings.copyBetweenMarkup.replace("{0}",target.children("a").text()).replace("{1}",target.next("li[data-role=node]").children("a").text()));markup.find("span").addClass(this.css.copyMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.copyAfterMarkup.replace("{0}",target.children("a").text()));markup.find("span").addClass(this.css.copyMarkupIcon)}}else{if(target.next("li[data-role=node]").length>0){markup=$(this.options.dragAndDropSettings.moveBetweenMarkup.replace("{0}",target.children("a").text()).replace("{1}",target.next("li[data-role=node]").children("a").text()));markup.find("span").addClass(this.css.moveMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.moveAfterMarkup.replace("{0}",target.children("a").text()));markup.find("span").addClass(this.css.moveMarkupIcon)}}$(this._insertLine.html).appendTo(target);this._helper=markup.html();ui.helper.removeClass(this.css.invalidDropIndicator).addClass(this.css.dropIndicator).html(this._helper)}else{this._validationObject.dropAfter=false;if(copy){if(target.prev("li[data-role=node]").length>0){markup=$(this.options.dragAndDropSettings.copyBetweenMarkup.replace("{0}",target.children("a").text()).replace("{1}",target.prev("li[data-role=node]").children("a").text()));markup.find("span").addClass(this.css.copyMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.copyBeforeMarkup.replace("{0}",target.children("a").text()));markup.find("span").addClass(this.css.copyMarkupIcon)}}else{if(target.prev("li[data-role=node]").length>0){markup=$(this.options.dragAndDropSettings.moveBetweenMarkup.replace("{0}",target.prev("li[data-role=node]").children("a").text()).replace("{1}",target.children("a").text()));markup.find("span").addClass(this.css.moveMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.moveBeforeMarkup.replace("{0}",target.children("a").text()));markup.find("span").addClass(this.css.moveMarkupIcon)}}if(target.index()===0){$(this._insertLine.html).prependTo(target).css("padding-bottom","0.1em")}else{$(this._insertLine.html).appendTo(target.prev())}this._helper=markup.html();ui.helper.removeClass(this.css.invalidDropIndicator).addClass(this.css.dropIndicator).html(this._helper)}this._helperDirty=true}else if(target.is(":ui-igTree")&&target.data("igTree")!==this){if(copy){markup=$(this.options.dragAndDropSettings.copyToMarkup.replace("{0}",""));markup.find("span").addClass(this.css.copyMarkupIcon)}else{markup=$(this.options.dragAndDropSettings.moveToMarkup.replace("{0}",""));markup.find("span").addClass(this.css.moveMarkupIcon)}this._helper=markup.html();ui.helper.removeClass(this.css.invalidDropIndicator).addClass(this.css.dropIndicator).html(this._helper);this._helperDirty=true}else{$(document).find("div[data-role=insert-line]").remove();if(this._helperDirty){this._helper=null;ui.helper.removeClass(this.css.dropIndicator).addClass(this.css.invalidDropIndicator).html(this._originalHelper.html);this._helperDirty=false}}},_resetSourceNode:function(){this._originalHelper.html=null;this._sourceNode.data=null;this._sourceNode.owner=null;this._sourceNode.element=null},_resetValidationObject:function(){this._validationObject.valid=true;this._validationObject.dropAfter=true;clearTimeout(this._validationObject.expandTimeout);this._validationObject.expandTimeout=null;this._validationObject.target=null},_initDropOptions:function(){var self=this,opt={tolerance:"pointer",greedy:true,drop:function(event,ui){if(self._sourceNode.element===null&&self._sourceNode.owner===null){return false}return self._performDrop(event,ui)},accept:function(){return self._validationObject.valid}};return opt},_performDrop:function(event,ui){var self=this,parent,target=$(event.originalEvent.target),noCancel;if(target.is("div[data-role=insert-line]")){target=target.closest("li[data-role=node]")}self.element.find("div[data-role=insert-line]").remove();noCancel=self._triggerNodeDropping(event,ui,target.closest("li[data-role=node]"),target.next("li[data-role=node]").length>0||!self._validationObject.dropAfter?target.index()+(self._validationObject.dropAfter?1:0):target.index());if(noCancel){if(target.is("a")||target.closest("a").parent().is("li[data-role=node]")){target=target.closest("li[data-role=node]");switch(self.options.dragAndDropSettings.dragAndDropMode){case"move":self.addNode(self._sourceNode.data,target);self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"));break;case"copy":self.addNode(self._sourceNode.data,target);break;default:if(!event.ctrlKey){self.addNode(self._sourceNode.data,target);self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"))}else{self.addNode(self._sourceNode.data,target)}break}}else if(target.is("li")){parent=self.parentNode(target);switch(self.options.dragAndDropSettings.dragAndDropMode){case"move":self.addNode(self._sourceNode.data,parent,target.next("li[data-role=node]").length>0||!self._validationObject.dropAfter?target.index()+(self._validationObject.dropAfter?1:0):null);self._sourceNode.element.attr("data-path",self._sourceNode.element.attr("data-path")+"_remove");self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"));break;case"copy":self.addNode(self._sourceNode.data,parent,target.next("li[data-role=node]").length>0||!self._validationObject.dropAfter?target.index()+(self._validationObject.dropAfter?1:0):null);break;default:if(!event.ctrlKey){self.addNode(self._sourceNode.data,parent,target.next("li[data-role=node]").length>0||!self._validationObject.dropAfter?target.index()+(self._validationObject.dropAfter?1:0):null);self._sourceNode.element.attr("data-path",self._sourceNode.element.attr("data-path")+"_remove");self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"))}else{self.addNode(self._sourceNode.data,parent,target.next("li[data-role=node]").length>0||!self._validationObject.dropAfter?target.index()+(self._validationObject.dropAfter?1:0):null)}break}}else if(target.is(":ui-igTree")){switch(self.options.dragAndDropSettings.dragAndDropMode){case"move":self.addNode(self._sourceNode.data);self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"));break;case"copy":self.addNode(self._sourceNode.data);break;default:if(!event.ctrlKey){self.addNode(self._sourceNode.data);self._sourceNode.owner.removeAt(self._sourceNode.element.attr("data-path"))}else{self.addNode(self._sourceNode.data)}break}}self._triggerNodeDropped(event,ui,target)}else{return false}},_accept:function(dropElem,target){var valid=true,node=target.closest("li[data-role=node]"),dropPath=dropElem.attr("data-path"),tree=target.closest(".ui-widget.ui-igtree"),sourceBinding=this._retrieveCurrentDepthBinding(parseInt(this._sourceNode.element.closest("ul").attr("data-depth"),10)),destinationBinding;if(target.is("a")&&target.parent().is("li[data-role=node]")||target.closest("a").parent().is("li[data-role=node]")){destinationBinding=tree.data("igTree")._retrieveCurrentDepthBinding(parseInt(target.closest("ul").attr("data-depth"),10)+1)}else{if(target.is("li[data-role=node]")){destinationBinding=tree.data("igTree")._retrieveCurrentDepthBinding(parseInt(target.closest("ul").attr("data-depth"),10))}else if(target.is(":ui-igTree")){destinationBinding=tree.data("igTree")._retrieveCurrentDepthBinding(0)}else{destinationBinding=false}}if(node.length>0&&(node.attr("data-path")===dropPath||node.attr("data-path").indexOf(dropPath+this.options.pathSeparator)===0)&&this===tree.data("igTree")){valid=false}else if(this!==tree.data("igTree")&&!tree.igTree("option","dragAndDropSettings").allowDrop){valid=false}else if(typeof tree.igTree("option","dragAndDropSettings").customDropValidation==="function"){valid=tree.igTree("option","dragAndDropSettings").customDropValidation.apply(target,[dropElem])}if(sourceBinding&&destinationBinding&&valid){valid=this._validateBindings(sourceBinding,destinationBinding,target)}return valid},_validateBindings:function(sourceBinding,destinationBinding,target){var valid=true;if(destinationBinding.hasOwnProperty("primaryKey")){if(!sourceBinding.hasOwnProperty("primaryKey")||sourceBinding.primaryKey!==destinationBinding.primaryKey){valid=false}else if(target.is("a")&&this._sourceNode.element.parent().closest("li[data-role=node]").is(target.closest("li[data-role=node]"))){valid=false}}if(destinationBinding.textKey!==sourceBinding.textKey){valid=false}if(destinationBinding.hasOwnProperty("valueKey")&&sourceBinding.hasOwnProperty("valueKey")&&destinationBinding.valueKey!==sourceBinding.valueKey){valid=false}if(destinationBinding.hasOwnProperty("childDataProperty")&&sourceBinding.hasOwnProperty("childDataProperty")&&destinationBinding.childDataProperty!==sourceBinding.childDataProperty){valid=false}return valid},_initDragAndDrop:function(element){var dragOptions=this._initDragOptions(),dropOptions=this._initDropOptions();if(!this._insertLine.html){this._insertLine.html='<div data-role="insert-line" class="'+this.css.insertLine+'"></div>'}if(!element){this.element.find("li[data-role=node]").draggable(dragOptions);this.element.droppable(dropOptions);this.element.delegate("a","mousedown",function(){$(this).focus()})}else{element.draggable(dragOptions);element.find("li[data-role=node]").draggable(dragOptions)}},_destroyDragAndDrop:function(){this.element.find("li[data-role=node]").draggable("destroy");this.element.droppable("destroy");this.element.undelegate("a","mousedown")},_constructFromData:function(){var ul,data=this.options.dataSource._rootds.data(),self=this;this._triggerDataBound(data);this._triggerRendering(data);this.element.attr("data-scroll",true);if(this.element.is("ul")){this.element.empty();ul=this.element;ul.addClass(this.css.treeCollection).addClass(this.css.treeRoot).attr("data-depth",0);MSApp.execUnsafeLocalFunction(function(){ul.html(self._initChildrenRecursively("",data))});this._triggerRendered()}else{this.element.empty();ul="<ul class='"+this.css.treeCollection+" "+this.css.treeRoot+"' data-depth='0'>";ul+=this._initChildrenRecursively("",data);ul+="</ul>";MSApp.execUnsafeLocalFunction(function(){$(ul).appendTo(self.element)});this._triggerRendered()}if(this.options.dragAndDrop){this._initDragAndDrop();if(typeof this.options.dragAndDropSettings.customDropValidation==="string"){if(window[this.options.dragAndDropSettings.customDropValidation]&&typeof window[this.options.dragAndDropSettings.customDropValidation]==="function"){this.options.dragAndDropSettings.customDropValidation=window[this.options.dragAndDropSettings.customDropValidation]}}}},_attachEvents:function(){var self=this,css=this.css,noCancel,target;this.element.delegate("span[data-role=expander]","click",function(event){self.toggle($(event.target).closest("li[data-role=node]"),event)});if(this.options.hotTracking){this.element.delegate("a",{click:function(event){target=$(event.target).closest("a");noCancel=self._triggerNodeClick(event,target.parent());if(noCancel){self.select(target.parent(),event);if($.ig.util.isWebKit){target.focus()}}else{event.preventDefault()}},dblclick:function(event){event.preventDefault();self._triggerNodeDoubleClick(event,$(event.target.parentNode))},keydown:function(event){self._kbNavigation(event)},focus:function(event){self._focusNode(event)},blur:function(event){self._blurNode(event)},mouseover:function(event){target=$(event.target).closest("a");target.addClass(css.nodeHovered)},mouseout:function(event){target=$(event.target).closest("a");target.removeClass(css.nodeHovered)}})}else{this.element.delegate("a",{click:function(event){target=$(event.target).closest("a");noCancel=self._triggerNodeClick(event,target.parent());if(noCancel){self.select(target.parent(),event);if($.ig.util.isWebKit){target.focus()}}else{event.preventDefault()}},dblclick:function(event){event.preventDefault();self._triggerNodeDoubleClick(event,$(event.target.parentNode))},keydown:function(event){self._kbNavigation(event)},focus:function(event){self._focusNode(event)},blur:function(event){self._blurNode(event)}})}this.element.delegate("span[data-role=checkbox] > span",{click:function(event){self.toggleCheckstate($(event.target).closest("li[data-role=node]"),event)},mouseover:function(event){$(event.target).closest("span[data-role=checkbox]").addClass(css.nodeHovered)},mouseout:function(event){$(event.target).closest("span[data-role=checkbox]").removeClass(css.nodeHovered)}})},_initChildrenRecursively:function(path,data,depth,checkFlag,indexFeed){var childUl,opt=this.options,childPath,binding,value,display,liStr=[],i=0,li,children;if(!indexFeed){indexFeed=0}if(!depth){depth=0}binding=this._retrieveCurrentDepthBinding(depth);if(!data.hasOwnProperty("length")&&data.hasOwnProperty(binding.textKey)){data=[data]}for(i;i<data.length;i++){childUl="";value="";if(path.length<=0){if(binding.hasOwnProperty("primaryKey")&&data[i].hasOwnProperty(binding.primaryKey)){childPath=typeof data[i][binding.primaryKey]==="function"?data[i][binding.primaryKey]():data[i][binding.primaryKey]}else{childPath=i+indexFeed}}else{if(binding.hasOwnProperty("primaryKey")&&data[i].hasOwnProperty(binding.primaryKey)){childPath=path+opt.pathSeparator+(typeof data[i][binding.primaryKey]==="function"?data[i][binding.primaryKey]():data[i][binding.primaryKey])}else{childPath=path+opt.pathSeparator+(i+indexFeed)}}if(binding.hasOwnProperty("valueKey")&&data[i].hasOwnProperty(binding.valueKey)){if(typeof data[i][binding.valueKey]==="function"){value=data[i][binding.valueKey]()}else{value=data[i][binding.valueKey]}}li='<li class="'+this._buildNodeCssString(data[i],depth,binding)+'" data-path="'+childPath+'" data-value="'+value+'" data-role="node">';children=data[i][binding.childDataProperty];if(typeof children==="function"){children=children()}if(children&&children.length>0||children&&opt.loadOnDemand){if(depth<=opt.initialExpandDepth&&!opt.loadOnDemand||binding.hasOwnProperty("expandedKey")&&data[i].hasOwnProperty(binding.expandedKey)&&data[i][binding.expandedKey]){li+=this._renderExpanderImage(true);display="block"}else{li+=this._renderExpanderImage(false);display="none"}}if(opt.checkboxMode&&opt.checkboxMode.toLowerCase()!=="off"){li+=this._renderCheckbox(checkFlag)}li+=this._renderNodeImage(data[i],binding);if(!binding.nodeContentTemplate){li+=this._renderAnchor(data[i],binding)}else{li+=this._renderNodeTemplate(data[i],binding)}if(children&&children.length>0||children&&opt.loadOnDemand){childUl='<ul style="display: '+display+'" data-depth="'+(depth+1)+'"';if(children.length>0&&!opt.loadOnDemand){childUl+=">"+this._initChildrenRecursively(childPath,children,depth+1,checkFlag)}else{childUl+=' data-populated="false">'}childUl+="</ul>"}li+=childUl;li+="</li>";liStr.push(li)}return liStr.join("")},_buildNodeCssString:function(data,depth,binding){var css=this.css,str=css.treeNode,children;if(depth===0){str+=" "+css.treeRootNode}children=data[binding.childDataProperty];if(typeof children==="function"){children=children()}if(children&&children.length>0||children&&this.options.loadOnDemand){str+=" "+css.parentNode}else{str+=" "+css.nodeNoChildren}return str},_retrieveCurrentDepthBinding:function(depth){var binding=this.options.bindings,i=0;for(i;i<depth;i++){if(binding.hasOwnProperty("bindings")){binding=binding.bindings}else{break}}return binding},_renderExpanderImage:function(expanded){var self=this,css=self.css,expander="";if(expanded){expander="<span data-role='expander' data-exp='true' class='"+css.collapseIcon+" "+css.nodeExpander+"'></span>"}else{expander="<span data-role='expander' data-exp='false' class='"+css.expandIcon+" "+css.nodeExpander+"'></span>"}return expander},_renderAnchor:function(data,binding){var href,target,text;if(binding.hasOwnProperty("navigateUrlKey")&&data[binding.navigateUrlKey]){if(typeof data[binding.navigateUrlKey]==="function"){href=data[binding.navigateUrlKey]()}else if(data[binding.navigateUrlKey].length<=0){href="#"}else{href=data[binding.navigateUrlKey]}}else{href="#"}if(binding.targetKey&&binding.targetKey.length>0&&data.hasOwnProperty(binding.targetKey)){target=data[binding.targetKey]}else{target=this.options.defaultNodeTarget}if(typeof data[binding.textKey]==="function"){text=data[binding.textKey]()}else{text=data[binding.textKey]}return"<a href='"+href+"' target='"+target+"' class='"+this.css.nodeAnchor+"'>"+text+"</a>"},_renderNodeTemplate:function(data,binding){var div=$("<div></div>"),html,href,target,template=binding.nodeContentTemplate;if(binding.hasOwnProperty("navigateUrlKey")&&data[binding.navigateUrlKey]){if(typeof data[binding.navigateUrlKey]==="function"){href=data[binding.navigateUrlKey]()}else if(data[binding.navigateUrlKey].length<=0){href="#"
}else{href=data[binding.navigateUrlKey]}}else{href="#"}if(binding.targetKey&&binding.targetKey.length>0&&data.hasOwnProperty(binding.targetKey)){target=data[binding.targetKey]}else{target=this.options.defaultNodeTarget}div.html($.ig.tmpl(template,data));if(div.children("a").length<=0){html="<a href='"+href+"' target='"+target+"' class='"+this.css.nodeAnchor+"'>"+div.html()+"</a>"}else if(!div.children("a").attr("href")){div.children("a").addClass(this.css.nodeAnchor).attr({href:href,target:target});html=div.html()}else{div.children("a").addClass(this.css.nodeAnchor);html=div.html()}return html},_renderCheckbox:function(checkFlag){var self=this,css=self.css;return"<span data-chk='"+(checkFlag?"on":"off")+"' data-role='checkbox' class='"+css.checkbox+"'><span class='"+(checkFlag?css.checkboxOn:css.checkboxOff)+"'></span></span>"},_renderNodeImage:function(data,binding){var opt=this.options,hasChildren,img="",src;hasChildren=data[binding.childDataProperty]&&data[binding.childDataProperty].length>0||data[binding.childDataProperty]&&opt.loadOnDemand;if(binding.hasOwnProperty("imageUrlKey")&&data.hasOwnProperty(binding.imageUrlKey)){if(typeof data[binding.imageUrlKey]==="function"){src=data[binding.imageUrlKey]();if(src&&src.length>0){img='<img src="'+src+'" alt="error" data-role="node-image" />'}}else if(data[binding.imageUrlKey].length>0){img='<img src="'+data[binding.imageUrlKey]+'" alt="error" data-role="node-image" />'}}if(opt.parentNodeImageUrl&&hasChildren){img+="<img src='"+opt.parentNodeImageUrl+"' alt='error' title='"+(opt.parentNodeImageTooltip!==null?opt.parentNodeImageTooltip:"")+"' data-role='parent-node-image' />"}else if(opt.parentNodeImageClass&&hasChildren){img+="<span title='"+(opt.parentNodeImageTooltip!==null?opt.parentNodeImageTooltip:"")+"' class='"+opt.parentNodeImageClass+"' data-role='parent-node-image'></span>"}else if(!hasChildren&&opt.leafNodeImageUrl){img+="<img src='"+opt.leafNodeImageUrl+"' alt='error' title='"+(opt.leafNodeImageTooltip!==null?opt.leafNodeImageTooltip:"")+"' data-role='leaf-node-image' />"}else if(!hasChildren&&opt.leafNodeImageClass){img+="<span title='"+(opt.leafNodeImageTooltip!==null?opt.leafNodeImageTooltip:"")+"' class='"+opt.leafNodeImageClass+"' data-role='leaf-node-image'></span>"}return img},_focusNode:function(event){$(event.target).addClass(this.css.nodeActive)},_blurNode:function(event){$(event.target).removeClass(this.css.nodeActive)},_kbNavigation:function(event){var opt=this.options,css=this.css,li=$(event.target.parentNode),nextLi,seq=li.index(),expander;if(event.keyCode===$.ui.keyCode.UP){nextLi=this._nextVisibleNodeUp(li);if(!nextLi){return}if(event.ctrlKey){li.children("a").blur();nextLi.children("a").focus()}else{li.children("a").blur();nextLi.children("a").focus();this.select(nextLi,null)}event.preventDefault()}else if(event.keyCode===$.ui.keyCode.DOWN){nextLi=this._nextVisibleNodeDown(li,seq);if(!nextLi){return}if(event.ctrlKey){li.children("a").blur();nextLi.children("a").focus()}else{li.children("a").blur();nextLi.children("a").focus();this.select(nextLi,null)}event.preventDefault()}else if(event.keyCode===$.ui.keyCode.RIGHT){if(li.children("ul").length>0){expander=li.children("."+css.nodeExpander);if(!expander.attr("data-exp")||expander.attr("data-exp")==="false"){this.toggle(li,null)}else{nextLi=li.find("ul > li:first");if(nextLi.length>0){if(event.ctrlKey){li.children("a").blur();nextLi.children("a").focus()}else{li.children("a").blur();nextLi.children("a").focus();this.select(nextLi,null)}}}}}else if(event.keyCode===$.ui.keyCode.LEFT){expander=li.children("."+css.nodeExpander);if(expander.attr("data-exp")&&expander.attr("data-exp")!=="false"){this.toggle(li,null)}else if(li.parent().parent().is("li")){nextLi=li.parent().parent();if(event.ctrlKey){li.children("a").blur();nextLi.children("a").focus()}else{li.children("a").blur();nextLi.children("a").focus();this.select(nextLi,null)}}}else if(event.keyCode===$.ui.keyCode.NUMPAD_ADD){if(li.children("ul").length>0){expander=li.children("."+css.nodeExpander);if(!expander.attr("data-exp")||expander.attr("data-exp")==="false"){this.toggle(li,null)}}}else if(event.keyCode===$.ui.keyCode.NUMPAD_SUBTRACT){if(li.children("ul").length>0){expander=li.children("."+css.nodeExpander);if(expander.attr("data-exp")&&expander.attr("data-exp")!=="false"){this.toggle(li,null)}}}else if(event.keyCode===$.ui.keyCode.SPACE){if(opt.checkboxMode&&opt.checkboxMode.toLowerCase()!=="off"){this.toggleCheckstate(li,null);event.preventDefault();event.stopPropagation()}}else if(event.keyCode===$.ui.keyCode.HOME){li.children("a").blur();li=this.element.find("li:first");if(li.length>0){li.children("a").focus();this.select(li)}event.preventDefault()}else if(event.keyCode===$.ui.keyCode.END){li.children("a").blur();li=this._lastVisibleNode();if(li){li.children("a").focus();this.select(li)}event.preventDefault()}},_nextVisibleNodeDown:function(node,nodeSeq){var expander=node.children("."+this.css.nodeExpander),parentLi,seq=nodeSeq,result=null;if(expander.length>0&&expander.attr("data-exp")&&expander.attr("data-exp")!=="false"&&node.children("ul").children("li:first").length>0){return node.children("ul").children("li:first")}if(seq===node.siblings().length){parentLi=node.parent().parent();while(parentLi.is("li")){seq=parentLi.index();if(seq!==parentLi.siblings().length){result=parentLi.next();break}parentLi=parentLi.parent().parent()}}else{result=node.next()}return result},_nextVisibleNodeUp:function(node){var li=node.prev(),expander,result=null;if(li.length<=0){if(node.parent().parent().is("li")){result=node.parent().parent()}}else{while(li.length>0){expander=li.children("."+this.css.nodeExpander);if(li.children("ul").children("li").length<=0||!expander.attr("data-exp")||expander.attr("data-exp")==="false"){result=li;break}li=li.children("ul").children("li:last")}}return result},_lastVisibleNode:function(){var li=this.element.is("ul")?this.element.children("li:last"):this.element.children("ul").children("li:last"),expander,result;if(li.length<=0){result=null}else{while(li.length>0){expander=li.children("."+this.css.nodeExpander);if(li.children("ul").children("li").length<=0||!expander.attr("data-exp")||expander.attr("data-exp")==="false"){result=li;break}li=li.children("ul").children("li:last")}}return result},_populatingNode:null,_populateNodeData:function(success,msg,data){if(!success){throw new Error($.ig.Tree.locale.errorOnRequest+msg)}var ul=this._populatingNode.ul,node=this._populatingNode.node,originalData=this.nodeDataFor(node.attr("data-path")),depth=ul.attr("data-depth"),binding=this._retrieveCurrentDepthBinding(depth-1),checked,newData=data.data();if(this.options.checkboxMode.toLowerCase()==="tristate"){checked=this.isChecked(node)}ul.children('li[data-role="loading"]').remove();if(!originalData[binding.childDataProperty]||!originalData[binding.childDataProperty].length){originalData[binding.childDataProperty]=newData}else{originalData[binding.childDataProperty]=originalData[binding.childDataProperty].concat(newData)}this._triggerNodePopulated(null,node);this._triggerRendering(newData);ul.append(this._initChildrenRecursively(node.attr("data-path"),newData,parseInt(ul.attr("data-depth"),10),checked));ul.attr("data-populated",true);if(this.options.dragAndDrop){this._initDragAndDrop(ul)}this._triggerRendered();this._populatingNode.indicator.hide();this._populatingNode.indicator.destroy();this._populatingNode=null;this.toggle(node);this._loadRequest()},_prepareRequest:function(node,event){var opt=this.options,pathKeyArr,path,key,data,binding,parentBinding,noCancel;if(this._populatingNode!==null){return}noCancel=this._triggerNodePopulating(event,node);if(noCancel){pathKeyArr=this._buildRequestString(node);binding=this._retrieveCurrentDepthBinding(parseInt(node.children("ul").attr("data-depth"),10));if(!pathKeyArr){return}path=pathKeyArr[0];key=pathKeyArr[1];data=this.nodeDataFor(node.attr("data-path"));parentBinding=this._retrieveCurrentDepthBinding(parseInt(node.children("ul").attr("data-depth"),10)-1);if(data.hasOwnProperty(parentBinding.childDataProperty)){data=data[parentBinding.childDataProperty]}if(data&&data.__deferred&&data.__deferred.uri){this._executeODataRequest(node,data)}else if(data&&data.length>0&&!opt.dataSourceUrl){this._renderOnDemand(node,data)}else{this._executeUrlRequest(node,binding,path,key)}}},_executeODataRequest:function(node,data){var dataSource,ul,indicator,opt=this.options,li;dataSource=new $.ig.JSONPDataSource({dataSource:data.__deferred.uri+"?$format=json&$callback=?",responseDataKey:opt.responseDataKey});ul=node.children("ul");li=$('<li style="width: 20px" data-role="loading">&nbsp;</li>').appendTo(ul);ul.show();indicator=li.igLoading({includeVerticalOffset:false}).data("igLoading").indicator();indicator.show();this._populatingNode={ul:ul,node:node,indicator:indicator};dataSource.dataBind(this._populateNodeData,this)},_renderOnDemand:function(node,data){var ul,checked;ul=node.children("ul");if(this.options.checkboxMode.toLowerCase()==="tristate"){checked=this.isChecked(node)}this._triggerNodePopulated(null,node);this._triggerRendering(data);ul.html(this._initChildrenRecursively(node.attr("data-path"),data,parseInt(ul.attr("data-depth"),10),checked));ul.attr("data-populated",true);if(this.options.dragAndDrop){this._initDragAndDrop(ul)}this._triggerRendered();this.toggle(node);this._loadRequest()},_executeUrlRequest:function(node,binding,path,key){var opt=this.options,ul,indicator,dataSource,li;if(opt.dataSourceUrl&&opt.dataSourceUrl.lastIndexOf("?")===-1){opt.dataSourceUrl+="?"}else if(!opt.dataSourceUrl){throw new Error($.ig.Tree.locale.noDataSourceUrl)}dataSource=new $.ig.DataSource({dataSource:opt.dataSourceUrl+"&"+this._encodeUrlPath(path,key)+"&"+this._encodeBinding(binding)+"&depth="+node.parent().attr("data-depth"),dataSourceType:"remoteUrl"});ul=node.children("ul");li=$('<li style="width: 20px" data-role="loading">&nbsp;</li>').appendTo(ul);ul.show();indicator=li.igLoading({includeVerticalOffset:false}).data("igLoading").indicator();indicator.show();this._populatingNode={ul:ul,node:node,indicator:indicator};dataSource.dataBind(this._populateNodeData,this)},_buildRequestString:function(node){var nodePath,key="",path="",binding=this.options.bindings,i,result;nodePath=node.attr("data-path").split(this.options.pathSeparator);for(i=0;i<nodePath.length;i++){if(key.length>0){key+="/"}key+=binding.childDataProperty;if(path.length>0){path+="/"}path+=(binding.primaryKey?binding.primaryKey+":":"")+nodePath[i];if(binding.bindings){binding=binding.bindings}}if(path.length<=0){result=null}else{result=[path,key]}return result},_encodeBinding:function(binding){var temp="binding=",item;for(item in binding){if(binding.hasOwnProperty(item)&&item!=="bindings"&&item!=="nodeContentTemplate"){temp+=item.toString()+":"+binding[item]+","}}temp=temp.substr(0,temp.length-1);return temp},_encodeUrlPath:function(path,key){var result;if(path.lastIndexOf("/")===-1){path+="/@"+key;result="path="+path}else{result="path="+path.substr(path.lastIndexOf("/")+1,path.length)+"/@"+key.substr(key.lastIndexOf("/")+1,key.length)}return result},_updateParentState:function(parent){var expander=parent.children("span[ data-role=expander ]");if(expander.length<=0){parent.removeClass(this.css.nodeNoChildren).addClass(this.css.parentNode);$(this._renderExpanderImage(false)).prependTo(parent)}else if(parent.children("ul").children("li").length<=0){parent.removeClass(this.css.parentNode).addClass(this.css.nodeNoChildren);parent.children("ul").remove();expander.remove()}this._updateImage(parent)},_updateParentCheckbox:function(parent){var checkbox=parent.children("span[data-role=checkbox]"),checkIcon=checkbox.children("span"),checkState=checkbox.attr("data-chk"),shouldBe,checkCount=0,css=this.css;parent.children("ul").children("li").each(function(){if($(this).children("span[data-role=checkbox]").attr("data-chk")==="on"){checkCount++}});if(checkCount===0){shouldBe="off"}else if(checkCount===parent.children("ul").children("li").length){shouldBe="on"}else{shouldBe="partial"}if(checkState!==shouldBe){checkbox.attr("data-chk",shouldBe);switch(shouldBe){case"off":checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff);break;case"partial":checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxOff).addClass(css.checkboxPartial);break;case"on":checkIcon.removeClass(css.checkboxPartial).removeClass(css.checkboxOff).addClass(css.checkboxOn);break;default:checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff)}parent=this.parentNode(parent);if(parent){this._updateParentCheckbox(parent)}}},_updateImage:function(parent){var hasChildren=parent.children("ul").children("li").length>0,opt=this.options,img;if(!hasChildren){if(opt.leafNodeImageUrl){img=parent.children("img[data-role=parent-node-image]");if(img.length>0){img.attr("title",opt.leafNodeImageTooltip!==null?opt.leafNodeImageTooltip:"");img.attr("src",opt.leafNodeImageUrl);img.attr("data-role","leaf-node-image")}}else if(opt.leafNodeImageClass){img=parent.children("span[data-role=parent-node-image]");if(img.length>0){img.attr("title",opt.leafNodeImageTooltip!==null?opt.leafNodeImageTooltip:"");img.removeClass(opt.parentNodeImageClass).addClass(opt.leafNodeImageClass);img.attr("data-role","leaf-node-image")}}}else{if(opt.parentNodeImageUrl){img=parent.children("img[data-role=leaf-node-image]");if(img.length>0){img.attr("title",opt.parentNodeImageTooltip!==null?opt.parentNodeImageTooltip:"");img.attr("src",opt.parentNodeImageUrl);img.attr("data-role","parent-node-image")}}else if(opt.parentNodeImageClass){img=parent.children("span[data-role=leaf-node-image]");if(img.length>0){img.attr("title",opt.parentNodeImageTooltip!==null?opt.parentNodeImageTooltip:"");img.removeClass(opt.leafNodeImageClass).addClass(opt.parentNodeImageClass);img.attr("data-role","parent-node-image")}}}},_addData:function(data,path,depth,dataIndex){var originalData=this.nodeDataFor(path),binding=this._retrieveCurrentDepthBinding(depth),temp,i;if(!binding.hasOwnProperty("primaryKey")){if(!originalData){if(this.options.dataSource._rootds._data.length<=this.element.find(".ui-igtree-noderoot").length||this.element.find(".ui-igtree-noderoot").length<=0){if(dataIndex===0){if($.type(data)==="array"){this.options.dataSource._rootds._data=data.concat(this.options.dataSource._rootds._data)}else{this.options.dataSource._rootds._data=[data].concat(this.options.dataSource._rootds._data)}}else if(!dataIndex){if($.type(data)==="array"){for(i=0;i<data.length;i++){this.options.dataSource._rootds._data.push(data[i])}}else{this.options.dataSource._rootds._data.push(data)}}else{this.options.dataSource._rootds._data.splice(dataIndex,0,data)}}}else{if(typeof originalData[binding.childDataProperty]!=="function"){if(!originalData.hasOwnProperty(binding.childDataProperty)||$.type(originalData[binding.childDataProperty])!=="array"){originalData[binding.childDataProperty]=[]}if(dataIndex===0){if($.type(data)==="array"){originalData[binding.childDataProperty]=data.concat(originalData[binding.childDataProperty])}else{originalData[binding.childDataProperty]=[data].concat(originalData[binding.childDataProperty])}}else if(!dataIndex){originalData[binding.childDataProperty]=originalData[binding.childDataProperty].concat(data)}else{temp=originalData[binding.childDataProperty].slice(0,dataIndex);temp=temp.concat(data);originalData[binding.childDataProperty]=temp.concat(originalData[binding.childDataProperty].slice(dataIndex))}}else{if(originalData[binding.childDataProperty]().length<=this.nodeByPath(path).children("ul").children("li").length){if(dataIndex===0){temp=$("<li></li>").appendTo(this.nodeByPath(path).children("ul"));originalData[binding.childDataProperty].unshift(data);temp.remove()}else if(!dataIndex){temp=$("<li></li>").appendTo(this.nodeByPath(path).children("ul"));originalData[binding.childDataProperty].push(data);temp.remove()}else{temp=$("<li></li>").appendTo(this.nodeByPath(path).children("ul"));originalData[binding.childDataProperty]().splice(dataIndex,0,data);temp.remove()}}}}}else{if(!originalData){if(this.options.dataSource._rootds._data.length<=this.element.find(".ui-igtree-noderoot").length||this.element.find(".ui-igtree-noderoot").length<=0){if($.type(data)==="array"){for(i=0;i<data.length;i++){this.options.dataSource._rootds._data.push(data[i])}}else{this.options.dataSource._rootds._data.push(data)}}}else{if(typeof originalData[binding.childDataProperty]!=="function"){if(!originalData.hasOwnProperty(binding.childDataProperty)||$.type(originalData[binding.childDataProperty])!=="array"){originalData[binding.childDataProperty]=[]}originalData[binding.childDataProperty]=originalData[binding.childDataProperty].concat(data)}else{if(originalData[binding.childDataProperty]().length<=this.nodeByPath(path).children("ul").children("li").length){temp=$("<li></li>").appendTo(this.nodeByPath(path).children("ul"));originalData[binding.childDataProperty].push(data);temp.remove()}}}}},_removeData:function(path){var splitPath=path.split(this.options.pathSeparator),data=this.options.dataSource._rootds.data(),i,j,binding=this.options.bindings,key;if(splitPath.length===1){if(!binding.hasOwnProperty("primaryKey")){data.splice(parseInt(splitPath[0],10),1)}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)){key=typeof data[j][binding.primaryKey]==="function"?data[j][binding.primaryKey]():data[j][binding.primaryKey];if(key.toString()===splitPath[0].toString()){data.splice(j,1);break}}}}return}for(i=0;i<splitPath.length-1;i++){if(!binding.hasOwnProperty("primaryKey")){data=data[parseInt(splitPath[i],10)]}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)){key=typeof data[j][binding.primaryKey]==="function"?data[j][binding.primaryKey]():data[j][binding.primaryKey];if(key.toString()===splitPath[i].toString()){data=data[j];break}}}}if(i<splitPath.length-2){if(data[binding.childDataProperty]&&typeof data[binding.childDataProperty]==="function"){data=data[binding.childDataProperty]()}else{data=data[binding.childDataProperty]}}if(binding.hasOwnProperty("bindings")&&i<splitPath.length-2){binding=binding.bindings}}if(data[binding.childDataProperty]&&typeof data[binding.childDataProperty]!=="function"){if(data[binding.childDataProperty]&&data[binding.childDataProperty].length<=1){delete data[binding.childDataProperty]}else{data=data[binding.childDataProperty];if(binding.hasOwnProperty("bindings")){binding=binding.bindings}if(!binding.hasOwnProperty("primaryKey")&&data.length){data.splice(parseInt(splitPath[splitPath.length-1],10),1)}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)&&data[j][binding.primaryKey].toString()===splitPath[i].toString()){data.splice(j,1);break}}}}}else{data=data[binding.childDataProperty]();if(binding.hasOwnProperty("bindings")){binding=binding.bindings}if(!binding.hasOwnProperty("primaryKey")&&data.length){data.splice(parseInt(splitPath[splitPath.length-1],10),1)}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)){key=typeof data[j][binding.primaryKey]==="function"?data[j][binding.primaryKey]():data[j][binding.primaryKey];if(key.toString()===splitPath[splitPath.length-1].toString()){data.splice(j,1);break}}}}}},_recalculatePaths:function(path){var splitPath=path.split(this.options.pathSeparator),index=path.length>0?splitPath[splitPath.length-1]:0,node,parentPath,newPath,ul,child;if(splitPath.length>1){splitPath.splice(splitPath.length-1,1);parentPath=splitPath.join(this.options.pathSeparator);node=this.nodeByPath(parentPath);for(index;index<node.children("ul").children("li").length;index++){newPath=parentPath+this.options.pathSeparator+index;child=$(node.children("ul").children("li")[index]);child.attr("data-path",newPath);if(child.children("ul").length>0&&child.children("ul").children("li").length>0){this._recalculatePaths(newPath+this.options.pathSeparator+"0")}}}else{ul=this.element.is("ul")?this.element:this.element.children("ul");for(index;index<ul.children("li").length;index++){child=$(ul.children("li")[index]);child.attr("data-path",index);if(child.children("ul").length>0&&child.children("ul").children("li").length>0){this._recalculatePaths(index+this.options.pathSeparator+"0")}}}},_loadQueue:null,_toSelect:false,_triggerChainRequest:function(path,toSelect){var list=path.split(this.options.pathSeparator),i,newPath="";if(this._loadQueue===null){this._loadQueue=[]}if(toSelect){this._toSelect=true}for(i=0;i<list.length;i++){newPath+=list[i];this._loadQueue.push(newPath);newPath+=this.options.pathSeparator}this._loadRequest()},_loadRequest:function(){var node;if(this._populatingNode===null){if(this._loadQueue&&this._loadQueue.length>0){node=this.nodeByPath(this._loadQueue.shift());if(this._loadQueue.length>0){if(!this.isExpanded(node)){this.toggle(node)}else{this._loadRequest()}}else if(this._toSelect){this.select(node);this._toSelect=false}}}},_replaceUIValue:function(node,data,item){var element=node.element,binding=this._retrieveCurrentDepthBinding(parseInt(element.parent().attr("data-depth"),10)),value,isFocused,anchor;switch(item){case binding.textKey:if(!binding.nodeContentTemplate){value=typeof data[item]==="function"?data[item]():data[item];element.children("a").text(value)}else{anchor=element.children("a");if(anchor.hasClass(this.css.nodeActive)){isFocused=true}anchor.replaceWith(this._renderNodeTemplate(data,binding));if(this.isSelected(element)){element.children("a").addClass(this.css.nodeSelected);this._selectedNode[0]=this.nodeFromElement(element)}if(isFocused){element.children("a").focus()}}break;case binding.valueKey:value=typeof data[item]==="function"?data[item]():data[item];element.attr("data-value",value);break;case binding.navigateUrlKey:value=typeof data[item]==="function"?data[item]():data[item];element.children("a").attr("href",value);break;case binding.imageUrlKey:value=typeof data[item]==="function"?data[item]():data[item];element.children("img[data-role=node-image]").attr("src",value);break}},dataBind:function(){this._triggerDataBinding();var dataOpt=this._initDataOptions();this._initDataSource(dataOpt);this.options.dataSource.dataBind(this._constructFromData,this)},toggleCheckstate:function(node,event){var self=this,opt=self.options,css=self.css,childCheckboxes,childCheckIcons,checkbox,checkIcon,parentLi,noCancel;if(!node){throw new Error($.ig.Tree.locale.incorrectNodeObject)}if(!opt.checkboxMode||opt.checkboxMode.toLowerCase()==="off"){return}checkbox=node.children("span[data-role=checkbox]");checkIcon=checkbox.children("span");noCancel=self._triggerNodeCheckstateChanging(event,node);if(noCancel){if(opt.checkboxMode.toLowerCase()==="tristate"){if(checkbox.attr("data-chk")==="on"||checkbox.attr("data-chk")==="partial"){childCheckboxes=node.find("span[data-role=checkbox]");childCheckIcons=childCheckboxes.children("span");checkbox.attr("data-chk","off");checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff);childCheckboxes.attr("data-chk","off");childCheckIcons.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff);parentLi=checkbox.parent().parent().parent();while(parentLi&&parentLi.is("li")){if(parentLi.find("ul > li > span[data-chk=on]").length<=0){checkbox=parentLi.children("span[data-role=checkbox]");checkIcon=checkbox.children("span");checkbox.attr("data-chk","off");checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff);parentLi=this.parentNode(parentLi)}else{checkbox=parentLi.children("span[data-role=checkbox]");checkIcon=checkbox.children("span");checkbox.attr("data-chk","partial");checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxOff).addClass(css.checkboxPartial);parentLi=this.parentNode(parentLi)}}}else{childCheckboxes=node.find("span[data-role=checkbox]");childCheckIcons=childCheckboxes.children("span");checkbox.attr("data-chk","on");checkIcon.removeClass(css.checkboxOff).removeClass(css.checkboxPartial).addClass(css.checkboxOn);childCheckboxes.attr("data-chk","on");childCheckIcons.removeClass(css.checkboxOff).removeClass(css.checkboxPartial).addClass(css.checkboxOn);parentLi=checkbox.parent().parent().parent();while(parentLi&&parentLi.is("li")){if(parentLi.find("ul > li > span[data-chk=on]").length===parentLi.find("ul > li").length){checkbox=parentLi.children("span[data-role=checkbox]");checkIcon=checkbox.children("span");checkbox.attr("data-chk","on");checkIcon.removeClass(css.checkboxOff).removeClass(css.checkboxPartial).addClass(css.checkboxOn);parentLi=this.parentNode(parentLi)}else{checkbox=parentLi.children("span[data-role=checkbox]");checkIcon=checkbox.children("span");checkbox.attr("data-chk","partial");checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxOff).addClass(css.checkboxPartial);parentLi=this.parentNode(parentLi)}}}}else{if(checkbox.attr("data-chk")==="on"||checkbox.attr("data-chk")==="partial"){checkbox.attr("data-chk","off");checkIcon.removeClass(css.checkboxOn).removeClass(css.checkboxPartial).addClass(css.checkboxOff)}else{checkbox.attr("data-chk","on");checkIcon.removeClass(css.checkboxOff).addClass(css.checkboxOn)}}self._triggerNodeCheckstateChanged(event,node)}},toggle:function(node,event){var self=this,opt=self.options,css=self.css,noCancel,sibling,siblingExpander,i=0,expander;if(!node){throw new Error($.ig.Tree.locale.incorrectNodeObject)}if(!event){expander=node.children("."+css.nodeExpander)}else{expander=$(event.target).closest("span[data-role=expander]")}if(node.children("ul").attr("data-populated")&&node.children("ul").attr("data-populated")==="false"){this._prepareRequest(node,event);return}if(expander.attr("data-exp")&&expander.attr("data-exp")!=="false"){noCancel=self._triggerNodeCollapsing(event,node);if(noCancel){$(node).children("ul").hide(opt.animationDuration,function(){self._triggerNodeCollapsed(event,node)});expander.removeClass(css.collapseIcon).addClass(css.expandIcon).attr("data-exp",false)}}else{noCancel=self._triggerNodeExpanding(event,node);if(noCancel){if(opt.singleBranchExpand){sibling=node.siblings();for(i;i<sibling.length;i++){siblingExpander=$(sibling[i]).children("."+css.nodeExpander);if(siblingExpander.length>0&&(siblingExpander.attr("data-exp")==="true"||siblingExpander.attr("data-exp")===true)){noCancel=self._triggerNodeCollapsing(event,$(sibling[i]));if(noCancel){$(sibling[i]).children("ul").hide(opt.animationDuration,$.proxy(this._triggerNodeCollapsed(event,$(sibling[i])),this));siblingExpander.removeClass(css.collapseIcon).addClass(css.expandIcon).attr("data-exp",false)}}}}node.children("ul").show(opt.animationDuration,function(){self._triggerNodeExpanded(event,node)});expander.removeClass(css.expandIcon).addClass(css.collapseIcon).attr("data-exp",true)}}},expandToNode:function(node,toSelect){var parentNode,cachedanimationDuration;if(node&&node.length>0){if(typeof node==="string"&&this.nodeByPath(node).length>0){node=this.nodeByPath(node)}if(typeof node==="string"&&this.options.loadOnDemand){this._triggerChainRequest(node,toSelect);return}if(toSelect){this.select(node)}parentNode=this.parentNode(node);cachedanimationDuration=this.options.animationDuration;this.options.animationDuration=0;while(parentNode){if(!this.isExpanded(parentNode)){this.toggle(parentNode)}parentNode=this.parentNode(parentNode)}this.options.animationDuration=cachedanimationDuration}},expand:function(node){var self=this,opt=self.options,css=self.css,sibling,siblingExpander,i=0,expander;if(!node||node.length<=0){throw new Error($.ig.Tree.locale.incorrectNodeObject)}if(node.children("ul").attr("data-populated")&&node.children("ul").attr("data-populated")==="false"){this._prepareRequest(node);return}expander=node.children("."+css.nodeExpander);if(!expander.attr("data-exp")||expander.attr("data-exp")==="false"){if(opt.singleBranchExpand){sibling=node.siblings();for(i;i<sibling.length;i++){siblingExpander=$(sibling[i]).children("."+css.nodeExpander);if(siblingExpander.length>0&&(siblingExpander.attr("data-exp")==="true"||siblingExpander.attr("data-exp")===true)){$(sibling[i]).children("ul").hide(opt.animationDuration);siblingExpander.removeClass(css.collapseIcon).addClass(css.expandIcon).attr("data-exp",false)}}}node.children("ul").show(opt.animationDuration);expander.removeClass(css.expandIcon).addClass(css.collapseIcon).attr("data-exp",true)}},collapse:function(node){var self=this,opt=self.options,css=self.css,expander;if(!node||node.length<=0){throw new Error($.ig.Tree.locale.incorrectNodeObject)}expander=node.children("."+css.nodeExpander);if(expander.attr("data-exp")&&expander.attr("data-exp")!=="false"){$(node).children("ul").hide(opt.animationDuration);expander.removeClass(css.collapseIcon).addClass(css.expandIcon).attr("data-exp",false)}},parentNode:function(node){if(!node){throw new Error($.ig.Tree.locale.incorrectNodeObject)}var parent=node.parent().closest("li[data-role=node]");return parent.length>0?parent:null},nodeByPath:function(nodePath){return this.element.find('li[data-path="'+nodePath+'"]')},nodesByValue:function(value){return this.element.find('li[data-value="'+value+'"]')},checkedNodes:function(){var elements=this.element.find("span[data-chk=on]").parent(),i=0,collection=[];if(elements.length>0){for(i;i<elements.length;i++){collection.push(this.nodeFromElement($(elements[i])))}}return collection},uncheckedNodes:function(){var elements=this.element.find("span[data-chk=off]").parent(),i=0,collection=[];if(elements.length>0){for(i;i<elements.length;i++){collection.push(this.nodeFromElement($(elements[i])))}}return collection},partiallyCheckedNodes:function(){var elements=this.element.find("span[data-chk=partial]").parent(),i=0,collection=[];if(elements.length>0){for(i;i<elements.length;i++){collection.push(this.nodeFromElement($(elements[i])))}}return collection},select:function(node,event){if(!node||node.length<=0){throw new Error($.ig.Tree.locale.incorrectNodeObject)}var css=this.css,nodeId=node.attr("data-path"),noCancel,prevent=false;if(event&&(node.children("a").attr("href")==="#"||node.children("a").attr("href")===document.URLUnencoded+"#")){prevent=true}if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(this._selectedNode[0].path!==null){if(this._selectedNode[0].path!==nodeId){noCancel=this._triggerSelectionChanging(event,node);if(noCancel){this._selectedNode[0].element.children("a").removeClass(css.nodeSelected);node.children("a").addClass(css.nodeSelected);this._selectedNode[0]=this.nodeFromElement(node);this._triggerSelectionChanged(event)}else if(event){prevent=true}}}else{noCancel=this._triggerSelectionChanging(event,node);if(noCancel){node.children("a").addClass(css.nodeSelected);this._selectedNode[0]=this.nodeFromElement(node);this._triggerSelectionChanged(event)}else if(event){prevent=true}}if(prevent){event.preventDefault()}},deselect:function(node){if(!node){throw new Error($.ig.Tree.locale.incorrectNodeObject)}var css=this.css,nodeId=node.attr("data-path");if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(this._selectedNode[0].path!==null){if(this._selectedNode[0].path===nodeId){node.children("a").removeClass(css.nodeSelected);this._selectedNode[0].path=null;this._selectedNode[0].element=null;this._selectedNode[0].data=null;this._selectedNode[0].binding=null}}},clearSelection:function(){var css=this.css,i=0;if(this._selectedNode&&this._selectedNode[0].path!==null){for(i;i<this._selectedNode.length;i++){this._selectedNode[i].element.children("a").removeClass(css.nodeSelected)}this._selectedNode=[{path:null,element:null,data:null,binding:null}]}},selectedNode:function(){if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}return this._selectedNode[0]},findNodesByText:function(text,parent){var collection=[],nodes,self=this;nodes=parent?parent.find('li > a:contains("'+text+'")'):this.element.find('li > a:contains("'+text+'")');
nodes.each(function(){collection.push(self.nodeFromElement($(this).closest("li[data-role=node]")))});return collection},findImmediateNodesByText:function(text,parent){var collection=[],nodes,self=this;nodes=parent?parent.children("ul").children("li").children('a:contains("'+text+'")'):this.element.is("ul")?this.element.children("li").children('a:contains("'+text+'")'):this.element.children("ul").children("li").children('a:contains("'+text+'")');nodes.each(function(){collection.push(self.nodeFromElement($(this).closest("li[data-role=node]")))});return collection},nodeByIndex:function(index,parent){var node;if(!parent){if(this.element.is("ul")){node=this.element.children().eq(index)}else{node=this.element.children("ul").children().eq(index)}}else{node=parent.children("ul").children().eq(index)}return node},nodeFromElement:function(element){if(element.length>0){var nodeElement={path:element.attr("data-path"),element:element,data:this.nodeDataFor(element.attr("data-path")),binding:this._retrieveCurrentDepthBinding(element.parent().attr("data-depth"))};return nodeElement}},children:function(parent){var children=[],self=this,child,ul;if(parent&&parent.length>0){ul=parent.children("ul");if(ul.length>0){ul.children("li").each(function(){child=$(this);children.push(self.nodeFromElement(child))})}return children}throw new Error($.ig.Tree.locale.incorrectNodeObject)},childrenByPath:function(path){var node=this.nodeByPath(path),children=[],self=this,child,ul;if(node.length>0){ul=node.children("ul");if(ul.length>0){ul.children("li").each(function(){child=$(this);children.push(self.nodeFromElement(child))})}return children}throw new Error($.ig.Tree.locale.incorrectPath+path)},isSelected:function(node){if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(node&&node.length>0){return this._selectedNode[0].path===node.attr("data-path")}throw new Error($.ig.Tree.locale.incorrectNodeObject)},isExpanded:function(node){if(node&&node.length>0){var expander=node.children("span[data-role=expander]");if(expander.length>0){return expander.attr("data-exp")==="true"}}else{throw new Error($.ig.Tree.locale.incorrectNodeObject)}},isChecked:function(node){if(node&&node.length>0){var checkbox=node.children("span[data-role=checkbox]");if(checkbox.length>0){return checkbox.attr("data-chk")==="on"}}else{throw new Error($.ig.Tree.locale.incorrectNodeObject)}},checkState:function(node){if(node&&node.length>0){var checkbox=node.children("span[data-role=checkbox]");if(checkbox.length>0){return checkbox.attr("data-chk")}}else{throw new Error($.ig.Tree.locale.incorrectNodeObject)}},addNode:function(node,parent,nodeIndex){if(!nodeIndex&&typeof parent==="number"){nodeIndex=parent;parent=null}if(!node||node.length<=0){if(parent&&parent.length>0){this._updateParentState(parent)}return}var ul,path,checked,isLi,li,isEmpty,r,binding,self=this;if(!parent){parent=this.element.is("ul")?this.element:this.element.children("ul");if(parent.children().length<=0){this._addData(node,"",0);this._triggerRendering(node);r=$(this._initChildrenRecursively("",node)).appendTo(parent);if(this.options.dragAndDrop){this._initDragAndDrop(r)}this._triggerRendered();this.options.dataSource.root().addNode({data:node,parentPath:"",path:r.attr("data-path")});return}}isLi=parent.is("li");ul=isLi?parent.children("ul"):parent;if(ul.length<=0){ul=$("<ul data-depth='"+(parseInt(parent.parent().attr("data-depth"),10)+1)+"' style='display: none'></ul>").appendTo(parent)}path=isLi?parent.attr("data-path"):"";binding=this._retrieveCurrentDepthBinding(parseInt(ul.attr("data-depth"),10));if(this.options.checkboxMode.toLowerCase()==="tristate"){checked=isLi?this.isChecked(parent):false}this._addData(node,path,parseInt(ul.attr("data-depth"),10)-1,nodeIndex);this._triggerRendering(node);isEmpty=ul.children("li").length<=0;if(nodeIndex===0){MSApp.execUnsafeLocalFunction(function(){li=$(self._initChildrenRecursively(path,node,parseInt(ul.attr("data-depth"),10),checked,ul.children("li").length)).prependTo(ul)});if(!binding.hasOwnProperty("primaryKey")){this._recalculatePaths(path)}}else if(!nodeIndex){MSApp.execUnsafeLocalFunction(function(){li=$(self._initChildrenRecursively(path,node,parseInt(ul.attr("data-depth"),10),checked,ul.children("li").length)).appendTo(ul)})}else{MSApp.execUnsafeLocalFunction(function(){li=$(self._initChildrenRecursively(path,node,parseInt(ul.attr("data-depth"),10),checked,ul.children("li").length)).insertBefore(ul.children("li:eq("+nodeIndex+")"))});if(!binding.hasOwnProperty("primaryKey")){this._recalculatePaths(path)}}if(isLi&&isEmpty){this._updateParentState(parent)}if(this.options.dragAndDrop){this._initDragAndDrop(li)}this._triggerRendered();r=[];li.each(function(){r.push($(this).attr("data-path"))});this.options.dataSource.root().addNode({data:node,parentPath:path,path:r});this._trigger("nodeAdded",null,{owner:this,element:li,data:node,index:nodeIndex,binding:binding})},removeAt:function(path){var node=this.nodeByPath(path),depth=parseInt(node.parent().attr("data-depth"),10),binding,parent=this.parentNode(node),data;if(node.length<=0){return}if(path.indexOf("_remove")!==-1){path=path.replace("_remove","")}binding=this._retrieveCurrentDepthBinding(depth);data={data:$.extend(false,{},this.nodeDataFor(path)),path:path};this._removeData(path,binding);node.remove();if(!binding.hasOwnProperty("primaryKey")){this._recalculatePaths(path)}if(parent&&parent.children("ul").children("li").length<=0){this._updateParentState(parent)}if(this.options.checkboxMode.toLowerCase()==="tristate"&&parent){this._updateParentCheckbox(parent)}this.options.dataSource.root().removeNode(data);this._trigger("nodeDeleted",null,{owner:this,data:data.data,path:path})},removeNodesByValue:function(value){var nodes=this.nodesByValue(value),self=this;nodes.each(function(){self.removeAt($(this).attr("data-path"))})},applyChangesToNode:function(element,data){var node=this.nodeFromElement(element),item;for(item in node.data){if(node.data.hasOwnProperty(item)){this._replaceUIValue(node,data,item)}}},transactionLog:function(){return this.options.dataSource.root()._transactionLog},_triggerSelectionChanging:function(event,node){var args={owner:this,selectedNodes:this._selectedNode,newNodes:[this._constructNodeObject(node)]};return this._trigger(this.events.selectionChanging,event,args)},_triggerSelectionChanged:function(event){var args={owner:this,selectedNodes:this._selectedNode,newNodes:this._selectedNode};this._trigger(this.events.selectionChanged,event,args)},_triggerNodeCollapsing:function(event,node){var args={owner:this,node:this._constructNodeObject(node)};return this._trigger(this.events.nodeCollapsing,event,args)},_triggerNodeCollapsed:function(event,node){var args={owner:this,node:this._constructNodeObject(node)};this._trigger(this.events.nodeCollapsed,event,args)},_triggerNodeExpanding:function(event,node){var args={owner:this,node:this._constructNodeObject(node)};return this._trigger(this.events.nodeExpanding,event,args)},_triggerNodeExpanded:function(event,node){var args={owner:this,node:this._constructNodeObject(node)};this._trigger(this.events.nodeExpanded,event,args)},_triggerNodePopulating:function(event,node){var args=this._constructNodeObject(node);return this._trigger(this.events.nodePopulating,event,args)},_triggerNodePopulated:function(event,node){var args=this._constructNodeObject(node);this._trigger(this.events.nodePopulated,event,args)},_triggerNodeCheckstateChanging:function(event,node){var state=node.children("span[data-role=checkbox]").attr("data-chk"),args={owner:this,node:this._constructNodeObject(node),currentState:state,newState:state==="off"?"on":"off",currentCheckedNodes:this.checkedNodes()};return this._trigger(this.events.nodeCheckstateChanging,event,args)},_triggerNodeCheckstateChanged:function(event,node){var state=node.children("span[data-role=checkbox]").attr("data-chk"),args={owner:this,node:this._constructNodeObject(node),newState:state,newCheckedNodes:this.checkedNodes(),newPartiallyCheckedNodes:this.partiallyCheckedNodes()};return this._trigger(this.events.nodeCheckstateChanged,event,args)},_triggerNodeClick:function(event,node){var args={owner:this,node:this._constructNodeObject(node)};return this._trigger(this.events.nodeClick,event,args)},_triggerNodeDoubleClick:function(event,node){var args=this._constructNodeObject(node);return this._trigger(this.events.nodeDoubleClick,event,args)},_triggerDataBinding:function(){var args={owner:this};this._trigger(this.events.dataBinding,null,args)},_triggerDataBound:function(dataView){var args={owner:this,dataView:dataView};this._trigger(this.events.dataBound,null,args)},_triggerRendering:function(dataView){var args={owner:this,dataView:dataView};this._trigger(this.events.rendering,null,args)},_triggerRendered:function(){var args={owner:this};this._trigger(this.events.rendered,null,args)},_triggerDragStart:function(event,ui,node){var obj=this._constructNodeObject(node),args=$.extend(false,obj,ui);return this._trigger(this.events.dragStart,event,args)},_triggerDrag:function(event,ui,node){var obj=this._constructNodeObject(node),args=$.extend(false,obj,ui);return this._trigger(this.events.drag,event,args)},_triggerDragStop:function(event,ui){this._trigger(this.events.dragStop,event,ui)},_triggerNodeDropping:function(event,ui,node,targetIndex){var obj=this._constructNodeObject(node),args,indexDecrement;obj.targetIndex=targetIndex;obj.originalIndex=ui.draggable.index();indexDecrement=this._sourceNode.element.parent().attr("data-depth")===node.parent().attr("data-depth")&&obj.targetIndex>obj.originalIndex?-1:0;obj.targetIndex+=indexDecrement;args=$.extend(false,obj,ui);return this._trigger(this.events.nodeDropping,event,args)},_triggerNodeDropped:function(event,ui,node){var obj=this._constructNodeObject(node),args=$.extend(false,obj,ui);this._trigger(this.events.nodeDropped,event,args)},_constructNodeObject:function(node){var nodeData=this.nodeDataFor(node!==null?node.attr("data-path"):null),nodeObject={path:node!==null?node.attr("data-path"):null,element:node!==null?node:null,data:nodeData,binding:node!==null?this._retrieveCurrentDepthBinding(parseInt(node.parent().attr("data-depth"),10)):null};return nodeObject},nodeDataFor:function(path){if(!path){return}var splitPath=path.split(this.options.pathSeparator),data=this.options.dataSource._rootds.data(),i,j,binding=this.options.bindings,temp;for(i=0;i<splitPath.length-1;i++){if(!binding.hasOwnProperty("primaryKey")){if(data[parseInt(splitPath[i],10)]){if(typeof data[parseInt(splitPath[i],10)][binding.childDataProperty]==="function"){data=data[parseInt(splitPath[i],10)][binding.childDataProperty]()}else{data=data[parseInt(splitPath[i],10)][binding.childDataProperty]}}}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)){temp=typeof data[j][binding.primaryKey]==="function"?data[j][binding.primaryKey]():data[j][binding.primaryKey];if(temp.toString()===splitPath[i].toString()){data=typeof data[j][binding.childDataProperty]==="function"?data[j][binding.childDataProperty]():data[j][binding.childDataProperty];break}}}}if(binding.hasOwnProperty("bindings")){binding=binding.bindings}}if(!binding.hasOwnProperty("primaryKey")&&data.length){data=data[parseInt(splitPath[splitPath.length-1],10)]}else{for(j=0;j<data.length;j++){if(data[j].hasOwnProperty(binding.primaryKey)){temp=typeof data[j][binding.primaryKey]==="function"?data[j][binding.primaryKey]():data[j][binding.primaryKey];if(temp.toString()===splitPath[i].toString()){data=data[j];break}}}}if(typeof data==="function"){data=data()}return data},destroy:function(){$.Widget.prototype.destroy.apply(this,arguments);this.element.undelegate();this.element.removeClass(this.css.tree);this.element.removeClass(this.css.treeCollection);this.element.removeClass(this.css.treeRoot);if(this.options.width){this.element.css("width","")}if(this.options.height){this.element.css("height","")}if(this.options.dragAndDrop){this._destroyDragAndDrop()}this.element.removeAttr("data-depth");this.element.removeAttr("data-scroll");this.element.empty();return this}});$.extend($.ui.igTree,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Column Moving 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.tree.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridColumnMoving",{renderInFeatureChooser:true,options:{columnSettings:[{columnKey:null,columnIndex:null,allowMoving:true}],mode:"immediate",moveType:"dom",addMovingDropdown:true,movingDialogWidth:400,movingDialogHeight:"",movingDialogAnimationDuration:200,movingAcceptanceTolerance:20,movingScrollTolerance:20,scrollSpeedMultiplier:2,scrollDelta:2,hideHeaderContentsDuringDrag:true,dragHelperOpacity:1,movingDialogCaptionButtonDesc:$.ig.ColumnMoving.locale.movingDialogCaptionButtonDesc,movingDialogCaptionButtonAsc:$.ig.ColumnMoving.locale.movingDialogCaptionButtonAsc,movingDialogCaptionText:$.ig.ColumnMoving.locale.movingDialogCaptionText,movingDialogDisplayText:$.ig.ColumnMoving.locale.movingDialogDisplayText,movingDialogDropTooltipText:$.ig.ColumnMoving.locale.movingDialogDropTooltipText,movingDialogDropTooltipMarkup:"<div><p><span></span><strong>{text}</strong></p></div>",dropDownMoveLeftText:$.ig.ColumnMoving.locale.dropDownMoveLeftText,dropDownMoveRightText:$.ig.ColumnMoving.locale.dropDownMoveRightText,dropDownMoveFirstText:$.ig.ColumnMoving.locale.dropDownMoveFirstText,dropDownMoveLastText:$.ig.ColumnMoving.locale.dropDownMoveLastText,movingToolTipMove:$.ig.ColumnMoving.locale.movingToolTipMove,featureChooserSubmenuText:$.ig.ColumnMoving.locale.featureChooserSubmenuText,columnMovingDialogContainment:"owner",inherit:false},css:{headerCellMouseOver:"ui-state-hover",dropDownButton:"ui-iggrid-moving-indicator",dropDownIndicatorContainer:"ui-iggrid-indicatorcontainer",dragIndicatorTop:"ui-iggrid-columnmoving-dragtop ui-icon ui-icon-triangle-1-s",dragIndicatorBottom:"ui-iggrid-columnmoving-dragbottom ui-icon ui-icon-triangle-1-n",dragIndicatorLeft:"ui-iggrid-columnmoving-dragleft",dragIndicatorRight:"ui-iggrid-columnmoving-dragright",dropDownIconContainer:"ui-iggrid-columnmovingiconcontainer",featureChooserMovingDialogIcon:"ui-icon ui-iggrid-icon-move",featureChooserLeftIcon:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-left",featureChooserRightIcon:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-right",featureChooserFirstIcon:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-first",featureChooserLastIcon:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-last",featureChooserSubmenu:"ui-iggrid-featurechooser-list-submenu ui-menu ui-widget ui-widget-content ui-corner-all",featureChooserSubmenuItem:"ui-iggrid-featurechooser-list-submenu-item ui-state-default",featureChooserSubmenuItemMouserOver:"ui-state-hover",columnMovingDropDown:"ui-iggrid-columnmoving-dropdown-dialog ui-widget ui-widget-content ui-corner-all",columnMovingDropDownList:"ui-iggrid-columnmoving-dropdown-list ui-menu",columnMovingDropDownItem:"ui-iggrid-columnmoving-dropdown-ddlistitemicons ui-state-default",columnMovingDropDownItemHover:"ui-iggrid-columnmoving-dropdown-listitem-hover ui-state-active ui-state-hover",columnMovingDropDownItemText:"ui-iggrid-columnmoving-dropdown-ddlistitemtext",columnMovingIndicatorSelected:"ui-iggrid-hiding-indicator-selected",movingDialogItemList:"ui-iggrid-moving-dialog-columns",movingDialogListItem:"ui-widget-content",movingDialogListItemArrowUp:"ui-icon-arrowthick-1-n ui-button-icon-primary ui-icon",movingDialogListItemArrowDown:"ui-icon-arrowthick-1-s ui-button-icon-primary ui-icon",movingDialogListItemArrowButton:"ui-button ui-corner-all ui-button-icon-only ig-sorting-indicator",movingDialogListItemText:"ui-iggrid-dialog-text",movingDialogCloseButton:"ui-icon ui-icon-close"},events:{columnDragStart:"columnDragStart",columnDragEnd:"columnDragEnd",columnDragCanceled:"columnDragCanceled",columnMoving:"columnMoving",columnMoved:"columnMoved",movingDialogOpening:"movingDialogOpening",movingDialogOpened:"movingDialogOpened",movingDialogDragged:"movingDialogDragged",movingDialogClosing:"movingDialogClosing",movingDialogClosed:"movingDialogClosed",movingDialogContentsRendering:"movingDialogContentsRendering",movingDialogContentsRendered:"movingDialogContentsRendered",movingDialogMoveUpButtonPressed:"movingDialogMoveUpButtonPressed",movingDialogMoveDownButtonPressed:"movingDialogMoveDownButtonPressed",movingDialogDragColumnMoving:"movingDialogDragColumnMoving",movingDialogDragColumnMoved:"movingDialogDragColumnMoved"},_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._cache={};this._cKey="";this._cIdx=-1;this._tKey="";this._tIdx=-1;this._oTh=null;this._cmib=null;this._cmit=null;this._movingDialog=null;this._groupBy=null;this._ddButtons={first:{text:this.options.dropDownMoveFirstText,func:$.proxy(this._moveFirst,this),icon:this.css.featureChooserFirstIcon},left:{text:this.options.dropDownMoveLeftText,func:$.proxy(this._moveLeft,this),icon:this.css.featureChooserLeftIcon},right:{text:this.options.dropDownMoveRightText,func:$.proxy(this._moveRight,this),icon:this.css.featureChooserRightIcon},last:{text:this.options.dropDownMoveLastText,func:$.proxy(this._moveLast,this),icon:this.css.featureChooserLastIcon}};this._hscroller=null;this._scroller={on:false,delay:-1};if(this.options.mode!=="immediate"&&this.options.mode!=="deferred"){this.options.mode="immediate"}if(this.options.mode==="immediate"&&this.options.moveType==="render"){this.options.moveType="dom"}if(this.options.addMovingDropdown===false){this.renderInFeatureChooser=false}},_setOption:function(key){if(key==="mode"||key==="columnSettings"||key==="addMovingDropdown"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}$.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){this.grid.moveColumn=this._gridMoveColumn;this._unregisterEvents();this._removeMoving();$.Widget.prototype.destroy.call(this);return this},moveColumn:function(column,target,after,inDom,callback){this._moveColumn(column,target,after,inDom,true,callback)},_headerCellRendered:function(event,args){if(this.grid.id()!==args.owner.id()){return}this._thRendered(args.th)},_headerRendering:function(){var i;for(i=0;i<this.grid.options.features.length;i++){if(this.grid.options.features[i].name==="GroupBy"){this._groupBy=this.grid.element.data("igGridGroupBy");break}}},_headerRendered:function(event,args){if(this.grid.id()!==args.owner.id()){return}this._thsRendered(args.table)},_gridFullyRendered:function(){this.grid.scrollContainer().bind("scroll",this._containerScrolledHandler);this._updateLayout()},_containerScrolled:function(event,args,fromParent){var grids,i,cmi;if(!this._autoScrolled){if(this.options.mode==="deferred"){this._adjustIndicators(event.originalEvent.detail,fromParent)}}grids=this.grid.element.find(".ui-iggrid-table");for(i=0;i<grids.length;i++){cmi=grids.eq(i).data("igGridColumnMoving");if(cmi){cmi._containerScrolled(event,args,true)}}},_fixedColumnsChanged:function(){this._updateLayout()},_headerPicked:function(event,args){var $th=$(event.target).closest("th"),id=this._getIdOfTh($th),noCancel=true;args={columnKey:id,columnIndex:$th.index(),owner:this,header:$th,helper:args.helper};noCancel=this._trigger(this.events.columnDragStart,event,args);if(noCancel){if(this.grid._focusedElement){this.grid._focusedElement.blur()}this._thPicked($th,id)}return noCancel},_headerDragged:function(event,args){var left;if(this._oPos){left=this._oPos.left>args.position.left}else{left=args.originalPosition.left>args.position.left}this._oPos={left:args.position.left};if(this.options.mode==="deferred"){this._thDragedDeferred(args.helper,args.offset,left)}else if(this._thDragged(args.helper,args.offset,left)){args.originalPosition.left=args.position.left}},_headerDropped:function(event,args){var $th=$(event.target).closest("th"),id=this._getIdOfTh($th),noCancel=true;args={columnKey:id,columnIndex:$th.index(),owner:this,header:$th,helper:args.helper};noCancel=this._trigger(this.events.columnDragEnd,event,args);if(noCancel){this._thDropped()}else{this._trigger(this.events.columnDragCanceled,event,args)}return noCancel},_dialogUpPressed:function(event){var tar=$(event.target),item=tar.closest("li"),parent=item.parent(),idx=item.index(),iItem=idx===0?item.parent().children().last().attr("data-value"):item.prev().attr("data-value"),iDir=idx===0?true:false,col=tar.closest("span").attr("datakey"),a,oc;a={owner:this,movingDialog:this._movingDialog,columnKey:col,columnIndex:idx,targetIndex:idx===0?parent.children().length-1:idx-1};this._cKey=col;this._cIdx=a.columnIndex;this._tIdx=a.targetIndex;if(this._cIdx===this._tIdx){return}oc=this._moveColumn(col,iItem,iDir,this.options.moveType==="dom",false);if(!oc){return false}if(idx===0){item.detach().insertAfter(parent.children("li:last"))}else{item.detach().insertBefore(parent.children("li:eq("+(idx-1)+")"))}this._trigger(this.events.movingDialogMoveUpButtonPressed,event,a)},_dialogDownPressed:function(event){var tar=$(event.target),item=tar.closest("li"),parent=item.parent(),idx=item.index(),iItem=idx===item.siblings().length?item.parent().children().first().attr("data-value"):item.next().attr("data-value"),iDir=idx===item.siblings().length?false:true,col=tar.closest("span").attr("datakey"),a,oc;a={owner:this,movingDialog:this._movingDialog,columnKey:col,columnIndex:idx,targetIndex:idx===parent.children().length-1?0:idx+1};this._cKey=col;this._cIdx=a.columnIndex;this._tIdx=a.targetIndex;if(this._cIdx===this._tIdx){return}oc=this._moveColumn(col,iItem,iDir,this.options.moveType==="dom",false);if(!oc){return false}if(idx===item.parent().children().length-1){item.detach().insertBefore(parent.children("li:first"))}else{item.detach().insertAfter(parent.children("li:eq("+idx+")"))}this._trigger(this.events.movingDialogMoveDownButtonPressed,event,a)},_dialogRearranging:function(event,args){var noCancel,a,oc,column=$(args.draggable),target=$(args.element),cid=column.attr("data-value"),tid=target.attr("data-value"),aft=$(args.element).closest("ul[data-depth=0]").data("igTree")._validationObject.dropAfter,cix=column.index(),tix=target.index();tix=tix>cix?aft?tix:tix-1:aft?tix+1:tix;a={owner:this,movingDialog:this._movingDialog,columnKey:cid,columnIndex:cix,targetIndex:tix};if(cix===tix){return false}noCancel=this._trigger(this.events.movingDialogDragColumnMoving,event,a);if(noCancel){this._cKey=cid;this._cIdx=a.columnIndex;this._tIdx=a.targetIndex;oc=this._moveColumn(cid,tid,aft,this.options.moveType==="dom",false);if(!oc){return false}a.movingDialog.find("div.ui-state-highlight").remove();this._trigger(this.events.movingDialogDragColumnMoved,event,a);return true}return false},_dialogRearranged:function(event,args){this._bindUpDownDialogButtons(args.element.parent())},_dialogDragged:function(event,args){this._trigger(this.events.movingDialogDragged,null,{movingDialogElement:event.target,owner:this,originalPosition:args.originalPosition,position:args.position})},_dialogOpening:function(event,args){var noCancel;noCancel=this._trigger(this.events.movingDialogOpening,null,{movingDialogElement:event.target,owner:this});if(noCancel){this._renderMovingDialogContent(event,args);this._trigger(this.events.movingDialogOpened,null,{movingDialogElement:event.target,owner:this})}return noCancel},_dialogClosing:function(event){return this._trigger(this.events.movingDialogClosing,null,{movingDialogElement:event.target,owner:this})},_dialogClosed:function(event){this._trigger(this.events.movingDialogClosed,null,{movingDialogElement:event.target,owner:this})},_dropDownMouseDown:function(event){var ind=$(event.target);this._toggleDropDown(ind,$("div[data-moving-inddropdown='"+this.grid.id()+"']"));this._cancelEvent(event)},_dropDownKeyDown:function(event){var sItem,nItem,nItemB,dropdown=$("div[data-moving-inddropdown='"+this.grid.id()+"']");if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){sItem=dropdown.find("ul .ui-state-hover:first");if(dropdown.is(":visible")&&sItem.length>0){sItem.trigger("mousedown")}this._toggleDropDown($(event.target),dropdown,false);this._cancelEvent(event)}else if(event.keyCode===$.ui.keyCode.ESCAPE){this._toggleDropDown($(event.target),dropdown,false);this._cancelEvent(event)}else if(event.keyCode===$.ui.keyCode.DOWN||event.keyCode===$.ui.keyCode.UP){if(dropdown.is(":visible")){sItem=dropdown.find("ul .ui-state-hover:first").closest("li");if(sItem.length===0){nItem=dropdown.find("ul li:eq(0)")}else{if(sItem.index()===0&&event.keyCode===$.ui.keyCode.UP){nItem=sItem.parent().children(":last")}else{nItem=event.keyCode===$.ui.keyCode.DOWN?sItem.next():sItem.prev()}}dropdown.find("ul .ui-state-hover").removeClass(this.css.columnMovingDropDownItemHover);nItemB=nItem.find("[role='button']");if(nItemB.length>0){nItem=nItemB}nItem.addClass(this.css.columnMovingDropDownItemHover)}this._cancelEvent(event)}},_dropDownButtonMouseOver:function(event){$(event.currentTarget).addClass(this.css.columnMovingDropDownItemHover)},_dropDownButtonMouseOut:function(event){$(event.currentTarget).removeClass(this.css.columnMovingDropDownItemHover)},_moveLeft:function(event,args){var sib=this._getAllSiblings(args),cid,tid,i;for(i=0;i<sib.length;i++){cid=sib[i].key||sib[i].identifier;if(cid===args){if(i>0){this._cKey=args;this._cIdx=i;this._tIdx=i-1;tid=sib[i-1].key||sib[i-1].identifier;this._moveColumn(cid,tid,false,this.options.moveType==="dom",false)}break}}},_moveRight:function(event,args){var sib=this._getAllSiblings(args),cid,tid,i;for(i=0;i<sib.length;i++){cid=sib[i].key||sib[i].identifier;if(cid===args){if(i<sib.length-1){this._cKey=args;this._cIdx=i;this._tIdx=i+1;tid=sib[i+1].key||sib[i+1].identifier;this._moveColumn(cid,tid,true,this.options.moveType==="dom",false)}break}}},_moveFirst:function(event,args){var sib=this._getAllSiblings(args),cid,tid,i;for(i=0;i<sib.length;i++){cid=sib[i].key||sib[i].identifier;if(cid===args){if(i!==0){this._cKey=args;this._cIdx=i;this._tIdx=0;tid=sib[0].key||sib[0].identifier;this._moveColumn(cid,tid,false,this.options.moveType==="dom",false)}break}}},_moveLast:function(event,args){var sib=this._getAllSiblings(args),cid,tid,i;for(i=0;i<sib.length;i++){cid=sib[i].key||sib[i].identifier;if(cid===args){if(i!==sib.length-1){this._cKey=args;this._cIdx=i;this._tIdx=sib.length-1;tid=sib[sib.length-1].key||sib[sib.length-1].identifier;this._moveColumn(cid,tid,true,this.options.moveType==="dom",false)}break}}},_headerMouseOver:function(event){$(event.target).closest("th").addClass(this.css.headerCellMouseOver)},_headerMouseOut:function(event){$(event.target).closest("th").removeClass(this.css.headerCellMouseOver)},_renderHelpers:function(){var existingBottomIndicator=this.grid._rootContainer().children("[id$='_moving_indicator_bottom']"),existingTopIndicator=this.grid._rootContainer().children("[id$='_moving_indicator_top']");if(existingBottomIndicator.length>0&&existingTopIndicator.length>0){this._cmib=existingBottomIndicator;this._cmib.data("users",this._cmib.data("users")+1);this._cmit=existingTopIndicator;this._cmit.data("users",this._cmit.data("users")+1)}else{this._cmib=$("<div>&nbsp;</div>").attr("id",this.grid.id()+"_moving_indicator_bottom").addClass(this.css.dragIndicatorBottom).css({position:"absolute","z-index":"1000000",width:"16px",height:"16px",display:"none"}).appendTo(this.grid._rootContainer());this._cmit=$("<div>&nbsp;</div>").attr("id",this.grid.id()+"_moving_indicator_top").addClass(this.css.dragIndicatorTop).css({position:"absolute","z-index":"1000000",width:"16px",height:"16px",display:"none"}).appendTo(this.grid._rootContainer())}},_renderFeatureChooser:function(col,th){var fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){if(fc._shouldRenderInFeatureChooser(col)===true){this._addMoveButtonsInFeatureChooser(fc,col)}else{this._renderMovingDropDownIndicator(th,col);this.grid._enableHeaderCellFeature(th)}}},_renderMovingDropDownIndicator:function(th,col){var $button,$anchor,$container,self=this;$button=$("<span></span>").addClass(this.css.dropDownButton);th.attr("th-remove-focus","");$anchor=$("<a></a>").attr("href","#").attr("title",this.options.movingToolTipMove).attr("id",this.grid.id()+"_moving_headerButton_"+col).bind({keydown:this._dropDownKeyHandler,blur:function(e){self._toggleDropDown($(e.target),$("div[data-moving-inddropdown='"+self.grid.id()+"']"),true)},mousedown:this._dropDownButtonHandler,mouseup:this._cancelEventHandler,click:this._cancelEventHandler});$container=$("<div></div>").addClass(this.css.dropDownIndicatorContainer).appendTo(th);$button.appendTo($anchor);$anchor.appendTo($container);this._needToRenderDropDown=true},_renderMovingDialogContent:function(){var $content=this._movingDialog.igGridModalDialog("getContent"),movingDialog=this._movingDialog,$tree=$content.find("#"+this.grid.id()+"_dialog_tree"),noCancel;noCancel=this._trigger(this.events.movingDialogContentsRendering,null,{movingDialogElement:movingDialog,owner:this});if(noCancel){if($tree.length>0){$tree.igTree("option","dataSource",this._getClonedDataSource(this.grid._visibleMchColumns()||this.grid._visibleColumns()))}else{$tree=this._initializeTree($content)}this._bindUpDownDialogButtons($tree);this._trigger(this.events.movingDialogContentsRendered,null,{movingDialogElement:movingDialog,owner:this})}},_initializeTree:function(content){var self=this,markup=self.options.movingDialogDropTooltipMarkup.replace("{text}",self.options.movingDialogDropTooltipText);return $("<ul id='"+this.grid.id()+"_dialog_tree'></ul>").appendTo(content).igTree({dataSourceType:"json",dataSource:this._getClonedDataSource(this.grid._visibleMchColumns()||this.grid._visibleColumns()),bindings:{primaryKey:"key",textKey:"headerText",valueKey:"key",childDataProperty:"group",nodeContentTemplate:this._getTreeTemplate()},dragAndDrop:true,dragAndDropSettings:{dragAndDropMode:"move",revert:true,zIndex:1000001,moveBetweenMarkup:markup,customDropValidation:function(col){var context=$(this),$col=$(col);if(self._isColumnMovable($col.attr("data-value"))){if(context.is("li")&&context.parent()[0]===$col.parent()[0]){return true}}return false},containment:false},nodeDropping:this._dialogRearrangingHandler,nodeDropped:this._dialogRearrangedHandler,selectionChanging:function(){return false}})},_getClonedDataSource:function(ds){return jQuery.extend(true,[],ds,this._cloneMovable(ds))},_cloneMovable:function(ds){var self=this,movableClone=[],idx=0;$.each(ds,function(){if(this.group){movableClone.push({movable:self._isColumnMovable(this.key,idx++),group:self._cloneMovable(this.group),key:this.key||this.identifier||idx})}else{movableClone.push({movable:self._isColumnMovable(this.key,idx++),key:this.key||idx})}});return movableClone},_getTreeTemplate:function(){var tmpl="",up,down,wrapper,data;data="<span>${headerText}</span>";wrapper="<span class='"+this.css.movingDialogListItemArrowButton+"'>";up=wrapper+"<span id='"+this.grid.id()+"_moving_dialog_${key}_up' title='"+this.options.movingDialogCaptionButtonAsc+"' role='button' datakey='${key}' class='"+this.css.movingDialogListItemArrowUp+"' style='"+"margin-top:-10px;'></span></span>";down=wrapper+"<span id='"+this.grid.id()+"_moving_dialog_${key}_down' title='"+this.options.movingDialogCaptionButtonDesc+"' role='button' datakey='${key}' class='"+this.css.movingDialogListItemArrowDown+"' style='"+"margin-top:-10px;'></span></span>";wrapper+="</span>";tmpl+="{{if ${movable} }}";tmpl+=up+down+data;tmpl+="{{else}}";tmpl+=wrapper+wrapper+data;tmpl+="{{/if}}";return tmpl},_renderMovingDialog:function(){var containment,o=this.options,$captionButtonContainer,$closeButton,movingDialog;if(this.options.columnMovingDialogContainment==="owner"){containment=this.grid.container()}else{containment="window"}movingDialog=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",this.grid.id()+"_moving_movingDialog");this._movingDialog=movingDialog;movingDialog.igGridModalDialog({containment:containment,renderFooterButtons:false,modalDialogCaptionText:o.movingDialogCaptionText,modalDialogWidth:o.movingDialogWidth,modalDialogHeight:o.movingDialogHeight,animationDuration:o.movingDialogAnimationDuration,gridContainer:this.grid.container(),modalDialogOpening:this._dialogOpeningHandler,modalDialogMoving:this._dialogDraggedHandler,modalDialogClosing:this._dialogClosingHandler,modalDialogClosed:this._dialogClosedHandler});$captionButtonContainer=movingDialog.igGridModalDialog("getCaptionButtonContainer");$closeButton=$("<button></button>").attr("id",this.grid.id()+"_moving_movingDialog_closeButton").appendTo($captionButtonContainer);$closeButton.igButton({onlyIcons:true,icons:{primary:this.css.movingDialogCloseButton},width:"20px",height:"20px",click:this._dialogCloseButtonHandler,title:$.ig.ColumnMoving.locale.movingDialogCloseButtonTitle})},_renderDropDown:function(element){var self=this,dropDown,list;dropDown=$("<div data-moving-inddropdown='"+this.grid.id()+"'></div>").css("position","absolute").css("display","none").addClass(this.css.columnMovingDropDown).appendTo(this.grid._rootContainer());list=$('<ul tabindex="0"></ul>').addClass(this.css.columnMovingDropDownList).appendTo(dropDown);$.each(this._ddButtons,function(key,val){$("<li></li>").addClass(self.css.columnMovingDropDownItem).attr("data-key",key).bind({mouseover:self._dropDownButtonMouseOverHandler,mouseout:self._dropDownButtonMouseOutHandler}).append($("<span></span>").addClass(self.css.dropDownIconContainer).append($("<span></span>").addClass(val.icon))).append($("<span></span>").addClass(self.css.columnMovingDropDownItemText).text(val.text)).appendTo(list)});$("<a></a>").appendTo($("<li></li>").appendTo(list)).igButton({labelText:this.options.movingDialogCaptionText,mousedown:function(event){if(event.target){setTimeout(function(){$(event.target).removeClass("ui-state-active")},0)}self._toggleDropDown(element,dropDown,true);self._openMovingDialog(element,dropDown,true)}});return dropDown},_toggleDropDown:function(element,dropDown,isCalledFromBlur){var th,id,isLast,offset,rOffset,left,isVisible=dropDown.is(":visible")===true,nth=element?element.closest("th"):null,nid=nth?nth.attr("id")||nth.attr("data-mch-id"):null,self=this;if(dropDown.data("isAnimating")===true||nid!==null&&this._currentlyToggled!==nid&&isCalledFromBlur===true||isVisible===false&&isCalledFromBlur===true){return}if(!isVisible){th=nth;th.find("a[title='"+this.options.movingToolTipMove+"']").focus();isLast=th.parent().children().length-th.index()<=2;offset=$.ig.util.offset(th);if(isLast){left=offset.left+th.outerWidth()-dropDown.outerWidth()}else{left=offset.left}rOffset=$.ig.util.getRelativeOffset(dropDown);left=Math.max(0,left-rOffset.left);dropDown.css("top",offset.top+th.outerHeight()-rOffset.top);dropDown.css("left",left);$.each(this._ddButtons,function(key,value){dropDown.find("li[data-key='"+key+"']").bind("mousedown.temp",function(event){self._toggleDropDown(element,dropDown,true);id=th.attr("id");if(id){id=id.replace(self.grid.id()+"_","")}else{id=th.attr("data-mch-id")}value.func(null,id);event.stopPropagation();event.preventDefault()})});this._currentlyToggled=th.attr("id")||th.attr("data-mch-id")}else{$.each(this._ddButtons,function(key){dropDown.find("li[data-key='"+key+"']").unbind("mousedown.temp")})}dropDown.data("isAnimating",true);dropDown.toggle(200,function(){if(dropDown.is(":visible")===true){if(element){element.addClass(self.css.columnMovingIndicatorSelected);element.attr("data-indicator-selected","true")}}else{if(element){element.removeClass(self.css.columnMovingIndicatorSelected);element.removeAttr("data-indicator-selected")}}dropDown.data("isAnimating",false)})},_renderSubmenuFC:function(columnKey,$submenu){var $ul,moveColumns,moveLeft,moveRight,moveFirst,moveLast;$ul=$('<ul class="'+this.css.featureChooserSubmenu+'"></ul>').appendTo($submenu);moveColumns={name:"ColumnMovingDialog",text:this.options.movingDialogDisplayText,iconClass:this.css.featureChooserMovingDialogIcon,method:this._openMovingDialogHandler};moveLeft={name:"Left",text:this.options.dropDownMoveLeftText,iconClass:this.css.featureChooserLeftIcon,method:$.proxy(this._moveLeft,this)};moveRight={name:"Right",text:this.options.dropDownMoveRightText,iconClass:this.css.featureChooserRightIcon,method:$.proxy(this._moveRight,this)};moveFirst={name:"First",text:this.options.dropDownMoveFirstText,iconClass:this.css.featureChooserFirstIcon,method:$.proxy(this._moveFirst,this)};moveLast={name:"Last",text:this.options.dropDownMoveLastText,iconClass:this.css.featureChooserLastIcon,method:$.proxy(this._moveLast,this)};this._renderSubmenuFCItem(moveColumns,$ul,columnKey,$submenu);this._renderSubmenuFCItem(moveFirst,$ul,columnKey,$submenu);this._renderSubmenuFCItem(moveLeft,$ul,columnKey,$submenu);this._renderSubmenuFCItem(moveRight,$ul,columnKey,$submenu);this._renderSubmenuFCItem(moveLast,$ul,columnKey,$submenu)},_renderSubmenuFCItem:function(obj,$ul,columnKey,$submenu){var $li,text=obj.text,html,fnBlur,$next,css=this.css,id=this.grid.id()+"_featurechooser_dd_li_"+columnKey+"_"+obj.name,method=obj.method;fnBlur=function($e){setTimeout(function(){$e.blur()},50)};html='<li tabindex="0" data-fc-item="1" class="'+this.css.featureChooserSubmenuItem+'" id="'+id+'" title="'+text+'">'+text+"</li>";$li=$(html).appendTo($ul);$li.bind({keydown:function(event){var keyCode=event.keyCode;switch(keyCode){case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:method(event,columnKey);fnBlur($(event.target));break;case $.ui.keyCode.DOWN:$next=$li.next();if($next.length===0){$ul.find("li:first").focus()}else{$next.focus()}break;case $.ui.keyCode.UP:$li.prev().focus();if($li.prev().length===0){$("#"+$submenu.data("buttonId")).focus()}break;case $.ui.keyCode.ESCAPE:fnBlur($(event.target));break}},mousedown:function(e){method(e,columnKey);fnBlur($(e.target))},mouseover:function(){$(this).addClass(css.featureChooserSubmenuItemMouserOver)},mouseleave:function(){$(this).removeClass(css.featureChooserSubmenuItemMouserOver)}})},_addMoveButtonsInFeatureChooser:function(fc,key){fc._renderInFeatureChooser(key,{name:"ColumnMovingDropDown",text:this.options.featureChooserSubmenuText,iconClass:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-move",methodRenderSubmenu:$.proxy(this._renderSubmenuFC,this),order:1,groupName:"dropdown",groupOrder:4,type:"dropdown",state:"hide"})},_moveColumn:function(column,target,after,inDom,fromApi,callback){var noCancel=true,args;if(fromApi===false){args={columnKey:this._cKey,columnIndex:this._cIdx,targetIndex:this._tIdx,owner:this};noCancel=this._trigger(this.events.columnMoving,null,args)}if(noCancel){this._movingDirty=true;this.grid.moveColumn(column,target,after,inDom,callback);if(fromApi===false){delete args.columnIndex;delete args.targetIndex;args.oldIndex=this._cIdx;args.newIndex=this._tIdx;this._triggerColumnMovedAsync(args)}return true}return false},_moveColumnOverwrite:function(column,target,after,inDom,callback){var mp,fixing,isgh,i;this._oldColsSave=this.grid._oldCols?jQuery.extend(true,[],this.grid._oldCols):null;this._colsSave=this.grid.options.columns?jQuery.extend(true,[],this.grid.options.columns):null;mp=this._gridMoveColumn.apply(this.grid,[column,target,after,inDom,callback]);if(mp){this.grid._oldCols=this._oldColsSave;if(this.grid._oldCols){this.grid._generateColumnFlatStructure(this.grid._oldCols)}else{this.grid.options.columns=this._colsSave}fixing=this.grid.element.data("igGridColumnFixing");isgh=!!this.grid._getMultiHeaderColumnById(mp.column);this.grid._columnMovingResets();if(mp.columnFixed){fixing._unfixColumnInternal(mp.column,isgh,mp.target,mp.after)}if(mp.targetFixed){fixing._fixColumnInternal(mp.column,isgh,mp.target,mp.after)}this.grid._fixedColumns=[];for(i=0;i<this.grid.options.columns.length;i++){if(this.grid.options.columns[i].fixed){this.grid._fixedColumns.push(this.grid.options.columns[i])}}this._updateLayout();if(callback){$.ig.util.invokeCallback(callback,[this.grid.options.columns])}}},_getAllSiblings:function(col){var fixing=this.grid.hasFixedColumns(),fixingDir=this.grid.fixingDirection(),sib=this._cache.siblings[col],fsib=fixing?this._cache.fixedSiblings[col]:null;if(fixing&&fsib&&fsib.length>0){if(fixingDir==="left"){return fsib.concat(sib)}return sib.concat(fsib)}return sib},_fixingFilter:function(cols,fixed){if(fixed){return $.grep(cols,this._isColFixed)}return $.grep(cols,this._isColUnfixed)},_isColFixed:function(col){return col.fixed},_isColUnfixed:function(col){return!col.fixed},_thRendered:function(th){var cid=this._getIdOfTh(th),cix=th.index("not[data-skip='true']");if(this._isColumnMovable(cid,cix)===true){this._markForMoving(th);if(this.options.addMovingDropdown===true){this._renderFeatureChooser(cid,th)}}},_thsRendered:function(){if(this.options.mode==="deferred"){this._renderHelpers()}if(this.options.addMovingDropdown===true){if(!this._movingDialog||this._movingDialog instanceof jQuery&&this._movingDialog.length===0){this._renderMovingDialog()}if($("div[data-moving-inddropdown='"+this.grid.id()+"']").length===0){this._renderDropDown()}}},_thPicked:function(th,id){this._cKey=id;this._cIdx=th.index();this._currentlyDraggedFixed=this.grid._isFixedElement(th);this._updateLayout();if(this.options.mode==="immediate"){if(this.options.hideHeaderContentsDuringDrag===true){th.children().not("div[data-hiddencolindicator]").hide()}this._oTh=th}},_thDragedDeferred:function(helper,pos,left){var movingOpts=this._moArrays[this._cKey],mo,targetLeft,targetPosition,scrollLeft=0,dragX,i;if(this._hscroller.length>0){scrollLeft=this._hscroller.scrollLeft()}dragX=left===true?pos.left:pos.left+helper.width();dragX+=this._getAbsoluteScroll(this.grid.headersTable());if(!this._gridReady()||this._movingDirty){return}for(i=0;i<movingOpts.length;i++){mo=movingOpts[i];targetLeft=mo.position;if(dragX>targetLeft-this.options.movingAcceptanceTolerance&&dragX<targetLeft+this.options.movingAcceptanceTolerance){this._activeMO=mo;if(dragX-targetLeft>0){this._tKey=mo.after||mo.before;this._aft=mo.after?false:true;targetPosition=this._cache.columns[this._tKey];this._showIndicators(targetLeft-this._getAbsoluteScroll(this.grid.headersTable()),targetPosition.element.offset().top,targetPosition.dimensions,mo.fixing?"right":null)}else{this._tKey=mo.before||mo.after;this._aft=mo.before?true:false;targetPosition=this._cache.columns[this._tKey];this._showIndicators(targetLeft-this._getAbsoluteScroll(this.grid.headersTable()),targetPosition.element.offset().top,targetPosition.dimensions,mo.fixing?"left":null)}break}}if(this._hscroller.length>0){this._checkScroll(scrollLeft,dragX,left)}return false},_thDragged:function(helper,pos,left){var movingOpts=this._moArrays[this._cKey],mo,targetLeft,scrollLeft=0,dragX,i,after,updateEvent=false;if(this._hscroller.length>0){scrollLeft=this._hscroller.scrollLeft()}dragX=left===true?pos.left:pos.left+helper.width();dragX+=this._getAbsoluteScroll(this.grid.headersTable());if(!this._gridReady()||this._movingDirty){return}for(i=0;i<movingOpts.length;i++){mo=movingOpts[i];targetLeft=mo.position;if(dragX>targetLeft-this.options.movingAcceptanceTolerance&&dragX<targetLeft+this.options.movingAcceptanceTolerance){this._activeMO=mo;after=dragX-targetLeft<=0&&mo.before!==null;if(!mo.fixing&&(mo.after===this._cKey&&after||mo.before===this._cKey&&!after)){continue}this._tKey=after?mo.before:mo.after;if(this._cKey!==this._tKey&&this._cKey!==this._activeMO.after||this._activeMO.fixing===true&&this._tKey!==this._cKey){if(mo.fixing&&(mo.after===this._cKey||mo.before===this._cKey)){if(Math.abs(dragX-targetLeft)<this._cache.columns[this._tKey].dimensions.width/3){continue}}if(this._cKey&&this._tKey){this._tIdx=this.grid._getCellIndexByColumnKey(this._tKey);this._moveColumn(this._cKey,this._tKey,after,true,false)}updateEvent=true;break}}}if(this._hscroller.length>0){this._checkScroll(scrollLeft,dragX,left)}return updateEvent},_thDropped:function(){if(this.options.mode==="immediate"){if(this.options.hideHeaderContentsDuringDrag===true){this._oTh.children().show()}this._scroller.on=false;return}this._hideIndicators();if(this._activeMO&&(this._cKey!==this._tKey&&this._cKey!==this._activeMO.after||this._activeMO.fixing===true&&this._tKey!==this._cKey)){this._moveColumn(this._cKey,this._tKey,this._aft,this.options.moveType==="dom",false)
}delete this._cKey;delete this._tKey;delete this._aft;delete this._activeMO;$(".ui-draggable-dragging").hide();this._scroller.on=false},_isColumnMovable:function(col,idx){var i,cs;for(i=0;i<this.options.columnSettings.length;i++){cs=this.options.columnSettings[i];if(cs.columnIndex){if(i===idx){return cs.allowMoving}}if(cs.columnKey){if(col===cs.columnKey){return cs.allowMoving}}}return true},_isColumnGroupable:function(col){var gbColumnSetting=this._groupBy._findColumnSetting(this._getIdOfTh(col));return gbColumnSetting&&gbColumnSetting.allowGrouping},_getIdOfTh:function(th){var mchid=th.attr("data-mch-id");if(mchid){return mchid}return th.attr("id").replace(this.grid.id()+"_","")},_getThById:function(id){return $("th[data-mch-id='"+id+"'],th[id='"+this.grid.id()+"_"+id+"']")},_adjustIndicators:function(delta,fromParent){var newl=parseInt(this._cmib.css("left"),10)-delta,fhr,fhrt;this._cmib.css("left",newl);this._cmit.css("left",newl);if(fromParent){fhr=this.grid.headersTable().find("tr").first();fhrt=fhr.offset().top;this._cmib.css("top",fhrt-16-$.ig.util.getRelativeOffset(this._cmib).top);this._cmit.css("top",fhrt+fhr.height()-$.ig.util.getRelativeOffset(this._cmit).top)}},_showIndicators:function(left,top,dim,tilt){if(tilt==="left"){this._cmib.removeClass(this.css.dragIndicatorRight).addClass(this.css.dragIndicatorLeft);this._cmit.removeClass(this.css.dragIndicatorRight).addClass(this.css.dragIndicatorLeft);this._cmit.css("left",left-12-$.ig.util.getRelativeOffset(this._cmib).left).show();this._cmit.css("top",top-14-$.ig.util.getRelativeOffset(this._cmib).top);this._cmib.css("left",left-12-$.ig.util.getRelativeOffset(this._cmit).left).show();this._cmib.css("top",top+dim.height-2-$.ig.util.getRelativeOffset(this._cmit).top)}else if(tilt==="right"){this._cmib.removeClass(this.css.dragIndicatorLeft).addClass(this.css.dragIndicatorRight);this._cmit.removeClass(this.css.dragIndicatorLeft).addClass(this.css.dragIndicatorRight);this._cmit.css("left",left-4-$.ig.util.getRelativeOffset(this._cmib).left).show();this._cmit.css("top",top-14-$.ig.util.getRelativeOffset(this._cmib).top);this._cmib.css("left",left-4-$.ig.util.getRelativeOffset(this._cmit).left).show();this._cmib.css("top",top+dim.height-2-$.ig.util.getRelativeOffset(this._cmit).top)}else{this._cmib.removeClass(this.css.dragIndicatorRight).removeClass(this.css.dragIndicatorLeft);this._cmit.removeClass(this.css.dragIndicatorRight).removeClass(this.css.dragIndicatorLeft);this._cmit.css("left",left-8-$.ig.util.getRelativeOffset(this._cmib).left).show();this._cmit.css("top",top-16-$.ig.util.getRelativeOffset(this._cmib).top);this._cmib.css("left",left-8-$.ig.util.getRelativeOffset(this._cmit).left).show();this._cmib.css("top",top+dim.height-$.ig.util.getRelativeOffset(this._cmit).top)}},_hideIndicators:function(){this._cmib.hide();this._cmit.hide()},_markForMoving:function(col){if(col.data("draggable")||this._groupBy){if(this._isColumnGroupable(col)){col.bind("drag",this._moveHandler);col.bind("dragstop",this._dropHandler);col.bind("dragstart",this._dragHandler);return}col.attr("groupby-disabled","true")}col.draggable({containment:this.grid._rootContainer(),appendTo:this.grid.container(),distance:5,scroll:false,revert:"valid",helper:function(event){var th,clone;th=$(event.target).closest("th");clone=th.clone().css("overflow","hidden").css("z-index",1e4).width(th.width()).height(th.height()).attr("data-mch-id",null).attr("id",null).addClass("ui-widget ui-iggrid").wrap($('<div class="ui-iggrid-dragMarkup"></div>').width(th.outerWidth()).height(th.outerHeight())).parent();clone.find("div[data-hiddencolindicator]").remove();return clone},opacity:this.options.dragHelperOpacity,drag:this._moveHandler,stop:this._dropHandler,start:this._dragHandler});col.unbind("mouseover.moving").bind("mouseover.moving",this._headerMouseOverHandler);col.unbind("mouseout.moving").bind("mouseout.moving",this._headerMouseOutHandler)},_updateLayout:function(){var cols,self=this;if(!this._gridReady()){setTimeout(function(){self._updateLayout()},50);return}if(this.grid._oldCols){cols=$.grep(this.grid._oldCols,this.grid._columnVisible)}else{cols=this.grid._visibleColumns()}this._hscroller=this.grid._hscrollbarcontent();this._hscroller=this._hscroller.length>0?this._hscroller:this.grid.scrollContainer();this._cache.columns={};this._cache.siblings={};this._cache.fixedSiblings={};this._updateLayoutPerLevel(cols,true);this._createMovingOptions();delete this._movingDirty},_updateLayoutPerLevel:function(cols,firstLevel){var i,id,$th,os;for(i=0;i<cols.length;i++){id=cols[i].key||cols[i].identifier;$th=this._getThById(id);os=$th.offset();if(!os||$.type(os.left)!=="number"){os={left:0,top:0}}os.left=os.left+this._getAbsoluteScroll($th);this._cache.columns[id]={};this._cache.columns[id].element=$th;this._cache.columns[id].offset=os;this._cache.columns[id].dimensions={width:$th.outerWidth(),height:$th.outerHeight()};if(firstLevel){this._cache.fixedSiblings[id]=this._fixingFilter(cols,true);this._cache.siblings[id]=this._fixingFilter(cols,false)}else{this._cache.siblings[id]=cols}}for(i=0;i<cols.length;i++){if(cols[i].group&&cols[i].hidden!==true){this._updateLayoutPerLevel($.grep(cols[i].group,this.grid._columnVisible))}}},_createMovingOptions:function(){var col,us=this._cache.siblings,fs=this._cache.fixedSiblings,fixingDir=this.grid.fixingDirection(),umo,fmo,mo;this._moArrays={};for(col in us){if(us.hasOwnProperty(col)){umo=this._movingOptsForSiblings(us[col]);if(fs.hasOwnProperty(col)){fmo=this._movingOptsForSiblings(fs[col])}else{fmo=[]}if(umo.length&&fmo.length){mo=this._combineMovingOptions(umo,fmo,fixingDir)}else if(umo.length){mo=umo}this._moArrays[col]=mo}}for(col in fs){if(fs.hasOwnProperty(col)&&!this._moArrays[col]){fmo=this._movingOptsForSiblings(fs[col]);this._moArrays[col]=fmo}}},_movingOptsForSiblings:function(siblings){var mo=[],pkey,ckey,i;if(siblings&&siblings.length){pkey=siblings[0].key||siblings[0].identifier;mo.push({before:null,after:pkey,position:this._cache.columns[pkey].offset.left,fixing:false});for(i=1;i<siblings.length;i++){ckey=siblings[i].key||siblings[i].identifier;mo.push({before:pkey,after:ckey,position:this._cache.columns[ckey].offset.left,fixing:false});pkey=ckey}mo.push({before:pkey,after:null,position:this._cache.columns[pkey].offset.left+this._cache.columns[pkey].dimensions.width,fixing:false})}return mo},_combineMovingOptions:function(umo,fmo,fixingDir){var combined,left,right;if(fixingDir==="left"){left=fmo;right=umo}else{left=umo;right=fmo}combined=left.slice(0,left.length-1);combined.push({before:left[left.length-1].before,after:right[0].after,position:right[0].position,fixing:true});combined=combined.concat(right.slice(1,right.length));return combined},_getAbsoluteScroll:function(el){var cel=el,abs=0;while(cel.length>0&&cel.attr("id")!==this.grid._rootContainer().attr("id")){abs+=cel.scrollLeft();cel=cel.parent()}return abs},_openMovingDialog:function(){this._movingDialog.igGridModalDialog("openModalDialog")},_closeMovingDialog:function(e){this._movingDialog.igGridModalDialog("closeModalDialog");if(e){e.preventDefault()}},_triggerColumnMovedAsync:function(args){var self=this;if(!this._gridReady()){setTimeout(function(){self._triggerColumnMovedAsync(args)},50);return}this._trigger(this.events.columnMoved,null,args)},_gridReady:function(){return!(this.grid._loadingIndicator&&this.grid._loadingIndicator._indicator.is(":visible"))},_bindUpDownDialogButtons:function(list){list.find("span[class='"+this.css.movingDialogListItemArrowDown+"']").unbind("mousedown",this._dialogDownHandler).bind("mousedown",this._dialogDownHandler);list.find("span[class='"+this.css.movingDialogListItemArrowUp+"']").unbind("mousedown",this._dialogUpHandler).bind("mousedown",this._dialogUpHandler)},_checkScroll:function(scrollLeft,dragX,left){var sbw=this.grid._hasVerticalScrollbar===true?this.grid._scrollbarWidth():0;if(this._currentlyDraggedFixed){return}dragX-=this._hscroller.offset().left;if(scrollLeft>0&&left===true&&dragX-scrollLeft<this.options.movingScrollTolerance){this._updateScroller(true,dragX-scrollLeft)}else if(scrollLeft<this._hscroller[0].scrollWidth+sbw-this._hscroller.outerWidth()&&left===false&&dragX-scrollLeft>this._hscroller.outerWidth()-this.options.movingScrollTolerance){this._updateScroller(false,this._hscroller.outerWidth()-dragX+scrollLeft)}else{this._stopScroller()}},_startScroller:function(left,delta){this._scroller.on=true;this._scroller.delay=delta*this.options.scrollSpeedMultiplier;this._scroller.direction=left===true?"left":"right";this._autoScroll()},_updateScroller:function(left,delta){if(this._scroller.on===false){this._startScroller(left,delta);return}this._scroller.delay=delta},_stopScroller:function(){this._scroller.on=false},_scrollGrid:function(){var sl=this._hscroller.scrollLeft(),delta,res,sbw;delta=this._scroller.direction==="left"?this.options.scrollDelta*-1:this.options.scrollDelta;res=sl+delta;sbw=this.grid._hasVerticalScrollbar===true?this.grid._scrollbarWidth():0;this._hscroller.scrollLeft(res);if(res<=0&&delta<0||res>=this._hscroller[0].scrollWidth+sbw-this._hscroller.outerWidth()&&delta>0){this._stopScroller()}if(this._hscroller[0].id.indexOf("_hscroller")>0){this.grid._synchronizeHScroll()}if(this.options.mode==="deferred"){this._adjustIndicators(delta)}if(this._scroller.on===true){setTimeout(this._autoScroll,this._scroller.delay)}},_cancelEvent:function(e){e.stopPropagation();e.preventDefault()},_columnMap:function(){return $.map(this.grid.options.columns,function(col){return{columnKey:col.key,enabled:true}})},_removeMoving:function(){var ths=this.grid.headersTable().find(">thead th"),i,th,mdl,removeContainer,fc;if(this._cmit&&this._cmit.length>0){if(this._cmit.data("users")===1){this._cmit.remove()}else{this._cmit.data("users",this._cmit.data("users")-1)}}if(this._cmib&&this._cmib.length>0){if(this._cmib.data("users")===1){this._cmib.remove()}else{this._cmib.data("users",this._cmib.data("users")-1)}}if(this.options.addMovingDropdown===true){mdl=this._movingDialog;if(mdl&&mdl instanceof jQuery){mdl.igGridModalDialog("destroy");mdl.remove()}$("div[data-moving-inddropdown='"+this.grid.id()+"']").remove()}fc=this.grid.element.data("igGridFeatureChooser");removeContainer=true;if(this.renderInFeatureChooser&&fc){fc._removeFeature("ColumnMovingDropDown",true);removeContainer=false}for(i=0;i<ths.length;++i){th=$(ths[i]);if(removeContainer){th.find(">div").find("span").unbind("mousedown",this._dropDownButtonHandler);th.find(">div").remove()}th.unbind("mouseover.moving",this._headerMouseOverHandler);th.unbind("mouseout.moving",this._headerMouseOutHandler);if(!this._grpByEnabled){if(th.data&&th.data("draggable")){th.draggable("destroy")}}else{th.unbind("draggabledrag",this._moveHandler);th.unbind("draggablestop",this._dropHandler);th.unbind("draggablestart",this._dragHandler)}}},_unregisterEvents:function(){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.unbind("iggridheaderrendering",this._headerRenderingHandler);this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.unbind("iggridrendered",this._gridFullyRenderedHandler);this.grid.element.unbind("iggridresizingcolumnresized",this._columnStateChanged);this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnStateChanged);this.grid.element.unbind("iggridpagingpagingdropdownrendered",this._columnStateChanged);this.grid.element.unbind("iggrid_columnsmoved",this._columnStateChanged);this.grid.headersTable().find("th").unbind("moving")},_registerEvents:function(){this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.bind("iggridheaderrendering",this._headerRenderingHandler);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.bind("iggridrendered",this._gridFullyRenderedHandler);this.grid.element.bind("iggridresizingcolumnresized",this._columnStateChanged);this.grid.element.bind("iggridcolumnscollectionmodified",this._columnStateChanged);this.grid.element.bind("iggridpagingpagingdropdownrendered",this._columnStateChanged);this.grid.element.bind("iggrid_columnsmoved",this._columnStateChanged)},_createHandlers:function(){this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this._headerRenderingHandler=$.proxy(this._headerRendering,this);this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._gridFullyRenderedHandler=$.proxy(this._gridFullyRendered,this);this._dragHandler=$.proxy(this._headerPicked,this);this._moveHandler=$.proxy(this._headerDragged,this);this._dropHandler=$.proxy(this._headerDropped,this);this._headerMouseOverHandler=$.proxy(this._headerMouseOver,this);this._headerMouseOutHandler=$.proxy(this._headerMouseOut,this);this._dropDownButtonHandler=$.proxy(this._dropDownMouseDown,this);this._dropDownKeyHandler=$.proxy(this._dropDownKeyDown,this);this._openMovingDialogHandler=$.proxy(this._openMovingDialog,this);this._dropDownButtonMouseOverHandler=$.proxy(this._dropDownButtonMouseOver,this);this._dropDownButtonMouseOutHandler=$.proxy(this._dropDownButtonMouseOut,this);this._dialogOpeningHandler=$.proxy(this._dialogOpening,this);this._dialogDraggedHandler=$.proxy(this._dialogDragged,this);this._dialogClosingHandler=$.proxy(this._dialogClosing,this);this._dialogClosedHandler=$.proxy(this._dialogClosed,this);this._dialogCloseButtonHandler=$.proxy(this._closeMovingDialog,this);this._dialogUpHandler=$.proxy(this._dialogUpPressed,this);this._dialogDownHandler=$.proxy(this._dialogDownPressed,this);this._dialogRearrangingHandler=$.proxy(this._dialogRearranging,this);this._dialogRearrangedHandler=$.proxy(this._dialogRearranged,this);this._columnStateChanged=$.proxy(this._updateLayout,this);this._cancelEventHandler=$.proxy(this._cancelEvent,this);this._autoScroll=$.proxy(this._scrollGrid,this);this._containerScrolledHandler=$.proxy(this._containerScrolled,this)},_injectGrid:function(gridInstance,isRebind){this.grid=gridInstance;if(isRebind===true){return}if(this.grid.element.igGridFeatureChooser!==undefined){this.grid.element.igGridFeatureChooser()}else{throw new Error($.ig.ColumnMoving.locale.featureChooserNotReferenced)}this._gridMoveColumn=this.grid.moveColumn;this.grid.moveColumn=$.proxy(this._moveColumnOverwrite,this);this._createHandlers();this._unregisterEvents();this._registerEvents()}});$.extend($.ui.igGridColumnMoving,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Responsive 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.tree.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridResponsive",{options:{columnSettings:[{columnKey:null,columnIndex:null,classes:"",configuration:null}],reactOnContainerWidthChanges:true,forceResponsiveGridWidth:true,responsiveSensitivity:20,responsiveModes:null,enableVerticalRendering:true,windowWidthToRenderVertically:null,propertiesColumnWidth:"50%",valuesColumnWidth:"50%",allowedColumnWidthPerType:{string:120,number:50,bool:50,date:80,object:150},singleColumnTemplate:null,inherit:false},events:{responsiveColumnHiding:"responsiveColumnHiding",responsiveColumnHidden:"responsiveColumnHidden",responsiveColumnShowing:"responsiveColumnShowing",responsiveColumnShown:"responsiveColumnShown",responsiveModeChanged:"responsiveModeChanged"},css:{verticalContainerCssClass:"ui-iggrid-responsive-vertical"},_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._callBackId=null;this._responsive=null;this._exclusiveContainer=false;this._mode="";this._modes=this.options.responsiveModes||{desktop:"infragistics",tablet:"infragistics",phone:"infragistics"};this._modes=this._initializeModeRecognizers(this._modes);this._hiddenByClass=this._flagClassConfiguration();this._defaultColumnTemplates=null;this._defaultColumnFormatters=null;this._footersDisplacement=.1;this._originalRenderRecord=null;this._newRenderRecord=null;this._vrw=typeof this.options.windowWidthToRenderVertically==="string"?parseInt(this.options.windowWidthToRenderVertically,10):this.options.windowWidthToRenderVertically;this._vr=null},_setOption:function(key,value){switch(key){case"propertiesColumnWidth":case"valuesColumnWidth":throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key));case"responsiveModes":this._modes=value;this._modes=this._initializeModeRecognizers(this._modes);break;case"reactOnContainerWidthChanges":if(value===true){this._activateContainer()}else{this._deactivateContainer()}break;case"enableVerticalRendering":this.options.enableVerticalRendering=value;if(this._shouldRenderVertically()){if(!this._vr){this._enableNoHeaderLayout(true,false)}}else{if(this._vr){this._disableNoHeaderLayout()}}break;case"windowWidthToRenderVertically":this._vrw=typeof value==="string"?parseInt(value,10):value;break}$.Widget.prototype._setOption.apply(this,arguments);this._hiddenByClass=this._flagClassConfiguration()},destroy:function(){this._deactivateContainer();if(this._initialGridRenderedHandler){this.grid.element.unbind("iggridrendered",this._initialGridRenderedHandler);this.grid.element.unbind("iggridheaderrendering",this._gridHeaderRenderingHandler)}this.grid.element.unbind("iggrid_heightchanged",this._gridContainerHeightHandler);$("#"+this.grid.element[0].id+"_responsive_test_container").remove();this.grid._renderRecord=this._originalRenderRecord;this.grid._renderColgroup=this._originalRenderColgroup;this.grid._renderCell=this._originalRenderCell;this.grid.renderNewRow=this._originalRenderNewRow;$.Widget.prototype.destroy.call(this);return this},getCurrentResponsiveMode:function(){return this._mode},_activateContainer:function(){if(!this._responsive||typeof this._responsive.addCallback!=="function"){this._responsive=this.grid.element.closest(".ui-widget").igResponsiveContainer().data("igResponsiveContainer");this._exclusiveContainer=true}this._callBackId=this._responsive.addCallback(this._containerResized,this,this.options.responsiveSensitivity,"x")},_deactivateContainer:function(){if(typeof this._callBackId==="number"){this._responsive.removeCallback(this._callBackId);this._callBackId=null}if(this._exclusiveContainer===true){this._responsive.destroy();delete this._responsive;this._exclusiveContainer=false}},_renderTestElement:function(){$("<div></div>").attr("id",this.grid.element[0].id+"_responsive_test_container").css("position","fixed").css("top","-100px").text("&nbsp;").appendTo(this.grid.container())},_initializeModeRecognizers:function(){var self=this,transformed={},nval;$.each(this._modes,function(key,value){if(typeof value==="string"){nval=value.substring(0,1).toUpperCase()+value.substring(1);nval=new $.ig[nval+"Mode"]({key:key,visibilityTester:$.proxy(self._checkVisibilityByClass,self)})}else if(typeof value==="object"&&!value.isActive){nval=new $.ig.ResponsiveMode({minWidth:value.minWidth||-1,maxWidth:value.maxWidth||Number.MAX_VALUE,minHeight:value.minHeight||-1,maxHeight:value.maxHeight||Number.MAX_VALUE})}else{nval=value}transformed[key]=nval});return transformed},_flagClassConfiguration:function(){var byClass=false;$.each(this.options.columnSettings,function(){if(this.classes){byClass=true;return false}});return byClass},_getDefaultColumnTemplates:function(){var cache={},col,i;for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i];if(col.template){if(col.key){cache[col.key]=col.template}else{cache[i]=col.template}}}return cache},_getDefaultColumnFormatters:function(){var cache={},col,i;for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i];if(col.formatter){if(col.key){cache[col.key]=col.formatter}else{cache[i]=col.formatter}}}return cache},_checkVisibilityByClass:function(classes){var testContainer=$("#"+this.grid.element[0].id+"_responsive_test_container");testContainer.removeClass();testContainer.addClass(classes);return testContainer.is(":visible")},_gridReady:function(){return!(this.grid._loadingIndicator&&this.grid._loadingIndicator._indicator.is(":visible"))},_shouldRenderVertically:function(){if(!this.options.enableVerticalRendering){return false}if(this._vrw===null||this._vrw===undefined){return this._shouldRenderVerticallyByDefault()}if($(window).width()<this._vrw){return true}if($(window).width()>=this._vrw){return false}return false},_shouldRenderVerticallyByDefault:function(){var i,gw=this.grid.element.width(),gp=100,cw,cols=[],col,tcocww=0,p,aw;for(i=0;i<this.grid._visibleColumns().length;i++){col=this.grid._visibleColumns()[i];if(col.width){cw=-1;if(typeof col.width==="string"){if(col.width.endsWith("%")){cw=parseInt(col.width,10);gp-=cw}else{gw-=parseInt(col.width,10)}}else{gw-=col.width}if(cw!==-1){cols.push({key:col.key||i,width:cw,type:col.dataType})}continue}tcocww++;cols.push({key:col.key||i,width:-1,type:col.dataType})}for(i=0;i<cols.length;i++){p=cols[i].width===-1?gp/tcocww:cols[i].width;aw=p/100*gw;if(aw<=this.options.allowedColumnWidthPerType[cols[i].type]){return true}}return false},_isSingleColumn:function(){if(this.options.singleColumnTemplate&&this.options.singleColumnTemplate[this._mode]){return true}},_updateGridSync:function(initial,full){var self=this;if(!this._gridReady()){setTimeout(function(){self._updateGridSync(initial,full)},50);return}return self._updateGrid(initial,full)},_updateGrid:function(initial,full){var result=[],applyTemplatesFormatters=false,colsToShow,colsToHide,self=this,i;this._vr=this._vr===null?this._shouldRenderVertically():this._vr;delete this.grid._visibleColumnsArray;if(this._vr){this.grid.element.addClass(this.css.verticalContainerCssClass)}if(this._hiddenByClass===true){result=this._updateColumnsByClass()}if(full===true){if(this._hiddenByClass===false){result=this._updateColumns()}applyTemplatesFormatters=this._updateTemplatesFormatters()}colsToShow=result[0]||[];colsToHide=result[1]||[];if(colsToShow.length===0&&colsToHide.length===0){if(applyTemplatesFormatters===true&&initial===false){return true}return}if(initial===false){this.grid._loadingIndicator.show();setTimeout(function(){self.grid._setHiddenColumns(colsToShow,false,initial);for(i=0;i<colsToShow.length;i++){self._trigger(self.events.responsiveColumnShown,null,self._getArgsByColumn(colsToShow[i]))}self.grid._setHiddenColumns(colsToHide,true,initial);for(i=0;i<colsToHide.length;i++){self._trigger(self.events.responsiveColumnHidden,null,self._getArgsByColumn(colsToHide[i]))}if(initial===false){self.grid._loadingIndicator.hide()}self._setMaxWidthOnGrid()},0)}else{$.each(colsToShow,function(){this.hidden=false});$.each(colsToHide,function(){this.hidden=true})}},_updateColumnsByClass:function(){var i,cs=this.options.columnSettings,col,colsToHide=[],colsToShow=[],noCancel,hidden,visible;for(i=0;i<cs.length;i++){if(cs[i].classes){col=this._getGridColumnBySetting(cs[i]);if(!col){continue}hidden=col.hidden||false;visible=this._checkVisibilityByClass(cs[i].classes);if(hidden===true&&visible===true){noCancel=this._trigger(this.events.responsiveColumnShowing,null,this._getArgsByColumnSetting(cs[i]));if(noCancel){colsToShow.push(col)}}if(hidden===false&&visible===false){noCancel=this._trigger(this.events.responsiveColumnHiding,null,this._getArgsByColumnSetting(cs[i]));if(noCancel){colsToHide.push(col)}}}}return[colsToShow,colsToHide]},_updateColumns:function(){var i,cs=this.options.columnSettings,col,colsToHide=[],colsToShow=[],noCancel,m=this._mode,hidden,visible;for(i=0;i<cs.length;i++){if(cs[i].configuration){col=this._getGridColumnBySetting(cs[i]);if(!col){continue}hidden=col.hidden||false;visible=!(cs[i].configuration[m]&&cs[i].configuration[m].hidden);if(hidden===true&&visible===true){noCancel=this._trigger(this.events.responsiveColumnShowing,null,this._getArgsByColumnSetting(cs[i]));if(noCancel){colsToShow.push(col)}}if(hidden===false&&visible===false){noCancel=this._trigger(this.events.responsiveColumnHiding,null,this._getArgsByColumnSetting(cs[i]));if(noCancel){colsToHide.push(col)}}}}return[colsToShow,colsToHide]},_updateTemplatesFormatters:function(){var i,cs=this.options.columnSettings,nt,nf,updated=false,col,m=this._mode,jsRndr=String(this.grid.options.templatingEngine).toLowerCase()==="jsrender";for(i=0;i<cs.length;i++){col=this._getGridColumnBySetting(cs[i]);if(!col){continue}if(cs[i].configuration&&cs[i].configuration[m]&&cs[i].configuration[m].template){nt=cs[i].configuration[m].template}else{nt=col.key?this._defaultColumnTemplates[col.key]:this._defaultColumnTemplates[$.inArray(col,this.grid.options.columns)]}if(cs[i].configuration&&cs[i].configuration[m]&&cs[i].configuration[m].formatter){nf=cs[i].configuration[m].formatter;nf=$.type(nf)==="string"?window[nf]:nf}else{nf=col.key?this._defaultColumnFormatters[col.key]:this._defaultColumnFormatters[$.inArray(col,this.grid.options.columns)]}if(col.template!==nt){col.template=nt;updated=true}if(col.formatter!==nf){col.formatter=nf;updated=true}}if(updated===true){if(!this.grid._tmplWrappers){this.grid._tmplWrappers=jsRndr?$.render:{}}this.grid._setTemplateDefinition(jsRndr)}return updated},_executeTemplate:function(data){if(this._jsr){return $.render[this.grid.id()+"_responsiveSct_"+this._mode](data).replace("<td","").replace("</td>","")}return $.ig.tmpl(this.options.singleColumnTemplate[this._mode],data).replace("<td","").replace("</td>","")},_renderRecord:function(data,index){if(this._vr){return this._renderRecordVerticalGrid(data,index)}if(this._scr){return this._renderRecordSingleColumnGrid(data,index)}return this._originalRenderRecord(data,index)},_renderRecordVerticalGrid:function(data,index){var i=0,str="",tstr,alt,vc=this.grid._visibleColumns(),key=this.grid.options.primaryKey;alt=index%2!==0&&this.grid.options.alternateRowStyles;for(i=0;i<vc.length;i++){str+="<tr";if(alt){str+=' class="'+this.grid.css.recordAltClass+'"'}str+=' data-id="'+data[key]+'"';str+=' data-col-key="'+vc[i].key+'"';str+="><td>";str+=vc[i].headerText+"</td>";str+="<td aria-readonly='true'";if(vc[i].template&&vc[i].template.length){tstr=this.grid._renderTemplatedCell(data,vc[i]);if(tstr.indexOf("<td")===0){str+=tstr.substring(3)}else{str+=">"+tstr}}else{str+=">"+this.grid._renderCell(data[vc[i].key],vc[i])}str+="</td></tr>"}return str},_renderRecordSingleColumnGrid:function(data,index){var str="<tr",pk=this.grid.options.primaryKey,formattedData,key,tmplRes;if(index%2!==0&&this.options.alternateRowStyles){str+=' class="'+this.grid.css.recordAltClass+'"'}if(pk!==null&&pk!==undefined){str+=' data-id="'+this.grid._kval_from_key(pk,data)+'"'}else if(data.ig_pk!==null&&pk!==undefined){str+=' data-id="'+data.ig_pk+'"'}str+="><td aria-readonly='true'";formattedData=$.extend(true,{},data);for(key in formattedData){if(formattedData.hasOwnProperty(key)){formattedData[key]=this.grid._renderCell(data[key],this.grid.columnByKey(key)||{},formattedData)}}tmplRes=this._executeTemplate(formattedData);if(tmplRes.indexOf("<td")===0){str+=tmplRes.substring(3)}else{str+=">"+tmplRes}str+="</td></tr>";return str},_renderNewRow:function(rec){var tbody,go,index,virt;if(this._vr){tbody=this.element.children("tbody");go=this.grid.options;virt=go.virtualization===true||go.rowVirtualization===true;if(virt){this._renderVirtualRecordsContinuous();this._startRowIndex=0;this.virtualScrollTo(this._totalRowCount)}else{index=this.grid.dataSource.dataView().length-1;tbody.append(this.grid._renderRecord(rec,index))}}else{this._originalRenderNewRow(rec)}},_renderCell:function(val,col,record,displayStyle,returnObject){var type=col.dataType,format=col.format,o=this.grid.options,auto=o.autoFormat;if(record){val=this.grid.dataSource.getCellValue(col.key,record)}val=this.grid._fixDate(val,col);if(col.formatter){return col.formatter(val,record,this._mode)}if(!format&&type==="bool"&&o.renderCheckboxes){format="checkbox"}if(format==="checkbox"&&type!=="bool"){format=null}type=type==="date"||type==="number"?type:"";if(format||(auto===true||auto==="dateandnumber")&&type||auto&&auto===type){return $.ig.formatter(val,type,format,true,o.enableUTCDates,displayStyle)}if(returnObject){return val}return val||val===0||val===false?val.toString():"&nbsp;"},_renderColgroup:function(table,isHeader,isFooter,autofitLastColumn){var colgroup,fcw,scw;this._vr=this._vr===null?this._shouldRenderVertically():this._vr;this._scr=this._scr===undefined||this._scr===null?this._isSingleColumn():this._scr;if(!this._vr&&!this._scr){this._originalRenderColgroup(table,isHeader,isFooter,autofitLastColumn);return}colgroup=$(table).find("colgroup");if(colgroup.length===0){colgroup=$("<colgroup></colgroup>").prependTo(table)}colgroup.empty();if(this._vr){fcw=typeof this.options.propertiesColumnWidth==="string"?parseInt(this.options.propertiesColumnWidth,10):this.options.propertiesColumnWidth;scw=typeof this.options.valuesColumnWidth==="string"?parseInt(this.options.valuesColumnWidth,10):this.options.valuesColumnWidth;colgroup.append("<col width='"+fcw+"%'></col><col width='"+scw+"%'></col>")}else if(this._scr){colgroup.append("<col width='100%'></col>")}},_enableNoHeaderLayout:function(vr,scr){this.grid.element.addClass(this.css.verticalContainerCssClass);if(!this.grid.options.showHeader||!this.grid.options.fixedHeaders||this.grid.options.height===null){this.grid.headersTable().children("thead").css("display","none")}else{this.grid.headersTable().css("position","absolute");this.grid.headersTable().css("top","-100px")}this._vr=vr;this._scr=scr;this._modifySortingStyles();this._disableUpdating();this.grid._rerenderColgroups();this.grid._renderData()},_disableNoHeaderLayout:function(){this.grid.element.removeClass(this.css.verticalContainerCssClass);if(!this.grid.options.showHeader||!this.grid.options.fixedHeaders||this.grid.options.height===null){this.grid.headersTable().children("thead").css("display","")}else{this.grid.headersTable().css("position","");this.grid.headersTable().css("top","")}this._scr=false;this._vr=false;this._modifySortingStyles(true);this._enableUpdating();this.grid._rerenderColgroups();this.grid._renderData()},_disableUpdating:function(){if(this.grid.element.data("igGridUpdating")){this._em=this.grid.element.igGridUpdating("option","editMode");this._dm=this.grid.element.igGridUpdating("option","enableDeleteRow");this.grid.element.igGridUpdating("option","editMode","none");this.grid.element.igGridUpdating("option","enableDeleteRow",false)}},_enableUpdating:function(){if(this.grid.element.data("igGridUpdating")){if(this._em){this.grid.element.igGridUpdating("option","editMode",this._em)}if(this._dm){this.grid.element.igGridUpdating("option","enableDeleteRow",true)}}},_getGridColumnBySetting:function(cs){var col;if(cs.columnKey&&typeof cs.columnKey==="string"){col=this.grid.columnByKey(cs.columnKey)}else if(cs.columnIndex!==null&&cs.columnIndex!==undefined&&typeof cs.columnIndex==="number"&&cs.columnIndex>=0&&cs.columnIndex<this.grid.options.columns.length){col=this.grid.options.columns[cs.columnIndex]}return col},_getArgsByColumnSetting:function(cs){return{owner:this,columnIndex:cs.columnIndex||null,columnKey:cs.columnKey||null}},_getArgsByColumn:function(col){return{owner:this,columnIndex:$.inArray(col,this.grid.options.columns),columnKey:col.key||null}},_getCurrentMode:function(){var env;$.each(this._modes,function(key){if(this.isActive()===true){env=key;return false}});return env},_containerResized:function(nw,nh){var mode=this._getCurrentMode(),prevMode,shouldUpdate=false,shouldRerender=false;if(nw<=0&&nh<=0){return}this._setMaxWidthOnGrid();if(mode&&mode!==this._mode){prevMode=this._mode;this._mode=mode;this._trigger(this.events.responsiveModeChanged,null,{owner:this,previousMode:prevMode,mode:mode});shouldUpdate=true}if(shouldUpdate||this._hiddenByClass){shouldRerender=this._updateGridSync(false,shouldUpdate)}if(this._isSingleColumn()){if(!this._scr){this._enableNoHeaderLayout(false,true)}else if(shouldUpdate){this.grid._renderData()}}else{if(this._scr){this._disableNoHeaderLayout();this._scr=false}else if(shouldRerender){this.grid._renderData()}}if(this._shouldRenderVertically()){if(!this._vr){this._enableNoHeaderLayout(true,false)}}else{if(this._vr){this._disableNoHeaderLayout();this._vr=false}else if(shouldRerender){this.grid._renderData()}}},_gridHeaderRendering:function(evt,ui){var i;if(ui.owner.id()!==this.grid.id()){return}this._renderTestElement();this._mode=this._getCurrentMode();this._defaultColumnTemplates=this._getDefaultColumnTemplates();this._defaultColumnFormatters=this._getDefaultColumnFormatters();if($.isArray(this.grid._initialHiddenColumns)){for(i=0;i<this.grid._initialHiddenColumns.length;i++){this.grid._initialHiddenColumns[i].hidden=true}}this._updateGrid(true,true);this.grid._captureInitiallyHiddenColumns()},_initialGridRendered:function(){if(this.options.reactOnContainerWidthChanges){this._activateContainer()}if(this._vr||this._scr){if(!this.grid.options.showHeader||!this.grid.options.fixedHeaders||this.grid.options.height===null){this.grid.headersTable().children("thead").css("display","none")}else{this.grid.headersTable().css("position","absolute");this.grid.headersTable().css("top","-100px")}this._disableUpdating();this._modifySortingStyles()}this._alreadyRendered=true;this._setMaxWidthOnGrid()},_dataRendered:function(){this._setMaxWidthOnGrid()},_modifySortingStyles:function(restore){var sorting=this.grid.element.data("igGridSorting");if(sorting){if(restore){sorting.options.applySortedColumnCss=this._srs}else{this._srs=sorting.options.applySortedColumnCss;sorting.options.applySortedColumnCss=false}}},_heightChanged:function(){var newHeight=$("#"+this.grid.element[0].id+"_scroll").height();if(this._height!==newHeight){this._height=newHeight;this.grid._adjustLastColumnWidth(false);this._setMaxWidthOnGrid()}},_setMaxWidthOnGrid:function(){var sbw=this.grid._hasVerticalScrollbar===true?this.grid._scrollbarWidth():0,npw;if(this.options.forceResponsiveGridWidth){this.grid._gridContentWidth=0;this.grid.element.css("width","100%");if(!this.grid._allColumnWidthsInPercentage){npw=100-sbw/this.grid.container().width()*100;if(this.grid.options.fixedHeaders===true){this.grid.headersTable().css("width",npw+"%")}if(this.grid.options.fixedFooters===true){this.grid.footersTable().css("width",npw+this._footersDisplacement+"%")}}}},_createHandlers:function(){this._gridHeaderRenderingHandler=$.proxy(this._gridHeaderRendering,this);this._initialGridRenderedHandler=$.proxy(this._initialGridRendered,this);this._gridContainerHeightHandler=$.proxy(this._heightChanged,this)},_injectGrid:function(gridInstance,isRebind){var key,sct;if(isRebind===true){return}this.grid=gridInstance;this._checkGridNotSupportedFeatures();this._createHandlers();if(this.options.forceResponsiveGridWidth===true){this.grid.options.width=typeof this.grid.options.width==="string"&&this.grid.options.width.endsWith("%")?this.grid.options.width:"100%";this.grid.options.autoFitLastColumn=false}this.grid.element.bind("iggridheaderrendering",this._gridHeaderRenderingHandler);this.grid.element.bind("iggridrendered",this._initialGridRenderedHandler);if(this.grid.options.height!==null&&this.grid.options.height.indexOf&&this.grid.options.height.indexOf("%")!==-1){this.grid.element.bind("iggrid_heightchanged",this._gridContainerHeightHandler)}this._originalRenderRecord=$.proxy(this.grid._renderRecord,this.grid);this._newRenderRecord=$.proxy(this._renderRecord,this);this._originalRenderColgroup=$.proxy(this.grid._renderColgroup,this.grid);this._newRenderColgroup=$.proxy(this._renderColgroup,this);this._originalRenderCell=this.grid._renderCell;this._newRenderCell=$.proxy(this._renderCell,this);this._originalRenderNewRow=$.proxy(this.grid.renderNewRow,this.grid);this._newRenderNewRow=$.proxy(this._renderNewRow,this);this.grid._renderRecord=this._newRenderRecord;this.grid._renderColgroup=this._newRenderColgroup;this.grid._renderCell=this._newRenderCell;this.grid.renderNewRow=this._newRenderNewRow;if(String(this.grid.options.templatingEngine).toLowerCase()==="jsrender"){this._jsr=true;sct=this.options.singleColumnTemplate;if(sct&&typeof sct==="object"){for(key in sct){if(sct.hasOwnProperty(key)){$.templates(this.grid.id()+"_responsiveSct_"+key,sct[key])}}}}},_checkGridNotSupportedFeatures:function(){var gridOptions=this.grid.options;if((gridOptions.virtualization===true||gridOptions.rowVirtualization===true||gridOptions.columnVirtualization===true)&&gridOptions.virtualizationMode==="fixed"){throw new Error($.ig.igGridResponsive.locale.fixedVirualizationNotSupported)}}});$.extend($.ui.igGridResponsive,{version:"16.1.20161.1009"});$.ig=$.ig||{};$.ig.ResponsiveMode=$.ig.ResponsiveMode||Class.extend({settings:{minWidth:-1,maxWidth:Number.MAX_VALUE,minHeight:-1,maxHeight:Number.MAX_VALUE},init:function(options){if(options){this.settings=$.extend(true,{},$.ig.ResponsiveMode.prototype.settings,options)}return this},isActive:function(){return window.innerWidth>=this.settings.minWidth&&window.innerWidth<=this.settings.maxWidth&&window.innerHeight>=this.settings.minHeight&&window.innerHeight<=this.settings.maxHeight}});$.ig.InfragisticsMode=$.ig.InfragisticsMode||$.ig.ResponsiveMode.extend({settings:{key:"",visibilityTester:null},init:function(options){this._hc="ui-hidden-"+options.key;this._vc="ui-visible-"+options.key;this._super(options);return this},isActive:function(){if(typeof this.settings.visibilityTester==="function"){return this.settings.visibilityTester(this._hc)===false&&this.settings.visibilityTester(this._vc)===true}return this._super()}});$.ig.BootstrapMode=$.ig.BootstrapMode||$.ig.ResponsiveMode.extend({settings:{key:"",visibilityTester:null},init:function(options){this._hc="hidden-"+options.key;this._vc="visible-"+options.key;this._super(options);return this},isActive:function(){if(typeof this.settings.visibilityTester==="function"){return this.settings.visibilityTester(this._hc)===false&&this.settings.visibilityTester(this._vc)===true}return this._super()}})})(jQuery);if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridModalDialog",{options:{buttonApplyText:"Apply",buttonCancelText:"Cancel",buttonApplyTitle:null,buttonCancelTitle:null,modalDialogCaptionText:"Header",modalDialogWidth:250,modalDialogHeight:"",renderFooterButtons:true,animationDuration:200,buttonApplyDisabled:false,closeModalDialogOnEnter:false,tabIndex:null},css:{modalDialog:"ui-dialog ui-draggable ui-resizable ui-iggrid-dialog ui-widget ui-widget-content ui-corner-all",modalDialogHeaderCaption:"ui-dialog-titlebar ui-widget-header ui-corner-top ui-helper-reset ui-corner-all ui-helper-clearfix",modalDialogHeaderCaptionTitle:"ui-dialog-title",modalDialogContent:"ui-dialog-content ui-widget-content",modalDialogHandleBar:"",captionButtonContainer:"ui-iggrid-modaldialog-caption-buttoncontainer",modalDialogFooter:"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix",buttonset:"ui-dialog-buttonset",blockArea:"ui-widget-overlay ui-iggrid-blockarea"},events:{modalDialogOpening:"modalDialogOpening",modalDialogOpened:"modalDialogOpened",modalDialogMoving:"modalDialogMoving",modalDialogClosing:"modalDialogClosing",modalDialogClosed:"modalDialogClosed",modalDialogContentsRendering:"modalDialogContentsRendering",modalDialogContentsRendered:"modalDialogContentsRendered",buttonOKClick:"buttonOKClick",buttonCancelClick:"buttonCancelClick"},_createWidget:function(options){this.gridContainer=options.gridContainer;this.containment=options.containment||options.gridContainer;$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._setGridWidthHeight();this._renderModalDialog()},_setGridWidthHeight:function(){this.element.css("width",this.options.modalDialogWidth).css("height",this.options.modalDialogHeight)},_checkModalDialogFocus:function(){var self=this;self.gridContainer.unbind("keydown.focusChecker");self.gridContainer.bind("keydown.focusChecker",function(e){var target,gridContainer,tabElems;if(e.keyCode===$.ui.keyCode.TAB){target=document.activeElement;gridContainer=self.gridContainer[0];if(!target||!gridContainer){return}if(target===gridContainer||$.contains(gridContainer,target)&&!$.contains(self.element[0],target)){tabElems=$(":tabbable",self.element);tabElems.first().focus();return}}})},openModalDialog:function(){var maxZ=1e4,rOffset,scrollLeft,scrollTop,pageLeft,pageTop,pageRight,pageBottom,pos,h,w,bh,bw,mdW,mdH,caption,content,footer,modalDialogTop,modalDialogLeft,noCancel=true,modalDialog=this.element,block,animationDuration=this._getAnimationDuration(),blockId=this._id("_modaldialog_block"),ti=this.options.tabIndex;if(this._modalDialogOpened){return}noCancel=this._trigger(this.events.modalDialogOpening,null,{modalDialog:modalDialog,owner:this});if(noCancel){this._checkModalDialogFocus();$("#"+blockId).remove();this._setGridWidthHeight();pos=$.ig.util.offset(this.gridContainer);w=this.gridContainer.outerWidth();h=this.gridContainer.outerHeight();scrollLeft=$(window).scrollLeft();scrollTop=$(window).scrollTop();pageLeft=pos.left-scrollLeft;pageTop=pos.top-scrollTop;pageRight=pageLeft+w;pageBottom=pageTop+h;if(typeof this.options.modalDialogWidth==="number"){mdW=parseInt(this.options.modalDialogWidth,10)}else{if(this.options.modalDialogWidth.indexOf("%")>0){var percentW=parseInt(this.options.modalDialogWidth,10)/100;if(this.options.containment instanceof jQuery){mdW=this.options.containment.width()*percentW}if(typeof this.options.containment==="string"){mdW=$(window).width()*percentW}}if(this.options.modalDialogWidth.indexOf("px")>0){mdW=parseInt(this.options.modalDialogWidth,10)}}if(typeof this.options.modalDialogHeight==="number"){mdH=parseInt(this.options.modalDialogHeight,10)}else{if(this.options.modalDialogHeight.indexOf("%")>0){var percentH=parseInt(this.options.modalDialogHeight,10)/100;if(this.options.containment instanceof jQuery){mdH=this.options.containment.height()*percentH}if(typeof this.options.containment==="string"){mdH=$(window).height()*percentH}}if(this.options.modalDialogHeight.indexOf("px")>0){mdH=parseInt(this.options.modalDialogHeight,10)}}block=$("<div></div>").appendTo(this.gridContainer).attr("id",blockId).css("position","absolute").addClass(this.css.blockArea).hide();if(block.outerWidth()!==this.gridContainer.outerWidth()){block.css("width",this.gridContainer.outerWidth())}if(block.outerHeight()!==this.gridContainer.outerHeight()){block.css("height",this.gridContainer.outerHeight())}rOffset=$.ig.util.getRelativeOffset(block);block.css({left:pos.left-rOffset.left,top:pos.top-rOffset.top}).fadeToggle(animationDuration);if(!mdW){mdW=this.element.width()}if(!mdH){mdH=this.element.height()}if(pageLeft<0){pageLeft=0}if(pageTop<0){pageTop=0}bw=$(window).width();bh=$(window).height();if(pageRight>bw){pageRight=bw}if(pageBottom>bh){pageBottom=bh}modalDialogTop=pageTop+scrollTop+(pageBottom-pageTop)/2-mdH/2;modalDialogLeft=pageLeft+scrollLeft+(pageRight-pageLeft)/2-mdW/2;if(modalDialogTop<0){modalDialogTop=pageTop}if(modalDialogLeft<0){modalDialogLeft=pageLeft}maxZ=$.ig.getMaxZIndex(this.element[0].id);rOffset=$.ig.util.getRelativeOffset(modalDialog);modalDialog.css({left:modalDialogLeft-rOffset.left,top:modalDialogTop-rOffset.top,zIndex:maxZ+2}).fadeToggle(animationDuration);block.css({zIndex:maxZ+1});caption=modalDialog.children("div.ui-dialog-titlebar");content=modalDialog.children("div.ui-dialog-content");footer=modalDialog.children("div.ui-dialog-buttonpane");content.css("height",modalDialog.height()-caption.outerHeight()-(content.outerHeight()-content.height())-footer.outerHeight());$("#"+this._id("content")).attr("tabIndex",$.type(ti)==="number"?ti:0).css({width:""});this._modalDialogOpened=true;this._trigger(this.events.modalDialogOpened,null,{modalDialogElement:modalDialog,owner:this});modalDialog.focus()}},_getAnimationDuration:function(){var animationDuration=this.options.animationDuration;if(animationDuration===null||animationDuration===undefined){animationDuration=200}return animationDuration},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"buttonApplyText":$("#"+this._id("footer_buttonok")).igButton("option","labelText",value);break;case"buttonApplyDisabled":$("#"+this._id("footer_buttonok")).igButton("option","disabled",value);break;case"buttonCancelText":$("#"+this._id("footer_buttoncancel")).igButton("option","labelText",value);break;case"modalDialogCaptionText":this.element.find("span.ui-dialog-title:eq(0)").html(value);break;case"modalDialogWidth":this.element.css("width",value);break;case"modalDialogHeight":this.element.css("height",value);break;case"renderFooterButtons":if(this.element.is(":visible")){this.closeModalDialog()}this.element.empty();this._renderModalDialog();break;default:break}},closeModalDialog:function(accepted){var noCancel=true,modalDialog=this.element,animationDuration=this._getAnimationDuration();if(!this._modalDialogOpened){return}noCancel=this._trigger(this.events.modalDialogClosing,null,{modalDialog:modalDialog,owner:this,accepted:!!accepted});if(noCancel){this.gridContainer.unbind("keydown.focusChecker");modalDialog.fadeToggle(animationDuration);$("#"+this._id("_modaldialog_block")).fadeToggle(animationDuration);this._modalDialogOpened=false;this._trigger(this.events.modalDialogClosed,null,{modalDialog:modalDialog,owner:this,accepted:!!accepted})}},_modalDialogMove:function(e,ui){var oPos=ui.originalPosition,pos=ui.position;this._trigger(this.events.modalDialogMoving,null,{modalDialog:e.target,owner:this,originalPosition:oPos,position:pos})},getCaptionButtonContainer:function(){return $("#"+this._id("caption_button_container"))},getFooter:function(){return $("#"+this._id("footer"))},getContent:function(){return $("#"+this._id("content"))},_renderModalDialog:function(){var self=this,css=this.css,modalDialog=this.element,caption,containment,modalDialogContent,footer,o=this.options,$buttonSet,$buttonOK,$buttonCancel,noCancel=true,ti=this.options.tabIndex;modalDialog.css("position","absolute").addClass(this.css.modalDialog).hide();noCancel=this._trigger(this.events.modalDialogContentsRendering,null,{modalDialog:modalDialog,owner:this});if(noCancel){caption=$("<div></div>").addClass(this.css.modalDialogHeaderCaption).appendTo(modalDialog);$("<span></span>").text(this.options.modalDialogCaptionText).addClass(this.css.modalDialogHeaderCaptionTitle).appendTo(caption);$("<div></div>").attr("id",this._id("caption_button_container")).addClass(css.captionButtonContainer).appendTo(caption);modalDialogContent=$("<div></div>").css("overflow","auto").addClass(this.css.modalDialogContent).attr("id",this._id("content")).appendTo(modalDialog);if(o.renderFooterButtons===true){footer=$("<div></div>").addClass(this.css.modalDialogFooter).attr("id",this._id("footer")).appendTo(modalDialog);$buttonSet=$("<div></div>").addClass(this.css.buttonset).appendTo(footer);$buttonOK=$("<button></button>").attr("id",this._id("footer_buttonok")).appendTo($buttonSet);if($.type(ti)){$buttonOK.attr("tabIndex",ti)}$buttonOK.igButton({labelText:o.buttonApplyText,title:o.buttonApplyTitle,disabled:o.buttonApplyDisabled});$buttonCancel=$("<button></button>").attr("id",this._id("footer_buttoncancel")).appendTo($buttonSet);if($.type(ti)){$buttonCancel.attr("tabIndex",ti)}$buttonCancel.igButton({labelText:o.buttonCancelText,title:o.buttonCancelTitle});$buttonCancel.bind({click:function(e){noCancel=self._trigger(self.events.buttonCancelClick,e,{modalDialog:modalDialog,owner:self});if(noCancel){self.closeModalDialog();e.preventDefault();e.stopPropagation()}}});$buttonOK.bind({click:function(e){var arg={modalDialog:modalDialog,owner:self,toClose:false};self._trigger(self.events.buttonOKClick,e,arg);if(arg.toClose){self.closeModalDialog(true);e.preventDefault();e.stopPropagation()}}})}containment=this.containment;if(containment==="window"){containment="document"}modalDialog.bind({keydown:function(e){var tabElems,first,last;if(e.keyCode===$.ui.keyCode.ESCAPE){self.closeModalDialog();return}if(e.keyCode===$.ui.keyCode.ENTER&&self.options.closeModalDialogOnEnter&&!self.options.buttonApplyDisabled){self.closeModalDialog(true);return}if(e.keyCode!==$.ui.keyCode.TAB){return}tabElems=$(":tabbable",this);first=tabElems.first();last=tabElems.last();if(e.target===last[0]&&!e.shiftKey){first.focus(1);return false}if(e.target===first[0]&&e.shiftKey){last.focus(1);return false}}}).draggable({containment:containment,handle:caption,drag:$.proxy(this._modalDialogMove,this)}).attr("role","dialog").attr("tabIndex",-1);if(!$.ig.util.isTouch){modalDialog.resizable({alsoResize:modalDialogContent,minHeight:modalDialog.outerHeight()/4,minWidth:modalDialog.outerWidth()/2});if(this.containment!=="window"){modalDialog.resizable("option","containment","parent")}}this._trigger(this.events.modalDialogContentsRendered,null,{modalDialog:modalDialog,owner:this})}},_id:function(){var i,ar=arguments,res=this.element[0].id;for(i=0;i<ar.length;i++){res+="_"+ar[i]}return res},destroy:function(){$("#"+this._id("_modaldialog_block")).remove();if(this.gridContainer){this.gridContainer.unbind("keydown.focusChecker")}$.Widget.prototype.destroy.apply(this,arguments);return this}});$.extend($.ui.igGridModalDialog,{version:"16.1.20161.1009"})})(jQuery);if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igEditorFilter",{setFocus:function(delay,toggle){var provider=this.options.provider;if(delay&&$.type(delay)==="number"&&delay>0){setTimeout(function(){provider.setFocus(toggle)},delay)}else{provider.setFocus(toggle)}},remove:function(){if(!this.options.provider.removeFromParent()){var p,e=this.element;p=e[0].parentNode;if(p&&p.tagName){p.removeChild(e[0])}e=this.validator();if(e){e.hide()}}},exitEditMode:function(){var editor=this.options.provider.editor;if(editor&&editor._exitEditMode&&$.type(editor._exitEditMode)==="function"){editor._exitEditMode()}},validator:function(){return this.options.provider.validator()},hasInvalidMessage:function(){var validator=this.validator();return validator?validator.getErrorMessages().length>0:false},destroy:function(){this.options.provider.destroy();$.Widget.prototype.destroy.call(this)}});$.extend($.ui.igEditorFilter,{version:"16.1.20161.1009"});$.ig.EditorProvider=$.ig.EditorProvider||Class.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){this.handlers={};this.userHandlers={};this.options=editorOptions||{};this.callbacks=callbacks;this.columnKey=key;this.handlers.keyDownHandler=$.proxy(this.keyDown,this);if(this.options.keydown){this.userHandlers.keyDown=this.options.keydown}this.options.keydown=this.handlers.keyDownHandler},keyDown:function(evt,ui){if(this.callbacks&&typeof this.callbacks.keyDown==="function"){this.callbacks.keyDown(evt,ui,this.columnKey)}if(this.userHandlers.keyDown){this.userHandlers.keyDown.apply(this.editor,[evt,ui])}},attachErrorEvents:function(errorShowing,errorShown,errorHidden){this.editor.element.bind({"igvalidatorrerrorhidden.updating":errorHidden,"igvalidatorerrorshowing.updating":errorShowing,"igvalidatorerrorshown.updating":errorShown})},getEditor:function(){return this.editor},refreshValue:function(){return true},getValue:function(){return this.editor.value()},setValue:function(val){this.editor.value(val)},setFocus:function(toggle){return null},setSize:function(width,height){return null},removeFromParent:function(){return false},destroy:function(){this.editor.destroy()},validator:function(){return null},validate:function(){var validator=this.validator();return validator?validator.isValid():true},requestValidate:function(){var validator=this.validator();return validator?validator.validate():true},isValid:function(){return true}});$.ig.EditorProviderBase=$.ig.EditorProviderBase||$.ig.EditorProvider.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){this._super(callbacks,key,editorOptions,tabIndex,format,element);this.handlers.textChangeHandler=$.proxy(this.textChanged,this);if(this.options.textChanged){this.userHandlers.textChanged=this.options.textChanged}this.options.textChanged=this.handlers.textChangeHandler;this.options.tabIndex=tabIndex},textChanged:function(evt,ui){if(this.callbacks&&typeof this.callbacks.textChanged==="function"){this.callbacks.textChanged(evt,ui,this.columnKey)}if(this.userHandlers.textChanged){this.userHandlers.textChanged.apply(this.editor,[evt,ui])}},setSize:function(width,height){this.editor._setOption("width",width);this.editor._setOption("height",height)},setFocus:function(){this.editor.setFocus()},removeFromParent:function(){var v=this.validator();if(v){v.hide()}this.editor._focused=false;this.editor._exitEditMode();this.editor.editorContainer().removeClass("ui-state-focus");return this.editor.editorContainer().detach()},destroy:function(){this.editor.element.unbind(".updating");this.editor.destroy()},refreshValue:function(){if(this.editor._editorInput.is(":focus")){this.editor._processValueChanging(this.editor._editorInput.val())}},validator:function(){if($.type(this.editor.validator)==="function"){return this.editor.validator()}return null},isValid:function(){return this.editor.isValid()}});$.ig.EditorProviderText=$.ig.EditorProviderText||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igTextEditor){throw new Error($.ig.GridUpdating.locale.igTextEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);element.igTextEditor(this.options);this.editor=element.data("igTextEditor");return this.editor.editorContainer()},keyDown:function(evt,ui){if(this.callbacks&&typeof this.callbacks.keyDown==="function"){if(!(ui.key===$.ui.keyCode.ENTER&&evt.originalEvent.altKey)||!ui.editorInput.is("textarea")){this.callbacks.keyDown(evt,ui,this.columnKey)}else{evt.originalEvent.stopPropagation()}}if(this.userHandlers.keyDown){this.userHandlers.keyDown.apply(this.editor,[evt,ui])}}});$.ig.EditorProviderNumeric=$.ig.EditorProviderNumeric||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igNumericEditor){throw new Error($.ig.GridUpdating.locale.igNumericEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);if(format==="int"){this.options.maxDecimals=0}else if(format==="double"&&!this.options.maxDecimals){this.options.maxDecimals=100}this.options.allowNullValue=true;element.igNumericEditor(this.options);this.editor=element.data("igNumericEditor");return this.editor.editorContainer()},getValue:function(){var val=this.editor.value();return isNaN(val)?null:val}});$.ig.EditorProviderCurrency=$.ig.EditorProviderCurrency||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igCurrencyEditor){throw new Error($.ig.GridUpdating.locale.igCurrencyEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);this.options.displayFactor=this.options.displayFactor||1;this.options.allowNullValue=true;element.igCurrencyEditor(this.options);this.editor=element.data("igCurrencyEditor");return this.editor.editorContainer()}});$.ig.EditorProviderPercent=$.ig.EditorProviderPercent||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igPercentEditor){throw new Error($.ig.GridUpdating.locale.igPercentEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);this.options.allowNullValue=true;element.igPercentEditor(this.options);this.editor=element.data("igPercentEditor");return this.editor.editorContainer()}});$.ig.EditorProviderMask=$.ig.EditorProviderMask||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igMaskEditor){throw new Error($.ig.GridUpdating.locale.igMaskEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);element.igMaskEditor(this.options);this.editor=element.data("igMaskEditor");return this.editor.editorContainer()}});$.ig.EditorProviderDate=$.ig.EditorProviderDate||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igDateEditor){throw new Error($.ig.GridUpdating.locale.igDateEditorException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);if(format&&!this.options.dateInputFormat){this.options.dateInputFormat=format}this.options.allowNullValue=true;element.igDateEditor(this.options);this.editor=element.data("igDateEditor");return this.editor.editorContainer()}});$.ig.EditorProviderDatePicker=$.ig.EditorProviderDatePicker||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igDatePicker){throw new Error($.ig.GridUpdating.locale.igDatePickerException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);if(format&&!this.options.dateInputFormat){this.options.dateInputFormat=format}this.options.allowNullValue=true;element.igDatePicker(this.options);this.editor=element.data("igDatePicker");return this.editor.editorContainer()}});$.ig.EditorProviderBoolean=$.ig.EditorProviderBoolean||$.ig.EditorProviderBase.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){var requiresWrapper;if(!this.renderFormat){this.renderFormat="checkbox"}this._super(callbacks,key,editorOptions,tabIndex,format,element);this.handlers.valueChanged=$.proxy(this.valueChanged,this);if(this.options.valueChanged){this.userHandlers.valueChanged=this.options.valueChanged}this.options.valueChanged=this.handlers.valueChanged;switch(this.renderFormat){case"checkbox":requiresWrapper=!element;element=element||$("<input />");if(!element.igCheckboxEditor){throw new Error($.ig.GridUpdating.locale.igCheckboxEditorException)}element.igCheckboxEditor(this.options);this.editor=element.data("igCheckboxEditor");if(requiresWrapper){this.outerContainer=$("<div />").css({background:"rgb(255, 255, 255)",outline:"0px","text-align":"center",overflow:"hidden"}).addClass("ui-igedit ui-igedit-container ui-state-default ui-iggrid-editor");this.outerContainer.append(this.editor.editorContainer());return this.outerContainer}return this.editor.editorContainer();case"dropdown":this.options.listItems=["true","false"];this.options.dropDownAttachToBody=true;this.options.button="dropdown";this.options.isLimitedToListValues=true;this.options.dropDownAttachedToBody=true;element=element||$("<span />");if(!element.igTextEditor){throw new Error($.ig.GridUpdating.locale.igTextEditorException)}element.igTextEditor(this.options);this.editor=element.data("igTextEditor");return this.editor.editorContainer()}},valueChanged:function(evt,ui){if(this.callbacks&&typeof this.callbacks.textChanged==="function"){this.callbacks.textChanged(evt,ui,this.columnKey)}if(this.userHandlers.valueChanged){this.userHandlers.valueChanged.apply(this.editor,[evt,ui])}},refreshValue:function(){return false},getValue:function(){if(this.renderFormat==="checkbox"){return this.editor.value()}return this.editor.value()==="true"},setValue:function(val){if(this.renderFormat==="checkbox"){this.editor.value(val!==null?val:false)}else{this.editor.value(val!==null?String(val):"false")}},setSize:function(width,height){var cont,chb,defChb;if(this.renderFormat==="checkbox"&&this.outerContainer){cont=this.outerContainer;chb=cont.children().first();cont.css("width",width);cont.css("height",height);chb.css({"margin-top":cont.height()/2-chb.height()/2});defChb=cont.siblings().first().children().first();width=defChb.width();height=defChb.height()}this._super(width,height)},removeFromParent:function(){if(this.renderFormat==="checkbox"&&this.outerContainer){return this.outerContainer.detach()}return this._super()},destroy:function(){this.editor.element.unbind(".updating");this.editor.destroy();if(this.outerContainer&&this.outerContainer instanceof jQuery){this.outerContainer.remove()}}});$.ig.EditorProviderCombo=$.ig.EditorProviderCombo||$.ig.EditorProvider.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<span />");if(!element.igCombo){throw new Error($.ig.GridUpdating.locale.igComboException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);this.handlers.selectionChangedHandler=$.proxy(this.selectionChanged,this);if(this.options.selectionChanged){this.userHandlers.selectionChanged=this.options.selectionChanged}this.options.selectionChanged=this.handlers.selectionChangedHandler;this.options.tabIndex=tabIndex;if(this.options.id){element.attr("id",this.options.id)}element.igCombo(this.options);this.editor=element.data("igCombo");this.editor.textInput().bind("keydown.updating",this.handlers.keyDownHandler);if(this.editor._options.internalSelChangeSubs&&$.type(this.editor._options.internalSelChangeSubs)==="array"){this.handlers.internalSelectionChangedHandler=$.proxy(this.internalSelectionChanged,this);this.editor._options.internalSelChangeSubs.push(this.handlers.internalSelectionChangedHandler)}return element},keyDown:function(evt,ui){if(evt.keyCode===$.ui.keyCode.TAB){this.editor.closeDropDown()}if(this.callbacks&&typeof this.callbacks.keyDown==="function"){if(evt.keyCode!==$.ui.keyCode.ENTER||!this.editor.dropDownOpened()){this.callbacks.keyDown(evt,ui||{owner:this.editor},this.columnKey)}}if(this.editor.options.allowCustomValue){this.internalSelectionChanged(evt,ui)}if(this.userHandlers.keyDown){this.userHandlers.keyDown.apply(this.editor,[evt,ui])}},internalSelectionChanged:function(evt,ui){if(this.callbacks&&typeof this.callbacks.textChanged==="function"){this.callbacks.textChanged(evt,ui,this.columnKey)}},selectionChanged:function(evt,ui){this.internalSelectionChanged(evt,ui);if(this.userHandlers.selectionChanged){this.userHandlers.selectionChanged.apply(this.editor,[evt,ui])}},refreshValue:function(){this.editor.refreshValue()},getValue:function(){var val=this.editor.value();if($.type(val)==="array"&&val.length){return val[0]}return val},setValue:function(val,fire){this.editor.value(val,null,fire)},setSize:function(width,height){this.editor.element.igCombo({width:width,height:height})},setFocus:function(){this.editor.textInput().focus()},removeFromParent:function(){this.editor.closeDropDown();if(this.validator()){this.validator().hide()}return this.editor.element.closest(".ui-igcombo-wrapper").detach()},validator:function(){return this.editor.validator()},destroy:function(){this.editor.textInput().unbind("keydown.updating");this.editor.element.unbind(".updating");this.editor.destroy()},isValid:function(){return true}});$.ig.EditorProviderObjectCombo=$.ig.EditorProviderObjectCombo||$.ig.EditorProviderCombo.extend({getValue:function(){var val=null,arr=[];if(this.editor.selectedItems()!==null){if(this.editor.options.multiSelection&&this.editor.options.multiSelection.enabled){$(this.editor.selectedItems()).each(function(){arr.push(this.data)});val=arr}else{val=this.editor.selectedItems()[0].data}}return val},setValue:function(val,fire){var arr=[],editor=this.editor;editor.deselectAll();if(val){if(editor.options.multiSelection&&editor.options.multiSelection.enabled){$(val).each(function(){arr.push(this[editor.options.valueKey])});editor.value(arr,null,fire)}else{editor.value(val[this.editor.options.valueKey],null,fire)}}}});$.ig.EditorProviderRating=$.ig.EditorProviderRating||$.ig.EditorProvider.extend({createEditor:function(callbacks,key,editorOptions,tabIndex,format,element){element=element||$("<div />");if(!element.igRating){throw new Error($.ig.GridUpdating.locale.igRatingException)}this._super(callbacks,key,editorOptions,tabIndex,format,element);this.handlers.valueChange=$.proxy(this.valueChange,this);if(this.options.valueChange){this.userHandlers.valueChange=this.options.valueChange}this.options.valueChange=this.handlers.valueChange;if(this.options.id){element.attr("id",this.options.id)}element.igRating(this.options);this.editor=element.data("igRating");this.handlers.internalValueChange=$.proxy(this.internalValueChange,this);this.editor._internalChanged=this.handlers.internalValueChange;if(this.editor._foc){this.editor._foc.attr("tabIndex",tabIndex);this.editor._foc.keydown(this.handlers.keyDown)}return element},internalValueChange:function(evt,ui){if(this.callbacks&&typeof this.callbacks.textChanged==="function"){this.callbacks.textChanged(evt,ui,this.columnKey)}},valueChange:function(evt,ui){this.internalValueChange(evt,ui);if(this.userHandlers.valueChange){this.userHandlers.valueChange.apply(this.editor,[evt,ui])}},setValue:function(val){return this.editor.value(val||0)},setSize:function(width,height){if(!this._once){this.editor._doVotes(this.editor.options)}this._once=1;var back=this.editor.element.parent().css("backgroundColor");this.editor.element.css({width:width,height:height,backgroundColor:back})},setFocus:function(){this.editor.focus()},validator:function(){return this.editor.validator()},destroy:function(){this.editor.element.unbind(".updating");this.editor.destroy()},isValid:function(){return true}})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Feature Chooser 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 *	jquery.ui.resizable.js
 *	infragistics.ui.popover.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridFeatureChooserPopover",$.ui.igPopover,{options:{gridId:"",targetButton:null,closeOnBlur:true,containment:null},_create:function(){$.extend($.ui.igGridFeatureChooserPopover.prototype.options,$.ui.igPopover.prototype.options);$.extend($.ui.igGridFeatureChooserPopover.prototype.css,$.ui.igPopover.prototype.css);$.ui.igPopover.prototype._create.apply(this)},isShown:function(){return this.container().is(":visible")},_setFCElementFocus:function(focus,$target){if($target===undefined||$target===null){$target=this.options.targetButton}this.options.targetButton.data("onFocus",focus);if(focus){$target.focus()}},registerElements:function(elements){var events,$targetButton=this.options.targetButton,self=this;events={focus:function(){setTimeout(function(){$targetButton.data("onFocus",true)},1)},blur:function(){$targetButton.data("onFocus",false);setTimeout(function(){if(!$targetButton.data("onFocus")&&self.isShown()){self._closePopover()}},10)}};elements.bind(events)},_createWidget:function(){var self=this,$targetButton;this._attachedToBody=true;this.options.content="";$.Widget.prototype._createWidget.apply(this,arguments);$.ui.igPopover.prototype._createWidget.apply(this,arguments);this._detachEventsFromTarget();$targetButton=this.options.targetButton;if(this.options.closeOnBlur){$targetButton.attr("tabindex","0");this._eventsFC={iggridfeaturechooserpopovershown:function(){self._setFCElementFocus(true)},iggridfeaturechooserpopoverhidden:function(){self._setFCElementFocus(false);self.popover.width("");self.popover.css({left:""})},mousedown:function(){setTimeout(function(){self._setFCElementFocus(true)},1)},touchstart:function(){setTimeout(function(){self._setFCElementFocus(true)},1)}};this.element.bind(this._eventsFC);this.registerElements($targetButton)}},_removeOriginalTitle:function(){},_positionPopover:function(){var $popover,availableWidth,mw=this.options.maxWidth,$containment=this.options.containment,$window=$(window);if(mw&&$.type(mw)==="string"){mw=parseInt(mw,10)}$popover=this.popover;if($popover){if($containment.offset().left>=$window.scrollLeft()){availableWidth=$window.width()+$window.scrollLeft()-$containment.offset().left}else{availableWidth=$window.width()}if(mw&&$.type(mw)==="number"&&mw<availableWidth){availableWidth=mw}this.popover.css("max-width",availableWidth)}$.ui.igPopover.prototype._positionPopover.apply(this,arguments)},destroy:function(){var $targetButton;if(this._eventsFCTargetButton){$targetButton=this.options.targetButton;$targetButton.unbind(this._eventsFCTargetButton)}if(this._eventsFC){this.element.unbind(this._eventsFC)}$.ui.igPopover.prototype.destroy.apply(this,arguments)}});$.extend($.ui.igGridFeatureChooserPopover,{version:"16.1.20161.1009"});$.ig=$.ig||{};$.ig.GridFeatureChooserSections=$.ig.GridFeatureChooserSections||{click:"click",toggle:"toggle",modalDialog:"modalDialog"};$.widget("ui.igGridFeatureChooser",{css:{featureChooserDropDown:"",headerButtonIcon:"ui-iggrid-featurechooserbutton ui-icon ui-icon-gear",headerButtonIconMouseOver:"ui-iggrid-header-icon-mouseover",headerButtonIconSelected:"ui-iggrid-header-icon-selected",listClass:"ui-iggrid-featurechooser-list ui-menu ui-widget ui-widget-content ui-corner-all",listItemClass:"ui-iggrid-featurechooserddlistitemicons ui-state-default",listItemContainer:"ui-iggrid-featurechooser-li-container",listItemIconContainer:"ui-iggrid-featurechooser-li-iconcontainer",itemSecondaryIconContainer:"ui-iggrid-featurechooser-secondaryicon-container",separator:"ui-iggrid-featurechooser-separator",listItemText:"ui-iggrid-featurechooserddlistitemtext",itemSelected:"item-selected",dropDownListItemHover:"ui-iggrid-featurechooser-listitem-hover ui-state-active ui-state-hover",dropDownButtonClasses:"ui-igbutton",dropDownButtonHoverClasses:"",dropDownButtonActiveClasses:"",dropDownButtonFocusClasses:"",dropDownButtonLabelClass:"",containerDelimiter:"ui-iggrid-featurechooser-container-delimiter",containerSection:"ui-iggrid-featurechooser-container-section",itemNoIcon:"ui-iggrid-featurechooserbutton ui-icon ui-icon-close",submenu:"ui-iggrid-featurechooser-submenu ui-widget-content ui-corner-all",submenuIcon:"ui-iggrid-featurechooser-submenuicon ui-icon ui-icon-triangle-1-s"},options:{dropDownWidth:null,animationDuration:400},events:{featureChooserRendering:"featureChooserRendering",featureChooserRendered:"featureChooserRendered",featureChooserDropDownOpening:"featureChooserDropDownOpening",featureChooserDropDownOpened:"featureChooserDropDownOpened",menuToggling:"menuToggling",featureToggling:"featureToggling",featureToggled:"featureToggled"},_createWidget:function(){$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this.analyzedData={};this.data={};this._features=[];this._isFeaturesAnalyzed=false;this.isInitialized=false;this.grid=this.element.data("igGrid");this.gridId=this.element[0].id;this._analyzeGridFeaturesOptions();this._countRenderedFeatures=0;if(this._headerRenderedHandler){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}this._headerRenderedHandler=$.proxy(this._headerRendered,this);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);if(this._gridDestroyedHandler){this.grid.element.unbind("igcontroldestroyed",this._gridDestroyedHandler)}this._gridDestroyedHandler=$.proxy(this.destroy,this);this.grid.element.bind("igcontroldestroyed",this._gridDestroyedHandler);if(this._virtualHorizontalScrollHandler){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}this._virtualHorizontalScrollHandler=$.proxy(this._virtualHorizontalScroll,this);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)},_analyzeGridFeaturesOptions:function(){var i,features=this.grid.options.features,featuresLength=features.length;for(i=0;i<featuresLength;i++){this._features.push(features[i].name)}},shouldShowFeatureIcon:function(key){if(this.analyzedData[key]!==undefined&&this.analyzedData[key]!==null){return this.analyzedData[key].length<=1}return true},_setOption:function(){$.Widget.prototype._setOption.apply(this,arguments)},_id:function(name,suffix){var res=this.gridId+"_"+name;if(suffix!==undefined&&suffix!==null&&$.type(suffix)==="string"){res+="_"+suffix}return res},_isMetroIE:function(){return!$.ig.util.isIEOld&&$.ig.util.isIE&&(window.hasOwnProperty("ontouchstart")||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0)},_isTouchDevice:function(){var fcIconDisplay;if(this._isTouch===undefined){fcIconDisplay=this.grid.options.featureChooserIconDisplay;if(fcIconDisplay==="none"){this._isTouch=true}else if(fcIconDisplay==="always"){this._isTouch=false}else{this._isTouch=$.ig.util.isTouch||this._isMetroIE()}}return this._isTouch},_callFeatureMethod:function(feature,isSelected,columnKey,event){var method,returnType=true,methodType=$.type(feature.method),featureData=this.grid.element.data("igGrid"+feature.name);if(methodType==="string"){if(featureData===undefined||featureData===null){return false}method=featureData[feature.method]}else if(methodType==="function"){method=feature.method}if(method===undefined||method===null){return false}if($.type(feature.method)==="string"){returnType=featureData[feature.method](event,columnKey,isSelected,feature.methodData)}else{returnType=feature.method(event,columnKey,isSelected,feature.methodData)}return returnType},_getFeatureByKeyName:function(columnKey,featureName){var i,feature=null,columnData=this.data[columnKey],columnDataLength;if(!columnData){return feature}columnDataLength=columnData.length;for(i=0;i<columnDataLength;i++){if(columnData[i].name===featureName){feature=columnData[i];break}}return feature},_clickFeature:function(event){var i,j,$target=$(event.target).data("data")!==undefined?$(event.target):$(event.currentTarget),d=$target.data("data"),self=this,isSelected=null,type=d.type,columnKey=d.columnKey,featureName=d.featureName,columnData=this.data[columnKey],columnDataLength=columnData.length,feature=null;feature=this._getFeatureByKeyName(columnKey,featureName);if(feature===null||feature===undefined){return}if(type==="toggle"){isSelected=!feature.isSelected}if(this._trigger(this.events.featureToggling,null,{target:$target,columnKey:columnKey,isToSelect:isSelected,featureName:"igGrid"+feature.name})===false){return}if(this._callFeatureMethod(feature,isSelected,columnKey,event)===false){return}if(type==="toggle"){feature.isSelected=isSelected;self._setSelectedItem(columnKey,isSelected,$("#"+self._id("featurechooser_dd_li_"+columnKey,featureName)));if(feature.updateOnClickAll===true){$.each(self.data,function(index,value){if(index!==columnKey){for(j=0;j<value.length;j++){if(value[j].name===featureName){break}}if(j===value.length){return true}columnData=self.data[index];if(columnData===null||columnData===undefined){return true}columnDataLength=columnData.length;for(i=0;i<columnDataLength;i++){if(columnData[i].name===featureName){columnData[i].isSelected=isSelected;break}}self._setSelectedItem(index,isSelected,$("#"+self._id("featurechooser_dd_li_"+index,value[j].name)))}})}}},_setListItemText:function(columnKey,featureName,text){$("#"+this._id("featurechooser_dd_li_"+columnKey,featureName)+" span.ui-iggrid-featurechooserddlistitemtext").text(text)},_analyzeFeatures:function(){if(this._isFeaturesAnalyzed===true){return}var i,k,cs=this.grid.options.columns,csLength=cs.length,featureName,featuresLength=this._features.length,features=this._features,newFeatures=[],columnsFeature,columnsFeatureLength,featureInstance,columnKey;for(i=0;i<featuresLength;i++){featureName=features[i];featureInstance=this.grid.element.data("igGrid"+featureName);if(featureInstance===undefined||featureInstance===null){continue}if(featureInstance.renderInFeatureChooser!==true){continue}if(featureInstance._columnMap===undefined||featureInstance._columnMap===null){continue}columnsFeature=featureInstance._columnMap();if(columnsFeature===false||columnsFeature===null||columnsFeature===undefined){continue}columnsFeatureLength=columnsFeature.length;if(columnsFeatureLength===0){for(k=0;k<csLength;k++){columnKey=cs[k].key;if(this.analyzedData[columnKey]===undefined||this.analyzedData[columnKey]===null){this.analyzedData[columnKey]=[]}if(this._isFeatureExistByColumnKey(featureName,columnKey)===true){continue}this.analyzedData[columnKey].push({name:featureName,method:null,text:null,iconClass:null,isSelected:false,columnCell:null,isActive:false})}}else{for(k=0;k<columnsFeatureLength;k++){columnKey=columnsFeature[k].columnKey;if(this.analyzedData[columnKey]===undefined||this.analyzedData[columnKey]===null){this.analyzedData[columnKey]=[]}if(columnsFeature[k].enabled!==true||this._isFeatureExistByColumnKey(featureName,columnKey)===true){continue}this.analyzedData[columnKey].push({name:featureName,method:null,text:null,iconClass:null,isSelected:false,columnCell:null,isActive:false})}}newFeatures.push({name:featureName,instance:featureInstance})}this._features=newFeatures;this._isFeaturesAnalyzed=true},_isFeatureExistByColumnKey:function(featureName,columnKey){var aData=this.analyzedData[columnKey],ret=false;if(aData===null||aData===undefined){return true}$.each(aData,function(index,value){if(value.name===featureName){ret=true;return false}});return ret},_shouldRenderInFeatureChooser:function(columnKey){this._analyzeFeatures();if(this.analyzedData[columnKey]!==undefined&&this.analyzedData[columnKey]!==null){return this.analyzedData[columnKey].length>1}return false},_headerRendered:function(sender,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(sender.target.id!==this.grid.element[0].id){return}this._renderFCForAllColumns()},_renderFCForAllColumns:function(){var self=this;$.each(this.data,function(columnKey,elem){self._initFC(columnKey,elem)})},_touchStart:function(e,columnKey){if($(e.target).attr("data-skip-event")){return e}this.toggleDropDown(columnKey);e.preventDefault();e.stopPropagation()},_initFC:function(columnKey,elem){var self=this,thead=this.grid.container().find("thead"),$columnCell,$theadCell,buttonId,cancelFunc,$button,$headerContainer;$columnCell=$("#"+self.grid.element[0].id+"_"+columnKey);buttonId=self._id("featureChooser_headerButton",columnKey);if(!$columnCell.length){return}$columnCell.find("[data-fc-button]").remove();$("#"+buttonId).remove();cancelFunc=function(e){e.preventDefault();e.stopPropagation()};if(elem.isCancelledRendering!==false&&self._trigger(self.events.featureChooserRendering,null,{owner:self.grid,columnKey:columnKey,columnCell:$columnCell})===false){elem.isCancelledRendering=true;return}elem.isCancelledRendering=false;if(this._isTouchDevice()){$columnCell.bind({click:function(e){self._touchStart(e,columnKey)}})}else{$theadCell=thead.find("#"+self.grid.element[0].id+"_"+columnKey);this.grid._enableHeaderCellFeature($theadCell);$headerContainer=$theadCell.find(".ui-iggrid-indicatorcontainer");if($headerContainer.length===0){$headerContainer=$("<div></div>").appendTo($theadCell).addClass("ui-iggrid-indicatorcontainer")}$button=$("<span></span>").prependTo($headerContainer).addClass(self.css.headerButtonIcon);$button.wrap('<a id="'+buttonId+'" role="button" tabindex="'+self.grid.options.tabIndex+'" data-fc-button="'+columnKey+'" href="#" title="'+$.ig.Grid.locale.featureChooserTooltip+'"></a>');$button.parent().attr("th-remove-focus","").bind({keydown:function(event){var $item,$nextPrevItem,$dialog=$("#"+self._id("featureChooser_dd",columnKey));if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){$item=$dialog.find("ul li.ui-iggrid-featurechooser-listitem-hover");if($dialog.is(":visible")&&$item.length>0){if($item.find('*[role="button"]').length){event.target=$item.find('*[role="button"]:eq(0)')}else{event.target=$item[0]}self._clickFeature(event)}self.toggleDropDown(columnKey);cancelFunc(event)}else if(event.keyCode===$.ui.keyCode.DOWN||event.keyCode===$.ui.keyCode.UP){if($dialog.is(":visible")){$item=$dialog.find("ul li.ui-iggrid-featurechooser-listitem-hover");if($item.length>1){$.each($item,function(index,value){self._removeCssSelectionListItem($(value))})}$nextPrevItem=event.keyCode===$.ui.keyCode.DOWN?$item.next():$item.prev();if($nextPrevItem.attr("data-fc-separator")){$nextPrevItem=event.keyCode===$.ui.keyCode.DOWN?$nextPrevItem.next():$nextPrevItem.prev()}if($item.length===0){self._addCssSelectionListItem($dialog.find("ul li:eq(0)"))}else if($nextPrevItem.length>0&&$nextPrevItem.is("li")){self._removeCssSelectionListItem($item);self._addCssSelectionListItem($nextPrevItem)}cancelFunc(event)}}},mousedown:function(event){self.toggleDropDown(columnKey);cancelFunc(event)},mouseover:function(){if($button.hasClass(self.css.headerButtonIconSelected)===false){$button.addClass(self.css.headerButtonIconMouseOver)}},mouseout:function(){$button.removeClass(self.css.headerButtonIconMouseOver)},mouseup:cancelFunc,click:cancelFunc});$("#"+this._id("featureChooser_dd",columnKey)).remove()}self._trigger(self.events.featureChooserRendered,null,{owner:self.grid,columnKey:columnKey,columnCell:$columnCell})},_renderInFeatureChooser:function(columnKey,data){var i,columnData=this.analyzedData[columnKey],columnDataLength;if(columnData===undefined||columnData===null){return}columnDataLength=columnData.length;if(columnData.isCancelledRendering===true){return}for(i=0;i<columnDataLength;i++){if(columnData[i].name.toLowerCase()===data.name.toLowerCase()){this.analyzedData[columnKey][i]=data;break}}if(i===columnDataLength){this.analyzedData[columnKey].push(data)}if(this.data[columnKey]===null||this.data[columnKey]===undefined){this.data[columnKey]=[]}if($.type(this.data[columnKey].order)!=="number"){this.data[columnKey].order=0}for(i=0;i<this.data[columnKey].length;i++){if(this.data[columnKey][i].name===data.name&&data.name!==undefined){return}}this.data[columnKey].push(data)},_renderMenu:function(columnKey){var i,data,self=this,listItems,popoverInstance,$targetButton,$headerCell=$("#"+this.grid.id()+"_"+columnKey),dropDownId=this._id("featureChooser_dd",columnKey),$dropDown=$("#"+dropDownId),rootContainer=this.grid._rootContainer();if($dropDown.length>0){return}$dropDown=$('<div tabindex="0"></div>').attr("id",dropDownId).appendTo(rootContainer);$targetButton=$("#"+this._id("featureChooser_headerButton",columnKey)).find("span");if($targetButton.length===0){$targetButton=$headerCell}$dropDown.igGridFeatureChooserPopover({position:"auto",targetButton:$targetButton,maxWidth:this.grid.container().width(),direction:"bottom",maxHeight:null,containment:rootContainer,appendTo:rootContainer});popoverInstance=$dropDown.data("igGridFeatureChooserPopover");$dropDown.bind("iggridfeaturechooserpopovershown",function(){self._visiblePopover=dropDownId});$dropDown.bind("iggridfeaturechooserpopoverhiding",function(){if(self._activeSubmenuId){$("#"+self._activeSubmenuId).hide();self._activeSubmenuId=null}});data=this.data[columnKey];if(data){for(i=0;i<data.length;i++){this._renderDropDownItem(columnKey,data[i])}listItems=popoverInstance.container().find("li[data-fc-order]");$dropDown.igGridFeatureChooserPopover("registerElements",listItems);$targetButton.bind({keydown:function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){popoverInstance._closePopover();e.stopPropagation()}else if(e.keyCode===$.ui.keyCode.TAB&&!e.shiftKey&&popoverInstance.isShown()){popoverInstance.popover.find("li[data-fc-order]:first").focus();e.stopPropagation();e.preventDefault()}}});listItems.bind({keydown:function(e){var $elem,keyCode=e.keyCode;switch(keyCode){case $.ui.keyCode.ESCAPE:$targetButton.data("onFocus",false).focus();popoverInstance._closePopover();break;case $.ui.keyCode.TAB:$elem=$(this);if(!e.shiftKey){if($elem.is(":last-child")){$elem.closest("ul").find("li:first-child").focus();e.preventDefault()}}else{if($elem.is(":first-child")){$elem.closest("ul").find("li:last-child").focus();e.preventDefault()}}break;case $.ui.keyCode.RIGHT:$elem=$(this);$elem=$elem.nextAll("li[data-fc-order]").eq(0);if($elem.length===0){$elem=$(this).closest("ul").find("li:first-child")}$elem.focus();e.preventDefault();break;case $.ui.keyCode.LEFT:$elem=$(this);$elem=$elem.prevAll("li[data-fc-order]").eq(0);if($elem.length===0){$elem=$(this).closest("ul").find("li:last-child")}$elem.focus();e.preventDefault();break}}})}$dropDown.bind({keydown:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE&&popoverInstance.container().is(":visible")){self.toggleDropDown(columnKey);popoverInstance.container().blur()}}})},_removeFeature:function(featureName,submenu){var self=this,cols=this.grid.options.columns;$.each(cols,function(index,col){self._removeDropDownItem(col.key,featureName);if(submenu){$("#"+self._id("featurechooser_submenu_"+col.key,featureName)).remove()}})},_removeDropDownItem:function(columnKey,featureName){var index=-1,data,$dropDown=$("#"+this._id("featureChooser_dd",columnKey)),$dropDownList=$("#"+this._id("featurechooser_dd_list",columnKey)),$item=$("#"+this._id("featurechooser_dd_li_"+columnKey,featureName));if($dropDown.length===0){data=this.data[columnKey];if(data){$.each(data,function(i,dataItem){if(dataItem.name===featureName){index=i;return false}});if(index>-1){data.splice(index,1);if(data.length===0){this._removeFC(columnKey)}}}}else if($item.length>0){$item.remove();if($dropDownList.find("li:not([data-fc-separator])").length===0){this._removeFC(columnKey)}else{this._removeSeparatorItem(columnKey)}}},_removeFC:function(columnKey){var $dropDown=$("#"+this._id("featureChooser_dd",columnKey));$dropDown.igGridFeatureChooserPopover("destroy");$dropDown.remove();$("#"+this._id("featureChooser_headerButton",columnKey)).remove()},_removeSeparatorItem:function(columnKey){var listLiSeparator=$("#"+this._id("featurechooser_dd_list",columnKey)).find("[data-fc-separator]");listLiSeparator.each(function(){var $li=$(this),$prevLi=$li.prev(),$nextLi=$li.next();if($prevLi.length===0||$prevLi.attr("data-fc-separator")!==undefined||$nextLi.length===0||$nextLi.attr("data-fc-separator")!==undefined){$li.remove();return false}})},_renderDropDownItem:function(columnKey,data){var dropDownId=this._id("featureChooser_dd",columnKey),$dropDownContainer=$("#"+dropDownId).igGridFeatureChooserPopover("container"),$li,listId,$list,funcClickOnFeature,$iconContainer,$span,cssClassIcon="",self=this,isSelected=data.isSelected,featureName=data.name,innerData,liId=this._id("featurechooser_dd_li_"+columnKey,featureName),groupName=data.groupName,groupOrder=data.groupOrder,listItemsGroup,insertElementObj,labelText;if($("#"+liId).length>0){return}if(groupName===undefined||groupName===null){groupName="click"}listId=this._id("featurechooser_dd_list",columnKey);$list=$("#"+listId);if($list.length===0){$dropDownContainer.html("");$list=$("<ul></ul>").attr("id",listId).addClass(this.css.listClass).appendTo($dropDownContainer)}if(isSelected===undefined||isSelected===null){isSelected=false}$li=$('<li tabindex="0"></li>').addClass(this.css.listItemClass).attr("id",liId).attr("data-fc-order",data.order);if(groupName!==undefined&&groupName!==null){$li.attr("data-fc-groupname",groupName)}if(groupOrder!==undefined&&groupOrder!==null){$li.attr("data-fc-grouporder",groupOrder)}innerData={columnKey:columnKey,featureName:featureName,updateOnClickAll:data.updateOnClickAll,iconClass:data.iconClass,iconClassOff:data.iconClassOff,groupName:groupName,groupOrder:groupOrder,type:data.type,textHide:data.textHide,state:data.state,text:data.text};$li.data("data",innerData);funcClickOnFeature=function(event){var submenuId=self._id("featurechooser_submenu_"+columnKey,featureName),e=event,$submenu,keyCode=event.keyCode;if(data.type!=="dropdown"){if(!keyCode||keyCode===$.ui.keyCode.ENTER||keyCode===$.ui.keyCode.SPACE){if(event.target===undefined){e.target=event.srcElement}self._clickFeature(event);self.hideDropDown(columnKey)}}else{if(self._visiblePopover){if(!keyCode){self._toggleSubmenu(columnKey,featureName,data);setTimeout(function(){$("#"+self._visiblePopover).data("igGridFeatureChooserPopover")._setFCElementFocus(true)},5)}else{if(keyCode===$.ui.keyCode.DOWN){$submenu=$("#"+submenuId);if($submenu.is(":visible")){$submenu.find("[data-fc-item]:first").focus()}else{self._toggleSubmenu(columnKey,featureName,data)}}else if(keyCode===$.ui.keyCode.ENTER||keyCode===$.ui.keyCode.SPACE){self._toggleSubmenu(columnKey,featureName,data)}else if(keyCode===$.ui.keyCode.UP){$submenu=$("#"+submenuId);if($submenu.is(":visible")){self._toggleSubmenu(columnKey,featureName,data)}}}}if(event.preventDefault){event.preventDefault()}}};$li.bind({keydown:funcClickOnFeature,mousedown:funcClickOnFeature});if(data.iconClass!==null&&data.iconClass!==undefined&&data.iconClass!==""){if(data.iconClassOff&&data.isSelected===false){cssClassIcon=data.iconClassOff}else{cssClassIcon=data.iconClass}}$iconContainer=$("<div></div>").addClass(this.css.listItemContainer).appendTo($li);$span=$("<span></span>").addClass(this.css.listItemIconContainer).appendTo($iconContainer);if(cssClassIcon!==""){$span.addClass(cssClassIcon)}else{$span.addClass(this.css.itemNoIcon)}labelText=data.text;$li.attr("title",labelText);$("<span></span>").text(data.text).addClass(this.css.listItemText).appendTo($iconContainer);listItemsGroup=$("#"+listId+" li[data-fc-groupName = "+groupName+"]");if(listItemsGroup.length===0){listItemsGroup=$("#"+listId+" li[data-fc-groupName]");insertElementObj=this._getInsertElement(listItemsGroup,groupOrder,"data-fc-grouporder");if(insertElementObj.item!==null){$list=listItemsGroup}this._insertElement(insertElementObj,$list,$li,groupName)}else{insertElementObj=this._getInsertElement(listItemsGroup,data.order,"data-fc-order");this._insertElement(insertElementObj,listItemsGroup,$li,groupName)}if(data.type==="toggle"){this._setSelectedItem(columnKey,data.isSelected,$li)}if(data.type==="dropdown"){$('<span class="'+this.css.submenuIcon+'" data-submenu-arrow="true"></span>').appendTo($iconContainer);self._renderSubmenu(columnKey,featureName,data)}},_renderSubmenu:function(columnKey,featureName,data){var submenuId=this._id("featurechooser_submenu_"+columnKey,featureName),$submenu;if($("#"+submenuId).length>0){$("#"+submenuId).remove()}if(this._submenus===null||this._submenus===undefined){this._submenus=[]}this._submenus.push(submenuId);$submenu=$('<div id="'+submenuId+'" style="position:absolute" class="'+this.css.submenu+'"></div>').appendTo(this.grid._rootContainer());$submenu.data("buttonId",this._id("featurechooser_dd_li_"+columnKey,featureName));$submenu.hide();if(data.methodRenderSubmenu){data.methodRenderSubmenu(columnKey,$submenu);$("#"+this._id("featureChooser_dd",columnKey)).igGridFeatureChooserPopover("registerElements",$submenu.find("[data-fc-item]"))}},_toggleSubmenu:function(columnKey,featureName,data){var rOffset,$li=$("#"+this._id("featurechooser_dd_li_"+columnKey,featureName)),$innerDiv=$li.find("div:nth-child(1)"),targetWidth=$innerDiv.outerWidth(),targetLeft=$innerDiv.offset().left,submenuId=this._id("featurechooser_submenu_"+columnKey,featureName),$submenu=$("#"+submenuId),left=targetLeft-Math.abs($submenu.outerWidth()-targetWidth)/2,top=$innerDiv.offset().top+$innerDiv.outerHeight();rOffset=$.ig.util.getRelativeOffset($submenu);$submenu.css({left:left-rOffset.left,top:top-rOffset.top});if(data.methodToggleSubmenu){data.methodToggleSubmenu(columnKey,!$submenu.is(":visible"),$submenu)}if(this._activeSubmenuId&&this._activeSubmenuId!==submenuId){$("#"+this._activeSubmenuId).hide()}this._activeSubmenuId=submenuId;$submenu.toggle("slide",{duration:150,direction:"up"})},_getSeparatorItem:function(){return $('<li data-fc-separator="1" class="'+this.css.separator+'"></li>')},_insertElement:function(insertElementObj,$list,$li,groupName){var $insertElement=insertElementObj.item,insertElementPosition=insertElementObj.position,$prevElement;if($insertElement===null){$li.appendTo($list);$prevElement=$li.prev();if($prevElement!==undefined&&$prevElement.length>0&&$prevElement.attr("data-fc-separator")!=="1"&&$prevElement.attr("data-fc-groupname")!==undefined&&$prevElement.attr("data-fc-groupname")!==groupName){this._getSeparatorItem().insertBefore($li)}}else{if(insertElementPosition==="after"){$li.insertAfter($insertElement);if($insertElement!==undefined&&$insertElement.length>0&&$insertElement.attr("data-fc-separator")!=="1"&&$insertElement.attr("data-fc-groupname")!==undefined&&$insertElement.attr("data-fc-groupname")!==groupName){this._getSeparatorItem().insertBefore($li)}}else{$li.insertBefore($insertElement);$prevElement=$li.prev();if($prevElement!==undefined&&$prevElement.length>0&&$prevElement.attr("data-fc-separator")!=="1"&&$prevElement.attr("data-fc-groupname")!==undefined&&$prevElement.attr("data-fc-groupname")!==groupName){this._getSeparatorItem().insertBefore($li)}else if($insertElement!==undefined&&$insertElement.length>0&&$insertElement.attr("data-fc-separator")!=="1"&&$insertElement.attr("data-fc-groupname")!==undefined&&$insertElement.attr("data-fc-groupname")!==groupName){this._getSeparatorItem().insertAfter($li)}}}},_getInsertElement:function(listItems,targetOrder,attr){var $item=null,itemOrder,at,i;for(i=0;i<listItems.length;i++){$item=$(listItems[i]);at=$item.attr(attr);if(at===undefined){continue}itemOrder=parseInt(at,10);if(itemOrder>targetOrder){return{item:$item,position:"before"}}}return{item:$item,position:"after"}},_setSelectedState:function(featureName,columnKey,isSelected,executeCallback){var data=this.data[columnKey],$listItem,self=this;if(data===undefined||data===null){return false}$.each(data,function(index,value){if(value.name.toLowerCase()===featureName.toLowerCase()){$listItem=$("#"+self._id("featurechooser_dd_li_"+columnKey,value.name));self._setSelectedItem(columnKey,isSelected,$listItem);self.data[columnKey][index].isSelected=!isSelected;if(executeCallback===true){self._callFeatureMethod(value,isSelected,columnKey,null)}value.isSelected=isSelected;return false}})},_setSelectedItem:function(columnKey,isSelected,$listItem){if($listItem===null||$listItem===undefined||$listItem.length===0){return}var innerData=$listItem.data("data"),textShow,textHide,labelText,$label=null;if(innerData!==undefined&&innerData!==null){textShow=innerData.text;textHide=innerData.textHide;$label=$listItem.find("span.ui-iggrid-featurechooserddlistitemtext")}$listItem.attr("data-fc-selected",isSelected);if(isSelected===true){$listItem.addClass(this.css.itemSelected);labelText=textShow;if($label!==null&&textShow!==null&&textShow!==undefined){$label.text(labelText)}if(innerData.iconClassOff){$listItem.find("span.ui-iggrid-featurechooser-li-iconcontainer").removeClass(innerData.iconClassOff).addClass(innerData.iconClass)}}else{$listItem.removeClass(this.css.itemSelected);labelText=textHide;if($label!==null&&textHide!==null&&textHide!==undefined){$label.text(labelText)}if(innerData.iconClassOff){$listItem.find("span.ui-iggrid-featurechooser-li-iconcontainer").removeClass(innerData.iconClass).addClass(innerData.iconClassOff)}}$listItem.attr("title",labelText)},_toggleSelectedItems:function(featureName,selected){var i,$li,columnKey,cols=this.grid.options.columns,colsLength=cols.length,isSelected,feature;if(selected!==undefined){isSelected=selected}for(i=0;i<colsLength;i++){columnKey=cols[i].key;if($("#"+this._id("featureChooser_dd",columnKey)).length===0){feature=this._getFeatureByKeyName(columnKey,featureName);if(feature===null||feature===undefined){continue}if(isSelected===undefined){isSelected=feature.isSelected}}else{$li=$("#"+this._id("featurechooser_dd_li_"+columnKey,featureName));if($li.data("data")===null||$li.data("data")===undefined){continue}if(selected===undefined){isSelected=$li.attr("data-fc-selected")==="true"}}this._setSelectedState(featureName,columnKey,!isSelected)}},showDropDown:function(columnKey){var $targetButton,dropDownId=this._id("featureChooser_dd",columnKey),$dropDown=this.getDropDownByColumnKey(columnKey),fcp;this.grid._focusedElement=$("#"+this._id("featureChooser_headerButton",columnKey)).find("span");$targetButton=$("#"+this._id("featureChooser_headerButton",columnKey)).find("span");if($targetButton.length===0){$targetButton=$("#"+this.grid.id()+"_"+columnKey)}if(this._visiblePopover&&dropDownId!==this._visiblePopover){fcp=$("#"+this._visiblePopover).data("igGridFeatureChooserPopover");if(fcp){fcp._closePopover()}setTimeout(function(){$dropDown.igGridFeatureChooserPopover("show",$targetButton)},100)}else{$dropDown.igGridFeatureChooserPopover("show",$targetButton)}},hideDropDown:function(columnKey){var $dropDown=this.getDropDownByColumnKey(columnKey);$dropDown.igGridFeatureChooserPopover("hide");this.grid._focusedElement=null},getDropDownByColumnKey:function(columnKey){var dropDownId=this._id("featureChooser_dd",columnKey),$dropDown=$("#"+dropDownId);if($dropDown.length===0){this._renderMenu(columnKey);$dropDown=$("#"+dropDownId)}return $dropDown},toggleDropDown:function(columnKey){var $dropDown=this.getDropDownByColumnKey(columnKey),isVisible=$dropDown.igGridFeatureChooserPopover("isShown");this._trigger(this.events.menuToggling,null,{isVisible:isVisible,columnKey:columnKey,owner:this});if(isVisible){this.hideDropDown(columnKey)}else{this.showDropDown(columnKey)}},_mouseOverDropDownItem:function(event){this._addCssSelectionListItem($(event.currentTarget))},_mouseOutDropDownItem:function(event){this._removeCssSelectionListItem($(event.currentTarget))},_addCssSelectionListItem:function($listItem){$listItem.addClass(this.css.dropDownListItemHover)},_removeCssSelectionListItem:function($listItem){$listItem.removeClass(this.css.dropDownListItemHover)},_virtualHorizontalScroll:function(){this._renderFCForAllColumns()},destroy:function(e,args){var i,l,self=this,sbm=this._submenus,grid;if(args&&args.owner){grid=args.owner;if(grid&&grid.id()!==this.gridId){return}}this.data=null;$.each(this.grid.options.columns,function(ind,column){var $dd=$("#"+self._id("featureChooser_dd",column.key));if($dd.length>0){$dd.igGridFeatureChooserPopover("destroy");$dd.remove()
}});if(sbm){l=sbm.length;for(i=0;i<l;i++){$("#"+sbm[i]).remove()}}if(this._headerRenderedHandler){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}if(this._gridDestroyedHandler){this.grid.element.unbind("igcontroldestroyed",this._gridDestroyedHandler)}if(this._gridRenderedHandler){this.grid.element.unbind("iggridrendered",this._gridRenderedHandler)}if(this._virtualHorizontalScrollHandler){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}delete this._gridRenderedHandler;delete this._headerRenderedHandler;delete this._gridDestroyedHandler;delete this._virtualHorizontalScrollHandler;$.Widget.prototype.destroy.apply(this,arguments);return this}});$.extend($.ui.igGridFeatureChooser,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Sorting 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.9.1.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 *	jquery.ui.resizable.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 *	infragistics.ui.editors.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.templating.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridFiltering",{renderInFeatureChooser:true,options:{caseSensitive:false,filterSummaryAlwaysVisible:true,renderFC:true,filterSummaryTemplate:$.ig.GridFiltering.locale.filterSummaryTemplate,filterDropDownAnimations:"linear",filterDropDownAnimationDuration:500,filterDropDownWidth:0,filterDropDownHeight:0,filterExprUrlKey:null,filterDropDownItemIcons:true,columnSettings:[{columnKey:null,columnIndex:null,allowFiltering:true,condition:null,conditionList:[],defaultExpressions:[],customConditions:null}],type:null,filterDelay:500,mode:null,advancedModeEditorsVisible:false,advancedModeHeaderButtonLocation:"left",filterDialogWidth:430,filterDialogHeight:"",filterDialogFilterDropDownDefaultWidth:80,filterDialogExprInputDefaultWidth:130,filterDialogColumnDropDownDefaultWidth:null,renderFilterButton:true,filterButtonLocation:"left",nullTexts:{startsWith:$.ig.GridFiltering.locale.startsWithNullText,endsWith:$.ig.GridFiltering.locale.endsWithNullText,contains:$.ig.GridFiltering.locale.containsNullText,doesNotContain:$.ig.GridFiltering.locale.doesNotContainNullText,equals:$.ig.GridFiltering.locale.equalsNullText,doesNotEqual:$.ig.GridFiltering.locale.doesNotEqualNullText,greaterThan:$.ig.GridFiltering.locale.greaterThanNullText,lessThan:$.ig.GridFiltering.locale.lessThanNullText,greaterThanOrEqualTo:$.ig.GridFiltering.locale.greaterThanOrEqualToNullText,lessThanOrEqualTo:$.ig.GridFiltering.locale.lessThanOrEqualToNullText,on:$.ig.GridFiltering.locale.onNullText,notOn:$.ig.GridFiltering.locale.notOnNullText,after:$.ig.GridFiltering.locale.afterNullText,before:$.ig.GridFiltering.locale.beforeNullText,thisMonth:$.ig.GridFiltering.locale.thisMonthLabel,lastMonth:$.ig.GridFiltering.locale.lastMonthLabel,nextMonth:$.ig.GridFiltering.locale.nextMonthLabel,thisYear:$.ig.GridFiltering.locale.thisYearLabel,lastYear:$.ig.GridFiltering.locale.lastYearLabel,nextYear:$.ig.GridFiltering.locale.nextYearLabel,empty:$.ig.GridFiltering.locale.emptyNullText,notEmpty:$.ig.GridFiltering.locale.notEmptyNullText,"null":$.ig.GridFiltering.locale.nullNullText,notNull:$.ig.GridFiltering.locale.notNullNullText},labels:{noFilter:$.ig.GridFiltering.locale.noFilterLabel,clear:$.ig.GridFiltering.locale.clearLabel,startsWith:$.ig.GridFiltering.locale.startsWithLabel,endsWith:$.ig.GridFiltering.locale.endsWithLabel,contains:$.ig.GridFiltering.locale.containsLabel,doesNotContain:$.ig.GridFiltering.locale.doesNotContainLabel,equals:$.ig.GridFiltering.locale.equalsLabel,doesNotEqual:$.ig.GridFiltering.locale.doesNotEqualLabel,greaterThan:$.ig.GridFiltering.locale.greaterThanLabel,lessThan:$.ig.GridFiltering.locale.lessThanLabel,greaterThanOrEqualTo:$.ig.GridFiltering.locale.greaterThanOrEqualToLabel,lessThanOrEqualTo:$.ig.GridFiltering.locale.lessThanOrEqualToLabel,trueLabel:$.ig.GridFiltering.locale.trueLabel,falseLabel:$.ig.GridFiltering.locale.falseLabel,after:$.ig.GridFiltering.locale.afterLabel,before:$.ig.GridFiltering.locale.beforeLabel,today:$.ig.GridFiltering.locale.todayLabel,yesterday:$.ig.GridFiltering.locale.yesterdayLabel,thisMonth:$.ig.GridFiltering.locale.thisMonthLabel,lastMonth:$.ig.GridFiltering.locale.lastMonthLabel,nextMonth:$.ig.GridFiltering.locale.nextMonthLabel,thisYear:$.ig.GridFiltering.locale.thisYearLabel,lastYear:$.ig.GridFiltering.locale.lastYearLabel,nextYear:$.ig.GridFiltering.locale.nextYearLabel,on:$.ig.GridFiltering.locale.onLabel,notOn:$.ig.GridFiltering.locale.notOnLabel,advancedButtonLabel:$.ig.GridFiltering.locale.advancedButtonLabel,filterDialogCaptionLabel:$.ig.GridFiltering.locale.filterDialogCaptionLabel,filterDialogConditionLabel1:$.ig.GridFiltering.locale.filterDialogConditionLabel1,filterDialogConditionLabel2:$.ig.GridFiltering.locale.filterDialogConditionLabel2,filterDialogOkLabel:$.ig.GridFiltering.locale.filterDialogOkLabel,filterDialogCancelLabel:$.ig.GridFiltering.locale.filterDialogCancelLabel,filterDialogAnyLabel:$.ig.GridFiltering.locale.filterDialogAnyLabel,filterDialogAllLabel:$.ig.GridFiltering.locale.filterDialogAllLabel,filterDialogAddLabel:$.ig.GridFiltering.locale.filterDialogAddLabel,filterDialogErrorLabel:$.ig.GridFiltering.locale.filterDialogErrorLabel,filterSummaryTitleLabel:$.ig.GridFiltering.locale.filterSummaryTitleLabel,filterDialogClearAllLabel:$.ig.GridFiltering.locale.filterDialogClearAllLabel,empty:$.ig.GridFiltering.locale.emptyNullText,notEmpty:$.ig.GridFiltering.locale.notEmptyNullText,nullLabel:$.ig.GridFiltering.locale.nullNullText,notNull:$.ig.GridFiltering.locale.notNullNullText,"true":$.ig.GridFiltering.locale.trueLabel,"false":$.ig.GridFiltering.locale.falseLabel},tooltipTemplate:$.ig.GridFiltering.locale.tooltipTemplate,filterDialogAddConditionTemplate:null,filterDialogAddConditionDropDownTemplate:null,filterDialogFilterTemplate:null,filterDialogFilterConditionTemplate:null,filterDialogAddButtonWidth:100,filterDialogOkCancelButtonWidth:120,filterDialogMaxFilterCount:5,filterDialogContainment:"owner",showEmptyConditions:false,showNullConditions:false,featureChooserText:$.ig.GridFiltering.locale.featureChooserText,featureChooserTextHide:$.ig.GridFiltering.locale.featureChooserTextHide,featureChooserTextAdvancedFilter:$.ig.GridFiltering.locale.featureChooserTextAdvancedFilter,persist:true,inherit:false},css:{filterRow:"ui-iggrid-filterrow ui-widget",filterCell:"ui-iggrid-filtercell",filterCellEditor:"ui-iggrid-filtereditor",filterDropDownList:"ui-menu ui-widget ui-widget-content ui-iggrid-filterddlist ui-corner-all",filterDropDown:"ui-iggrid-filterdd",filterDropDownListItemTextContainer:"ui-iggrid-filterddlistitemcontainer",filterDropDownListItem:"ui-iggrid-filterddlistitem",filterDropDownListItemAdvanced:"ui-iggrid-filterddlistitemadvanced",filterDropDownListItemWithIcons:"ui-iggrid-filterddlistitemicons ui-state-default",filterDropDownListItemClear:"ui-iggrid-filterddlistitemclear",filterDropDownListItemHover:"ui-iggrid-filterddlistitemhover ui-state-hover",filterDropDownListItemActive:"ui-iggrid-filterddlistitemactive ui-state-active",filterDateCell:"",filterTextCell:"",filterNumberCell:"",filterBoolCell:"",filterButton:"ui-iggrid-filterbutton ui-corner-all ui-icon ui-icon-triangle-1-s",filterButtonAdvanced:"ui-iggrid-filterbutton ui-iggrid-filterbuttonadvanced ui-icon ui-icon-search",filterButtonAdvancedRight:"ui-iggrid-filterbuttonright ui-iggrid-filterbuttonadvanced ui-icon ui-icon-search",filterButtonHover:"ui-iggrid-filterbuttonhover ui-state-hover",filterButtonActive:"ui-iggrid-filterbuttonactive ui-state-active",filterButtonFocus:"ui-iggrid-filterbuttonfocus ui-state-focus",filterButtonDisabled:"ui-iggrid-filterbuttondisabled ui-state-disabled",filterButtonDate:"ui-iggrid-filterbuttondate",filterButtonString:"ui-iggrid-filterbuttonstring",filterButtonNumber:"ui-iggrid-filterbuttonnumber",filterButtonBoolean:"ui-iggrid-filterbuttonbool",filterButtonAdvancedHover:"ui-iggrid-filterbuttonadvancedhover ui-state-hover",filterButtonAdvancedActive:"ui-iggrid-filterbuttonadvancedactive ui-state-active",filterButtonAdvancedFocus:"ui-iggrid-filterbuttonadvancedfocus ui-state-focus",filterButtonAdvancedDisabled:"ui-iggrid-filterbuttonadvanceddisabled ui-state-disabled",filterItemIcon:"ui-iggrid-filtericon",filterItemIconContainer:"ui-iggrid-filtericoncontainer",filterItemIconStartsWith:"ui-iggrid-filtericonstartswith",filterItemIconEndsWith:"ui-iggrid-filtericonendswith",filterItemIconContains:"ui-iggrid-filtericoncontains",filterItemIconEquals:"ui-iggrid-filtericonequals",filterItemIconDoesNotEqual:"ui-iggrid-filtericondoesnotequal",filterItemIconDoesNotContain:"ui-iggrid-filtericondoesnotcontain",filterItemIconGreaterThan:"ui-iggrid-filtericongreaterthan",filterItemIconLessThan:"ui-iggrid-filtericonlessthan",filterItemIconGreaterThanOrEqualTo:"ui-iggrid-filtericongreaterthanorequalto",filterItemIconLessThanOrEqualTo:"ui-iggrid-filtericonlessthanorequalto",filterItemIconTrue:"ui-iggrid-filtericontrue",filterItemIconFalse:"ui-iggrid-filtericonfalse",filterItemIconAfter:"ui-iggrid-filtericonafter",filterItemIconBefore:"ui-iggrid-filtericonbefore",filterItemIconToday:"ui-iggrid-filtericontoday",filterItemIconYesterday:"ui-iggrid-filtericonyesterday",filterItemIconThisMonth:"ui-iggrid-filtericonthismonth",filterItemIconLastMonth:"ui-iggrid-filtericonlastmonth",filterItemIconNextMonth:"ui-iggrid-filtericonnextmonth",filterItemIconThisYear:"ui-iggrid-filtericonthisyear",filterItemIconLastYear:"ui-iggrid-filtericonlastyear",filterItemIconNextYear:"ui-iggrid-filtericonnextyear",filterItemIconOn:"ui-iggrid-filtericonon",filterItemIconNotOn:"ui-iggrid-filtericonnoton",filterItemIconClear:"ui-iggrid-filtericonclear",blockArea:"ui-widget-overlay ui-iggrid-blockarea",filterDialog:"ui-dialog ui-draggable ui-resizable ui-iggrid-dialog ui-widget ui-widget-content ui-corner-all",filterDialogHeaderCaption:"ui-dialog-titlebar ui-iggrid-filterdialogcaption ui-widget-header ui-corner-all ui-helper-reset ui-helper-clearfix",filterDialogHeaderCaptionTitle:"ui-dialog-title",filterDialogAddCondition:"ui-iggrid-filterdialogaddcondition",filterDialogAddConditionDropDown:"ui-iggrid-filterdialogaddconditionlist",filterDialogAddButton:"ui-iggrid-filterdialogaddbuttoncontainer ui-helper-reset",filterDialogOkCancelButton:"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix ui-iggrid-filterdialogokcancelbuttoncontainer",filterDialogFiltersTable:"ui-iggrid-filtertable ui-helper-reset",filterDialogFilterRemoveButton:"ui-icon ui-icon-closethick",filterDialogClearAllButton:"ui-iggrid-filterdialogclearall",featureChooserModalDialogIcon:"ui-icon ui-iggrid-icon-advanced-filter"},events:{dataFiltering:"dataFiltering",dataFiltered:"dataFiltered",dropDownOpening:"dropDownOpening",dropDownOpened:"dropDownOpened",dropDownClosing:"dropDownClosing",dropDownClosed:"dropDownClosed",filterDialogOpening:"filterDialogOpening",filterDialogOpened:"filterDialogOpened",filterDialogMoving:"filterDialogMoving",filterDialogFilterAdding:"filterDialogFilterAdding",filterDialogFilterAdded:"filterDialogFilterAdded",filterDialogClosing:"filterDialogClosing",filterDialogClosed:"filterDialogClosed",filterDialogContentsRendering:"filterDialogContentsRendering",filterDialogContentsRendered:"filterDialogContentsRendered",filterDialogFiltering:"filterDialogFiltering"},_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){this._editors=[];if(!$.fn.fadeToggle){$.fn.fadeToggle=$.fn.toggle}this._fcData={};this._isInitFC=false;this._dsTransformedCustomConditions=null;if(this.options.filterDropDownAnimations==="none"){this.options.filterDropDownAnimationDuration=1;this.options.filterDropDownAnimations="linear"}},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);if(key==="mode"||key==="renderFilterButton"||key==="filterButtonLocation"||key==="type"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}if(key==="filterDropDownWidth"){this.grid.container().find("div ul").parent().css("width",value)}else if(key==="filterDropDownHeight"){this.grid.container().find("div ul").parent().css("height",value)}else if(key==="filterDialogWidth"){$("#"+this.grid.container().attr("id")+"_dialog").css("width",value)}else if(key==="filterDialogHeight"){$("#"+this.grid.container().attr("id")+"_dialog").css("height",value)}else if(key==="columnSettings"){this._initDefaultSettings()}},destroy:function(){var i,fc,cols=this.grid.options.columns,gridId=this.grid.id(),block=$("#"+gridId+"_container_block"),dialog=$("#"+gridId+"_container_dialog"),gridContainer=this.grid.container();$("#"+gridContainer[0].id+" .ui-iggrid-filterrow").remove();$("#"+gridContainer[0].id+" .ui-iggrid-filterdd").remove();for(i=0;i<cols.length;i++){$("#"+gridId+"_dd_"+cols[i].key).remove();$("#"+gridId+"_dd_"+cols[i].key+"_button").remove()}block.remove();dialog.remove();gridContainer.unbind("keydown.focusChecker");this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler);this.grid.element.unbind("iggridresizingcolumnresized",this._columnResizedHandler);this.grid.element.unbind("iggridheaderextracellsmodified",this._headerInitHandler);this.grid.element.unbind("iggrid_columnsmoved",this._columnsAlteredHandler);this.grid.element.unbind("iggriduidirty",this._onUIDirtyHandler);delete this._headerCellRenderedHandler;delete this._headerRenderedHandler;delete this._virtualHorizontalScrollHandler;delete this._columnResizedHandler;delete this._headerInitHandler;delete this._onUIDirtyHandler;delete this._columnsAlteredHandler;this._editors=null;this._fcData=null;this.options.columnSettings=null;this.options=null;if(this._loadingIndicator){delete this._loadingIndicator}if(this._filterInternal){delete this._filterInternal}if(this._toggleFilterRowHandler){delete this._toggleFilterRowHandler}if(this._openFilterDialogFromFCHandler){delete this._openFilterDialogFromFCHandler}fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){fc._removeFeature("Filtering");fc._removeFeature("AdvancedFiltering")}$.Widget.prototype.destroy.call(this);return this},_initLoadingIndicator:function(){this._loadingIndicator=this.grid.container().length>0?this.grid.container().igLoading().data("igLoading"):this.grid.element.igLoading().data("igLoading").indicator()},_onUIDirty:function(e,args){if(this.options.persist&&this.options.type==="remote"){return}var i,cols=this.grid.options.columns,condition;if(args.owner===this||args.owner.element[0].id!==this.element[0].id){return}this._filterDialogClearAll();if(this._editors!==null&&this._editors!==undefined){for(i=0;i<this._editors.length;i++){if(this.options.columnSettings[i].allowFiltering!==false){this._editors[i].value(null);condition=null;if(this.options.columnSettings[i].columnKey){condition=this.options.nullTexts[this._findColumnSetting(this.options.columnSettings[i].columnKey).condition]}if(condition===null||condition===undefined){condition=this.options.nullTexts[this._getDefaultCondition(this._getColType(cols[i].key))]}this._editors[i].element.igGridFilterEditor("option","placeHolder",condition)}}}for(i=0;i<cols.length;i++){$("#"+this.grid.id()+"_dd_"+cols[i].key).find("li").removeClass("ui-iggrid-filterddlistitemactive ui-state-active")}$(".ui-iggrid-filterbutton",this.grid.container()).parent().attr("title",this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter));this.grid.dataSource.settings.filtering.expressions=[]},getFilteringMatchesCount:function(){var o=this.options,ds=this.grid.dataSource,matches;if(o.type==="local"||o.type==="remote"&&ds.hasTotalRecordsCount()===false){if(ds._filter){matches=ds._filteredData.length}else{matches=ds._data.length}}else{matches=ds.totalRecordsCount()}return matches},_dataRendered:function(){var w,fCntnr,defExpr,expr,matches=0,grid=this.grid,summary=grid.container().find(".ui-iggrid-footer .ui-iggrid-results").eq(0),footer=summary.parent(),shouldInitHeights=false,isInitiallyFiltered=false,i,isFiltering=false,exprs,reInitHeights=false;if(!this._loadingIndicator){this._initLoadingIndicator()}if(this._hiddenCells&&this._hiddenCells.length>0){for(i=0;i<this._hiddenCells.length;i++){this._hiddenCells[i].show()}this._hiddenCells=undefined}if(this._defaultExpressions&&this._defaultExpressions.length>0){defExpr=this._defaultExpressions;this._defaultExpressions=[];this._updateFiltersUI(defExpr,false);isInitiallyFiltered=true;this._isFilteringRequest=true}if(this._shouldFireDataFiltered){exprs=this._getDataColumnFilteringExpressions(grid.dataSource.settings.filtering.expressions);this._shouldFireDataFiltered=false;this._trigger(this.events.dataFiltered,null,{columnKey:this._curColKey,columnIndex:this._curColIndex,owner:this,expressions:exprs})}if(!summary.is(":visible")){shouldInitHeights=true}if(this._isFilteringRequest===true){if(this.options.filterSummaryAlwaysVisible===true&&summary.length===0){footer=$("<div></div>").appendTo(grid.container()).addClass("ui-widget ui-helper-clearfix ui-corner-bottom ui-widget-header ui-iggrid-footer");if(grid.hasFixedColumns()){footer.css("clear","both");reInitHeights=$.ig.util.isChrome&&footer.height()>grid.container().height()}summary=$("<span></span>").appendTo(footer).addClass("ui-iggrid-results");if(isInitiallyFiltered&&grid.element.data("igGridPaging")){footer.attr("id",grid.element[0].id+"_pager").addClass("ui-iggrid-pager");summary.attr("id",grid.element[0].id+"_pager_label").addClass("ui-iggrid-pagerrecordslabel")}shouldInitHeights=true}matches=this.getFilteringMatchesCount();if(!summary.parent().is(":visible")){summary.parent().show();shouldInitHeights=true}summary.text(this.options.filterSummaryTemplate.replace("${matches}",matches)).attr("title",this.options.labels.filterSummaryTitleLabel);summary.show();isFiltering=true;this._isFilteringRequest=false}else if(this._isFilteringRequest===false){expr=grid.dataSource.settings.filtering.expressions||[];if(summary.data("hideflag")!==false&&expr.length===0){isFiltering=true;summary.hide();if(summary.parent().children().length===1){summary.parent().hide()}}else{summary.data("hideflag",true)}shouldInitHeights=true}this._loadingIndicator.hide();if(shouldInitHeights){if(grid.hasFixedColumns()){fCntnr=grid.fixedContainer()[0];if(fCntnr){w=fCntnr.style.width;fCntnr.style.width=""}}grid._initializeHeights();if(w){fCntnr.style.width=w}if(reInitHeights){grid._initializeHeights()}if(isFiltering&&(grid.options.virtualization||grid.options.rowVirtualization)){grid._updateVirtualScrollContainer();grid._virtualDom=null;grid._renderVirtualRecords()}}this._setEditorsWidth()},_initFC:function(){var columnKey,i,fc=this.grid.element.data("igGridFeatureChooser"),o=this.options,cs=this.options.columnSettings,showAdvancedButton=o.mode==="advanced"&&o.advancedModeEditorsVisible===true,isAdvanced=o.mode!=="simple"&&o.advancedModeEditorsVisible===false;this._isInitFC=true;if(o.renderFC===false){return}if(fc!==null&&fc!==undefined&&this.renderInFeatureChooser){if(this._toggleFilterRowHandler===null||this._toggleFilterRowHandler===undefined){this._toggleFilterRowHandler=$.proxy(this.toggleFilterRowByFeatureChooser,this)}if(this._openFilterDialogFromFCHandler===null||this._openFilterDialogFromFCHandler===undefined){this._openFilterDialogFromFCHandler=$.proxy(this._openFilterDialogFromFC,this)}for(i=0;i<cs.length;i++){columnKey=cs[i].columnKey;if(columnKey&&cs[i].allowFiltering===true&&fc._shouldRenderInFeatureChooser(columnKey)===true){this._filterRowShown=true;this._fcData[columnKey]=true;if(isAdvanced||showAdvancedButton){fc._renderInFeatureChooser(columnKey,{name:"AdvancedFiltering",text:o.featureChooserTextAdvancedFilter,iconClass:this.css.featureChooserModalDialogIcon,isSelected:true,method:this._openFilterDialogFromFCHandler,updateOnClickAll:true,groupName:"modaldialog",groupOrder:3,order:3})}if(!isAdvanced){fc._renderInFeatureChooser(columnKey,{name:"Filtering",text:o.featureChooserText,textHide:o.featureChooserTextHide,iconClass:this.css.featureChooserModalDialogIcon,isSelected:true,method:this._toggleFilterRowHandler,updateOnClickAll:true,groupName:"toggle",groupOrder:1,order:2,type:"toggle",state:"hide"})}}}}},_columnResized:function(){if(this._filterRowShown!==false){this._setEditorsWidth()}},_setEditorsWidth:function(){if(this.options.mode!=="simple"&&this.options.advancedModeEditorsVisible!==true){return}var cs=this.options.columnSettings,cols=this.grid._visibleColumns(),cells=this.grid.headersTable().find("thead tr[data-role=filterrow]").first().find("td").not("[data-skip=true]"),cellWidth,i,j,skipColumn;for(i=0;i<cols.length;i++){for(j=0;j<cs.length;j++){if(cs[j].columnKey===cols[i].key&&cs[j].allowFiltering===false){skipColumn=true;break}}if(skipColumn){skipColumn=false;continue}if(!$.ig.util.isOpera&&(this.grid.options.height&&this.grid.options.fixedHeaders===true||$.ig.util.isWebKit)){cellWidth=cells.eq(i).innerWidth()}else{cellWidth=cells.eq(i).width()}cellWidth-=cells.eq(i).data("buttonWidth");cells.eq(i).children("span[data-filter-editor]").first().igGridFilterEditor("option","width",cellWidth)}},_headerRendered:function(sender){var thead,filterrow,i=0,cell,w,button,cols=this.grid.options.columns,thCell,id,j,cs=this.options.columnSettings,skipColumn=false,buttonCss,showAdvancedInHeader=false,indicatorContainer,cancelFunc,ci,buttonWidth,isMRL=!!this.grid._rlp,isSimpleMode=this.options.mode==="simple"||this.options.advancedModeEditorsVisible===true,isToCheck=this.grid._initialHiddenColumns&&this.grid._initialHiddenColumns.length>0;if(sender.target.id!==this.grid.element[0].id){return}thead=this.grid.container().find("thead");if(this.options.mode==="simple"||this.options.advancedModeEditorsVisible===true){filterrow=$("<tr></tr>").appendTo(thead).addClass(this.css.filterRow).attr("data-role","filterrow");this.grid._headerInit(filterrow)}else{filterrow=thead.find("tr:first")}cancelFunc=function(e){e.preventDefault();e.stopPropagation()};if(isToCheck){this._hiddenCells=[]}ci=i+filterrow.find("[data-skip=true]").length;for(i=0;i<cols.length;i++,ci++){if(isSimpleMode===true){cell=$("<td></td>").appendTo(filterrow).addClass(this.css.filterCell);if(isToCheck&&this._hiddenCells.length<this.grid._initialHiddenColumns.length){for(j=this.grid._initialHiddenColumns.length-1;j>=0;j--){if(this.grid._initialHiddenColumns[j].key===cols[i].key){cell.hide();this._hiddenCells.push(cell);break}}}cell.attr("aria-describedBy",this.grid.id()+"_"+cols[i].key)}else{if(this.grid._isMultiColumnGrid){cell=$(this.grid._headerCells[ci])}else{cell=isMRL?this.grid.container().find("#"+this.grid.id()+"_"+cols[i].key):$(filterrow[0].cells[ci])}if(cell.children().first().is("a")){cell.children().first().css("display","inline");cell.css("cursor","pointer")}cell.data("colName",cols[i].key);cell.attr("aria-describedBy",this.grid.id()+"_"+cols[i].key)}if(this.grid._isMultiColumnGrid!==true||isSimpleMode===true){if(i===cols.length-1&&this.grid.options.height&&parseInt(this.grid.options.height,10)>0){cell.css("width",parseInt(cols[i].width,10)+this.grid._scrollbarWidth())}else{cell.css("width",cols[i].width)}}for(j=0;j<cs.length;j++){if(cs[j].columnKey===cols[i].key&&cs[j].allowFiltering===false){if(this.options.advancedModeEditorsVisible===true||this.options.mode!=="advanced"){this._editors.push({})}skipColumn=true;break}}if(skipColumn){skipColumn=false;continue}thCell=thead.children().first().find("th:nth-child("+(ci+1)+")");if($.ig.util.isWebKit&&thCell.length>0){w=thCell[0].offsetWidth}else if(this.grid.options.height&&this.grid.options.fixedHeaders===true||$.ig.util.isWebKit){w=thCell.innerWidth()}else{w=thCell.width()}showAdvancedInHeader=this.options.advancedModeEditorsVisible===false&&this.options.mode==="advanced"&&this.options.renderFilterButton===true;if(this.options.renderFilterButton===true&&!showAdvancedInHeader||showAdvancedInHeader&&this._renderFCFor(cols[i].key)===false){id=this.grid.element.attr("id")+"_dd_"+cols[i].key;if(this.options.advancedModeEditorsVisible===true||this.options.mode!=="advanced"){this._renderDropDown(cols[i].dataType,id,cols[i].key)}buttonCss=this.options.mode==="advanced"?this.css.filterButtonAdvanced:this.css.filterButton;if(showAdvancedInHeader&&this.options.advancedModeHeaderButtonLocation==="right"){buttonCss=this.css.filterButtonAdvancedRight;button=$("<span></span>").appendTo(cell).addClass(buttonCss).data("colIndex",i)}else{button=$("<span></span>").prependTo(cell).addClass(buttonCss).data("colIndex",i)}if(this.options.mode==="advanced"){if(!cell.hasClass(this.grid.css.headerCellFeatureEnabledClass)){cell.addClass(this.grid.css.headerCellFeatureEnabledClass)}}if(this.options.mode==="simple"||this.options.mode==="advanced"&&this.options.advancedModeEditorsVisible===true){button.wrap('<a id="'+id+'_button" href="#" title="'+this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter)+'" ></a>')}else{button.wrap('<a id="'+id+'_button" href="#" title="'+this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter)+'" style="display:inline;"></a>')}indicatorContainer=cell.find(".ui-iggrid-indicatorcontainer");if(indicatorContainer.length===0){indicatorContainer=$("<div></div>").appendTo(cell).addClass("ui-iggrid-indicatorcontainer")}indicatorContainer.append(button.parent());w=parseInt(w,10);if(this.grid.options.height===null&&$.ig.util.isFF){buttonWidth=button.outerWidth(true)}else{buttonWidth=button.outerWidth(false)}w-=buttonWidth;cell.data("buttonWidth",buttonWidth)}if(this.options.renderFilterButton===true){if(this.options.advancedModeEditorsVisible===true||this.options.mode!=="advanced"){button.parent().bind({mousedown:$.proxy(this._toggleDropDown,this),mouseup:cancelFunc,click:cancelFunc,blur:$.proxy(this._closeDropDown,this),keydown:$.proxy(this._toggleDropDownKeyboard,this),mouseover:$.proxy(this._hoverButton,this),mouseout:$.proxy(this._unhoverButton,this),focus:$.proxy(this._activateButton,this)});if(document.documentMode===5||document.documentMode===7||$.ig.util.isIE7){button.parent().bind({focusout:$.proxy(this._closeDropDown,this)})}}else if(this._renderFCFor(cols[i].key)===false){button.parent().bind({click:$.proxy(this._openFilterDialog,this),keydown:$.proxy(this._openFilterDialogFromKeyboard,this),focus:$.proxy(this._activateButton,this),blur:$.proxy(this._deactivateButton,this)})}}if(this.options.advancedModeEditorsVisible===true||this.options.mode!=="advanced"){this._createEditor(cell,w,i,cols[i])}}if($("#"+this.grid.container().attr("id")+"_dialog").length>0){$("#"+this.grid.container().attr("id")+"_dialog").remove()}this._renderFilterDialog()},_renderFCFor:function(columnKey){return!(this._fcData===null||this._fcData===undefined||this.options.renderFC===false||this._fcData[columnKey]!==true)},_columnMap:function(){var o=this.options,i,elem,cs=o.columnSettings,csLength=cs.length,result=[];if(o.renderFC===false){return false}for(i=0;i<csLength;i++){elem={columnKey:cs[i].columnKey,enabled:true};if(cs[i].allowFiltering===false){elem.enabled=false}result.push(elem)}return result},_headerCellRendered:function(){if(this._isInitFC!==true){this._initFC()}},_openFilterDialogFromFC:function(event,columnKey){this._openFilterDialog(event,columnKey)},toggleFilterRowByFeatureChooser:function(event){var fc,$filterRow,o=this.options,isShown=this._filterRowShown,$thead=this.grid.container().find("thead"),isAdvanced=!(o.mode==="simple"||o.advancedModeEditorsVisible===true);if(isShown===null||isShown===undefined){this._filterRowShown=true;isShown=this._filterRowShown}if(isAdvanced===false||isAdvanced&&o.advancedModeEditorsVisible){$filterRow=$thead.find('tr[data-role="filterrow"]');if(isShown===true){$filterRow.hide();if(document.documentMode===7||$.ig.util.isIE7){$filterRow.children().hide()}isShown=false}else{$filterRow.show();if(document.documentMode===7||$.ig.util.isIE7){$filterRow.children().show()}this._setEditorsWidth();isShown=true}if(event===null||event===undefined){fc=this.grid.element.data("igGridFeatureChooser");if(fc){fc._toggleSelectedItems("Filtering")}}this._filterRowShown=isShown;this.grid._initializeHeights();if(this.grid.options.autofitLastColumn&&this.grid.options.height&&this.grid.hasVerticalScrollbar()!==this.grid._hasVerticalScrollbar){this.grid._adjustLastColumnWidth()}}},_getEditorVal:function(editor){if(editor._editorInput.is(":focus")&&editor.element.data("editorType")!=="igDatePicker"){editor._processValueChanging(editor._editorInput.val())}return editor.value()},_getEditorNameByColType:function(colType){if(colType==="date"||colType==="datetime"){return"igDatePicker"}if(colType==="number"||colType==="numeric"){return"igNumericEditor"}return"igTextEditor"},_createEditor:function(parent,w,colIndex,col){var $editor,colType,colKey,options,edtrType,self=this,colSetting,isReadOnly=false,cond;colType=col.dataType;colKey=col.key;if(colType==="object"){colType=this._getColType(colKey)}edtrType=this._getEditorNameByColType(colType);colSetting=this._findColumnSetting(colKey);cond=colSetting.condition;$editor=$("<span />").attr("data-filter-editor",true);if(this.options.filterButtonLocation==="left"){$editor.appendTo(parent)}else{$editor.prependTo(parent)}if(colType==="bool"||colType==="boolean"){isReadOnly=true}if(colSetting.defaultExpressions&&colSetting.defaultExpressions.length>0){$(colSetting.defaultExpressions).each(function(){if(colSetting.customConditions&&colSetting.customConditions.hasOwnProperty(this.cond)){cond=colKey+"_"+this.cond}else{cond=this.cond}isReadOnly=!self.requiresFilteringExpression(cond)})}options={width:w,suppressNotifications:true,readOnly:isReadOnly,textAlign:"left",revertIfNotValid:false,placeHolder:this.options.nullTexts[cond],allowNullValue:true,rendered:function(e,args){var edtr=args.owner,$edtrCont=edtr.editorContainer(),$indCont=parent.find(".ui-iggrid-indicatorcontainer");if(self.options.filterButtonLocation==="left"){$indCont.prependTo($edtrCont);$edtrCont.on({mousedown:function(e){if(edtr.options.readOnly){self._toggleDropDown({currentTarget:$indCont.find("a")});e.stopPropagation()}}})}else{$indCont.appendTo($edtrCont)}}};$editor.data("colIndex",colIndex).data("colKey",colKey);if(colType==="date"||colType==="datetime"){options=$.extend({},options,{enableUTCDates:this.options.type==="remote"?true:this.grid.options.enableUTCDates,valueChanged:$.proxy(this._filter,this),revertIfNotValid:false});if(col.format){options.dateInputFormat=col.format}}else{options.textChanged=$.proxy(this._filter,this)}$editor.data("editorType",edtrType);$editor.igGridFilterEditor(options);this._editors.push($editor.data(edtrType));$editor.find("input").addClass(this.css.filterCellEditor)},_fixedColumnsChanged:function(args){var i,start=args.start,$edtr,len=args.length,at=args.at;this.grid._rearrangeArray(this.options.columnSettings,start,len,at);this.grid._rearrangeArray(this._editors,start,len,at);for(i=0;i<this._editors.length;i++){$edtr=$(this._editors[i].element);$edtr.data("colIndex",i);$edtr.closest("td").find("span.ui-iggrid-filterbutton").data("colIndex",i)}},_columnsAltered:function(event,args){var i,cs,start=args.start,len=args.len,idx=args.index;for(i=0;i<this.options.columnSettings.length;i++){cs=this.options.columnSettings[i];if(this.grid._isColumnHidden(cs.columnKey)===true){start+=i<=start?1:0;len+=i>=start&&i<start+len?1:0;idx+=i<=idx?1:0}}this.grid._rearrangeArray(this.options.columnSettings,start,len,idx);this.grid._rearrangeArray(this._editors,start,len,idx);for(i=0;i<this._editors.length;i++){$(this._editors[i].element).data("colIndex",i);$(this._editors[i].element).closest("td").find("span.ui-iggrid-filterbutton").data("colIndex",i)}},_findColumnSetting:function(key){var i;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){return this.options.columnSettings[i]}}},filter:function(expressions,updateUI,addedFromAdvanced){this._loadingIndicator.show();if(expressions!==undefined&&expressions.length>0){this._isFilteringRequest=true}if(!addedFromAdvanced){this._filterDataSource(expressions,true);this._updateFiltersUI([],false)}else{this._filterDataSource(expressions)}if(updateUI===undefined||updateUI===true){this._updateFiltersUI(expressions===undefined?this._generateExpressions():expressions,addedFromAdvanced)}},_filter:function(ui,args){clearTimeout(this._timeoutId);this._ui=ui;this._args=args;if(parseInt(this.options.filterDelay,10)===0){this._filterInternal()}else{this._timeoutId=setTimeout($.proxy(this._filterInternal,this),this.options.filterDelay)}},_filterInternal:function(colIndex,colKey){var args=this._args,_colIndex,_colKey,noCancel,editor,exprs;if(args!==undefined){_colIndex=$(args.owner.element).data("colIndex");_colKey=$(args.owner.element).data("colKey")}else{_colIndex=colIndex;_colKey=colKey}exprs=this._generateExpressions(true);
noCancel=this._trigger(this.events.dataFiltering,null,{columnKey:_colKey,columnIndex:_colIndex,owner:this,newExpressions:exprs});if(noCancel){this._loadingIndicator.show();editor=this._editors?this._editors[_colIndex]:null;if(editor){editor._addedFromAdvanced=false}this._curColKey=_colKey;this._curColIndex=_colIndex;this._filterDataSource(exprs,false,true)}},_filterDataSource:function(expressions,apiCall,updateUI){var exprs,i,j,expr,col,button,groupBy,cols=this.grid.options.columns,found=false,defaultTooltip,noCancel;defaultTooltip=this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter);if(apiCall){if($.type(expressions)==="array"&&expressions.length){for(i=0;i<expressions.length;i++){expr=expressions[i];if(expr.dataType){continue}col=this.grid.columnByKey(expr.fieldName);if(col){if(col.dataType){expr.dataType=col.dataType}else{expr.dataType="string"}}}}}if(expressions!==undefined&&!updateUI){if(apiCall===true){this.grid.dataSource.settings.filtering.expressions=expressions;this._filterDialogClearAll();for(i=0;i<expressions.length;i++){this._addFilterFromDialog(null,expressions[i])}}else{this.grid.dataSource.settings.filtering.expressions=expressions}}else{if(expressions!==undefined&&updateUI){exprs=expressions}else{exprs=this._generateExpressions(true)}for(i=0;i<cols.length;i++){found=false;button=$("#"+this.grid.element[0].id+"_dd_"+cols[i].key+"_button");for(j=0;j<exprs.length;j++){if(cols[i].key===exprs[j].fieldName){found=true;if((exprs[j].expr===undefined||exprs[j].expr===null||exprs[j].expr==="")&&this.requiresFilteringExpression(exprs[j].cond)){button.attr("title",defaultTooltip)}else{button.attr("title",this.options.tooltipTemplate.replace("${condition}",this.options.labels[exprs[j].cond]))}break}}if(!found){button.attr("title",defaultTooltip)}}this.grid.dataSource.settings.filtering.expressions=exprs}if(this.options.persist){this._saveFilteringExpressions()}if(this.grid._hasUnboundColumns){this.grid._rebindUnboundColumns=true}this.grid.element.trigger("iggriduisoftdirty",{owner:this});noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(noCancel){exprs=this.grid.dataSource.settings.filtering.expressions;if(this.options.type==="remote"){this.grid.dataSource.settings.paging.pageIndex=0;this.grid._shouldResetPaging=true}else if(this.grid.container().find(".ui-iggrid-footer .ui-iggrid-results").length>0){this.grid.container().find(".ui-iggrid-footer .ui-iggrid-results").data("overrideLabel",exprs.length)}this._isFilteringRequest=true;this._preserveSorting();if(exprs.length===0){if(!apiCall){this._shouldFireDataFiltered=true}if(this.options.type==="remote"){this._isFilteringRequest=false;this.grid.dataSource.dataBind()}else{this.grid.dataSource.settings.filtering.type="local";this._isFilteringRequest=false;this.grid.dataSource.clearLocalFilter();groupBy=this.grid.element.data("igGridGroupBy");if(groupBy&&groupBy.options&&groupBy.options.groupedColumns&&groupBy.options.groupedColumns.length>0){if(this.grid.dataSource.settings.sorting.expressions.length>0&&groupBy.options.type==="local"){this.grid.dataSource.sort(this.grid.dataSource.settings.sorting.expressions)}}this.grid._renderData()}}else{if(this.options.type==="remote"){if(!apiCall){this._shouldFireDataFiltered=true}this.grid.dataSource.dataBind()}else{this.grid.dataSource.settings.filtering.type="local";this.grid.dataSource.filter(exprs);groupBy=this.grid.element.data("igGridGroupBy");if(groupBy&&groupBy.options&&groupBy.options.groupedColumns&&groupBy.options.groupedColumns.length>0){if(this.grid.dataSource.settings.sorting.expressions.length>0&&groupBy.options.type==="local"&&this.grid.dataSource._allDataSorted===false){this.grid.dataSource.sort(this.grid.dataSource.settings.sorting.expressions)}}this.grid._renderData();if(!apiCall){this._trigger(this.events.dataFiltered,null,{columnKey:this._curColKey,columnIndex:this._curColIndex,owner:this,expressions:exprs})}}}}},_filterDataSourceClear:function(colKey,colIndex){var i,exprs=this.grid.dataSource.settings.filtering.expressions,noCancel,noCancelFiltering,clearFiltering=false;for(i=0;i<exprs.length;i++){if(exprs[i].fieldName===colKey){clearFiltering=true;$.ig.removeFromArray(exprs,i);break}}if(!clearFiltering){return}this.grid.dataSource.settings.filtering.expressions=exprs;if(this.options.persist){this._saveFilteringExpressions()}if(!this._curColKey||colKey){this._curColKey=colKey;this._curColIndex=colIndex}noCancelFiltering=this._trigger(this.events.dataFiltering,null,{columnKey:this._curColKey,columnIndex:this._curColIndex,owner:this,newExpressions:exprs});if(noCancelFiltering){noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(noCancel){this.grid.dataSource.settings.paging.pageIndex=0;this._preserveSorting();this.grid._shouldResetPaging=true;this._loadingIndicator.show();if(this.options.type==="remote"){if(exprs.length>0){this._shouldFireDataFiltered=true}else{this._isFilteringRequest=false;this._shouldFireDataFiltered=true}this.grid.dataSource.dataBind()}else{this.grid.dataSource.settings.filtering.type="local";if(this.grid.container().find(".ui-iggrid-footer .ui-iggrid-results").length>0){this.grid.container().find(".ui-iggrid-footer .ui-iggrid-results").data("overrideLabel",exprs.length)}if(exprs.length>0){this.grid.dataSource.filter(exprs)}else{this._isFilteringRequest=false;this.grid.dataSource.clearLocalFilter()}this.grid._renderData();this._trigger(this.events.dataFiltered,null,{columnKey:this._curColKey,columnIndex:this._curColIndex,owner:this,expressions:exprs})}}}},_preserveSorting:function(){var hasGroupedCols=false,groupBy=this.grid.element.data("igGridGroupBy");if(groupBy&&groupBy.options&&groupBy.options.groupedColumns&&groupBy.options.groupedColumns.length>0){hasGroupedCols=true}if(this.grid.dataSource.settings.sorting.expressions.length>0&&hasGroupedCols){this.grid.dataSource.settings.sorting.defaultFields=this.grid.dataSource.settings.sorting.expressions}},_getDataColumnFilteringExpressions:function(fe){if(!this.grid._hasUnboundColumns){return fe}var grid=this.grid,newFE;newFE=$.grep(fe,function(s){var col=grid.columnByKey(s.fieldName);return!col||col.unbound!==true});return newFE},_saveFilteringExpressions:function(){var fe=this._getDataColumnFilteringExpressions(this.grid.dataSource.settings.filtering.expressions);if(this.element.closest(".ui-iggrid-root").data("igGrid")){this.grid._savePersistenceData(fe,"filtering",this.grid.element[0].id)}this._filteringExpressions=fe},_preserveFiltering:function(){var fe=this._filteringExpressions||this.grid._getPersistenceData("filtering",this.grid.element[0].id);if(fe){if(this.grid._hasUnboundColumns){this._updateFiltersUI([],false)}this.grid.dataSource.settings.filtering.expressions=fe;this.grid.dataSource.settings.filtering.defaultFields=fe;this._defaultExpressions=fe}},_updateFiltersUI:function(expressions){var i,j,editor,filterList,items,condName,$li,exprLen=expressions.length;if(this._editors){for(i=0;i<this._editors.length;i++){if(this.options.columnSettings[i].allowFiltering!==false){this._editors[i].value(null)}}}if(this.options.showEmptyConditions&&!exprLen){for(i=0;i<this.options.columnSettings.length;i++){condName=this.options.columnSettings[i].condition;if(condName==="empty"||condName==="notEmpty"||condName==="null"||condName==="notNull"){$li=$("#"+this.grid.element[0].id+"_dd_"+this.options.columnSettings[i].columnKey).find("ul").children().first();if($li.length){this._selectDropDownItem({currentTarget:$li},null)}}}}for(i=0;i<exprLen;i++){filterList=$("#"+this.grid.element[0].id+"_dd_"+expressions[i].fieldName).find("ul");items=filterList.children();condName=this._resolveConditionNameFromExpression(expressions[i]);for(j=0;j<items.length;j++){if($(items[j]).data("cond")===condName){this._selectDropDownItem({currentTarget:items[j]},null,expressions[i]);break}}editor=this._editors[this._columnIndexFromKey(expressions[i].fieldName)];if(editor!==undefined&&editor!==null&&editor.value){if(this.requiresFilteringExpression(condName)){editor.value(expressions[i].expr)}else{editor.value(this._editorValueForCondition(condName,editor))}editor._addedFromAdvanced=true}}this._updateTooltips(expressions)},_updateTooltips:function(expressions){var button,title,found,titleText,tempTooltipExpr,cols=this.grid.options.columns,colsLength=cols.length,i,j,expressionFieldName,condName,conditionLabel,isSimpleMode=this.options.mode==="simple"||this.options.advancedModeEditorsVisible===true;titleText=this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter);title="";for(i=0;i<expressions.length;i++){button=$("#"+this.grid.element[0].id+"_dd_"+expressions[i].fieldName+"_button");if(!this.requiresFilteringExpression(expressions[i].cond)||expressions[i].expr===undefined||expressions[i].expr===null){tempTooltipExpr=""}else{tempTooltipExpr=expressions[i].expr;if(expressions[i].type==="date"){if($.type(tempTooltipExpr)==="number"){tempTooltipExpr=new Date(tempTooltipExpr)}if(this.grid.options.enableUTCDates&&$.type(tempTooltipExpr)==="date"&&tempTooltipExpr.toUTCString){tempTooltipExpr=tempTooltipExpr.toUTCString()}}}expressionFieldName=expressions[i].fieldName;for(j=0;j<colsLength;j++){if(cols[j].key===expressionFieldName){expressionFieldName=cols[j].headerText;break}}condName=this._resolveConditionNameFromExpression(expressions[i]);conditionLabel=this.options.labels[condName];if(isSimpleMode){button.attr("title",this.options.tooltipTemplate.replace("${condition}",conditionLabel));continue}if(i===0){button.attr("title",expressionFieldName+" "+conditionLabel+" "+tempTooltipExpr+" ")}else{button.attr("title",title+expressions[i].logic+" "+expressionFieldName+" "+conditionLabel+" "+tempTooltipExpr+" ")}title=button.attr("title")}for(i=0;i<colsLength;i++){found=false;for(j=0;j<expressions.length;j++){if(expressions[j].fieldName===cols[i].key){found=true;break}}if(!found){$("#"+this.grid.element[0].id+"_dd_"+cols[i].key+"_button").attr("title",titleText)}}},_resolveConditionNameFromExpression:function(expression){var expressionFieldName,custConds=this._dsTransformedCustomConditions;expressionFieldName=expression.fieldName;if(custConds&&custConds[expressionFieldName+"_"+expression.cond]){return expressionFieldName+"_"+expression.cond}else{return expression.cond}},_columnIndexFromKey:function(key){var i;for(i=0;i<this.grid.options.columns.length;i++){if(this.grid.options.columns[i].key===key){return i}}},_generateExpressions:function(filterRowTrigger){var exprs=[],cols=this.grid.options.columns,expr,i,currentCondition,requiresEntry,isExprAdded,dt,defExpr,precise,format,preciseInd;for(i=0;i<cols.length;i++){if(this._editors&&this._editors[i]&&this._editors[i]._addedFromAdvanced&&!filterRowTrigger){continue}if(this.options.columnSettings[i].allowFiltering!==true){defExpr=this.options.columnSettings[i].defaultExpressions;if(defExpr&&defExpr.length){expr=defExpr[0].expr;currentCondition=defExpr[0].cond}else{continue}}else{expr=this._getEditorVal(this._editors[i]);currentCondition=this.options.columnSettings[i].condition}requiresEntry=this.requiresFilteringExpression(currentCondition);if(currentCondition===undefined||currentCondition===null||currentCondition===""){continue}if((expr===undefined||expr===null||expr==="")&&requiresEntry){continue}precise="";dt=cols[i].dataType;if(dt==="date"&&expr){if(this.options.type==="remote"&&this.options.filterExprUrlKey!==null&&this.options.filterExprUrlKey!==undefined){expr=Date.UTC(expr.getUTCFullYear(),expr.getUTCMonth(),expr.getUTCDate(),expr.getUTCHours(),expr.getUTCMinutes())}else{format=cols[i].format;if(format&&format.indexOf){preciseInd=format.toLowerCase().indexOf("h");if(preciseInd===-1){preciseInd=format.indexOf("m")}if(preciseInd===-1){preciseInd=format.indexOf("s")}if(preciseInd>-1){precise=format.substr(preciseInd)}}if($.type(expr)==="date"){expr=new Date(expr.valueOf());if(precise===""&&currentCondition==="after"){expr.setHours(23);expr.setMinutes(59);expr.setSeconds(59);expr.setMilliseconds(999)}}}}isExprAdded=false;if(dt!=="date"||dt==="date"&&expr!==null&&expr!==undefined&&currentCondition!=="empty"&&currentCondition!=="notEmpty"&&currentCondition!=="null"&&currentCondition!=="notNull"||dt==="date"&&!this.requiresFilteringExpression(currentCondition)){if(expr!==""&&dt!=="bool"&&!this.options.filterExprUrlKey){isExprAdded=true;exprs.push({fieldName:cols[i].key,cond:currentCondition,expr:expr})}else if(dt==="bool"&&expr!==""&&expr!==null||dt!=="bool"&&(this.options.filterExprUrlKey!==undefined&&this.options.filterExprUrlKey!==null||this.options.type==="local")){isExprAdded=true;exprs.push({fieldName:cols[i].key,cond:currentCondition,expr:expr})}else if(dt==="bool"&&(expr===""||expr===null)&&(currentCondition==="null"||currentCondition==="notNull"||currentCondition==="empty"||currentCondition==="notEmpty")){isExprAdded=true;exprs.push({fieldName:cols[i].key,cond:currentCondition,expr:expr})}if(isExprAdded){if(dt===undefined&&$.type(expr)==="string"){exprs[exprs.length-1].dataType="string"}if(cols[i].unbound){exprs[exprs.length-1].dataType=dt}if(precise){exprs[exprs.length-1].preciseDateFormat=precise}}}}return exprs},_getDefaultCondition:function(type){var result="equals";if(type===undefined||type===null||type==="string"){result="contains"}else if(type==="number"){result="equals"}else if(type==="date"){result="on"}else if(type==="bool"||type==="boolean"){result="true"}else if(type==="object"){result=""}return result},_initDefaultSettings:function(){var settings=[],key,de,cs=this.options.columnSettings,i,j,k,l,cols=this.grid.options.columns,allowFiltering,defExpr,isToCheckUnboundColumns=this.grid._hasUnboundColumns===true&&this.options.type==="remote",conditionIsValid,conds,custConds;this._defaultExpressions=this.grid.dataSource.settings.filtering.expressions||[];if(cols&&cols.length>0){for(i=0;i<cols.length;i++){allowFiltering=true;if(isToCheckUnboundColumns&&this.grid.getUnboundColumnByKey(cols[i].key)!==null){allowFiltering=false}settings[i]={columnIndex:i,columnKey:cols[i].key,condition:this._getDefaultCondition(this._getColType(cols[i].key)),allowFiltering:allowFiltering}}}if(settings.length===0&&this.grid.options.autoGenerateColumns&&cs.length>0){for(i=0;i<cs.length;i++){if(!cs[i].columnKey){continue}conds=this._populateConditionsList(cs[i].columnKey,this._getColType(cs[i].columnKey));defExpr=cs[i].defaultExpressions;custConds=cs[i].customConditions;if(defExpr&&defExpr.length>0){for(k=0;k<defExpr.length;k++){conditionIsValid=false;for(l=0;l<conds.length;++l){for(key in custConds){if(custConds.hasOwnProperty(key)){if(conds[l].condition===cs[i].columnKey+"_"+defExpr[k].cond){conditionIsValid=true;break}}}if(conditionIsValid){break}if(conds[l].condition===defExpr[k].cond){conditionIsValid=true;break}}if(!conditionIsValid){throw new Error($.ig.util.stringFormat($.ig.GridFiltering.locale.defaultConditionContainsInvalidCondition,cs[i].columnKey))}de={fieldName:cs[i].columnKey,expr:defExpr[k].expr,cond:defExpr[k].cond};if(defExpr[k].logic){de.logic=defExpr[k].logic}this._defaultExpressions.push(de)}}}}else{for(i=0;i<cs.length;i++){for(j=0;j<settings.length;j++){if(settings[j].columnKey===cs[i].columnKey||cs[i].columnKey===undefined&&settings[j].columnIndex===cs[i].columnIndex){break}}if(j===settings.length){continue}conds=this._populateConditionsList(cs[i].columnKey,this._getColType(cs[i].columnKey));for(key in cs[i]){if(cs[i].hasOwnProperty(key)){if(key!=="columnKey"&&key!=="columnIndex"){settings[j][key]=cs[i][key]}if(key==="defaultExpressions"&&cs[i][key]){defExpr=cs[i][key];custConds=cs[i].customConditions;for(k=0;k<defExpr.length;k++){conditionIsValid=false;for(l=0;l<conds.length;++l){for(key in custConds){if(custConds.hasOwnProperty(key)){if(conds[l].condition===cs[i].columnKey+"_"+defExpr[k].cond){conditionIsValid=true;break}}}if(conditionIsValid){break}if(conds[l].condition===defExpr[k].cond){conditionIsValid=true;break}}if(!conditionIsValid){throw new Error($.ig.util.stringFormat($.ig.GridFiltering.locale.defaultConditionContainsInvalidCondition,cs[i].columnKey))}de={fieldName:cs[i].columnKey,expr:defExpr[k].expr,cond:defExpr[k].cond};if(defExpr[k].logic){de.logic=defExpr[k].logic}this._defaultExpressions.push(de)}}}}}}this.options.columnSettings=settings;this.grid.dataSource.settings.filtering.expressions=this._defaultExpressions;this.grid.dataSource.settings.filtering.defaultFields=this._defaultExpressions},_transformCustomConditionsForDataSource:function(){var i,cs=this.options.columnSettings,curCS,custConds,curCond,newCond,key,keyCond;for(i=0;i<cs.length;++i){curCS=cs[i];custConds=curCS.customConditions;if(custConds){this._dsTransformedCustomConditions=this._dsTransformedCustomConditions||{};for(key in custConds){if(custConds.hasOwnProperty(key)){curCond=custConds[key];keyCond=curCS.columnKey+"_"+key;newCond={requireExpr:!!curCond.requireExpr,filterFunc:curCond.filterFunc,expressionText:curCond.expressionText||key};this.options.labels[keyCond]=this.options.labels[keyCond]||curCond.labelText;this.options.nullTexts[keyCond]=this.options.nullTexts[keyCond]||curCond.labelText;this._dsTransformedCustomConditions[keyCond]=newCond}}}}this.grid.dataSource.settings.filtering.customConditions=this._dsTransformedCustomConditions},_renderDropDown:function(type,id,colName){var ul=this._renderDropDownElement(id,colName),i,cs=this.options.columnSettings,cols=this.grid.options.columns,item,obj,conds;conds=this._populateConditionsList(colName,this._getColType(colName));if(this.options.filterDropDownItemIcons!==true&&conds.length>0){$("<a></a>").appendTo($("<li></li>").appendTo(ul).addClass(this.css.filterDropDownListItem).addClass(this.css.filterDropDownListItemClear)).text(this.options.labels.clear).addClass("ui-corner-all");for(i=0;i<conds.length;++i){$("<a></a>").appendTo($("<li></li>").appendTo(ul).addClass(this.css.filterDropDownListItem).data("cond",conds[i].condition)).text(conds[i].text).addClass("ui-corner-all")}}else if(this.options.filterDropDownItemIcons===true&&conds.length>0){obj={itemClass:this.css.filterDropDownListItemWithIcons,imgContainerClass:this.css.filterItemIconContainer,textClass:this.css.filterDropDownListItemTextContainer};this._renderDropDownToList(obj,[{text:this.options.labels.clear,imgClass:this.css.filterItemIconClear}],ul);this._renderDropDownToList(obj,conds,ul)}if(this.options.mode==="advanced"){this._renderAdvancedButton(ul)}for(i=0;i<cs.length;i++){if(cs[i].columnKey===colName&&cs[i].condition!==this._getDefaultCondition(this._getColType(cols[i].key))){if(cs[i].condition==="null"){item=ul.find(':contains("'+this.options.labels.nullLabel+'")')}else{item=ul.find(':contains("'+this.options.labels[cs[i].condition]+'")')}item=item.children().first().closest("li");item.addClass(this.css.filterDropDownListItemActive).parent().data("selectedItem",$("li",item.parent()).index(item))}}},_renderAdvancedButton:function(ul){var li;li=$("<li></li>").appendTo(ul).addClass(this.css.filterDropDownListItemAdvanced);this._currentButton=$(toStaticHTML('<input type="button"></input>'));this._currentButton.igButton({labelText:this.options.labels.advancedButtonLabel}).bind({mousedown:$.proxy(this._openFilterDialog,this)});li.append(this._currentButton)},_openFilterDialogFromKeyboard:function(event){if(event.keyCode===$.ui.keyCode.ENTER){this._openFilterDialog(event)}},_checkModalDialogFocus:function(){var $dialog=$("#"+this.grid.container().attr("id")+"_dialog"),$container=this.grid.container();$container.unbind("keydown.focusChecker");$container.bind("keydown.focusChecker",function(e){var tabElems,target,gridContainer=$container[0];if(e.keyCode===$.ui.keyCode.TAB){target=document.activeElement;if(!target||!gridContainer){return}if(target===gridContainer||$.contains(gridContainer,target)&&!$.contains($dialog[0],target)){tabElems=$(":tabbable",$dialog);tabElems.first().focus();return}}})},_filterDialogOkClicked:function(event,ui){var noCancel=this._trigger(this.events.filterDialogFiltering,null,{dialog:$("#"+this.grid.container().attr("id")+"_dialog"),owner:this});if(noCancel){ui.toClose=true}},_openFilterDialog:function(event,columnKey){var dialog=$("#"+this.grid.container().attr("id")+"_dialog");this._dialogCurrentColumn=$(event.target).closest("ul").data("colName");if(this._dialogCurrentColumn===undefined||this._dialogCurrentColumn===null){if(columnKey!==null&&columnKey!==undefined){this._dialogCurrentColumn=columnKey}else{this._dialogCurrentColumn=$(event.target).closest("th").data("colName")}}if(this._dialogCurrentColumn===undefined||this._dialogCurrentColumn===null){this._dialogCurrentColumn=this.grid.options.columns[0]}dialog.igGridModalDialog("openModalDialog");event.preventDefault();event.stopPropagation()},_filterDialogOpening:function(event){var maxZ,left,top,pos,h,w,bh,dh,dw,bw,noCancel=true,block=$("#"+this.grid.container().attr("id")+"_block"),dialog=$("#"+this.grid.container().attr("id")+"_dialog"),addDefault=true,rOffset,i,expressions=this.grid.dataSource.settings.filtering.expressions;this._checkModalDialogFocus();maxZ=$.ig.getMaxZIndex(this.grid.container().attr("id")+"_dialog");block.css("zIndex",maxZ+1);dialog.css("zIndex",maxZ+2);if(this.options.filterDialogContainment==="owner"){dialog.draggable("option","containment",this.grid.container())}else{dialog.draggable("option","containment","document")}dialog.find(".ui-iggrid-filtertable tbody tr").remove();this._dialogCurrentType=this.grid.columnByKey(this._dialogCurrentColumn).dataType;dialog.find(".ui-iggrd-filtertable tbody tr").remove();if(expressions&&expressions.length>0){addDefault=true;for(i=0;i<expressions.length;i++){if(!addDefault||expressions[i].fieldName===this._dialogCurrentColumn){addDefault=false}this._addFilterFromDialog(null,expressions[i])}if(addDefault){this._addFilterFromDialog()}}else{this._addFilterFromDialog()}noCancel=this._trigger(this.events.filterDialogOpening,null,{dialog:dialog,owner:this});if(noCancel){pos=$.ig.util.offset(this.grid.container());left=pos.left;top=pos.top;if(block.outerWidth()!==this.grid.container().outerWidth()){block.css("width",this.grid.container().outerWidth())}if(block.outerHeight()!==this.grid.container().outerHeight()){block.css("height",this.grid.container().outerHeight())}$("#"+this.grid.container().attr("id")+"_dialog_error").hide();rOffset=$.ig.util.getRelativeOffset(block);block.css({left:left-rOffset.left,top:top-rOffset.top}).fadeToggle();w=this.grid.container().outerWidth();h=this.grid.container().outerHeight();bw=$(window).width();bh=$(window).height();if(w+left>bw){w=w-(w+left-bw)}if(w<=0){w=this.grid.container().outerWidth()}if(h+top>bh){h=h-(h+top-bh)}if(h<=0){h=this.grid.container().outerHeight()}dh=parseInt(this.options.filterDialogHeight,10);dw=parseInt(this.options.filterDialogWidth,10);if(isNaN(dh)||dh<=0){dh=dialog.outerHeight()}if(isNaN(dw)||dw<=0){dw=dialog.outerWidth()}top=top+parseInt(h/2,10)-dh/2;left=left+parseInt(w/2,10)-dw/2;top=top<0?pos.top:top;left=left<0?pos.left:left;rOffset=$.ig.util.getRelativeOffset(dialog);dialog.focus();if(!(this.options.mode==="advanced"&&this.options.advancedModeEditorsVisible===false)&&this._currentTarget!==null&&this._currentTarget!==undefined){this._toggleDropDown({currentTarget:this._currentTarget},true)}}else{event.preventDefault();event.stopPropagation()}},_filterDialogOpened:function(){var dialog=$("#"+this.grid.container().attr("id")+"_dialog");this._trigger(this.events.filterDialogOpened,null,{dialog:dialog,owner:this})},_closeFilterDialog:function(event){var dialog=$("#"+this.grid.container().attr("id")+"_dialog");dialog.igGridModalDialog("closeModalDialog",false);event.preventDefault()},_filterDialogClosing:function(evt,ui){var noCancel=this._trigger(this.events.filterDialogClosing,null,{owner:this});if(!noCancel){ui.toClose=false;evt.preventDefault();evt.stopPropagation()}else{ui.toClose=true}},_filterDialogClosed:function(evt,ui){this._trigger(this.events.filterDialogClosed,null,{owner:this});if(ui.accepted){this._searchFilterDialog()}},_searchFilterDialog:function(){var expressions=[],rows,boolLogic,selectLogic,i,type,exprObj,$row,expr,noCancelFiltering=true,cond,col,$input,hrs,mins,sec,ms;rows=$("#"+this.grid.container().attr("id")+"_dialog").find("[data-af-row]");if(!rows.length){rows=$("#"+this.grid.container().attr("id")+"_dialog table tbody").children()}boolLogic="and";selectLogic=$("#"+this.grid.container().attr("id")+"_dialog select:first");if(selectLogic.length>0){boolLogic=$("#"+this.grid.container().attr("id")+"_dialog select:first")[0].value==="all"?"AND":"OR"}for(i=0;i<rows.length;i++){$row=$(rows[i]);$input=this._getDialogColSelByRow($row);if($input.data("value")!==undefined){col=this.grid.columnByKey($input.data("value"))}else{col=this.grid.columnByText($input[0].value)}if(!col){continue}type=col.dataType;expr=this._getDialogExprSelByRow($row).igGridFilterEditor("value");expr=!expr&&type==="string"?"":expr;cond=this._getDialogCondSelByRow($row)[0].value;if($.type(expr)==="date"){if(this.options.type==="local"&&(!col.format||col.format==="date")){if(cond==="after"){hrs=23;mins=59;sec=59;ms=999}else{hrs=0;mins=0;sec=0;ms=0}}if(this.grid.options.enableUTCDates){if(hrs===undefined){hrs=expr.getUTCHours();mins=expr.getUTCMinutes()}expr=Date.UTC(expr.getUTCFullYear(),expr.getUTCMonth(),expr.getUTCDate(),hrs,mins)}else if(hrs!==undefined){expr.setHours(hrs);expr.setMinutes(mins);expr.setSeconds(sec);expr.setMilliseconds(ms)}}exprObj={fieldName:col.key,cond:cond,expr:expr,logic:boolLogic,type:type};if(col.unbound&&type){exprObj.dataType=type}else if(type===undefined&&$.type(expr)==="string"){exprObj.dataType="string"}expressions.push(exprObj)}this._currentAdvancedExpressions=expressions;noCancelFiltering=this._trigger(this.events.dataFiltering,null,{owner:this,newExpressions:expressions});if(noCancelFiltering){this.filter(expressions,true,true)}},_filterDialogStartMove:function(){this._isFilterDialogMouseDown=true},_filterDialogStopMove:function(){this._isFilterDialogMouseDown=false;this._dialogClientX=undefined;this._dialogClientY=undefined},_filterDialogMove:function(e,ui){$(e.target).find(".ui-igedit-fieldincontainer").igGridFilterEditor("hideDropDown");this._trigger(this.events.filterDialogMoving,null,{dialog:e.target,owner:this,originalPosition:ui.originalPosition,position:ui.position})},_renderFilterDialog:function(){var dialog,condObj,dropDownData,condElement,condDropDown,closeButton,f=this,opts=this.options,captionsContainer,dialogContent,noCancel=true,addClearButtons,limit,container,containment,titleLabel=opts.labels.filterDialogCaptionLabel,searchButtonLabel=this.options.labels.filterDialogOkLabel,cancelButtonLabel=this.options.labels.filterDialogCancelLabel;container=this.grid._rootContainer();if(this.options.filterDialogContainment==="owner"){containment=this.grid._rootContainer()}else{containment="window"}dialog=$("<div></div>").appendTo(container).attr("id",this.grid.container().attr("id")+"_dialog");dialog.igGridModalDialog({containment:containment,modalDialogCaptionText:titleLabel,modalDialogWidth:opts.filterDialogWidth,modalDialogHeight:opts.filterDialogHeight,buttonApplyText:searchButtonLabel,buttonCancelText:cancelButtonLabel,gridContainer:this.grid._rootContainer(),modalDialogOpening:$.proxy(this._filterDialogOpening,this),modalDialogOpened:$.proxy(this._filterDialogOpened,this),modalDialogMoving:$.proxy(this._filterDialogMove,this),modalDialogClosing:$.proxy(this._filterDialogClosing,this),modalDialogClosed:$.proxy(this._filterDialogClosed,this),buttonOKClick:$.proxy(this._filterDialogOkClicked,this),tabIndex:this._getNextTabIndex()});captionsContainer=dialog.igGridModalDialog("getCaptionButtonContainer");closeButton=$("<span></span>").appendTo($("<a></a>").appendTo(captionsContainer).attr({href:"#",role:"button",title:$.ig.GridFiltering.locale.filterDialogCloseLabel,tabindex:this._getNextTabIndex()}).addClass("ui-dialog-titlebar-close ui-corner-all")).bind({click:$.proxy(this._closeFilterDialog,this)}).addClass("ui-icon ui-icon-closethick");noCancel=this._trigger(this.events.filterDialogContentsRendering,null,{dialogElement:dialog,owner:this});if(noCancel){dialogContent=dialog.igGridModalDialog("getContent");condObj={label1:this.options.labels.filterDialogConditionLabel1,label2:this.options.labels.filterDialogConditionLabel2};dropDownData=[{text:this.options.labels.filterDialogAllLabel,value:"all"},{text:this.options.labels.filterDialogAnyLabel,value:"any"}];if(this.options.filterDialogAddConditionTemplate&&typeof this.options.filterDialogAddConditionTemplate==="string"){condElement=$(this._fTmplWrappers[this.grid.id()+"_filterDialogAddConditionTemplate"](condObj))}else{condElement=$("<div><span>"+condObj.label1+"</span><div><select tabindex='"+this._getNextTabIndex()+"' title='"+$.ig.GridFiltering.locale.filterDialogConditionDropDownLabel+"'></select></div><span>"+condObj.label2+"</span></div>")}condElement.appendTo(dialogContent).addClass(this.css.filterDialogAddCondition);if(this.options.filterDialogAddConditionDropDownTemplate&&typeof this.options.filterDialogAddConditionDropDownTemplate==="string"){condDropDown=$(this._fTmplWrappers[this.grid.id()+"_filterDialogAddConditionDropDownTemplate"](dropDownData))}else{condDropDown=$("<option value='"+dropDownData[0].value+"'>"+dropDownData[0].text+"</option>"+"<option value='"+dropDownData[1].value+"'>"+dropDownData[1].text+"</option>")}condDropDown.appendTo(condElement.find("div").addClass(this.css.filterDialogAddConditionDropDown).find("select"));addClearButtons=$("<div></div>").appendTo(dialogContent);$(toStaticHTML('<input type="button"></input>')).attr("tabindex",this._getNextTabIndex()).appendTo($("<span></span>").appendTo(addClearButtons).addClass(this.css.filterDialogAddButton)).igButton({labelText:this.options.labels.filterDialogAddLabel,width:this.options.filterDialogAddButtonWidth,tabindex:this._getNextTabIndex()}).bind({click:$.proxy(this._addFilterFromDialog,this)});$("<button />").attr("tabindex",this._getNextTabIndex()).appendTo(addClearButtons).css("float","right").igButton({labelText:this.options.labels.filterDialogClearAllLabel,click:$.proxy(this._filterDialogClearAll,this),css:{buttonClasses:this.css.filterDialogClearAllButton,buttonHoverClasses:"",buttonActiveClasses:"",buttonFocusClasses:"",buttonLabelClass:""}});$("<label></label>").appendTo(dialogContent).attr("id",dialog.attr("id")+"_error").hide().text(this.options.labels.filterDialogErrorLabel).addClass("ui-widget ui-state-error ui-igvalidator-label");$("<table><tbody></tbody></table>").appendTo(dialogContent).addClass(this.css.filterDialogFiltersTable);if(this._hc===true){limit=$("#"+this.grid.element[0].id.split("_")[0]+"_container")}else{limit=this.grid.container()}dialog.bind({keydown:function(e){var tabElems,first,last;if(e.keyCode===$.ui.keyCode.ESCAPE){f._closeFilterDialog(e)}if(e.keyCode!==$.ui.keyCode.TAB){return}tabElems=$(":tabbable",dialog);first=tabElems.first();last=tabElems.last();if(e.target===last[0]&&!e.shiftKey){first.focus(1);return false}if(e.target===first[0]&&e.shiftKey){last.focus(1);return false}}});this._trigger(this.events.filterDialogContentsRendered,null,{dialogElement:dialog,owner:this})}},_setResizableEnv:function(){var initH,e=$("#"+this.grid.container().attr("id")+"_dialog"),rCont=e.find(">.ui-dialog-content"),hCont=e.find(">.ui-dialog-titlebar"),bCont=e.find(">.ui-dialog-buttonpane");if(!this._resizeCont){this._resizeCont=rCont;initH=e.height()-hCont.outerHeight()-(rCont.outerHeight()-rCont.height())-bCont.outerHeight();this._setFilterDialogContentHeight(initH)}this._resizeCont=rCont;if(e[0].style.height===""){e.css("height",e.height())}this._trigger(this.events.filterDialogOpened,null,{dialog:e,owner:this})},_resizeHandler:function(event,ui){var u=ui.originalElement,heightDifference,e=$("#"+this.grid.container().attr("id")+"_dialog"),rCont=e.find(">.ui-dialog-content"),hCont=e.find(">.ui-dialog-titlebar"),bCont=e.find(">.ui-dialog-buttonpane"),pad=rCont.outerHeight()-rCont.height();
heightDifference=hCont.outerHeight(true)+bCont.outerHeight(true)+pad;this._setFilterDialogContentHeight(u.height()-heightDifference)},_setFilterDialogContentHeight:function(height){this._resizeCont.css({height:height+"px"})},_changeFilterCondition:function(e){var editor,condition,$target=$(e.target),$row=$target.closest("[data-af-row]");if(!$row.length){$row=$target.closest("tr")}condition=e.target.value;editor=this._getDialogExprSelByRow($row);this._setFilterDialogInput(editor,condition)},_setFilterDialogInput:function(editor,condition){var editorObject,requiresEntry=this.requiresFilteringExpression(condition);if(!requiresEntry){editor.igGridFilterEditor("option","readOnly",true);editorObject=editor.data(editor.data("editorType"));this._editorValueForCondition(condition,editorObject)}else{editor.igGridFilterEditor("option","readOnly",false)}},_getDialogColSelByRow:function($frow){var $elem=$frow.find("[data-af-col]");if(!$elem.length){$elem=$frow.find("td:first").find("input").first()}return $elem},_getDialogCondSelByRow:function($frow){var $elem=$frow.find("[data-af-cond]");if(!$elem.length){$elem=$frow.find("td:nth-child(2)").find("select").first()}return $elem},_getDialogExprSelByRow:function($frow){var $elem=$frow.find("[data-af-expr]");if(!$elem.length){$elem=$frow.find("td:nth-child(3)").find("input").first()}return $elem},_getDialogRmvBtnByRow:function($frow){var $elem=$frow.find("[data-af-rmv]");if(!$elem.length){$elem=$frow.find("td:last").find("span")}return $elem},_getNextTabIndex:function(){var gti=this.grid.options.tabIndex;return gti+1},_addFilterFromDialog:function(e,expression){var tableBody=$("#"+this.grid.container().attr("id")+"_dialog table tbody"),j,cs=this.options.columnSettings,rows,filterObj={},filterRow,colKeys,i,noCancel=true,field,type,cnd,allowed,defaultValue,condition,col,conds;noCancel=this._trigger(this.events.filterDialogFilterAdding,null,{filtersTableBody:tableBody,owner:this});if(noCancel){rows=$("#"+this.grid.container().attr("id")+"_dialog").find("[data-af-row]");if(!rows.length){rows=tableBody.children()}if(rows.length>=this.options.filterDialogMaxFilterCount){$("#"+this.grid.container().attr("id")+"_dialog_error").show();return}if(this.options.filterDialogFilterTemplate&&typeof this.options.filterDialogFilterTemplate==="string"){filterRow=$(this._fTmplWrappers[this.grid.id()+"_filterDialogFilterTemplate"](filterObj))}else{filterRow=$("<tr data-af-row><td><input data-af-col/></td><td><select data-af-cond tabindex='"+this._getNextTabIndex()+"' title='"+$.ig.GridFiltering.locale.filterDialogConditionDropDownLabel+"'></select></td><td><input data-af-expr /> </td><td><span data-af-rmv></span></td></tr>")}filterRow.appendTo(tableBody);colKeys=[];for(i=0;i<this.grid.options.columns.length;i++){allowed=true;for(j=0;j<cs.length;j++){if((this.grid.options.columns[i].key===cs[j].columnKey||i===cs[j].columnIndex)&&cs[j].allowFiltering===false){allowed=false;break}}if(allowed){colKeys.push(this.grid.options.columns[i].headerText)}}if(expression===undefined){col=this.grid.columnByKey(this._dialogCurrentColumn);field=col.headerText;if(this._dialogCurrentType==="object"){this._dialogCurrentType=this._getColType(this._dialogCurrentColumn)}type=this._dialogCurrentType}else{col=this.grid.columnByKey(expression.fieldName);if(col!==null){field=col.headerText;if(col.dataType==="object"){type=this._getColType(expression.fieldName)}else{type=col.dataType}}condition=this._resolveConditionNameFromExpression(expression);defaultValue=expression.expr;if(type==="date"&&$.type(defaultValue)==="number"&&this.grid.options.enableUTCDates){defaultValue=new Date(defaultValue)}}cnd=this._getDialogCondSelByRow(filterRow);this._getDialogColSelByRow(filterRow).css("width",80).igTextEditor({listItems:colKeys,button:"dropdown",isLimitedToListValues:true,allowNullValue:false,buttonType:"dropdown",width:this.options.filterDialogColumnDropDownDefaultWidth||120,valueChanged:$.proxy(this._polulateFilterConditionDropDown,this),dropDownAttachedToBody:true,value:field,tabIndex:this._getNextTabIndex()});conds=this._populateConditionsList(col.key,this._getColType(col.key));this._renderAdvancedConditionsDropDown(cnd,conds);if(condition!==undefined&&cnd.length>0){cnd[0].value=condition}cnd.bind("change",$.proxy(this._changeFilterCondition,this));this._getDialogCondSelByRow(filterRow).css("width",this.options.filterDialogFilterDropDownDefaultWidth);this._populateFilterDialogInput(this._getDialogExprSelByRow(filterRow),type,defaultValue,col,condition);if(cnd.length&&!this.requiresFilteringExpression(condition)){this._changeFilterCondition({target:cnd[0]})}this._getDialogRmvBtnByRow(filterRow).attr("tabindex",this._getNextTabIndex()).addClass(this.css.filterDialogFilterRemoveButton).bind({mousedown:$.proxy(this._removeFilterFromDialog,this)});this._trigger(this.events.filterDialogFilterAdded,null,{filter:filterRow,owner:this})}},_filterDialogClearAll:function(e){var tableBody=$("#"+this.grid.container().attr("id")+"_dialog table tbody");tableBody.empty();$("#"+this.grid.container().attr("id")+"_dialog_error").hide();if(e){e.preventDefault()}},_polulateFilterConditionDropDown:function(e,args){var selectedColKey=args.newValue,conditionListElem,cols=this.grid.options.columns,type,input,i,col,conds,$tr,$target=$(e.target);$tr=$target.closest("[data-af-row]");if(!$tr.length){$tr=$target.closest("tr")}conditionListElem=this._getDialogCondSelByRow($tr);input=this._getDialogExprSelByRow($tr);if($(e.target).data("value")!==undefined){col=this.grid.columnByKey($(e.target).data("value"));if(col){type=col.dataType}}else{for(i=0;i<cols.length;i++){if(cols[i].headerText===selectedColKey){type=cols[i].dataType;col=cols[i];break}}}if(type==="object"){type=this._getColType(col.key)}if(type===undefined){return}conds=this._populateConditionsList(col.key,type);this._renderAdvancedConditionsDropDown(conditionListElem,conds);this._populateFilterDialogInput(input,type,undefined,col,conds[0].condition)},_populateFilterDialogInput:function(input,type,defaultValue,col,condition){var edtrT=this._getEditorNameByColType(type),options={suppressNotifications:true,tabIndex:this._getNextTabIndex(),buttonHidden:type!=="date",button:"dropdown",readOnly:type==="bool",maxDecimals:12,textAlign:type==="number"?"right":"left",width:this.options.filterDialogExprInputDefaultWidth,value:defaultValue,enableUTCDates:this.options.type==="remote"?true:this.grid.options.enableUTCDates};if(type==="date"&&col&&col.format){options.dateInputFormat=col.format}if(!input.is("input")){input=input.find("INPUT").eq(0)}if(input.data("editorType")){input.igGridFilterEditor("destroy")}input.data("editorType",edtrT);input.igGridFilterEditor(options);if(condition){this._setFilterDialogInput(input,condition)}},_populateConditionsList:function(selectedColKey,type){var conditions=[],i,j,labels=this.options.labels,cs=this.options.columnSettings,css=this.css,validConditions=[],matchingCondition,custConds,curCond,newCond,key;if(type==="number"){validConditions.push({condition:"equals",text:labels.equals,imgClass:css.filterItemIconEquals});validConditions.push({condition:"doesNotEqual",text:labels.doesNotEqual,imgClass:css.filterItemIconDoesNotEqual});validConditions.push({condition:"greaterThan",text:labels.greaterThan,imgClass:css.filterItemIconGreaterThan});validConditions.push({condition:"lessThan",text:labels.lessThan,imgClass:css.filterItemIconLessThan});validConditions.push({condition:"greaterThanOrEqualTo",text:labels.greaterThanOrEqualTo,imgClass:css.filterItemIconGreaterThanOrEqualTo});validConditions.push({condition:"lessThanOrEqualTo",text:labels.lessThanOrEqualTo,imgClass:css.filterItemIconLessThanOrEqualTo})}else if(type==="bool"||type==="boolean"){validConditions.push({condition:"true",text:labels.trueLabel,imgClass:css.filterItemIconTrue});validConditions.push({condition:"false",text:labels.falseLabel,imgClass:css.filterItemIconFalse})}else if(type==="date"){validConditions.push({condition:"on",text:labels.on,imgClass:css.filterItemIconOn});validConditions.push({condition:"notOn",text:labels.notOn,imgClass:css.filterItemIconNotOn});validConditions.push({condition:"after",text:labels.after,imgClass:css.filterItemIconAfter});validConditions.push({condition:"before",text:labels.before,imgClass:css.filterItemIconBefore});validConditions.push({condition:"today",text:labels.today,imgClass:css.filterItemIconToday});validConditions.push({condition:"yesterday",text:labels.yesterday,imgClass:css.filterItemIconYesterday});validConditions.push({condition:"thisMonth",text:labels.thisMonth,imgClass:css.filterItemIconThisMonth});validConditions.push({condition:"lastMonth",text:labels.lastMonth,imgClass:css.filterItemIconLastMonth});validConditions.push({condition:"nextMonth",text:labels.nextMonth,imgClass:css.filterItemIconNextMonth});validConditions.push({condition:"thisYear",text:labels.thisYear,imgClass:css.filterItemIconThisYear});validConditions.push({condition:"lastYear",text:labels.lastYear,imgClass:css.filterItemIconLastYear});validConditions.push({condition:"nextYear",text:labels.nextYear,imgClass:css.filterItemIconNextYear})}else if(type==="string"){validConditions.push({condition:"startsWith",text:labels.startsWith,imgClass:css.filterItemIconStartsWith});validConditions.push({condition:"endsWith",text:labels.endsWith,imgClass:css.filterItemIconEndsWith});validConditions.push({condition:"contains",text:labels.contains,imgClass:css.filterItemIconContains});validConditions.push({condition:"doesNotContain",text:labels.doesNotContain,imgClass:css.filterItemIconDoesNotContain});validConditions.push({condition:"equals",text:labels.equals,imgClass:css.filterItemIconEquals});validConditions.push({condition:"doesNotEqual",text:labels.doesNotEqual,imgClass:css.filterItemIconDoesNotEqual})}if(this.options.showEmptyConditions){validConditions.push({condition:"empty",text:labels.empty,imgClass:css.filterItemIcon});validConditions.push({condition:"notEmpty",text:labels.notEmpty,imgClass:css.filterItemIcon})}if(this.options.showNullConditions){validConditions.push({condition:"null",text:labels.nullLabel,imgClass:css.filterItemIcon});validConditions.push({condition:"notNull",text:labels.notNull,imgClass:css.filterItemIcon})}for(i=0;i<cs.length;++i){if(cs[i].columnKey===selectedColKey){cs=cs[i];break}}custConds=cs.customConditions;for(key in custConds){if(custConds.hasOwnProperty(key)){curCond=custConds[key];newCond={condition:cs.columnKey+"_"+key,text:curCond.labelText,imgClass:curCond.filterImgIcon};validConditions.push(newCond)}}if(cs.conditionList&&cs.conditionList.length>0){for(i=0;i<cs.conditionList.length;++i){matchingCondition=null;for(j=0;j<validConditions.length;++j){if(validConditions[j].condition===cs.conditionList[i]||validConditions[j].condition===cs.columnKey+"_"+cs.conditionList[i]){matchingCondition=validConditions[j];break}}if(!matchingCondition){throw new Error($.ig.util.stringFormat($.ig.GridFiltering.locale.conditionNotValidForColumnType,cs.conditionList[i],type))}conditions.push(matchingCondition)}}else{for(i=0;i<validConditions.length;++i){conditions.push(validConditions[i])}}return conditions},_renderAdvancedConditionsDropDown:function(conditionListElem,conditions){var i,condList="";conditionListElem.empty();if(this.options.filterDialogFilterConditionTemplate&&typeof this.options.filterDialogFilterConditionTemplate==="string"){condList=$(this._fTmplWrappers[this.grid.id()+"_filterDialogFilterConditionTemplate"](conditions))}else{for(i=0;i<conditions.length;i++){condList+="<option value='"+conditions[i].condition+"'>"+conditions[i].text+"</option>"}condList=$(condList)}condList.appendTo(conditionListElem);if($.ig.util.isIE){conditionListElem.parent().append(conditionListElem);conditionListElem.width(conditionListElem.width())}},_removeFilterFromDialog:function(e){var filterR,$target=$(e.target),$tr=$target.closest("[data-af-row]");if(!$tr.length){$target.closest("tr").remove();filterR=$("#"+this.grid.container().attr("id")+"_dialog").find("tr")}else{$tr.remove();filterR=$("#"+this.grid.container().attr("id")+"_dialog").find("[data-af-row]")}if(filterR.length<this.options.filterDialogMaxFilterCount){$("#"+this.grid.container().attr("id")+"_dialog_error").hide()}},_renderDropDownToList:function(obj,list,ul){var i,cond;for(i=0;i<list.length;i++){cond=$("<li class='"+obj.itemClass+"'><span class='"+obj.imgContainerClass+"'>"+"<span class='"+this.css.filterItemIcon+" "+list[i].imgClass+"'></span></span>"+"<span class='"+obj.textClass+"'> "+list[i].text+"</span></li>");cond.appendTo(ul).data("cond",list[i].condition)}},_renderDropDownElement:function(id,colName){var ul,container;ul=$("<ul></ul>").appendTo(this.grid._rootContainer()).addClass(this.css.filterDropDownList);container=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",id).addClass(this.css.filterDropDown).css("overflow","hidden").css("position","absolute").hide();if(!$.ig.util.isIE){container.css("overflow-y","auto")}container.remove();if(this.options.filterDropDownWidth>0){ul.css("width",this.options.filterDropDownWidth)}if(this.options.filterDropDownHeight>0){container.css("height",this.options.filterDropDownHeight)}ul.data("colName",colName);ul.wrap(container);ul.parent().data("efh","1");$("#"+id).delegate("li",{mousedown:$.proxy(this._selectDropDownItem,this),mouseover:$.proxy(this._hoverDropDownItem,this),mouseout:$.proxy(this._unhoverDropDownItem,this)});return ul},_hoverButton:function(event){var $target=$(event.currentTarget).find("span");if(this.options.mode==="advanced"){$target.addClass(this.css.filterButtonAdvancedHover)}else{$target.addClass(this.css.filterButtonHover)}},_unhoverButton:function(event){var $target=$(event.currentTarget).find("span");if(this.options.mode==="advanced"){$target.removeClass(this.css.filterButtonAdvancedHover)}else{$target.removeClass(this.css.filterButtonHover)}},_activateButton:function(event){var $target=$(event.currentTarget).find("span");if(this._dontApplyStyles){this._dontApplyStyles=false;return}if(this.options.mode==="advanced"){$target.addClass(this.css.filterButtonAdvancedActive)}else{$target.addClass(this.css.filterButtonActive)}},_deactivateButton:function(event){var target=$(event.target).find("span");target.removeClass(this.css.filterButtonAdvancedActive);target.removeClass(this.css.filterButtonActive)},_toggleDropDown:function(event,close,dontFocus){var $target=$(event.currentTarget),id=$target.attr("id"),dd,left,top,noCancel=true,button=$target.find("span"),rOffset,maxZ,block=$("#"+this.grid.container().attr("id")+"_block"),dialog=$("#"+this.grid.container().attr("id")+"_dialog");if(this._animating&&id===this._animatingId){return}maxZ=$.ig.getMaxZIndex(this.grid.container().attr("id")+"_dialog");block.css("zIndex",maxZ+1);dialog.css("zIndex",maxZ+2);dd=$("#"+id.substring(0,id.lastIndexOf("_button")));if(dd.find("ul > li").length===0){return}dd.css("zIndex",maxZ+3);if(!(!dd.is(":visible")&&close===true)){this._animating=true;this._animatingId=id}if(this._openingAnimation!==true){this._dontFocus=dontFocus}else{this._dontFocus=null}this._isClosing=false;if(dd.is(":visible")){noCancel=this._trigger(this.events.dropDownClosing,null,{dropDown:dd,owner:this});this._isClosing=true}else{if(!close){noCancel=this._trigger(this.events.dropDownOpening,null,{dropDown:dd,owner:this})}}if(noCancel){left=$.ig.util.offset(button).left;top=$.ig.util.offset(button).top+button.outerHeight();if(dd.offset().left!==left&&dd.offset().top!==top){rOffset=$.ig.util.getRelativeOffset(dd);left-=rOffset.left;top-=rOffset.top;dd.css("left",left).css("top",top)}this._currentTarget=$target;this._dd=dd;if(!this._isClosing){this._opendd=dd}if($.ig.util.isIE){dd.css("overflow-x","hidden");dd.css("overflow-y","hidden")}if(close!==undefined&&close===true){if(dd.is(":visible")){if(this.options.filterDropDownAnimations!=="none"){dd.hide(this.options.filterDropDownAnimationDuration,$.proxy(this._animationEnd,this))}else{dd.hide();this._trigger(this.events.dropDownClosed,null,{dropDown:dd,owner:this})}}}else{if(this.options.filterDropDownAnimations!=="none"){if(dd.is(":visible")){this._closingTarget=this._currentTarget}else{this._openingTarget=this._currentTarget;this._openingAnimation=true}dd.toggle(this.options.filterDropDownAnimationDuration,$.proxy(this._animationEnd,this))}else{dd.toggle();if(this._isClosing){this._trigger(this.events.dropDownClosed,null,{dropDown:dd,owner:this})}else{this._trigger(this.events.dropDownOpened,null,{dropDown:dd,owner:this})}if(dontFocus!==true){this._dontApplyStyles=true;$target.focus()}}}}if($.type(event.stopPropagation)==="function"){event.stopPropagation()}},_animationEnd:function(){if(this.options===null){return}if(this._isClosing===true){this._trigger(this.events.dropDownClosed,null,{dropDown:this._dd,owner:this})}else{this._trigger(this.events.dropDownOpened,null,{dropDown:this._opendd,owner:this});this._openingAnimation=false}if(this._dd&&$.ig.util.isIE){this._dd.css("overflow-y","auto")}this._isClosing=null;if(this._dontFocus!==true){this._dontApplyStyles=true;this._openingTarget.focus()}this._animating=false},_toggleDropDownKeyboard:function(event){var parent,selectedItem,$target=$(event.target),ddVisible;if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){event.stopPropagation();event.preventDefault();parent=$("#"+$target.attr("id").substring(0,$target.attr("id").lastIndexOf("_button"))).find("ul");if(parent.data("selectedItem")||parent.data("selectedItem")===0){selectedItem=parent.find("li:nth-child("+(parent.data("selectedItem")+1)+")");ddVisible=$("#"+$target.attr("id").substring(0,$target.attr("id").lastIndexOf("_button"))).is(":visible");if($(selectedItem).hasClass("ui-iggrid-filterddlistitemadvanced")&&ddVisible){this._openFilterDialog(event)}}if(selectedItem&&ddVisible){event.currentTarget=selectedItem;this._selectDropDownItem(event)}else{this._toggleDropDown(event)}}else if(event.keyCode===$.ui.keyCode.DOWN){event.stopPropagation();event.preventDefault();this._selectDropDownItem(event,"next")}else if(event.keyCode===$.ui.keyCode.UP){event.stopPropagation();event.preventDefault();this._selectDropDownItem(event,"prev")}},_closeDropDown:function(event){var $target=$(event.currentTarget).find("span"),$targetButton=$(event.currentTarget),dd;if(this._openingTarget&&event.target.id===this._openingTarget.attr("id")&&this._openingAnimation===true){return}dd=$("#"+$targetButton.attr("id").substring(0,$targetButton.attr("id").lastIndexOf("_button")));if(dd&&!dd.is(":visible")){$target.removeClass(this.css.filterButtonActive);return}this._toggleDropDown(event,true,true);if(this._dontApplyStyles){this._dontApplyStyles=false;return}if(this.options.mode==="advanced"){$target.removeClass(this.css.filterButtonAdvancedActive)}else{$target.removeClass(this.css.filterButtonActive)}},_getColType:function(colkey){var type=this.grid.dataSource._getFieldTypeFromSchema(colkey);if(type===undefined){type=this.grid.columnByKey(colkey).dataType}return type},_selectDropDownItem:function(event,nav,expr){var $target=$(event.currentTarget),filterCondition,colIndex,sel,parent,requiresEntry,button,currentCond,targetParent,evtArgs,focT,type;if($target.find("input").length>0&&this.options.mode==="advanced"){return}if(nav==="next"||nav==="prev"){parent=$("#"+$target.attr("id").substring(0,$target.attr("id").lastIndexOf("_button"))).find("ul")}if(nav==="next"){if(parent.data("selectedItem")===undefined){$target=parent.find("li:first")}else{$target=parent.find("li:nth-child("+(parent.data("selectedItem")+1)+")");if($target.next().length===0){$target=parent.find("li:first")}else{$target=$target.next()}}}if(nav==="prev"){if(parent.data("selectedItem")===undefined){$target=parent.find("li:last")}else{$target=parent.find("li:nth-child("+(parent.data("selectedItem")+1)+")");if($target.prev().length===0){$target=parent.find("li:last")}else{$target=$target.prev()}}}filterCondition=$target.data("cond");button=$("#"+$target.closest("div").attr("id")+"_button");button.attr("title",this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter));if($target.data("cond")===undefined){button.attr("title",this.options.tooltipTemplate.replace("${condition}",this.options.labels.noFilter))}colIndex=$("#"+$target.closest("div").attr("id")+"_button").find("span").data("colIndex");if(!colIndex&&expr){$.each(this.options.columnSettings,function(index,col){if(col.columnKey===expr.fieldName){colIndex=index;return false}})}currentCond=this.options.columnSettings[parseInt(colIndex,10)].condition;targetParent=$target.parent();sel=targetParent.data("selectedItem");type=this._getColType(this.grid.options.columns[colIndex].key);requiresEntry=this.requiresFilteringExpression(filterCondition);if(filterCondition!==undefined){this.options.columnSettings[parseInt(colIndex,10)].condition=filterCondition;if(sel!==undefined){targetParent.find("li:nth-child("+(sel+1)+")").removeClass(this.css.filterDropDownListItemActive)}$target.addClass(this.css.filterDropDownListItemActive);targetParent.data("selectedItem",$("li",targetParent).index($target));this._editors[colIndex].element.igGridFilterEditor("option","placeHolder",this.options.nullTexts[filterCondition])}else if(currentCond==="empty"||currentCond==="notEmpty"||currentCond==="null"||currentCond==="notNull"||!this.requiresFilteringExpression(currentCond)){this.options.columnSettings[parseInt(colIndex,10)].condition=this._getDefaultCondition(type);if(sel!==undefined){targetParent.find("li:nth-child("+(sel+1)+")").removeClass(this.css.filterDropDownListItemActive);targetParent.data("selectedItem",null);this._editors[colIndex].element.igGridFilterEditor("option","placeHolder",this.options.nullTexts[this._getDefaultCondition(type)])}if(currentCond==="null"||this.grid.options.columns[colIndex].dataType==="date"){this._editors[colIndex].element.igGridFilterEditor("option","placeHolder",this.options.nullTexts[this._getDefaultCondition(type)])}}else{if(sel!==undefined){targetParent.find("li:nth-child("+(sel+1)+")").removeClass(this.css.filterDropDownListItemActive)}$target.addClass(this.css.filterDropDownListItemActive);targetParent.data("selectedItem",$("li",targetParent).index($target))}if(nav===undefined||event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){if($target.hasClass("ui-iggrid-filterddlistitemclear")||this.options.filterDropDownItemIcons===true&&$target.find(".ui-iggrid-filtericonclear").length>0){if(!requiresEntry||filterCondition===undefined){this._editors[colIndex].element.igGridFilterEditor("option","readOnly",this._getColType(this.grid.options.columns[colIndex].key)==="boolean")}this._editors[colIndex].value(null);this._filterDataSourceClear(this.grid.options.columns[colIndex].key,colIndex);this._toggleDropDown({currentTarget:button},true)}else{if(!requiresEntry&&!expr){this._editors[colIndex].element.igGridFilterEditor("option","readOnly",true);this._editorValueForCondition(filterCondition,this._editors[colIndex]);this._args=undefined;this._filterInternal(colIndex,this.grid.options.columns[colIndex].key)}else if(this._editors[colIndex].value()!==""&&this._editors[colIndex].value()!==null){this._editors[colIndex].setFocus(true);evtArgs={owner:this._editors[colIndex],text:this._editors[colIndex].displayValue()};this._filter(event,evtArgs)}if(requiresEntry){this._editors[colIndex].element.igGridFilterEditor("option","readOnly",false);if(nav===undefined&&filterCondition!==undefined){focT=$.ig.util.isTouchDevice()?this.options.filterDropDownAnimationDuration:-1;this._editors[colIndex].setFocus(focT)}}}}},requiresFilteringExpression:function(filterCondition){var custConds=this._dsTransformedCustomConditions;if(this.grid.dataSource._isFilteringExprNotReq(filterCondition)){return false}if(custConds&&custConds[filterCondition]){return custConds[filterCondition].requireExpr}if(filterCondition===undefined||filterCondition===null){return false}return true},_editorValueForCondition:function(filterCondition,editor){var date=new Date,custConds=this._dsTransformedCustomConditions;if(filterCondition==="true"){editor.value(true)}else if(filterCondition==="false"){editor.value(false)}else if(filterCondition==="today"){editor.value(new Date)}else if(filterCondition==="yesterday"){if(this.grid.options.enableUTCDates){editor.value(new Date(Date.UTC(date.getFullYear(),date.getMonth(),date.getDate()-1,0,0,0,0)))}else{editor.value(new Date(date.getFullYear(),date.getMonth(),date.getDate()-1,0,0,0,0))}}else if(custConds&&custConds[filterCondition]){editor.value(custConds[filterCondition].expressionText)}else{editor.value(null)}},_assignTemplates:function(){var self=this,opts=self.options,gId=this.grid.id();this._fTmplWrappers={};this._fTmplWrappers[gId+"_filterDialogFilterTemplate"]=function(d){return $.ig.tmpl(opts.filterDialogFilterTemplate,d)};this._fTmplWrappers[gId+"_filterDialogAddConditionTemplate"]=function(d){return $.ig.tmpl(opts.filterDialogAddConditionTemplate,d)};this._fTmplWrappers[gId+"_filterDialogAddConditionDropDownTemplate"]=function(d){return $.ig.tmpl(opts.filterDialogAddConditionDropDownTemplate,d)};this._fTmplWrappers[gId+"_filterDialogFilterConditionTemplate"]=function(d){return $.ig.tmpl(opts.filterDialogFilterConditionTemplate,d)};if(String(this.grid.options.templatingEngine).toLowerCase()==="jsrender"){this._jsr=true;$.templates(gId+"_filterDialogFilterTemplate",opts.filterDialogFilterTemplate);$.templates(gId+"_filterDialogAddConditionTemplate",opts.filterDialogAddConditionTemplate);$.templates(gId+"_filterDialogAddConditionDropDownTemplate",opts.filterDialogAddConditionDropDownTemplate);$.templates(gId+"_filterDialogFilterConditionTemplate",opts.filterDialogFilterConditionTemplate);this._fTmplWrappers=$.render}},_hoverDropDownItem:function(event){if($(event.currentTarget).find("input").length===0){$(event.currentTarget).addClass(this.css.filterDropDownListItemHover)}},_unhoverDropDownItem:function(event){$(event.currentTarget).removeClass(this.css.filterDropDownListItemHover)},_virtualHorizontalScroll:function(event,args){var start=args.startColIndex,i,headers=this.grid.headersTable().find("th"),columnKey;if(this._currentTarget){this._toggleDropDown({currentTarget:this._currentTarget},true)}if(this.options.mode==="advanced"&&this.options.advancedModeEditorsVisible!==true){for(i=0;i<this.grid._virtualColumnCount;i++){columnKey=this.grid.options.columns[i+start].key;$(headers[i]).data("colName",columnKey);if(this._fcData[columnKey]===true){continue}$(headers[i]).find("a").attr("id",this.grid.element[0].id+"_dd_"+columnKey+"_button")}this._updateTooltips(this._currentAdvancedExpressions||[])}else{throw new Error($.ig.GridFiltering.locale.virtualizationSimpleFilteringNotAllowed)}},_headerInit:function(owner,args){var filterrow;if(this.options.mode!=="simple"&&this.options.advancedModeEditorsVisible!==true||this.grid.element.attr("id")!==args.owner.element.attr("id")){return}filterrow=this.grid.headersTable().children("thead").find("[data-role=filterrow]");filterrow.find("[data-skip=true]").remove();this.grid._headerInit(filterrow,null,true)},_injectGrid:function(gridInstance){var topmostGrid=null;this.grid=gridInstance;if(this.options.type===null){this.options.type=this.grid._inferOpType()}if(this.options.persist&&this.options.type==="remote"){topmostGrid=this.element.closest(".ui-iggrid-root").data("igGrid");if(topmostGrid&&topmostGrid.element.attr("id")!==this.grid.element[0].id&&topmostGrid.options.initialDataBindDepth===-1){this.options.persist=false}}if(this.options.type){this.grid.dataSource.settings.filtering.type=this.options.type}else{this.grid.dataSource.settings.filtering.type="remote"}if(this.options.filterExprUrlKey){this.grid.dataSource.settings.filtering.filterExprUrlKey=this.options.filterExprUrlKey}this.grid.dataSource.settings.filtering.caseSensitive=this.options.caseSensitive;if(this._headerCellRenderedHandler!==null&&this._headerCellRenderedHandler!==undefined){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler)}this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);if(this._headerRenderedHandler!==null&&this._headerRenderedHandler!==undefined){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}this._headerRenderedHandler=$.proxy(this._headerRendered,this);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);if(this._columnResizedHandler!==null&&this._columnResizedHandler!==undefined){this.grid.element.unbind("iggridresizingcolumnresized",this._columnResizedHandler)}this._columnResizedHandler=$.proxy(this._columnResized,this);this.grid.element.bind("iggridresizingcolumnresized",this._columnResizedHandler);if(this._columnsAlteredHandler!==null&&this._columnsAlteredHandler!==undefined){this.grid.element.unbind("iggrid_columnsmoved",this._columnsAlteredHandler)}this._columnsAlteredHandler=$.proxy(this._columnsAltered,this);this.grid.element.bind("iggrid_columnsmoved",this._columnsAlteredHandler);this._transformCustomConditionsForDataSource();this._initDefaultSettings();if(this._onUIDirtyHandler!==null&&this._onUIDirtyHandler!==undefined){this.grid.element.unbind("iggriduidirty",this._onUIDirtyHandler)}this._onUIDirtyHandler=$.proxy(this._onUIDirty,this);this.grid.element.bind("iggriduidirty",this._onUIDirtyHandler);if(this._virtualHorizontalScrollHandler!==null&&this._virtualHorizontalScrollHandler!==undefined){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}this._virtualHorizontalScrollHandler=$.proxy(this._virtualHorizontalScroll,this);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler);if((this.grid.options.virtualization===true&&this.grid.options.width!==null||this.grid.options.columnVirtualization===true)&&this.options.mode===null){this.options.mode="advanced"}else if((this.grid.options.virtualization===false||this.grid.options.virtualization===true&&!this.grid._isColumnVirtualizationEnabled())&&(this.options.mode===null||this.options.mode==="simple")){this.options.mode="simple"}else if(this.options.mode==="simple"&&(this.grid.options.virtualization===true||this.grid.options.columnVirtualization===true)){throw new Error($.ig.GridFiltering.locale.virtualizationSimpleFilteringNotAllowed)}if(this.grid._rlp&&(this.options.mode==="simple"||!this.options.mode)){throw new Error($.ig.GridFiltering.locale.multiRowLayoutSimpleFilteringNotAllowed)}if(this._headerInitHandler!==null&&this._headerInitHandler!==undefined){this.grid.element.unbind("iggridheaderextracellsmodified",this._headerInitHandler)}this._headerInitHandler=$.proxy(this._headerInit,this);this.grid.element.bind("iggridheaderextracellsmodified",this._headerInitHandler);if(this.grid.element.igGridFeatureChooser!==undefined){this.grid.element.igGridFeatureChooser()}else{throw new Error($.ig.GridFiltering.locale.featureChooserNotReferenced)}this._assignTemplates();if(this.options.persist){this._preserveFiltering()}}});$.extend($.ui.igGridFiltering,{version:"16.1.20161.1009"});$.fn.extend({igGridFilterEditor:function(){var edtrT=this.data("editorType"),func=this[edtrT];if($.type(func)!=="function"){return}return func.apply(this,arguments)}})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Outlook GroupBy feature 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on:
*	jquery-1.4.4.js
*	jquery.ui.core.js
*	jquery.ui.widget.js
*	jquery.ui.mouse.js
*	jquery.ui.draggable.js
*	jquery.ui.droppable.js
*	infragistics.ui.grid.framework.js
*	infragistics.ui.grid.shared.js
*	infragistics.ui.grid.featurechooser.js
*/
(function($){$.widget("ui.igGridGroupBy",{css:{dragMarkup:"ui-iggrid-dragMarkup",groupByArea:"ui-iggrid-groupbyarea",groupByAreaText:"ui-iggrid-groupbyareatext",groupedRow:"ui-iggrid-groupedrow",expandHeaderCellGroupBy:"ui-iggrid-header ui-widget-header",groupByExpandCellExpanded:"ui-icon ui-iggrid-expandbutton ui-iggrid-expandbuttonexpanded ui-icon-minus",groupByExpandCellCollapsed:"ui-icon ui-iggrid-expandbutton ui-icon-plus",groupByAreaDropHover:"ui-iggrid-groupbyareahover",groupByExpandColumn:"ui-iggrid-expandcolumn",nonGroupRowEmptyCell:"ui-iggrid-nongrouprowemptycell",groupedColumnLabel:"ui-iggrid-groupedcolumnlabel ui-state-default",groupedColumnLabelText:"ui-iggrid-groupedcolumnlabeltext",groupByRemoveButton:"ui-icon ui-icon-circle-close ui-iggrid-groupbyremovebutton",groupedColumnLabelRightEdgeEnd:"ui-iggrid-groupbylabelrightedgeend",groupedColumnLabelRightEdge:"ui-iggrid-groupbylabelrightedge",groupedColumnLayoutLabel:"ui-iggrid-groupbylayoutlabel",headerExtraCell:"ui-iggrid-expandheadercellgb",footerExtraCell:"ui-widget-content ui-iggrid-footerextracell",featureChooserIconClass:"ui-icon ui-iggrid-icon-groupby",dialogGroupedColumns:"ui-iggrid-groupby-dialog-groupedcolumns",dialogUnroupedColumns:"ui-iggrid-groupby-dialog-ungroupedcolumns",dialogGroupedItem:"ui-widget-content",dialogUngroupedItem:"ui-widget-content",dialogUngroupedColumnsGroupByButton:"ui-iggrid-dialog-groupby-button",dialogUngroupedColumnsText:"ui-iggrid-dialog-text",dialogButtonAsc:"ui-button ui-corner-all ui-button-icon-only ig-sorting-indicator",dialogButtonAscIcon:"ui-button-icon-primary ui-icon ui-icon-arrowthick-1-n",dialogButtonDesc:"ui-button ui-corner-all ui-button-icon-only ig-sorting-indicator",dialogButtonDescIcon:"ui-button-icon-primary ui-icon ui-icon-arrowthick-1-s",dialogButtonUngroup:"ui-iggrid-dialog-groupedbuttons ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-igbutton ui-widget-content ui-igbutton-remove",dialogButtonUngroupContainer:"ui-button-icon-primary ui-icon ui-icon-circle-close",dialogGroupedColumnTextContainer:"ui-iggrid-dialog-text",dialogListGroupedColumns:"ui-iggrid-dialog-list-groupedcolumns",dialogListUngroupedColumns:"ui-iggrid-dialog-list-ungroupedcolumns",dialogLayoutsDDButton:"ui-icon ui-icon-triangle-1-s ui-iggrid-dialog-layouts-dd-button",dropDownLayoutsContainer:"ui-iggrid-featurechooser-dropdown-dialog ui-widget ui-widget-content ui-corner-all",dialogLayoutsDDField:"ui-iggrid-dialog-layouts-dd-field",dialogLayoutsDD:"ui-iggrid-dialog-layouts-dd ui-widget-content ui-corner-all ig-combo-icon-container",modalDialogTreeContainer:"ui-iggrid-groupby-dialog-tree",modalDialogLayoutsContainer:"ui-iggrid-groupby-dialog-layoutscontainer",dialogButtonsHover:"ui-state-hover",groupByLastEmptyCell:"ui-iggrid-last-emptycell"},renderInFeatureChooser:false,options:{groupByAreaVisibility:"top",initialExpand:true,emptyGroupByAreaContent:$.ig.GridGroupBy.locale.emptyGroupByAreaContent,emptyGroupByAreaContentSelectColumns:$.ig.GridGroupBy.locale.emptyGroupByAreaContentSelectColumns,expansionIndicatorVisibility:true,groupByLabelWidth:null,labelDragHelperOpacity:.5,indentation:30,defaultSortingDirection:"asc",groupedColumns:[{key:null,dir:"asc",layout:null,col:null}],resultResponseKey:null,groupedRowTextTemplate:"${key}: ${val} (${count})",type:null,groupByUrlKey:null,groupByUrlKeyAscValue:null,groupByUrlKeyDescValue:null,summarySettings:{multiSummaryDelimiter:",",summaryFormat:"#.00"},columnSettings:[{allowGrouping:true,isGroupBy:false,groupComparerFunction:null,groupLabelFormatter:null,dir:"asc",summaries:[{summaryFunction:"avg",text:null,customSummary:null}]}],expandTooltip:$.ig.GridGroupBy.locale.expandTooltip,collapseTooltip:$.ig.GridGroupBy.locale.collapseTooltip,removeButtonTooltip:$.ig.GridGroupBy.locale.removeButtonTooltip,modalDialogGroupByOnClick:false,modalDialogGroupByButtonText:$.ig.GridGroupBy.locale.modalDialogGroupByButtonText,modalDialogCaptionButtonDesc:$.ig.GridGroupBy.locale.modalDialogCaptionButtonDesc,modalDialogCaptionButtonAsc:$.ig.GridGroupBy.locale.modalDialogCaptionButtonAsc,modalDialogCaptionButtonUngroup:$.ig.GridGroupBy.locale.modalDialogCaptionButtonUngroup,modalDialogCaptionText:$.ig.GridGroupBy.locale.modalDialogCaptionText,modalDialogDropDownLabel:$.ig.GridGroupBy.locale.modalDialogDropDownLabel,modalDialogRootLevelHierarchicalGrid:$.ig.GridGroupBy.locale.modalDialogRootLevelHierarchicalGrid,modalDialogDropDownButtonCaption:$.ig.GridGroupBy.locale.modalDialogDropDownButtonCaption,modalDialogClearAllButtonLabel:$.ig.GridGroupBy.locale.modalDialogClearAllButtonLabel,emptyGroupByAreaContentSelectColumnsCaption:$.ig.GridGroupBy.locale.emptyGroupByAreaContentSelectColumnsCaption,modalDialogDropDownWidth:200,modalDialogDropDownAreaWidth:null,modalDialogAnimationDuration:200,modalDialogWidth:400,modalDialogHeight:"",modalDialogButtonApplyText:$.ig.GridGroupBy.locale.modalDialogButtonApplyText,modalDialogButtonCancelText:$.ig.GridGroupBy.locale.modalDialogButtonCancelText,useGridColumnFormatter:true,persist:true,groupByDialogContainment:"owner",inherit:false},events:{groupedColumnsChanging:"groupedColumnsChanging",groupedColumnsChanged:"groupedColumnsChanged",modalDialogMoving:"modalDialogMoving",modalDialogClosing:"modalDialogClosing",modalDialogClosed:"modalDialogClosed",modalDialogOpening:"modalDialogOpening",modalDialogOpened:"modalDialogOpened",modalDialogContentsRendering:"modalDialogContentsRendering",modalDialogContentsRendered:"modalDialogContentsRendered",modalDialogButtonApplyClick:"modalDialogButtonApplyClick",modalDialogButtonResetClick:"modalDialogButtonResetClick",modalDialogGroupingColumn:"modalDialogGroupingColumn",modalDialogGroupColumn:"modalDialogGroupColumn",modalDialogUngroupingColumn:"modalDialogUngroupingColumn",modalDialogUngroupColumn:"modalDialogUngroupColumn",modalDialogSortGroupedColumn:"modalDialogSortGroupedColumn"},_create:function(){this._orderedGroupedCols=[]},_createWidget:function(){this.options.columnSettings=[];this.options.groupedColumns=[];this._tempSortingExpr=[];this._tempGroupedColumns=[];this._tempOrderedGroupedCols=[];this._tempOptions={};this._currentTreeLayer=null;this._isInitFC=false;this._modalSelectedLayout=null;$.Widget.prototype._createWidget.apply(this,arguments)},_setOption:function(key,value){var modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog");$.Widget.prototype._setOption.apply(this,arguments);if(key==="groupByAreaVisibility"||key==="expansionIndicatorVisibility"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}switch(key){case"modalDialogGroupByOnClick":$("#"+this.grid.id()+"_groupby_modalDialog").remove();this._renderGroupByDialog();break;case"modalDialogCaptionText":modalDialog.igGridModalDialog("option","modalDialogCaptionText",value);break;case"modalDialogAnimationDuration":modalDialog.igGridModalDialog("option","animationDuration",value);break;case"modalDialogWidth":modalDialog.igGridModalDialog("option","modalDialogWidth",value);break;case"modalDialogHeight":modalDialog.igGridModalDialog("option","modalDialogHeight",value);break;case"modalDialogButtonApplyText":modalDialog.igGridModalDialog("option","buttonApplyText",value);break;case"modalDialogButtonCancelText":modalDialog.igGridModalDialog("option","buttonCancelText",value);break;default:break}},_headerRendered:function(event,args){var groupby=this,groupbyarea;if(args.owner.id()!==this.grid.id()){return}if(args.owner.element.attr("data-childgrid")){return}this._renderGroupByDialog();if(this.options.groupByAreaVisibility==="top"){groupbyarea=$("<div></div>").prependTo(this.grid.container())}else if(this.options.groupByAreaVisibility==="bottom"){groupbyarea=$("<div></div>").appendTo(args.owner.container())}else if(this.options.groupByAreaVisibility==="hidden"){return}groupbyarea.attr("id",this.grid.element.attr("id")+"_groupbyarea").addClass(this.css.groupByArea);this._setGroupAreaTextContent($("<span></span>").appendTo(groupbyarea).addClass(this.css.groupByAreaText));groupbyarea.droppable({accept:"th:not([groupby-disabled])",hoverClass:groupby.css.groupByAreaDropHover,drop:function(event,ui){var accepted,isdescendant;isdescendant=ui.draggable.closest(".ui-iggrid-root").attr("id")===groupby.grid.id()||ui.draggable.closest(".ui-iggrid").find(".ui-iggrid-root").length>0;if(!groupby.grid.element.hasClass("ui-iggrid-root")){isdescendant=true}accepted=ui.draggable.hasClass("ui-iggrid-header")&&isdescendant;if(accepted){groupby._groupBy(event,ui.draggable)}}});if(this.grid._isMultiColumnGrid){groupbyarea.droppable("option","tolerance","touch")}},_renderGroupByDialog:function(){var $buttonOK,containment,self=this,o=this.options,$captionButtonContainer,modalDialog;if(this.options.groupByDialogContainment==="owner"){containment=this.grid.container()}else{containment="window"}modalDialog=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",this.grid.id()+"_groupby_modalDialog");modalDialog.igGridModalDialog({renderFooterButtons:!o.modalDialogGroupByOnClick,modalDialogCaptionText:o.modalDialogCaptionText,modalDialogWidth:o.modalDialogWidth,modalDialogHeight:o.modalDialogHeight,animationDuration:o.modalDialogAnimationDuration,buttonApplyText:o.modalDialogButtonApplyText,buttonCancelText:o.modalDialogButtonCancelText,containment:containment,gridContainer:this.grid.container(),modalDialogOpening:function(event,args){return self._groupByDialogOpening(event,args)},modalDialogMoving:function(e,ui){self._trigger(self.events.modalDialogMoving,null,{modalDialogElement:e.target,owner:self,originalPosition:ui.originalPosition,position:ui.position})},modalDialogClosing:function(){return self._trigger(self.events.modalDialogClosing,null,{modalDialogElement:modalDialog,owner:self})},modalDialogClosed:function(){self._trigger(self.events.modalDialogClosed,null,{modalDialogElement:modalDialog,owner:self})}});if(o.modalDialogGroupByOnClick){$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$("<span></span>").bind("click.hiding",function(event){modalDialog.igGridModalDialog("closeModalDialog",true);event.preventDefault();event.stopPropagation();return false}).addClass("ui-icon ui-icon-closethick").appendTo($("<a></a>").appendTo($captionButtonContainer).attr("title",$.ig.GridHiding.locale.columnChooserCloseButtonTooltip).attr("href","#").attr("role","button").addClass("ui-dialog-titlebar-close ui-corner-all"))}else{$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$buttonOK=$("#"+this.grid.id()+"_groupby_modalDialog_footer_buttonok");$buttonOK.bind("igbuttonclick",function(e){self._groupByDialogButtonOKClick(e)})}},openGroupByDialog:function(){var modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog");modalDialog.igGridModalDialog("openModalDialog")},closeGroupByDialog:function(){var modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog");modalDialog.igGridModalDialog("closeModalDialog")},_groupByDialogOpening:function(){var noCancel,modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog");noCancel=this._trigger(this.events.modalDialogOpening,null,{modalDialogElement:modalDialog,owner:this});if(noCancel){this.renderGroupByModalDialog();this._trigger(this.events.modalDialogOpened,null,{modalDialogElement:modalDialog,owner:this})}return noCancel},renderGroupByModalDialog:function(){var $content,i,self=this,o=this.options,css=this.css,modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog"),noCancel,$groupedColumns,$ungroupedColumns;noCancel=this._trigger(this.events.modalDialogContentsRendering,null,{modalDialogElement:modalDialog,owner:this});if(noCancel){$content=modalDialog.igGridModalDialog("getContent");$content.empty();self._tempGroupedColumns=o.groupedColumns.slice(0);self._tempOrderedGroupedCols=self._orderedGroupedCols.slice(0);self._tempSortingExpr=self.grid.dataSource.settings.sorting.expressions.slice(0);self._tempOptions={columnLayouts:[]};if(this.grid.options.columnLayouts&&this.grid.options.columnLayouts.length>0){for(i=0;i<this.grid.options.columnLayouts.length;i++){self._tempOptions.columnLayouts.push($.extend(true,{},this.grid.options.columnLayouts[i]))}this._renderLayoutsDropDown()}$groupedColumns=$("<div></div>").attr("id",this.grid.id()+"_groupby_modalDialog_groupedcolumns").addClass(css.dialogGroupedColumns).appendTo($content);$ungroupedColumns=$("<div></div>").attr("id",this.grid.id()+"_groupby_modalDialog_ungroupedcolumns").addClass(css.dialogUnroupedColumns).appendTo($content);$("<ul></ul>").addClass(css.dialogListGroupedColumns).appendTo($groupedColumns);$("<ul></ul>").addClass(css.dialogListUngroupedColumns).appendTo($ungroupedColumns);this._renderColumnsDialog(this.grid.options.columns);this._currentTreeLayer=null;if(this._isToRenderClearAllButton()){this._renderDialogButtonClearAll()}else{$("#"+this.grid.id()+"_groupbydialog_reset_button").remove()}this._trigger(this.events.modalDialogContentsRendered,null,{modalDialogElement:modalDialog,owner:this})}},_addSlideButtonGroupedColumns:function(){var css=this.css,o=this.options,$groupedColumns=$("#"+this.grid.id()+"_groupby_modalDialog_groupedcolumns"),buttonId=this.grid.id()+"_groupbymodaldialot_slidebutton",$button,innerHTML;innerHTML='<div class="'+css.dialogSlideArea+'">'+'	<div class="'+css.dialogSlideAreaContainer+'">'+'		<button id="'+buttonId+'" class="'+css.dialogButtonSlide+'" role="button" aria-disabled="false" title="'+o.dialogButtonSlideCaption+'">'+'			<span class="'+css.dialogButtonSlideContainer+'"></span>'+'			<span class="ui-button-text">'+o.dialogButtonSlideCaption+"</span>"+"		</button>"+"	</div>"+"</div>";$(innerHTML).insertAfter($groupedColumns);$button=$("#"+buttonId);$button.bind({click:function(){$groupedColumns.slideToggle("slow");$(this).find("span:eq(0)").toggleClass(css.dialogButtonSlideUp);return false}})},_renderLayoutsDropDown:function(){var o=this.options,fn,w,dW,$ddField,self=this,css=this.css,modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog"),$content=modalDialog.igGridModalDialog("getContent"),cancelFunc,htmlLayouts,$buttonDD,$dropDown,$tree,dropDownId=this.grid.id()+"_groupby_modalDialog_layoutsDD",modalDialogDropDownAreaWidth=o.modalDialogDropDownAreaWidth||o.modalDialogDropDownWidth,columnLayoutsData=this.grid.options.columnLayouts.slice(0),$layoutsContainer;$layoutsContainer=$("<div></div>").attr("id",this.grid.id()+"_groupby_modalDialog_layoutsContainer").addClass(css.modalDialogLayoutsContainer).appendTo($content);htmlLayouts='<div style="float: left;">'+o.modalDialogDropDownLabel+"</div>"+'<div class="'+css.dialogLayoutsDD+'">'+'	<div id="'+this.grid.id()+'_groupby_modalDialog_layoutsDDField" class="'+css.dialogLayoutsDDField+'">'+o.modalDialogRootLevelHierarchicalGrid+"</div>"+'	<span id="'+this.grid.id()+'_groupby_modalDialog_layoutsDDButton" style="float:right;">^</span>'+'	<div style="clear: both;"></div>'+"</div>"+'<div style="clear: both;"></div>';$layoutsContainer.html(htmlLayouts);$buttonDD=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDDButton");$buttonDD.wrap('<a href="#" title="'+o.modalDialogDropDownButtonCaption+' "></a>');cancelFunc=function(e){e.preventDefault();e.stopPropagation()};$buttonDD.closest("div").bind({mousedown:function(event){self._toggleDropDown(event,false)},mouseup:cancelFunc,click:cancelFunc});$buttonDD.addClass(css.dialogLayoutsDDButton);if(this._checkIsGroupByInherit(this.grid.options)===false){columnLayoutsData=this._getEnabledGroupByLayouts(columnLayoutsData)}if(columnLayoutsData.length>0||this._checkIsGroupByEnabled(this.grid.options)){$dropDown=$("#"+dropDownId);$dropDown.remove();$dropDown=$("<div></div>");$dropDown.attr("id",dropDownId).css({position:"absolute",display:"none","z-index":"1000"}).addClass(this.css.dropDownLayoutsContainer).appendTo($("#"+this.grid.id()+"_groupby_modalDialog_content")).bind({mousedown:function(){clearTimeout(self._dropDownTimeout);setTimeout(function(){$buttonDD.closest("a").focus()},10)}});if(o.modalDialogDropDownWidth){$buttonDD.closest("div").width(o.modalDialogDropDownWidth)}if(modalDialogDropDownAreaWidth){$dropDown.width(modalDialogDropDownAreaWidth)}if(o.modalDialogDropDownWidth&&(!o.modalDialogDropDownWidth.indexOf||o.modalDialogDropDownWidth.indexOf("%")===-1)){w=$buttonDD.closest("div").width()-$buttonDD.outerWidth();$ddField=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDDField");$ddField.width(w);dW=$ddField.outerWidth()-w;if(dW>0){w-=dW;$ddField.width(w-2)}}$tree=$("<div></div>").attr("id",this.grid.id()+"_groupby_modal_treeLayouts").addClass(css.modalDialogTreeContainer);$tree.appendTo($dropDown);columnLayoutsData=[{key:"Root",columnLayouts:columnLayoutsData,isRoot:true}];$tree.igTree({dataSourceType:"json",dataSource:columnLayoutsData,initialExpandDepth:1e6,bindings:{textKey:"key",childDataProperty:"columnLayouts"},nodeClick:function(event,args){var data=args.node.data,keyLayout=data.key,$groupedUL=$("#"+self.grid.id()+"_groupby_modalDialog_groupedcolumns ul"),$ungroupedUL=$("#"+self.grid.id()+"_groupby_modalDialog_ungroupedcolumns ul");if(data.dislabledGroupBy===true){return}$groupedUL.empty();$ungroupedUL.empty();$("#"+self.grid.id()+"_groupby_modalDialog_layoutsDDField").text(keyLayout);if(args.node.path.length===1){self._renderColumnsDialog(self.grid.options.columns);self._currentTreeLayer=null}else{self._currentTreeLayer=keyLayout;self._renderColumnsDialog(data.columns,keyLayout)}self._toggleDropDown()}});fn=function(){self._dropDownTimeout=setTimeout(function(){self.closeDropDown()},200)};$buttonDD.closest("a").bind({focus:function(){self._igTreeHasFocus=true;clearTimeout(self._dropDownTimeout)},blur:function(){self._igTreeHasFocus=false;fn()}});$tree.find("a").bind({focus:function(){clearTimeout(self._dropDownTimeout)},blur:function(){fn()}});$tree.find("span.ui-igtree-expander.ui-icon").bind({click:function(){clearTimeout(self._dropDownTimeout);setTimeout(function(){$buttonDD.closest("a").focus()},10)}})}},openDropDown:function(){var $dropDown=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDD");if($dropDown.is(":visible")===false){this._toggleDropDown()}},closeDropDown:function(){var $dropDown=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDD");if($dropDown.is(":visible")===true){this._toggleDropDown()}},_getEnabledGroupByLayouts:function(layouts){var resultLayouts=[],i,tempChildLayouts,layout;if(layouts){for(i=0;i<layouts.length;i++){tempChildLayouts=null;layout=$.extend(true,{},layouts[i]);if(layout.columnLayouts&&this._checkIsGroupByInherit(layout)===false){tempChildLayouts=this._getEnabledGroupByLayouts(layout.columnLayouts);if(tempChildLayouts&&tempChildLayouts.length>0){layout.columnLayouts=tempChildLayouts}else{layout.columnLayouts=null}}if(this._checkIsGroupByEnabled(layout)){resultLayouts.push(layout)}else if(layout.columnLayouts!==null&&layout.columnLayouts!==undefined){layout.dislabledGroupBy=true;resultLayouts.push(layout)}}}return resultLayouts},_checkIsGroupByInherit:function(layout){var i;if(layout&&layout.features){for(i=0;i<layout.features.length;i++){if(layout.features[i].name==="GroupBy"&&layout.features[i].inherit===true){return true}}}return false},_checkIsGroupByEnabled:function(layout){var i;if(layout&&layout.features){for(i=0;i<layout.features.length;i++){if(layout.features[i].name==="GroupBy"){return true}}}return false},_toggleDropDown:function(){var $button=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDDButton").parent(),$modalDialogContent=$("#"+this.grid.id()+"_groupby_modalDialog_content"),$layoutsDDField=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDDField").parent(),left=0,top=0,$dropDown=$("#"+this.grid.id()+"_groupby_modalDialog_layoutsDD"),isVisible=$dropDown.is(":visible")===true,self=this;if($dropDown.data("isAnimating")===true){return}if(!isVisible){top=$layoutsDDField.offset().top-$modalDialogContent.offset().top+$layoutsDDField.height()+1;left=$layoutsDDField.offset().left-$modalDialogContent.offset().left;$dropDown.css({top:top,left:left})}$dropDown.data("isAnimating",true);$dropDown.slideToggle(400,function(){var $layoutsDD=$("#"+self.grid.id()+"_groupby_modalDialog_layoutsDD"),$tree=$("#"+self.grid.id()+"_groupby_modal_treeLayouts");if($dropDown.is(":visible")===true){$button.focus();self._activeDropdown=$dropDown;if(!self.options.modalDialogDropDownAreaWidth&&!self.options.modalDialogDropDownWidth){if($layoutsDD.width()!==$tree.width()){$layoutsDD.width($tree.width())}}}else{self._activeDropdown=null}$dropDown.data("isAnimating",false)})},_groupByDialogButtonOKClick:function(e){var noCancel,noCancelGroupBy,i,j,len,tempGroupedCol,copy,o=this.options,$hTable,modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog"),isToCallGroupedColumnsChanged=false;noCancel=this._trigger(this.events.modalDialogButtonApplyClick,null,{modalDialogElement:modalDialog,owner:this,groupedColumns:this._tempGroupedColumns,groupedColumnLayouts:this._tempOptions.columnLayouts,sortingExpr:this._tempSortingExpr});if(noCancel){noCancelGroupBy=this._trigger(this.events.groupedColumnsChanging,e,{owner:this,groupedColumns:o.groupedColumns,newGroupedColumns:{columns:this._tempGroupedColumns,layouts:this._tempOptions.columnLayouts},triggeredBy:"modalDialog"});if(noCancelGroupBy){if(this._orderedGroupedCols.length!==this._tempOrderedGroupedCols.length){isToCallGroupedColumnsChanged=true}else{len=this._orderedGroupedCols.length;for(i=0;i<len;i++){tempGroupedCol=this._tempOrderedGroupedCols[i];for(j=0;j<len;j++){if(tempGroupedCol.key===this._orderedGroupedCols[j].key&&tempGroupedCol.layout===this._orderedGroupedCols[j].layout){break}}if(j===len){isToCallGroupedColumnsChanged=true;break}}}this._orderedGroupedCols=this._tempOrderedGroupedCols;if(o.groupedColumns){o.groupedColumns=this._tempGroupedColumns}if(this.grid.options.columnLayouts){this.grid.options.columnLayouts=this._tempOptions.columnLayouts}if(this.grid.dataSource.settings.sorting.expressions){this.grid.dataSource.settings.sorting.expressions=this._tempSortingExpr}if(this._isToRenderClearAllButton()===false){if($(".ui-iggrid-groupbyarea",this.grid.container()).find("ul li").length===0){this._isgroup=null}else{this._isgroup=false}}else{this._isgroup=true}$hTable=this.grid.headersTable();if(o.groupedColumns.length===0&&$hTable.find("thead tr").children().first().hasClass("ui-iggrid-expandheadercellgb")){if($.ig.util.isIE){this.grid.element.children("tbody").hide();$hTable.hide()}this.grid.element.find("colgroup").children().first().remove();if(this.grid.options.fixedHeaders){$hTable.find("colgroup").children().first().remove()}if(this.grid.options.fixedFooters&&this.grid.options.height!==null){this.grid.footersTable().find("colgroup").children().first().remove()}$hTable.find("thead tr").children("[data-skip]").first().remove()}copy=this._orderedGroupedCols.slice(0);this._orderedGroupedCols=[];this._ensureLabelsOrder(copy,this._orderedGroupedCols,this.grid.options);this._rebind();if($.ig.util.isIE&&!$hTable.is(":visible")){$hTable.show()}if(this.grid.options.width!==null&&this.grid.options.width!==undefined){this.grid._updateGridContentWidth()}this.grid._trigger("headerExtraCellsModified",null,{owner:this});if(isToCallGroupedColumnsChanged===true){this.grid._onGroupedColumnsChanged(this._tempGroupedColumns);this._trigger(this.events.groupedColumnsChanged,e,{owner:this,groupedColumns:this._tempGroupedColumns,triggeredBy:"modalDialog"})}}e.preventDefault();e.stopPropagation();modalDialog.igGridModalDialog("closeModalDialog")}},_setSortingTempExpr:function(key,dir,layout){var i,layouts,j,gc=this._tempGroupedColumns,gcTemp,sexpr,s=this._tempSortingExpr,settings,lobj;sexpr={fieldName:key,dir:dir,layout:layout,isGroupBy:true};if(dir===""){for(j=0;j<s.length;j++){if(s[j].fieldName===key&&s[j].layout===layout){s.splice(j,1);break}}return}if(gc.length===0&&!layout){gcTemp=this._tempGroupedColumns.slice(0);this._allGroupedCols(gcTemp);gc=gcTemp.slice(0)}for(i=0;i<gc.length;i++){if(gc[i].key===key){gc[i].dir=dir;for(j=0;j<s.length;j++){if(s[j].fieldName===key){s[j].dir=gc[i].dir;if(gc[i].layout){s[j].layout=gc[i].layout}break}}if(j===s.length){this._addSortingExpressions(s,sexpr)}break}}if(layout){for(i=0;i<this._tempOrderedGroupedCols.length;i++){if(this._tempOrderedGroupedCols[i].key===key&&(this._tempOrderedGroupedCols.layout&&this._tempOrderedGroupedCols.layout===layout||!this._tempOrderedGroupedCols.layout)){this._tempOrderedGroupedCols[i].dir=dir;break}}for(j=0;j<s.length;j++){if(s[j].fieldName===key&&s[j].layout===layout){s[j].dir=dir;break}}if(j===s.length){this._addSortingExpressions(s,sexpr)}layouts=[];this._findLayout(layout,this._tempOptions,layouts);lobj=layouts[0];for(i=0;lobj.features&&i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){settings=lobj.features[i].columnSettings;for(j=0;j<settings.length;j++){if(settings[j].columnKey===key){settings[j].dir=dir;break}}break}}}},_setGroupByTempExpr:function(key,isGroupBy,dir,layout){var i,gexpr,expr,lobj,c,fcs,setting,layouts;if(layout){layouts=[];this._findLayout(layout,this._tempOptions,layouts);lobj=layouts[0];c=this._getColumnByLayoutKey(key,lobj.columns)}else{lobj=this.grid.options;c=this.grid.columnByKey(key)}if(layout){if(!lobj.features){lobj.features=[];lobj.features.push({name:"GroupBy",columnSettings:[]});fcs=lobj.features[0].columnSettings}else{for(i=0;i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){fcs=lobj.features[i].columnSettings;if(!fcs){lobj.features[i].columnSettings=[];fcs=lobj.features[i].columnSettings}break}}}for(i=0;i<fcs.length;i++){if(fcs[i].columnKey===key){if(!isGroupBy){fcs.splice(i,1)}else{setting=fcs[i]}break}}if(isGroupBy){if(!setting){fcs.push({columnKey:key,isGroupBy:isGroupBy,dir:dir})}else{setting.isGroupBy=isGroupBy;setting.dir=dir}}}gexpr={key:key,dir:dir,layout:layout,col:c};if(!layout){expr=this._tempGroupedColumns;for(i=0;i<expr.length;i++){if(expr[i].key===key){expr.splice(i,1);break}}if(isGroupBy){expr=expr.concat(gexpr)}this._tempGroupedColumns=expr}if(isGroupBy){this._tempOrderedGroupedCols.push(gexpr)}else{for(i=0;i<this._tempOrderedGroupedCols.length;i++){if(this._tempOrderedGroupedCols[i].key===key&&(this._tempOrderedGroupedCols.layout&&this._tempOrderedGroupedCols.layout===layout||!this._tempOrderedGroupedCols.layout)){$.ig.removeFromArray(this._tempOrderedGroupedCols,i);break}}}this._setSortingTempExpr(key,dir,layout)},_checkColumnIsGroupedInternal:function(key,layout,groupedColumns,options){var isGrouped=false,i,j,layouts,lobj,fcs;if(!layout){for(i=0;i<groupedColumns.length;i++){if(groupedColumns[i].key===key){isGrouped=true;break}}}else{layouts=[];this._findLayout(layout,options,layouts);lobj=layouts[0];if(lobj&&lobj.features){for(i=0;i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){fcs=lobj.features[i].columnSettings;if(fcs){for(j=0;j<fcs.length;j++){if(fcs[j].columnKey===key){if(fcs[j].isGroupBy){isGrouped=true}break}}}break}}}}return isGrouped},checkColumnIsGrouped:function(key,layout){return this._checkColumnIsGroupedInternal(key,layout,this.options.groupedColumns,this.grid.options)},_getAllColumns:function(columns,columnsRes){var i,columnsLength=columns.length;for(i=0;i<columnsLength;i++){if(columns[i].group){this._getAllColumns(columns[i].group,columnsRes)}else{columnsRes.push(columns[i])}}},_renderColumnsDialog:function(columns,layout){var self=this,columnsRes=[];if(this.grid._isMultiColumnGrid){this._getAllColumns(columns,columnsRes)}else{columnsRes=columns}$.each(columnsRes,function(columnIndex,column){var cs=self._findColumnSetting(column.key);if(self.options.type==="remote"&&(column.unboundDS===true||column.unbound===true)){return true}if(!cs||cs.allowGrouping){if(self._checkColumnIsGroupedInternal(column.key,layout,self._tempGroupedColumns,self._tempOptions)){self._renderDialogGroupedColumn(column,layout)}else{self._renderDialogUngroupedColumn(column,layout)}}})},_clearAllGroupedColumns:function(){this._tempGroupedColumns=[];this._clearAllGroupedColumnsLayout(this._tempOptions)},_clearAllGroupedColumnsLayout:function(layout){var i,fcs;if(layout!==null&&layout.features){for(i=0;i<layout.features.length;i++){if(layout.features[i].name==="GroupBy"){fcs=layout.features[i].columnSettings;if(fcs){layout.features[i].columnSettings=[]}}}}for(i=0;layout.columnLayouts&&i<layout.columnLayouts.length;i++){this._clearAllGroupedColumnsLayout(layout.columnLayouts[i])}},_isToRenderClearAllButton:function(){if(this.options.modalDialogGroupByOnClick===true){return true}if(this._tempGroupedColumns.length>0){return true}if(this._checkRenderLayoutsClearAll(this.grid.options)===true){return true}return false},_checkRenderLayoutsClearAll:function(layout){var i,j,fcs;if(layout!==null&&layout.features){for(i=0;i<layout.features.length;i++){if(layout.features[i].name==="GroupBy"){fcs=layout.features[i].columnSettings;if(fcs){for(j=0;j<fcs.length;j++){if(fcs[j].isGroupBy){return true}}}}}}for(i=0;layout.columnLayouts&&i<layout.columnLayouts.length;i++){if(this._checkRenderLayoutsClearAll(layout.columnLayouts[i])===true){return true}}return false},_renderDialogGroupedColumn:function(column,layout){var i,j,s,$li,liHTML,$buttonUngroup,o=this.options,self=this,css=this.css,key=column.key,$ul=$("#"+this.grid.id()+"_groupby_modalDialog_groupedcolumns ul"),buttonAscDescId=this.grid.id()+"_"+key+"_groupbydialog_groupedcolumns_buttonascdesc",buttonUngroupId=this.grid.id()+"_"+key+"_groupbydialog_groupedcolumns_buttonungroup",dir="asc",gc=null;$("#"+this.grid.id()+"_groupby_modalDialog").css("width");if(!layout){for(i=0;i<self._tempGroupedColumns.length;i++){if(self._tempGroupedColumns[i].key===key){gc=self._tempGroupedColumns[i];dir=gc.dir;break}}}else{s=self._tempSortingExpr;for(j=0;j<s.length;j++){if(s[j].fieldName===key&&s[j].layout===layout){dir=s[j].dir;break}}}$li=$('<li tabIndex="0"></li>').attr("id",self.grid.id()+"_"+key+"_groupbydialog_grouped_li").addClass(css.dialogGroupedItem);$li.appendTo($ul);liHTML='<span id="'+buttonAscDescId+'" class="'+css.dialogButtonAsc+'" role="button" title="'+o.modalDialogCaptionButtonAsc+'">'+'	<span class="'+css.dialogButtonAscIcon+'"></span>'+"</span>"+'<span class="'+css.dialogGroupedColumnTextContainer+'">'+column.headerText+"</span>"+'<button id="'+buttonUngroupId+'" class="'+css.dialogButtonUngroup+'" role="button" title="'+o.modalDialogCaptionButtonUngroup+'" >'+'	<span class="'+css.dialogButtonUngroupContainer+'"></span>'+'	<span class="ui-button-text">'+o.modalDialogCaptionButtonUngroup+"</span>"+"</button>";$li.html(liHTML);$buttonUngroup=$("#"+buttonUngroupId);self._setDialogButtonAscDesc(dir==="asc",key);$li.bind({keydown:function(e){if(e.keyCode===$.ui.keyCode.ENTER||e.keyCode===$.ui.keyCode.SPACE){$li.click();e.preventDefault();e.stopPropagation()}},click:function(){self._dialogButtonAscDescClick(key,layout)}});$buttonUngroup.bind({keydown:function(e){if(e.keyCode===$.ui.keyCode.ENTER||e.keyCode===$.ui.keyCode.SPACE){e.target.click();e.preventDefault();e.stopPropagation()}},click:function(e){var noCancel,$nextLi;noCancel=self._trigger(self.events.modalDialogUngroupingColumn,e,{key:key,layout:layout,owner:self});if(noCancel){$li.remove();if(o.modalDialogGroupByOnClick===true){self.ungroupByColumn(key,layout)}else{self._setGroupByTempExpr(key,false,"",layout)}$nextLi=self._renderDialogUngroupedColumn(column,layout);$nextLi.find(":focusable").first().focus(1);if($("#"+self.grid.id()+"_groupby_modalDialog_groupedcolumns ul li").length===0&&self._isToRenderClearAllButton()===false){$("#"+self.grid.id()+"_groupbydialog_reset_button").remove()}self._trigger(self.events.modalDialogUngroupColumn,e,{key:key,layout:layout,owner:self,groupedColumns:self._tempGroupedColumns})}e.preventDefault();e.stopPropagation()},mouseover:function(){if(!$(this).hasClass(css.dialogButtonsHover)){$(this).addClass(css.dialogButtonsHover)}},mouseout:function(){if($(this).hasClass(css.dialogButtonsHover)){$(this).removeClass(css.dialogButtonsHover)}}});return $li},_dialogButtonAscDescClick:function(key,layout){var o=this.options,$buttonAscDesc=$("#"+this.grid.id()+"_"+key+"_groupbydialog_groupedcolumns_buttonascdesc"),noCancel,modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog"),isAsc=$buttonAscDesc.data("isAsc");
noCancel=this._trigger(this.events.modalDialogSortGroupedColumn,null,{modalDialogElement:modalDialog,owner:this,key:key,isAsc:!isAsc,layout:layout});if(noCancel){if(isAsc===true){if(o.modalDialogGroupByOnClick===true){this._setSortingTempExpr(key,"desc",layout);this.grid.dataSource.settings.sorting.expressions=this._tempSortingExpr;this._rebind()}else{this._setSortingTempExpr(key,"desc",layout)}}else{if(o.modalDialogGroupByOnClick===true){this._setSortingTempExpr(key,"asc",layout);this.grid.dataSource.settings.sorting.expressions=this._tempSortingExpr;this._rebind()}else{this._setSortingTempExpr(key,"asc",layout)}}this._setDialogButtonAscDesc(!isAsc,key)}},_setDialogButtonAscDesc:function(isAsc,key){var css=this.css,$buttonAscDesc=$("#"+this.grid.id()+"_"+key+"_groupbydialog_groupedcolumns_buttonascdesc"),$spanIcon=$buttonAscDesc.find("span:eq(0)"),caption;if(isAsc===true){$buttonAscDesc.removeClass(css.dialogButtonDesc).addClass(css.dialogButtonAsc);$spanIcon.removeClass(css.dialogButtonDescIcon).addClass(css.dialogButtonAscIcon);caption=this.options.modalDialogCaptionButtonAsc}else{$buttonAscDesc.removeClass(css.dialogButtonAsc).addClass(css.dialogButtonDesc);$spanIcon.removeClass(css.dialogButtonAscIcon).addClass(css.dialogButtonDescIcon);caption=this.options.modalDialogCaptionButtonDesc}$buttonAscDesc.data("isAsc",isAsc).attr("title",caption)},_renderDialogButtonClearAll:function(){if(this.options.modalDialogGroupByOnClick===true){return}var self=this,o=this.options,resetButtonId=self.grid.id()+"_groupbydialog_reset_button",modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog"),$captionButtonContainer,$resetButton;if($("#"+resetButtonId).length===0){$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$resetButton=$("<button></button>").attr("id",resetButtonId).appendTo($captionButtonContainer);$resetButton.igButton({labelText:o.modalDialogClearAllButtonLabel,click:function(e){var noCancel,$groupedUL,$ungroupedUL,layouts=[];noCancel=self._trigger(self.events.modalDialogButtonResetClick,e,{modalDialogElement:modalDialog,owner:self});if(noCancel){self._clearAllGroupedColumns();self._tempSortingExpr=self.grid.dataSource.settings.sorting.expressions.slice(0);$groupedUL=$("#"+self.grid.id()+"_groupby_modalDialog_groupedcolumns ul");$ungroupedUL=$("#"+self.grid.id()+"_groupby_modalDialog_ungroupedcolumns ul");$groupedUL.empty();$ungroupedUL.empty();self._tempSortingExpr=[];self._tempOrderedGroupedCols=[];if(!self._currentTreeLayer){self._renderColumnsDialog(self.grid.options.columns)}else{self._findLayout(self._currentTreeLayer,self._tempOptions,layouts);if(layouts.length>0){self._renderColumnsDialog(layouts[0].columns,self._currentTreeLayer)}}$(this).remove()}}})}},_renderDialogUngroupedColumn:function(column,layout){var self=this,$li,$a,key=column.key,o=this.options,css=this.css,$ul=$("#"+this.grid.id()+"_groupby_modalDialog_ungroupedcolumns ul");$li=$("<li></li>").attr("id",self.grid.id()+"_"+key+"_groupbydialog_grouped_li").addClass(css.dialogUngroupedItem).append('<span class="'+css.dialogUngroupedColumnsGroupByButton+'"><a href="#"></a></span> <span class="'+css.dialogUngroupedColumnsText+'">'+column.headerText+"</span>");$li.appendTo($ul);$a=$li.find("a:first");$a.addClass(css.modalDialogSortByColumn);$a.html(o.modalDialogGroupByButtonText);$li.bind({click:function(e){var noCancel,$nextLi;noCancel=self._trigger(self.events.modalDialogGroupingColumn,e,{key:key,layout:layout,owner:self});if(noCancel){$li.remove();if(o.modalDialogGroupByOnClick){self.groupByColumn(key,layout)}else{self._setGroupByTempExpr(key,true,o.defaultSortingDirection,layout)}self._renderDialogButtonClearAll();$nextLi=self._renderDialogGroupedColumn(column,layout);$nextLi.find(":focusable").first().focus(1);self._renderDialogButtonClearAll();self._trigger(self.events.modalDialogGroupColumn,e,{key:key,layout:layout,owner:self,groupedColumns:self._tempGroupedColumns})}e.preventDefault();e.stopPropagation()}});return $li},_setGroupAreaTextContent:function($area){var text=this.options.emptyGroupByAreaContent,linkText=this.options.emptyGroupByAreaContentSelectColumns,linkTextCaption=this.options.emptyGroupByAreaContentSelectColumnsCaption,$a,self=this;text=text.replace("{0}",'<a href="#" id="'+this.grid.id()+'_link_selectcolumns" title="'+linkTextCaption+'">'+linkText+"</a>");$area.html(text);$a=$("#"+this.grid.id()+"_link_selectcolumns");$a.bind({click:function(e){self.openGroupByDialog();e.preventDefault();e.stopPropagation()}})},_headerCellDragCancel:function(){return false},_headerCellRendered:function(event,args){var groupby=this,cs,hg,hgTemp,isMultiColumnHeaderGrid=this.grid._isMultiColumnGrid;if(args.owner.id()!==this.grid.id()){return}if(args.isMultiColumnHeader===true){return}hg=groupby.grid.element.hasClass("ui-iggrid-root")?groupby.grid.container():groupby.grid.element.closest(".ui-iggrid-root");if(hg.length===0){hg=groupby.grid.container()}else{hgTemp=hg.closest(".ui-widget");if(hgTemp.length>0){hg=hgTemp}}cs=this._findColumnSetting(args.columnKey);if(!$.ig.util.isIE||$.ig.util.browserVersion>=9){args.th.find(".ui-iggrid-headertext").css("width","100%")}if(cs&&cs.allowGrouping||!cs){args.th.draggable({containment:hg,appendTo:hg,distance:5,revert:"invalid",scroll:false,cancel:"div.ui-iggrid-indicatorcontainer",helper:function(event){var th,helperDOM;if($(event.target).is("span")){groupby._spanDragging=true}else{groupby._spanDragging=false}th=$(event.target).closest("th");helperDOM=th.clone().css("overflow","hidden").width(th.width()).addClass("ui-widget ui-iggrid").wrap($('<div class="'+groupby.css.dragMarkup+'"/>').width(th.outerWidth()));if(isMultiColumnHeaderGrid){helperDOM.height(th.height())}return helperDOM.parent()},opacity:groupby.options.labelDragHelperOpacity,drag:function(event,ui){var groupbyarea;groupby._isDragging=true;groupbyarea=$(".ui-iggrid-groupbyarea",hg);if(!groupbyarea.hasClass("ui-iggrid-groupbyareahover")&&!groupby._movingEnabled){if(groupby._spanDragging){ui.helper.find("span").css("cursor","no-drop")}else{ui.helper.css("cursor","no-drop")}}else{if(groupby._spanDragging){ui.helper.find("span").css("cursor","move")}else{ui.helper.css("cursor","move")}}},stop:function(){groupby._isDragging=false}}).bind({mouseover:groupby._headerMouseOverHandler,mouseout:groupby._headerMouseOutHandler});if(args.owner.element.attr("data-childgrid")){args.th.attr("data-layout",args.owner.options.key).attr("data-grid-id",args.owner.element.attr("id"))}}},_findColumnSetting:function(key){var i;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){return this.options.columnSettings[i]}}},_renderRecords:function(ui,args){if(args.owner.id()!==this.grid.id()){return}if(args.vrtWnd&&args.vrtWnd.calledFromGroupBy){return true}if(this.options.groupedColumns.length>0){this._renderRecordsInternal(args)}else{return true}return false},_recordsRendered:function(ui,args){if(args.calledFromGroupBy){return}var currentScrollTop=$(window).scrollTop();if(!args.tbody.is(":visible")){args.tbody.css("display","")}if(this._scrolltop!==0&&currentScrollTop!==0&&this._scrolltop!==currentScrollTop){$(window).scrollTop(this._scrolltop)}},_renderRecordsInternal:function(args){var grid=this.grid,idval=null,ds=grid.dataSource.dataView(),firstTime=true,counter,d=[],tbody=grid.element.children("tbody"),fh=false,html,i,tbodyHtml,$thDataSkip,noCancel=true,gr,groupedRowsLength,tr,countHiddenRows,startIndex=0,endIndex=0,newFirstVisibleRow,isScrolledToBottom,lastVisibleRow,avgRowHeight,dataSkipWidth=0,scrollContainer;noCancel=grid._trigger(grid.events.rowsRendering,null,args);if(noCancel){this._indent=this.options.indentation;if(grid.options.fixedHeaders===true){fh=true}if(grid._isMultiColumnGrid){this._colspan=grid.container().find("#"+grid.id()+" colgroup:first>col:not([data-hiding])").length-1}else{if(grid.options.showHeader){this._colspan=grid.container().find("#"+grid.id()+(fh===true?"_headers":"")+" thead>tr:first").children("th:not(.ui-iggrid-expandheadercellgb)").length}else{this._colspan=grid.container().find("#"+grid.id()+" colgroup:first>col").length-1}}this._processGroupsRecursive(0,ds,tbody,d,idval,0,ds.length,firstTime);if(!grid.headersTable().find("thead tr th").hasClass("ui-iggrid-expandheadercellgb")){$thDataSkip=$("<th></th>").prependTo(grid.headersTable().find("thead tr:nth-child(1)")).addClass(this.css.expandHeaderCellGroupBy).addClass(this.css.headerExtraCell).attr("data-skip",true);if(grid._isMultiColumnGrid){$thDataSkip.attr("rowspan",grid._maxLevel+1)}if(grid.headersTable().attr("id")!==grid.element.attr("id")){$("<col />").prependTo(grid.headersTable().find("colgroup")).attr("data-skip","true").width(this._indent)}if(grid.footersTable().attr("id")!==grid.element.attr("id")){$("<col />").prependTo(grid.footersTable().find("colgroup")).attr("data-skip","true").width(this._indent)}}else{grid.headersTable().find("colgroup col:nth-child(1)").width(this._indent);grid.footersTable().find("colgroup col:nth-child(1)").width(this._indent)}tbody.show();html=d.join("");this._expandedRowCount=0;if(grid.options.virtualization===true){this._visibleGroupedRows=[];this._groupedRows=this._tokenizeTBody(html);if(this._groupedRows.length>0){this._groupedRows[0]=this._groupedRows[0].substr(0,3)+' data-firstgrouprow="true" '+this._groupedRows[0].substr(3);this._groupedRows[this._groupedRows.length-1]=this._groupedRows[this._groupedRows.length-1].substr(0,3)+' data-lastrow="true" '+this._groupedRows[this._groupedRows.length-1].substr(3);for(i=this._groupedRows.length-1;i>=0;i--){if(this._groupedRows[i].indexOf('data-grouprow="true"')>=0){this._groupedRows[i]=this._groupedRows[i].substr(0,3)+' data-lastgrouprow="true" '+this._groupedRows[i].substr(3);break}}this._virtualRowCount=this._determineVirtualRowCount(this._groupedRows,grid._getDisplayContainerHeight());if(this._virtualRowCount>this._groupedRows.length){this._virtualRowCount=this._groupedRows.length}endIndex=this._virtualRowCount;if(!grid._persistVirtualScrollTop||!grid._prevFirstVisibleTRIndex){grid._scrollTo(0,true)}tbodyHtml="";if(!this.options.initialExpand){this._countGroupedRows=html.match(/(data-grouprow="true")/gi).length;this._cachedGroupedRows=this._groupedRows;this._visibleRowIndexes=[];gr=[];this._groups={};counter=0;groupedRowsLength=this._groupedRows.length;countHiddenRows=0;for(i=0;i<groupedRowsLength;i++){tr=this._groupedRows[i];if(tr.indexOf("data-grouprow")>-1){counter++;countHiddenRows=0;tr=tr.replace(/data-row-idx="(\d)+"/i,'data-row-idx="'+(counter-1)+'"');if(tr.indexOf("display:none")===-1){this._visibleRowIndexes.push(counter-1);this._visibleGroupedRows.push(tr)}gr.push(tr)}else{if(++countHiddenRows>this._virtualRowCount){continue}if(!this._groups[counter-1]){this._groups[counter-1]=[]}this._groups[counter-1].push(tr)}}this._groupedRows=gr;gr=null;this._virtualRowCount=this._determineVirtualRowCount(this._visibleGroupedRows,grid._getDisplayContainerHeight());if(this._virtualRowCount>this._visibleGroupedRows.length){this._virtualRowCount=this._visibleGroupedRows.length}if(this.grid._prevFirstVisibleTRIndex&&this.grid._persistVirtualScrollTop){startIndex=this._visibleRowIndexes.indexOf(this.grid._prevFirstVisibleTRIndex)}endIndex=startIndex+this._virtualRowCount;tbodyHtml+=this._renderInitiallyCollapsedRows(startIndex,endIndex)}else{if(this.grid._prevFirstVisibleTRIndex&&this.grid._persistVirtualScrollTop){startIndex=this.grid._prevFirstVisibleTRIndex;endIndex=startIndex+this._virtualRowCount;if(startIndex>=this._groupedRows.length){endIndex=this._groupedRows.length;startIndex=this._groupedRows.length-this._virtualRowCount-1}else{endIndex=this._determineVirtualRowCount(this._groupedRows,grid._getDisplayContainerHeight())+startIndex}if(endIndex>this._groupedRows.length){endIndex=this._groupedRows.length;startIndex=endIndex-this._determineVirtualRowCount(this._groupedRows,grid._getDisplayContainerHeight())}if(startIndex<0){startIndex=0}}for(i=startIndex;i<endIndex;i++){tbodyHtml+=this._groupedRows[i]}}if(window.MSApp===undefined){tbody.html(tbodyHtml)}else{MSApp.execUnsafeLocalFunction(function(){tbody.html(tbodyHtml)})}grid._totalRowCount=grid._getTotalRowCount();grid._avgRowHeight=grid._calculateAvgRowHeight();grid._buildVirtualDomForContinuousVirtualization()}avgRowHeight=grid._calculateAvgRowHeight();if(!grid._persistVirtualScrollTop||!this._avgRowHeight||Math.abs(this._avgRowHeight-avgRowHeight)>1){this._avgRowHeight=avgRowHeight}if(grid._persistVirtualScrollTop&&grid._prevFirstVisibleTRIndex){grid._setScrollContainerHeight(this._avgRowHeight*grid._getTotalRowCount());newFirstVisibleRow=tbody.find('tr[data-row-idx="'+grid._prevFirstVisibleTRIndex+'"]');isScrolledToBottom=grid._getScrollContainerScrollTop()+5>grid._scrollContainer()[0].scrollHeight-grid._scrollContainer().innerHeight();if(isScrolledToBottom){lastVisibleRow=tbody.find("tr:visible:last");grid._setDisplayContainerScrollTop(lastVisibleRow[0].offsetTop)}else{if(newFirstVisibleRow.length>0){grid._setDisplayContainerScrollTop(newFirstVisibleRow[0].offsetTop)}}}}else{if(window.MSApp===undefined){tbody.html(html)}else{MSApp.execUnsafeLocalFunction(function(){tbody.html(html)})}if(grid.options.width===null){grid._setContainerWidth(grid.container())}else{grid._updateGridContentWidth()}if(grid._persistVirtualScrollTop&&grid._prevFirstVisibleTROffset){grid.scrollContainer()[0].scrollTop=grid._prevFirstVisibleTROffset}}scrollContainer=grid._virtualcontainer().length>0?grid._virtualcontainer():grid.scrollContainer();if(this.options.groupedColumns.length>0&&scrollContainer.length>0&&grid.element.width()>scrollContainer.width()&&(grid.options.virtualization===true||grid.options.rowVirtualization===true)){$(grid.element).find(">colgroup>col[data-skip=true]").each(function(){dataSkipWidth+=parseInt(this.style.width,10)});grid._setGridContentWidth(grid._calculateContainerWidth(false)+dataSkipWidth)}this.grid._trigger(this.grid.events.rowsRendered,null,{owner:this.grid,tbody:tbody})}},_getTotalRowCount:function(){if(this.grid.options.virtualization&&this.options.groupedColumns.length>0){if(this.options.initialExpand&&this._groupedRows){return this._groupedRows.length}if(!this.options.initialExpand&&this._visibleGroupedRows){return this._visibleGroupedRows.length}}return this._getTotalRowCountHandler()},_calculateAvgRowHeight:function(){var rowHeightSum=this.grid.container().find("#"+this.grid.id()+" > tbody").height();if(rowHeightSum===0){rowHeightSum=parseInt(this.options.height,10)}if(this.options.groupedColumns.length>0){return rowHeightSum/this._virtualRowCount}return rowHeightSum/this.grid._virtualRowCount},_processGroupsRecursive:function(i,ds,tbody,d,idval,start,end,firstTime){var index,tmpSum=0,j,tmpCount=start,tmpStart=start,k,arr,arrLength,cssClass,gcval=this.options.groupedColumns[i].key,cs;if(ds.length===0){return}idval=this.grid.dataSource.getCellValue(gcval,ds[tmpCount]);cs=this._settingFromKey(gcval);firstTime=true;if(!(this.options.indentation&&this.options.indentation.indexOf&&this.options.indentation.indexOf("%")!==-1)){this._indent=parseInt(this.options.indentation,10)*(i+1)}for(j=start;j<end;j++){if(j<tmpCount||tmpCount>=end){continue}if(!this._cmp(cs,this.grid.dataSource.getCellValue(gcval,ds[tmpCount]),idval)||firstTime){firstTime=false;idval=this.grid.dataSource.getCellValue(gcval,ds[tmpCount]);if(cs.customGroupName){index=this._renderGroupRow(d,i,gcval,idval,cs.customGroupName,cs,ds[tmpCount])}else{index=this._renderGroupRow(d,i,gcval,idval,null,cs,ds[tmpCount])}tmpStart=tmpCount;if(this.options.groupedColumns.length-1>i){while(tmpCount<end&&this._cmp(cs,this.grid.dataSource.getCellValue(gcval,ds[tmpCount]),idval)){tmpCount++;tmpSum++}this._rs(gcval,idval,index,tmpSum,tmpStart,tmpCount,ds,d);tmpSum=0;this._processGroupsRecursive(i+1,ds,tbody,d,idval,j,tmpCount,firstTime)}else{arr=[];while(tmpCount<end&&this._cmp(cs,this.grid.dataSource.getCellValue(gcval,ds[tmpCount]),idval)){tmpCount++;tmpSum++;this._renderRecord(d,tbody,ds[tmpCount-1],tmpCount-1,this.options.initialExpand,arr)}arrLength=arr.length;for(k=0;k<arrLength;k++){cssClass=this.css.nonGroupRowEmptyCell;if(k===arrLength-1){cssClass+=" "+this.css.groupByLastEmptyCell}d[arr[k]]+='<td class="'+cssClass+'" data-skip="true"></td>'}this._rs(gcval,idval,index,tmpSum,tmpStart,tmpCount,ds,d);tmpSum=0}}}},_rs:function(gcval,idval,index,tmpSum,tmpStart,tmpCount,ds,d){var subdata,res;res=this._calcRealSum(gcval,idval,tmpSum,ds);d[index]=d[index].replace(new RegExp("__sum__","g"),res.sum);if(d[index].indexOf("$$value$$")!==-1){subdata=ds.slice(tmpStart,tmpCount);d[index]=this._calcRealSummary(d[index],gcval,idval,subdata,res.allGroupData)}},_cmp:function(cs,val1,val2){var res,o=this.grid.options,enableUTCDates=o.enableUTCDates,rowTemplate=!o.rowTemplate||o.rowTemplate.length<=0,format,key,col;if(cs.groupComparerFunction){if(typeof cs.groupComparerFunction==="function"){res=cs.groupComparerFunction(cs,val1,val2)}else{res=window[cs.groupComparerFunction](cs,val1,val2)}return res}if($.type(val1)==="date"&&$.type(val2)==="date"){key=cs.columnKey;if(key!==undefined&&key!==null){col=this.grid.columnByKey(key);if(col!==undefined&&col!==null){format=col.format}}return $.ig.formatter(val1,"date",format,rowTemplate,enableUTCDates)===$.ig.formatter(val2,"date",format,rowTemplate,enableUTCDates)}return val1===val2},_encodeSummaryParams:function(owner,params){var cs=this.options.columnSettings,i,j,key;for(i=0;i<cs.length;i++){if(cs[i].summaries&&cs[i].summaries.length>0){for(j=0;j<cs[i].summaries.length;j++){key="gs("+cs[i].columnKey+")";if(params.extraParams[key]){params.extraParams[key]=params.extraParams[key]+","+cs[i].summaries[j].summaryFunction}else{params.extraParams[key]=cs[i].summaries[j].summaryFunction}}}}},_calcRealSummary:function(contents,gcval,idval,subdata,allGroupData){var n,k,i,cs,j,mdata=this.grid.dataSource.metadata(this.options.resultResponseKey),o,str=contents,val,found=false,mul=1,t,kVal;n=this.grid.dataSource.data();if(mdata&&mdata!==null){cs=this.options.columnSettings;for(i=0;i<cs.length;i++){for(j=0;j<cs[i].summaries.length;j++){o=mdata[cs[i].columnKey+"_"+cs[i].summaries[j].summaryFunction];for(k in o){if(o.hasOwnProperty(k)){t=this.grid.columnByKey(gcval).dataType;if(t==="bool"&&$.type(k)==="string"){kVal=k.toLowerCase()==="true"?true:false}else if(t==="number"&&$.type(k)==="string"){kVal=mul*k}else{kVal=k}if(idval!==null&&!idval.length&&idval===kVal*mul||kVal===idval){val=o[k];val=$.ig.formatter(val,"number",this.options.summarySettings.summaryFormat);if(cs[i].summaries[j].customSummary===undefined||cs[i].summaries[j].customSummary===null){str=str.replace(cs[i].columnKey+cs[i].summaries[j].summaryFunction+"$$value$$",val)}}}}}}}if(!found||this.grid.dataSource.dataView().length<n.length){return this._summaries(str,subdata,gcval,allGroupData)}},_calcRealSum:function(gcval,idval,sum,ds){var tmpSum=0,k,n,setting,mul=1,metadata,t,arrGrp=[],nVal,grpRecs,i,grpCols=this.options.groupedColumns;setting=this._settingFromKey(gcval);metadata=this.grid.dataSource.metadata(this.options.resultResponseKey);if(metadata&&metadata[gcval]){k=metadata[gcval];for(n in k){if(k.hasOwnProperty(n)){t=this.grid.columnByKey(gcval).dataType;if(t==="bool"&&$.type(n)==="string"){nVal=n.toLowerCase()==="true"?true:false}else if(t==="number"&&$.type(n)==="string"){nVal=mul*n}else{nVal=n}if(idval!==null&&idval!==undefined&&!idval.length&&idval===nVal*mul){tmpSum=k[n]}else if(nVal===idval){tmpSum=k[n]}}}}else if(ds.length<this.grid.dataSource.data().length){tmpSum=0;if(gcval===grpCols[0].key){this._grpRecords={}}else{this._grpRecords=this._grpRecords||{};for(i=0;i<grpCols.length;i++){if(grpCols[i].key===gcval&&i>0){grpRecs=this._grpRecords[grpCols[i-1].key];break}}}if(!grpRecs){if(this.grid.dataSource._filter&&this.grid.dataSource._filteredData&&this.options.type==="local"){n=this.grid.dataSource._filteredData}else{n=this.grid.dataSource.data()}}else{n=grpRecs}arrGrp=this.getGroupedData(n,gcval,idval,setting);tmpSum=arrGrp.length;this._grpRecords[gcval]=arrGrp}return{sum:tmpSum>0?tmpSum:sum,allGroupData:arrGrp}},getGroupedData:function(data,colKey,idval,setting){var idx,k,len=data.length,arrGrp=[];setting=setting||this._settingFromKey(colKey);for(k=0;k<len;k++){if(this._cmp(setting,data[k][colKey],idval)){idx=k;break}}for(k=idx;k<len;k++){if(this._cmp(setting,data[k][colKey],idval)){arrGrp.push(data[k])}else{break}}return arrGrp},_settingFromKey:function(key){var cs,j;for(j=0;j<this.options.columnSettings.length;j++){if(this.options.columnSettings[j].columnKey===key){cs=this.options.columnSettings[j]}}return cs},_renderGroupRow:function(arr,indent,field,val,customName,colCustomSetting,record){var expcell,textcell,col,margin=indent>0?parseInt(this.options.indentation,10)*indent:0,text,state,css,i,cs=this.options.columnSettings,shtml="",tmpl,title,j,hide=false,grpRowId;if(this.options.initialExpand){css=this.css.groupByExpandCellExpanded;title=this.options.collapseTooltip}else{css=this.css.groupByExpandCellCollapsed;title=this.options.expandTooltip;if(indent>0){hide=true}}if(this.options.expansionIndicatorVisibility){expcell='<td class="'+this.css.groupByExpandColumn+'" gbexpandcell="1"'+' tabindex="'+this.grid.options.tabIndex+'"><span class="ui-iggrid-expandbuttoncontainer-group-by" style="margin-left:'+margin+'px;"><span class="'+css+'" title="'+title+'"></span></span></td>'}else{expcell='<td class="'+this.css.groupByExpandColumn+'" gbexpandcell="1"></td>'}tmpl=this.options.groupedRowTextTemplate;col=this.grid.columnByKey(field);if(colCustomSetting&&colCustomSetting.groupLabelFormatter){if(typeof colCustomSetting.groupLabelFormatter==="function"){val=colCustomSetting.groupLabelFormatter(val)}else{val=window[colCustomSetting.groupLabelFormatter](val)}}else if(this.options.useGridColumnFormatter===true){val=this.grid._renderCell(val,col,record," ")}tmpl=tmpl.replace(new RegExp("\\$\\{key\\}","g"),col.headerText);if(customName){text=tmpl.replace(new RegExp("\\$\\{val\\}","g"),customName).replace(new RegExp("\\$\\{count\\}","g"),"__sum__")}else{text=tmpl.replace(new RegExp("\\$\\{val\\}","g"),val).replace(new RegExp("\\$\\{count\\}","g"),"__sum__")}if(this.options.initialExpand){state="expanded"}else{state="collapsed"}for(i=0;i<cs.length;i++){for(j=0;j<cs[i].summaries.length;j++){shtml+=" "+cs[i].columnKey+" "+(cs[i].summaries[j].text||cs[i].summaries[j].summaryFunction)+" "+cs[i].columnKey+cs[i].summaries[j].summaryFunction+"$$value$$";if(j!==cs[i].summaries.length-1){shtml+=this.options.summarySettings.multiSummaryDelimiter}}}text+=shtml;textcell='<td data-gbsummary="true" colspan="'+this._colspan+'" tabindex="'+this.grid.options.tabIndex+'">'+text+"</td>";grpRowId=this.grid.options.primaryKey||record.hasOwnProperty("ig_pk")?$.ig.util.getCheckSumForObject({text:text}):null;arr.push('<tr class="'+this.grid.css.recordClass+" "+this.css.groupedRow+'" data-grouprow="true" data-state="'+state+'" data-glevel="'+indent+'"'+(hide?' style="display:none;"':"")+' aria-expanded="'+(state==="expanded"?"true":"false")+'"'+' aria-describedby="'+this.grid.id()+"_"+col.key+'"'+' title="'+$.ig.GridGroupBy.locale.summaryRowTitle+'"'+(grpRowId?' data-id="'+grpRowId+'"':"")+' tabindex="'+this.grid.options.tabIndex+'" >'+expcell+textcell+"</tr>");return arr.length-1},_renderRecord:function(d,tbody,data,rowIndex,expand,arr){var i,j,dLen,lastIndex=d.length;this.grid._renderRecordInArray(d,tbody,data,rowIndex);dLen=d.length;for(i=lastIndex;i<dLen;i++){if(d[i].indexOf&&d[i].indexOf("<tr")!==-1){if(!expand){d[i]=d[i]+' style="display: none;"'}for(j=i;j<dLen;j++){if(d[j].indexOf&&d[j].indexOf("data-grouprow")!==-1){break}if(d[j].indexOf&&d[j].indexOf(">")!==-1){arr.push(j);break}}break}}},_renderNewRow:function(rec){var tbody=this.grid.element.children("tbody"),dataRows=tbody.children("tr:not([data-container='true'],[data-grouprow='true'])"),index=dataRows.length,row,ind,i;row=$(this.grid._renderRecord(rec,index));ind=dataRows.last().find("td."+this.css.nonGroupRowEmptyCell).removeClass(this.css.groupByLastEmptyCell).length;for(i=0;i<ind;i++){$("<td></td>").addClass(this.css.nonGroupRowEmptyCell).addClass(this.css.groupByLastEmptyCell).attr("data-skip",true).prependTo(row)}MSApp.execUnsafeLocalFunction(function(){tbody.append(row)})},_summaries:function(contents,data,gcval,allGroupData){var i,j,cs=this.options.columnSettings,s,ret=contents,arr,val,argsData;if(contents&&contents.indexOf&&contents.indexOf("$$value$$")===-1){return contents}for(i=0;i<cs.length;i++){s=cs[i].summaries;if(s.length>0){arr=this._arr(cs[i].columnKey,data);for(j=0;j<s.length;j++){if(s[j].summaryFunction==="custom"){argsData={dataRecords:data,array:arr,key:gcval,allGroupData:allGroupData}}else{argsData=arr}val=$.ig.calcSummaries(s[j].summaryFunction,argsData,s[j].customSummary);val=$.ig.formatter(val,"number",this.options.summarySettings.summaryFormat);ret=ret.replace(cs[i].columnKey+s[j].summaryFunction+"$$value$$",val)}}}return ret},_arr:function(key,data){var arr=[],i;for(i=0;i<data.length;i++){arr.push(data[i][key])}return arr},_dataEmpty:function(event,args){var indent=0,indentation=parseInt(this.options.indentation,10),colGroup,headersColGroup;if(args.owner.id()!==this.grid.id()){return}if(this.options.groupedColumns.length>0){indent+=indentation*this.options.groupedColumns.length;if(this.options.indentation&&this.options.indentation.indexOf&&this.options.indentation.indexOf("%")>=0){indent=this.options.indentation}colGroup=args.owner.element.children("colgroup");headersColGroup=this.grid.headersTable().children("colgroup");if(colGroup.children("[data-registeredCol=true]").length===0&&headersColGroup.children("[data-registeredCol=true]").length===0){$("<col />").prependTo(colGroup).attr("data-skip","true").attr("data-registeredCol","true").width(indent)}else{colGroup.children("col:nth-child(1)").width(indent)}}if(this._isgroup!==null&&this._isgroup!==undefined&&parseInt(this.grid.container().width(),10)>0&&!this.grid.options.width){if(this._isgroup===true){if(this.grid.options.virtualization!==true){this.grid.container().width(parseInt(this.grid.container().width(),10)+indentation)}}else{this.grid.container().width(parseInt(this.grid.container().width(),10)-indentation);indentation*=-1}if(this.grid.options.virtualization===true&&this.grid.options.virtualizationMode==="continuous"){this.grid._setDisplayContainerWidth(this.grid._getDisplayContainerWidth()+indentation);this.grid._setVHeadersWidth(this.grid._getVHeadersWidth()+indentation)}this._isgroup=null}this._tbody=args.tbody;if(!this._isgroup&&this.groupByColumns().length>0){this._groupAreaList()}event.stopPropagation()},_checkGroupExists:function(key){var exists=false,i;for(i=0;i<this.options.groupedColumns.length;i++){if(this.options.groupedColumns[i].key===key){exists=true;break}}return exists},_groupBy:function(event,th){var noCancel,key,layout,cgrid,fc,eArgs,exists=false;layout=th.attr("data-layout");if(layout){cgrid=$("#"+th.attr("data-grid-id")).data("igGrid");key=cgrid.options.columns[th.data("columnIndex")].key}else{if(th.data("columnIndex")===null||th.data("columnIndex")===undefined){return}key=this.grid.options.columns[th.data("columnIndex")].key;cgrid=this.grid}fc=this.grid.element.data("igGridFeatureChooser");if(fc!==undefined&&fc!==null){fc._setSelectedState("GroupBy",key,true,false)}if(!layout){exists=this._checkGroupExists(key)}if(exists){return}eArgs={owner:this,groupedColumns:this.options.groupedColumns,key:key,layout:layout,grid:cgrid,triggeredBy:"dragAndDrop"};noCancel=this._trigger(this.events.groupedColumnsChanging,event,eArgs);if(noCancel){this.groupByColumn(key,layout);this._trigger(this.events.groupedColumnsChanged,event,eArgs)}},groupByColumns:function(){var gc=[];if(this._hierarchical){gc=this._orderedGroupedCols}else{gc=this.options.groupedColumns}return gc},_ensureLabelsOrder:function(from,to,layout){var i,key=layout?layout.key:null;for(i=0;i<from.length;i++){if((from[i].layout===key||!from[i].layout&&!key)&&!this._exists(to,from[i])){to.push(from[i])}}for(i=0;layout.columnLayouts&&i<layout.columnLayouts.length;i++){this._ensureLabelsOrder(from,to,layout.columnLayouts[i])}},_exists:function(arr,layout){var i;for(i=0;i<arr.length;i++){if((arr[i].layout===layout.layout||!arr[i].layout&&!layout.layout)&&arr[i].key===layout.key){return true}}return false},_findLayout:function(layout,opts,layouts){var i;if(opts.key===layout){layouts.push(opts)}else if(!layout){layouts.push(this.grid.options)}else{for(i=0;opts.columnLayouts&&i<opts.columnLayouts.length;i++){this._findLayout(layout,opts.columnLayouts[i],layouts)}}},_isGroupColumn:function(key,layout,gc){var i,gcLen=gc.length;for(i=0;i<gcLen;i++){if(gc[i].key===key&&gc[i].layout===layout){return true}}return false},_allGroupedCols:function(gc){var i,j,key,layout,isToAdd;for(i=0;i<this.options.groupedColumns.length;i++){key=this.options.groupedColumns[i].key;layout=this.options.groupedColumns[i].layout;isToAdd=true;for(j=0;j<gc.length;j++){if(key===gc[j].key&&layout===gc[j].layout){this.options.groupedColumns[i]=gc[j];isToAdd=false;break}}if(isToAdd){gc.push(this.options.groupedColumns[i])}}this._addGroupsRecursive(gc,this.grid.options.columnLayouts)},_addGroupsRecursive:function(gc,layouts){var i,j,gb,col,k,persist;if(!layouts){return}for(i=0;i<layouts.length;i++){for(j=0;layouts[i].features&&j<layouts[i].features.length;j++){if(layouts[i].features[j].name==="GroupBy"){gb=layouts[i].features[j];break}}if(gb){persist=gb.persist||this.options.persist;for(j=0;gb.columnSettings&&gb.columnSettings.length&&j<gb.columnSettings.length;j++){if(gb.columnSettings[j].isGroupBy){if(persist&&gb.columnSettings[j].columnKey){if(this._isGroupColumn(gb.columnSettings[j].columnKey,layouts[i].key,gc)){continue}}for(k=0;k<layouts[i].columns.length;k++){if(layouts[i].columns[k].key===gb.columnSettings[j].columnKey||gb.columnSettings[j].columnIndex===k){col=layouts[i].columns[k];break}}gc.push({key:gb.columnSettings[j].columnKey||col.key,layout:layouts[i].key,dir:gb.columnSettings[j].dir,col:col})}}}gb=null;this._addGroupsRecursive(gc,layouts[i].columnLayouts)}},_getColumnByLayoutKey:function(key,columns){var c,i;if(this.grid._isMultiColumnGrid){for(i=0;i<columns.length;i++){if(columns[i].key===key){c=columns[i];break}if(columns[i].group!==undefined&&columns[i].group!==null){c=this._getColumnByLayoutKey(key,columns[i].group);if(c!==undefined&&c!==null){break}}}}else{for(i=0;i<columns.length;i++){if(columns[i].key===key){c=columns[i];break}}}return c},groupByColumn:function(key,layout,sortingDirection){var i,expr,gexpr,lobj,c,fcs,setting,layouts,exists=this._checkGroupExists(key),copy,dir="asc";this.grid._onGroupedColumnsChanging(this.options.groupedColumns);if(sortingDirection!==undefined&&sortingDirection!==null){dir=sortingDirection}else if(this.options.defaultSortingDirection!==undefined){dir=this.options.defaultSortingDirection}if(!layout&&exists){return}if(layout){layouts=[];this._findLayout(layout,this.grid.options,layouts);lobj=layouts[0];c=this._getColumnByLayoutKey(key,lobj.columns)}else{lobj=this.grid.options;c=this.grid.columnByKey(key)}if(layout){if(!lobj.features){lobj.features=[];lobj.features.push({name:"GroupBy",columnSettings:[]});fcs=lobj.features[0].columnSettings}else{for(i=0;i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){fcs=lobj.features[i].columnSettings;if(!fcs){lobj.features[i].columnSettings=[];fcs=lobj.features[i].columnSettings}break}}}for(i=0;i<fcs.length;i++){if(fcs[i].columnKey===key){if(fcs[i].isGroupBy){return}setting=fcs[i];break}}if(!setting){fcs.push({columnKey:key,isGroupBy:true,dir:dir})}else{setting.isGroupBy=true}}expr={fieldName:key,dir:dir,layout:layout,isGroupBy:true};gexpr={key:key,dir:dir,layout:layout,col:c};if(!layout){this.options.groupedColumns.push(gexpr)}this._orderedGroupedCols.push(gexpr);copy=this._orderedGroupedCols.slice(0);this._orderedGroupedCols=[];this._ensureLabelsOrder(copy,this._orderedGroupedCols,this.grid.options);this.grid._trigger("headerExtraCellsModified",null,{owner:this});
this._addSortingExpressions(this.grid.dataSource.settings.sorting.expressions,expr);if(!layout){this._isgroup=true}this._rebind();this.grid._onGroupedColumnsChanged(this.options.groupedColumns)},_addSortingExpressions:function(se,expr){var i,seLength=se.length,found=-1,layout=expr.layout,key=expr.fieldName;for(i=0;i<seLength;i++){if(se[i].fieldName===key&&(!layout&&!se[i].layout||layout&&layout===se[i].layout)){if(se[i].isSorting){expr.isSorting=true}se.splice(i,1);break}}seLength=se.length;for(i=0;i<seLength;i++){if(se[i].isGroupBy===true){found=i}else{break}}if(found===-1){se.unshift(expr)}else{se.splice(found+1,0,expr)}},ungroupByColumn:function(key,layout){var i,fc,self=this,exprs=this.grid.dataSource.settings.sorting.expressions,lobj,fcs,layouts,exists=this._checkGroupExists(key),copy;if(!layout&&!exists){return}this.grid._onGroupedColumnsChanging(this.options.groupedColumns);if(layout){layouts=[];this._findLayout(layout,this.grid.options,layouts);lobj=layouts[0]}else{lobj=this.grid.options}fc=this.grid.element.data("igGridFeatureChooser");if(fc!==undefined&&fc!==null){fc._setSelectedState("GroupBy",key,false,false)}for(i=0;i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){fcs=lobj.features[i].columnSettings;break}}for(i=0;fcs&&i<fcs.length;i++){if(fcs[i].columnKey===key){fcs[i].isGroupBy=false}}if(!layout){for(i=0;i<this.options.groupedColumns.length;i++){if(this.options.groupedColumns[i].key===key){$.ig.removeFromArray(this.options.groupedColumns,i);break}}}for(i=0;i<this._orderedGroupedCols.length;i++){if(this._orderedGroupedCols[i].key===key&&(this._orderedGroupedCols[i].layout&&this._orderedGroupedCols[i].layout===layout||!this._orderedGroupedCols[i].layout&&(layout===""||layout===undefined))){$.ig.removeFromArray(this._orderedGroupedCols,i);break}}for(i=0;i<exprs.length;i++){if(exprs[i].fieldName===key&&(!layout||layout&&layout===exprs[i].layout)){if(exprs[i].isSorting){exprs[i].isGroupBy=undefined}else{$.ig.removeFromArray(exprs,i)}}}copy=this._orderedGroupedCols.slice(0);this._orderedGroupedCols=[];this._ensureLabelsOrder(copy,this._orderedGroupedCols,this.grid.options);this.grid._trigger("headerExtraCellsModified",null,{owner:this});this.grid.element.children("tbody").hide();if(document.documentMode===8){this.grid.element.hide();this.grid.headersTable().hide()}if(!layout&&this.options.groupedColumns.length===0){this.grid.element.find("colgroup").children().first().remove();if(this.grid.options.fixedHeaders){this.grid.headersTable().find("colgroup").children().first().remove()}if(this.grid.options.fixedFooters&&this.grid.options.height!==null){this.grid.footersTable().find("colgroup").children().first().remove()}this.grid.headersTable().find("thead tr").children("[data-skip]").first().remove()}if(!layout){this._isgroup=false}this._rebind();if(document.documentMode===8){this.grid.headersTable().show();this.grid.element.show()}if(this.options.groupedColumns.length===0){if(window.mozInnerScreenX!==undefined&&self.grid.options.fixedFooters===true){self.grid.footersTable().hide();setTimeout(function(){self.grid.footersTable().show()},0)}this._setGroupAreaTextContent($(".ui-iggrid-groupbyarea .ui-iggrid-groupbyareatext",this.grid.container()));if(this.grid.options.width!==null&&this.grid.options.width!==undefined){this.grid._updateGridContentWidth()}}this.grid._onGroupedColumnsChanged(this.options.groupedColumns)},_clearSettings:function(layouts){var i,j,cs,k;for(i=0;i<layouts.length;i++){if(layouts[i].features&&layouts[i].features.length){for(j=0;j<layouts[i].features.length;j++){if(layouts[i].features[j].name==="GroupBy"){cs=layouts[i].features[j].columnSettings;if(cs){for(k=0;k<cs.length;k++){cs[k].isGroupBy=false}}}}}if(layouts[i].columnLayouts){this._clearSettings(layouts[i].columnLayouts)}}},ungroupAll:function(){var indent=0,i,layouts=this.grid.options.columnLayouts,cols=this.groupByColumns(),hasRoot=false;if(cols.length===0){return}this.grid._onGroupedColumnsChanging(this.options.groupedColumns);for(i=1;i<this.options.groupedColumns.length;i++){indent+=parseInt(this.options.indentation,10)}if(parseInt(this.grid.container().width(),10)>0&&!this.grid.options.width){this.grid.container().width(parseInt(this.grid.container().width(),10)-indent)}this.grid.dataSource.settings.sorting.expressions=[];this.options.groupedColumns=[];this._orderedGroupedCols=[];if(!this._hierarchical){cols=[]}else{for(i=0;i<cols.length;i++){if(!cols[i].layout){hasRoot=true;break}}if(hasRoot){cols=[]}}if(layouts){this._clearSettings(layouts)}if(this.options.groupedColumns.length===0&&cols.length===0){this.grid.element.find("colgroup").children().first().remove();if(this.grid.options.fixedHeaders){this.grid.headersTable().find("colgroup").each(function(){$(this).children("[data-skip]").first().remove()})}if(this.grid.options.fixedFooters){this.grid.footersTable().find("colgroup").each(function(){$(this).children("[data-skip]").first().remove()})}this.grid.headersTable().find("thead tr").each(function(){$(this).children("[data-skip]").first().remove()});this.grid.footersTable().find("tfoot tr").each(function(){$(this).children("[data-skip]").first().remove()})}this._isgroup=false;this._rebind();if(this.options.groupedColumns.length===0){if(this.grid.options.width!==null&&this.grid.options.width!==undefined){this.grid._updateGridContentWidth()}}this.grid._onGroupedColumnsChanged([])},_regroup:function(){var items=$(".ui-iggrid-groupbyarea",this.grid.container()).find("ul li"),groupby=this,i,copy,gbObj,eArgs,noCancel,sExprs=[],gbExprs=[];this.options.groupedColumns=[];this.grid.dataSource.settings.sorting.expressions=[];copy=this._orderedGroupedCols.slice(0);this._orderedGroupedCols=[];items.each(function(){var direction,k,layout,c,lobj,layouts=[],sExpr;k=$(this).attr("data-key");layout=$(this).attr("data-layout");direction=$(this).find(".ui-iggrid-asc").length>0?"asc":"desc";if(layout){groupby._findLayout(layout,groupby.grid.options,layouts);lobj=layouts[0];for(i=0;lobj&&i<lobj.columns.length;i++){if(lobj.columns[i].key===k){c=lobj.columns[i];break}}}else{c=groupby.grid.columnByKey(k)}gbObj={key:k,dir:direction,col:c,layout:layout};sExpr={fieldName:k,dir:direction,isGroupBy:true};if(layout){sExpr.layout=layout}gbExprs.push(gbObj);sExprs.push(sExpr)});eArgs={owner:this,groupedColumns:gbExprs,triggeredBy:"regroup"};noCancel=this._trigger(this.events.groupedColumnsChanging,null,eArgs);if(noCancel){for(i=0;i<gbExprs.length;i++){groupby._addSortingExpressions(groupby.grid.dataSource.settings.sorting.expressions,sExprs[i]);groupby._orderedGroupedCols.push(gbExprs[i]);if(!gbExprs[i].layout){groupby.options.groupedColumns.push(gbExprs[i])}}groupby._ensureLabelsOrder(copy,groupby._orderedGroupedCols,groupby.grid.options);this.grid._loadingIndicator.show();this._rebindDataSource();this._trigger(this.events.groupedColumnsChanged,null,eArgs)}},_rebind:function(){this._scrolltop=$(window).scrollTop();this.grid._loadingIndicator.show();this._saveSortingExpressions();this._rebindDataSource();this._groupAreaList()},_rebindDataSource:function(){var ds=this.grid.dataSource;if(this.options.type==="remote"){ds.dataBind()}else{if(ds.settings.sorting.expressions.length===0){this.grid.dataBind()}else{ds.sort(ds.settings.sorting.expressions);this.grid._renderData()}}},_renderPartialRecords:function(parentrow){if(parentrow.attr("data-loaded")){return}var dataRowId,rows,html="",i,rowsLength,scrollerHeight;dataRowId=parseInt(parentrow.attr("data-row-idx"),10);if(dataRowId>=0){rows=this._groups[dataRowId]}if(!rows){return}rowsLength=rows.length;for(i=0;i<rowsLength;i++){html+=rows[i]}$(html).insertAfter(parentrow);scrollerHeight=this.grid._getScrollContainerHeight();this._addScrollHeight=parentrow.outerHeight()*rowsLength;this.grid._setScrollContainerHeight(scrollerHeight+this._addScrollHeight);parentrow.attr("data-loaded",true)},_onKeyDownGroup:function(event){var $target;if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){$target=$(event.target);this._toggleGroup(event);event.preventDefault();event.stopPropagation();$target.focus()}},_toggleGroup:function(event){var parentrow=$(event.target).closest("tr"),grid,i,el,currentLevel,cindex,glevel=parentrow.attr("data-glevel"),grouprow,rowPath=[],level=glevel,style,owner=this;cindex=parentrow.index();if(this._hierarchical){grid=parentrow.closest(".ui-iggrid-table").data("igGrid")}else{grid=this.grid}if(parentrow.attr("data-state")==="expanded"){parentrow.attr("data-state","collapsed").attr("aria-expanded","false").find(".ui-iggrid-expandbutton").attr("title",this.options.expandTooltip).removeClass(this.css.groupByExpandCellExpanded).addClass(this.css.groupByExpandCellCollapsed)}else{parentrow.attr("data-state","expanded").attr("aria-expanded","true").find(".ui-iggrid-expandbutton").attr("title",this.options.collapseTooltip).removeClass(this.css.groupByExpandCellCollapsed).addClass(this.css.groupByExpandCellExpanded);if(!this.options.initialExpand){this._renderPartialRecords(parentrow)}}rowPath[glevel]=parentrow;grid.element.children("tbody").children().each(function(index){if(index>cindex){var $this=$(this);grouprow=$this.attr("data-grouprow");level=$this.attr("data-glevel");if(grouprow==="true"&&level<=glevel){return false}if(grouprow){currentLevel=level}else{currentLevel=parseInt(rowPath[rowPath.length-1].attr("data-glevel"),10)+1}style="";for(i=0;i<currentLevel;i++){if(rowPath[i]!==undefined&&rowPath[i].attr("data-state")!=="expanded"){style="none";break}}$this.css("display",style);if(style!=="none"){owner._expandedRowCount++}else{owner._expandedRowCount--}if(grouprow){rowPath[parseInt($this.attr("data-glevel"),10)]=$this}}});if(this._expandedRowCount>0){this._virtualRowCount=this.grid._determineVirtualRowCount(this._groupedRows,this.grid._getDisplayContainerHeight());this._avgRowHeight=this.grid._calculateAvgRowHeight();this.grid._setScrollContainerHeight(this.grid._getScrollContainerHeight()+this._avgRowHeight*this._expandedRowCount)}else{this._virtualRowCount=this.grid._determineVirtualRowCount(this._groupedRows,this.grid._getDisplayContainerHeight());this._avgRowHeight=this.grid._calculateAvgRowHeight();this.grid._setScrollContainerHeight(this._avgRowHeight*this.grid._getTotalRowCount())}for(el in rowPath){if(rowPath.hasOwnProperty(el)){el=null;$.ig.removeFromArray(rowPath,el)}}this.grid._adjustLastColumnWidth(false);event.stopPropagation()},_groupAreaList:function(){var area=$(".ui-iggrid-groupbyarea",this.grid.container()),layout,allgrouped=[],dropFunc,mousedownFunc,list=area.find("ul"),i,groupby=this,css,key,item,itemEdge,helperFunc,overFunc,outFunc,text;allgrouped=this.groupByColumns();if(list.length>0){list.empty()}else{list=$("<ul></ul>").appendTo(area).addClass("ui-iggrid-grouparealist")}helperFunc=function(event){var li=null;if($(event.target).is("li")){li=$(event.target)}else{li=$(event.target).closest("li")}li=li.clone();li.find(".ui-iggrid-groupbylabelrightedgeend").remove();li.find(".ui-iggrid-groupbylabelrightedge").remove();li.find(".ui-iggrid-groupbyremovebutton").remove();li.attr("data-dragging",true);return li};overFunc=function(event,ui){var $li;if(!ui.draggable.hasClass("ui-iggrid-groupedcolumnlabel")){return false}if(ui.draggable.attr("data-key")===$(this).attr("data-key")){return false}if(groupby._thOver){$li=ui.draggable.closest("ul").find("li[data-key="+groupby._thOver+"]");if($li.length>0&&$li.hasClass("ui-iggrid-groupbydroppableedge")){$li.removeClass("ui-iggrid-groupbydroppableedge")}}groupby._thOver=$(event.target).attr("data-key");$(event.target).addClass("ui-iggrid-groupbydroppableedge")};outFunc=function(event,ui){if(!ui.draggable.hasClass("ui-iggrid-groupedcolumnlabel")){return false}if(ui.draggable.attr("data-key")===$(this).attr("data-key")){return false}$(event.target).removeClass("ui-iggrid-groupbydroppableedge")};dropFunc=function(event,ui){var parent,$dragged,$target;$(this).removeClass("ui-iggrid-groupbydroppableedge");if(!ui.draggable.hasClass("ui-iggrid-groupedcolumnlabel")){return}if(ui.draggable.attr("data-key")!==$(this).attr("data-key")){parent=$(this).closest("ul");$target=$(this);$dragged=ui.draggable;if($dragged.index()>$target.index()){$dragged.insertBefore($target)}else{$dragged.insertAfter($target)}parent.find("li[data-dragging=true]").remove();parent.find("li").removeClass("ui-iggrid-groupbydroppableedge");groupby._regroup();groupby._groupAreaList();event.preventDefault();event.stopPropagation();return false}return};mousedownFunc=function(event){event.preventDefault();event.stopPropagation();return false};for(i=0;i<allgrouped.length;i++){key=allgrouped[i].key;layout=allgrouped[i].layout;text=allgrouped[i].col.headerText;if(allgrouped[i].dir==="asc"){css="ui-iggrid-asc ui-icon ui-icon-arrowthick-1-n"}else{css="ui-iggrid-desc ui-icon ui-icon-arrowthick-1-s"}item=$("<li></li>").appendTo(list).addClass(this.css.groupedColumnLabel).css("float","left").attr("data-key",key).attr("data-layout",layout||"").bind({mouseup:$.proxy(this._changeSortState,this)}).draggable({containment:"body",appendTo:"parent",distance:5,revert:"invalid",helper:helperFunc}).droppable({accept:"li",tolerance:"touch",over:overFunc,out:outFunc,drop:dropFunc});if(this.options.groupByLabelWidth!==null){item.width(this.options.groupByLabelWidth)}itemEdge=$("<span></span>").appendTo(item).css({"float":"right"}).addClass(this.css.groupedColumnLabel).addClass(this.css.groupedColumnLabelRightEdgeEnd);itemEdge.attr("data-marker","edge");item.prev().find("span[data-marker]").removeClass(this.css.groupedColumnLabelRightEdgeEnd).addClass(this.css.groupedColumnLabelRightEdge);if(layout){$("<span></span>").appendTo(item).text(text).addClass(this.css.groupedColumnLabelText);$("<span></span>").prependTo(item).text(layout).addClass(this.css.groupedColumnLayoutLabel)}else{$("<span></span>").appendTo(item).text(text)}$("<span></span>").appendTo(item).addClass(css);if(!$.ig.util.isTouch){$("<span></span>").appendTo(item).addClass("ui-iggrid-groupbyremovebutton").attr("title",groupby.options.removeButtonTooltip).bind({mouseup:$.proxy(groupby._removeButtonClick,groupby),mousedown:mousedownFunc})}if($.ig.util.isIE7&&item.width()>300){item.width(260)}else{item.width(Math.ceil(item.width())+22)}}list.children().bind({mouseover:$.proxy(this._showRemoveButton,this),mouseout:$.proxy(this._hideRemoveButton,this)})},_changeSortState:function(event){var li=$(event.target).closest("li"),key=li.attr("data-key"),i,layout=li.attr("data-layout"),layouts,eArgs,j,gc=this._orderedGroupedCols,s=this.grid.dataSource.settings.sorting.expressions,settings,lobj,noCancel;for(i=0;i<gc.length;i++){if(gc[i].key===key&&(layout&&layout===gc[i].layout||!layout)){if(gc[i].dir==="asc"){gc[i].dir="desc"}else{gc[i].dir="asc"}for(j=0;j<s.length;j++){if(s[j].fieldName===key&&(layout&&layout===s[j].layout||!layout)){s[j].dir=gc[i].dir;break}}eArgs={owner:this,groupedColumns:gc,key:gc[i].key,triggeredBy:"sortStateChanged"};noCancel=this._trigger(this.events.groupedColumnsChanging,event,eArgs);if(noCancel){this._rebind();this._trigger(this.events.groupedColumnsChanged,event,eArgs)}break}}if(layout){layouts=[];this._findLayout(layout,this.grid.options,layouts);lobj=layouts[0];for(i=0;lobj.features&&i<lobj.features.length;i++){if(lobj.features[i].name==="GroupBy"){settings=lobj.features[i].columnSettings;for(j=0;j<settings.length;j++){if(settings[j].columnKey===key){settings[j].dir=settings[j].dir==="asc"?"desc":"asc";break}}break}}this._rebind()}},_showRemoveButton:function(event){var button=$(event.target).closest("li").find(".ui-iggrid-groupbyremovebutton"),key=$(event.target).closest("li").attr("data-key"),layout=$(event.target).closest("li").attr("data-layout");if(!key){return}button.attr("data-key",key).attr("data-layout",layout).addClass("ui-icon ui-icon-circle-close")},_hideRemoveButton:function(event){var button=$(event.target).closest("li").find(".ui-iggrid-groupbyremovebutton");button.removeClass("ui-icon ui-icon-circle-close");$(event.target).closest("li").removeClass("ui-state-hover")},_removeButtonClick:function(event){var key=$(event.target).attr("data-key"),noCancel,layout,eArgs;if(this._isDragging){return}eArgs={owner:this,groupedColumns:this.options.groupedColumns,key:key,triggeredBy:"removeButton"};noCancel=this._trigger(this.events.groupedColumnsChanging,event,eArgs);if(noCancel){layout=$(event.target).attr("data-layout");this.ungroupByColumn(key,layout);this._trigger(this.events.groupedColumnsChanged,event,eArgs)}event.preventDefault();event.stopPropagation();return false},destroy:function(){var modalDialog=$("#"+this.grid.id()+"_groupby_modalDialog");this.grid.container().find(".ui-iggrid-groupbyarea").remove();if(this.grid._initialized){this.ungroupAll()}this._detachEvents(true);modalDialog.igGridModalDialog("getCaptionButtonContainer");modalDialog.remove();$.Widget.prototype.destroy.call(this);return this},_detachEvents:function(isDestroyDraggable){var ths=this.grid.headersTable().find("th"),i;if(isDestroyDraggable===true){for(i=0;i<ths.length;++i){if($(ths[i]).data().draggable){$(ths[i]).draggable("destroy")}}}ths.unbind("mouseover",this._headerMouseOverHandler).unbind("mouseout",this._headerMouseOutHandler);$(document).undelegate("#"+this.grid.id()+"_container td[gbexpandcell=1]","mousedown",this._toggleGroupHandler);$(document).undelegate("#"+this.grid.id()+"_container td[gbexpandcell=1]","keydown",this._onKeyDownGroupHandler);this.grid.element.unbind("iggridheaderrenderedinternal",this._headerRenderedHandler);this.grid.element.unbind("iggriddataempty",this._dataRenderingHandler);this.grid.element.unbind("iggrid_rowsrendering",this._rowsRenderingHandler);this.grid.element.unbind("iggridrowsrendered",this._rowsRenderedHandler);this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.unbind("iggridheadercelldragcancel",this._headerDragCancelHandler);this.grid.element.unbind("iggriduidirty",this._uiDirtyHandler);this.grid.element.unbind("iggriddatabound",this._dataBoundHandler);if(this._columnsCollectionModifiedHandler){this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler)}if(isDestroyDraggable===true){delete this._dataRenderingHandler;delete this._rowsRenderingHandler;delete this._rowsRenderedHandler;delete this._headerCellRenderedHandler;delete this._headerDragCancelHandler;delete this._uiDirtyHandler;delete this._columnsCollectionModifiedHandler}},_initDefaultSettings:function(){var settings=[],key,cs=this.options.columnSettings,i,j,allowGroupBy,isToCheckUnboundColumns=this.grid._hasUnboundColumns===true&&this.options.type==="remote";this._orderedColumnSettings=[];if(this.grid.options.columns&&this.grid.options.columns.length>0){for(i=0;i<this.grid.options.columns.length;i++){allowGroupBy=true;if(isToCheckUnboundColumns&&this.grid.getUnboundColumnByKey(this.grid.options.columns[i].key)!==null){allowGroupBy=false}settings[i]={columnIndex:i,columnKey:this.grid.options.columns[i].key,allowGrouping:allowGroupBy,summaries:[],isGroupBy:false}}}if(settings.length===0&&this.grid.options.autoGenerateColumns&&cs.length>0){for(i=0;i<cs.length;i++){if(!cs[i].columnKey){continue}if(!cs[i].dir){cs[i].dir=this.options.defaultSortingDirection||"asc"}this._orderedColumnSettings.push(cs[i])}}else{for(i=0;i<cs.length;i++){for(j=0;j<settings.length;j++){if(settings[j].columnKey===cs[i].columnKey||settings[j].columnIndex===cs[i].columnIndex){break}}if(j===settings.length){continue}for(key in cs[i]){if(cs[i].hasOwnProperty(key)&&key!=="columnKey"&&key!=="columnIndex"){settings[j][key]=cs[i][key]}}if(settings[j].dir===undefined&&this.options.defaultSortingDirection){settings[j].dir=this.options.defaultSortingDirection}this._orderedColumnSettings.push(settings[j])}}this.options.columnSettings=settings;for(i=0;this.grid._headerInitCallbacks&&i<this.grid._headerInitCallbacks.length;i++){if(this.grid._headerInitCallbacks[i].type==="GroupBy"){$.ig.removeFromArray(this.grid._headerInitCallbacks,i);break}}for(i=0;this.grid._footerInitCallbacks&&i<this.grid._footerInitCallbacks.length;i++){if(this.grid._footerInitCallbacks[i].type==="GroupBy"){$.ig.removeFromArray(this.grid._footerInitCallbacks,i);break}}},_renderExtraFooterCells:function(row,colgroup,prepend){if(this.options.groupedColumns.length>0){if(prepend===true){$("<td></td>").addClass(this.css.footerExtraCell).prependTo(row).attr("data-skip",true)}else{$("<td></td>").addClass(this.css.footerExtraCell).appendTo(row).attr("data-skip",true)}}},_renderExtraHeaderCells:function(row,colgroup,prepend){if(this.options.groupedColumns.length>0){if(prepend===true){$("<td></td>").prependTo(row).addClass(this.css.headerExtraCell).attr("data-skip",true);if(colgroup){$("<col />").prependTo(colgroup).attr("data-skip",true).css("width",this.options.indentation)}}else{$("<td></td>").appendTo(row).addClass(this.css.headerExtraCell).attr("data-skip",true);if(colgroup){$("<col />").appendTo(colgroup).attr("data-skip",true).css("width",this.options.indentation)}}}},_columnsCollectionModified:function(event,args){var colGroup;if(args.owner.id()!==this.grid.id()){return}args.tbody=this.grid.element.children("tbody");if(this.options.groupedColumns.length>0){colGroup=this.grid.headersTable().children("colgroup");if(colGroup.children("[data-registeredCol=true]").length===0){$("<col />").prependTo(colGroup).attr("data-skip","true").attr("data-registeredCol","true").width(this._indent)}else{colGroup.children("col:nth-child(1)").width(this._indent)}if(this.grid.headersTable().attr("id")!==this.grid.element.attr("id")){$("<col />").prependTo(this.grid.element.children("colgroup")).attr("data-skip","true").width(this._indent)}if(this.grid.footersTable().attr("id")!==this.grid.element.attr("id")){$("<col />").prependTo(this.grid.footersTable().children("colgroup")).attr("data-skip","true").width(this._indent)}if(this.grid.options.width===null){this.grid._setContainerWidth(this.grid.container())}else{this.grid._updateGridContentWidth()}}this._dataEmpty(event,args)},_onUIDirty:function(){if(this.options.persist){return}this.ungroupAll()},_saveSortingExpressions:function(){if(this.options.persist){this.grid._savePersistenceData(this.grid.dataSource.settings.sorting.expressions,"sorting");this._groupedColumns=this._orderedGroupedCols;this._optionsGC=this.options.groupedColumns}},_getSortingExpressions:function(){return this.grid._getPersistenceData("sorting")},_restoreGroupBy:function(){var se=this._getSortingExpressions(),col,layouts,lobj,i,key;if(this._groupedColumns){this._orderedGroupedCols=this._groupedColumns}if(this._optionsGC){this.options.groupedColumns=this._optionsGC;if(this.grid._hasUnboundColumns&&this.options.type==="local"){for(i=0;i<this._optionsGC.length;i++){key=this._optionsGC[i].key;if(this._optionsGC[i].layout){layouts=[];this._findLayout(this._optionsGC[i].layout,this.grid.options,layouts);lobj=layouts[0];col=this._getColumnByLayoutKey(key,lobj.columns)}else{col=this.grid.columnByKey(key)}if(col&&col.unbound){this.ungroupByColumn(key,this._optionsGC[i].layout)}}}}if(se){this.grid.dataSource.settings.sorting.expressions=se;this.grid.dataSource.settings.sorting.defaultFields=se}},_onDataBound:function(){if(this.options.groupedColumns.length>0&&this.grid._isDataBoundCalled){this.grid._trigger("headerExtraCellsModified",null,{owner:this})}},_injectGrid:function(gridInstance){var i,gc,gcsort,s,root=null,orderedGrouped=null,layoutGrouped=null;this.grid=gridInstance;this._checkGridNotSupportedFeatures();if(this.options.type===null){this.options.type=this.grid._inferOpType()}root=this.element.closest(".ui-iggrid-root");if(this.options.persist&&this.options.type==="remote"&&root.data("igGrid")){this.options.persist=false}if(root.is("div")){root=root.find("#"+root.attr("id")+"_table")}root=root.data("igGridGroupBy");if(root){orderedGrouped=root._orderedGroupedCols;if(orderedGrouped&&orderedGrouped.length>0&&this.grid.options.key){layoutGrouped=[];for(i=0;i<orderedGrouped.length;i++){if(this.grid.options.key===orderedGrouped[i].layout){layoutGrouped.push(orderedGrouped[i])}}}}for(i=0;i<this.grid.options.features.length;i++){if(this.grid.options.features[i].name==="ColumnMoving"){this._movingEnabled=true;break}}this._dataBoundHandler=$.proxy(this._onDataBound,this);this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._dataRenderingHandler=$.proxy(this._dataEmpty,this);this._toggleGroupHandler=$.proxy(this._toggleGroup,this);this._onKeyDownGroupHandler=$.proxy(this._onKeyDownGroup,this);this._rowsRenderingHandler=$.proxy(this._renderRecords,this);this._rowsRenderedHandler=$.proxy(this._recordsRendered,this);this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this._headerDragCancelHandler=$.proxy(this._headerCellDragCancel,this);if(this.grid.options.virtualization===true&&this.grid.options.virtualizationMode==="continuous"){this._rebuildVirtualRowsHandler=$.proxy(this._rebuildVirtualRows,this);this.grid.element.bind("iggridrebuildingvirtualrows",this._rebuildVirtualRowsHandler);this.grid._getTotalRowsCount=$.proxy(this._getTotalRowsCount,this)}this._getLastVisibleDataRecordIndexHandler=$.proxy(this.grid._getLastVisibleDataRecordIndex,this.grid);this.grid._getLastVisibleDataRecordIndex=$.proxy(this._getLastVisibleDataRecordIndex,this);if(!this._calculateAvgRowHeightHandler){this._calculateAvgRowHeightHandler=$.proxy(this.grid._calculateAvgRowHeight,this.grid);this.grid._calculateAvgRowHeight=$.proxy(this._calculateAvgRowHeight,this)}if(!this._getTotalRowCountHandler){this._getTotalRowCountHandler=$.proxy(this.grid._getTotalRowCount,this.grid);this.grid._getTotalRowCount=$.proxy(this._getTotalRowCount,this)}this._detachEvents();this.grid.element.bind("iggridheaderrenderedinternal",this._headerRenderedHandler);this.grid.element.bind("iggriddataempty",this._dataRenderingHandler);this.grid.element.bind("iggrid_rowsrendering",this._rowsRenderingHandler);this.grid.element.bind("iggridrowsrendered",this._rowsRenderedHandler);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.bind("iggriddatabound",this._dataBoundHandler);this.grid.element.bind("iggridheadercelldragcancel",this._headerDragCancelHandler);this._headerMouseOverHandler=function(event){$(event.currentTarget).addClass("ui-state-hover")};this._headerMouseOutHandler=function(event){$(event.currentTarget).removeClass("ui-state-hover")};this.grid.dataSource.settings.sorting.sortUrlKey=this.options.groupByUrlKey;this.grid.dataSource.settings.sorting.sortUrlAscValueKey=this.options.groupByUrlKeyAscValue;this.grid.dataSource.settings.sorting.sortUrlDescValueKey=this.options.groupByUrlKeyDescValue;if(this.options.type){this.grid.dataSource.settings.sorting.type=this.options.type}else{this.grid.dataSource.settings.sorting.type="remote"}this.grid.dataSource.settings.encodeExtraParams=$.proxy(this._encodeSummaryParams,this);this._initDefaultSettings();this.options.groupedColumns=[];if(!this.grid.options.key&&(layoutGrouped===null||layoutGrouped.length===0)){for(i=0;i<this._orderedColumnSettings.length;i++){if(this._orderedColumnSettings[i].isGroupBy){s=this._orderedColumnSettings[i];gc={key:s.columnKey,dir:s.dir||"asc",col:this.grid.columnByKey(s.columnKey)};this.options.groupedColumns.push(gc);gcsort={fieldName:s.columnKey,dir:s.dir||"asc",layout:this.grid.options.key,isGroupBy:true};if(this.options.type==="local"){gcsort.layout=null;this.grid.dataSource.settings.sorting.defaultFields.push(gcsort)}this._addSortingExpressions(this.grid.dataSource.settings.sorting.expressions,gcsort)}}}else{for(i=0;layoutGrouped!==null&&i<layoutGrouped.length;i++){this.options.groupedColumns.push(layoutGrouped[i]);gcsort={fieldName:layoutGrouped[i].key,dir:layoutGrouped[i].dir||"asc",layout:this.grid.options.key,isGroupBy:true};if(this.options.type==="local"){gcsort.layout=null;this.grid.dataSource.settings.sorting.defaultFields.push(gcsort)}this._addSortingExpressions(this.grid.dataSource.settings.sorting.expressions,gcsort)}}if(this.grid.element.closest(".ui-iggrid-root").length===0||this.grid.element.hasClass("ui-iggrid-root")||this.grid._isWrapped){$(document).delegate("#"+this.grid.id()+"_container td[gbexpandcell=1]","mousedown",this._toggleGroupHandler);$(document).delegate("#"+this.grid.id()+"_container td[gbexpandcell=1]","keydown",this._onKeyDownGroupHandler)}this._renderExtraHeaderCellHandler=$.proxy(this._renderExtraHeaderCells,this);this._renderExtraFooterCellHandler=$.proxy(this._renderExtraFooterCells,this);this.grid._headerInitCallbacks.push({type:"GroupBy",func:this._renderExtraHeaderCellHandler});this.grid._footerInitCallbacks.push({type:"GroupBy",func:this._renderExtraFooterCellHandler});this._columnsCollectionModifiedHandler=$.proxy(this._columnsCollectionModified,this);this.grid.element.bind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler);this._uiDirtyHandler=$.proxy(this._onUIDirty,this);this.grid.element.bind("iggriduidirty",this._uiDirtyHandler);if(this.grid.element.igGridFeatureChooser!==undefined){this.grid.element.igGridFeatureChooser()}this._hierarchical=this.grid._isHierarchicalGrid;if(this.options.persist){this._restoreGroupBy()}this._allGroupedCols(this._orderedGroupedCols)},_tokenizeTBody:function(html){var start=0,trTokens=[],index=0,begin,end,tr;while(true){begin=html.indexOf("<tr",start);end=html.indexOf("</tr>",start);if(begin===-1||end===-1){break}tr=html.substr(begin,end+5-begin);tr=tr.substr(0,3)+' data-row-idx="'+index++ +'" '+tr.substr(3);trTokens.push(tr);if(end+5<html.length-1){start=end+5}else{break}}return trTokens},_determineVirtualRowCount:function(allRows,displayContainerHeight){var div,rowNumber,rows,i,height,avgRowHeight,rowsPerPage,result;div=$("<div></div>)").appendTo("body").css({position:"absolute",top:-1800,left:-1800,visibility:"hidden"});rowNumber=allRows.length>10?10:allRows.length;rows="";for(i=0;i<rowNumber;i++){rows+=allRows[i]}div.html(rows);height=div.height();avgRowHeight=height/rowNumber;rowsPerPage=displayContainerHeight/avgRowHeight;result=Math.ceil(rowsPerPage*3);div.remove();return result},_getTotalRowsCount:function(){if(this.options.groupedColumns.length>0&&this._groupedRows){if(!this.options.initialExpand&&this._getTotalRowCountHandler){return this._countGroupedRows}return this._groupedRows.length}return this.grid.dataSource.dataView().length},_renderInitiallyCollapsedRows:function(startIndex,endIndex){var i=0,index=0,tbodyHtml="",tr;if(endIndex>this._visibleGroupedRows.length){endIndex=this._visibleGroupedRows.length;startIndex=endIndex-this._virtualRowCount}if(startIndex<0){startIndex=0}for(i=startIndex;i<endIndex;i++){tbodyHtml+=this._visibleGroupedRows[i];index=this._visibleRowIndexes[i]+1;if(index>this._groupedRows.length-1){index=this._groupedRows.length-1}tr=this._groupedRows[index];while(tr!==null&&tr!==undefined&&tr.indexOf("display:none")>-1&&tr.indexOf("data-grouprow")>-1){tbodyHtml+=tr;index++;tr=this._groupedRows[index]}}return tbodyHtml},_getLastVisibleDataRecordIndex:function(){if(this.options.groupedColumns.length>0){if(!this.options.initialExpand){return this._visibleRowIndexes[this._visibleRowIndexes.length-1]}return this._groupedRows.length}return this.grid.dataSource.dataView().length},_rebuildVirtualRows:function(event,args){var scrollData,scrollResult,virtualScrollerY,deltaScroll,tableId,noCancel,visibleArea,tbody,expandedRowsHeight,trs,i,scrollerHeight,firstVisibleTR,firstVisibleTRRelativeOffset,startIndexToBeLoaded,dataRowIndexToBeFirst,endIndexToBeLoaded,hasOverflow,tr,lastVisibleTR,lastVisibleTRIndex,firstVisibleTRIndex,rowsHtml,newFirstVisibleRow,start,end,displayContainerScrollTop,avgRowHeight,maxScrollPos;if(args.owner.id()!==this.grid.id()){return}if(this.options.groupedColumns.length===0){return true}scrollData=args.scrollData;scrollResult=args.scrollResult;virtualScrollerY=scrollData.virtualScrollerY;deltaScroll=scrollData.deltaScroll;tableId="#"+this.element[0].id;visibleArea=scrollData.visibleArea;tbody=$(tableId+" > tbody");expandedRowsHeight=0;
tableId="#"+this.element[0].id;trs=$(tableId+" > tbody > tr[data-container='true']");for(i=0;i<trs.length;i++){expandedRowsHeight+=$(trs[i]).outerHeight()}if(expandedRowsHeight>0){scrollerHeight=this.grid._getScrollContainerHeight();this.grid._setScrollContainerHeight(scrollerHeight-expandedRowsHeight)}if(deltaScroll>0&&scrollResult.action==="SA_NEED_NEXT_PAGE"){firstVisibleTR=this.grid._getFirstVisibleTR(visibleArea);firstVisibleTRRelativeOffset=Math.abs(firstVisibleTR[0].offsetTop-visibleArea.top);startIndexToBeLoaded=parseInt(firstVisibleTR.attr("data-row-idx"),0);dataRowIndexToBeFirst=startIndexToBeLoaded;endIndexToBeLoaded=parseInt(this._virtualRowCount,0)+startIndexToBeLoaded-1;hasOverflow=false;if(endIndexToBeLoaded>this._groupedRows.length-1){endIndexToBeLoaded=this._groupedRows.length-1;startIndexToBeLoaded=endIndexToBeLoaded-this._virtualRowCount+1;hasOverflow=true}noCancel=this.grid._trigger(this.grid.events.rowsRendering,null,{owner:this.grid,tbody:tbody,vrtWnd:{calledFromGroupBy:true,start:startIndexToBeLoaded,end:endIndexToBeLoaded}});if(noCancel){tbody.empty();rowsHtml="";if(this.options.initialExpand){for(i=startIndexToBeLoaded;i<=endIndexToBeLoaded;i++){rowsHtml+=this._groupedRows[i]}}else{startIndexToBeLoaded=this._visibleRowIndexes.indexOf(parseInt(firstVisibleTR.attr("data-row-idx"),0));endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount;rowsHtml=this._renderInitiallyCollapsedRows(startIndexToBeLoaded,endIndexToBeLoaded)}tbody.html(rowsHtml);if(hasOverflow){tr=$(tableId+" > tbody > tr[data-row-idx='"+dataRowIndexToBeFirst+"']");firstVisibleTRRelativeOffset=tr[0].offsetTop+firstVisibleTRRelativeOffset}this.grid._setDisplayContainerScrollTop(firstVisibleTRRelativeOffset+deltaScroll)}}if(deltaScroll<0&&!this.options.initialExpand){scrollResult.action="SA_NEED_SOME_PAGE"}if(deltaScroll<0&&scrollResult.action==="SA_NEED_PREV_PAGE"){lastVisibleTR=this.grid._getLastVisibleTR(visibleArea);lastVisibleTRIndex=parseInt(lastVisibleTR.attr("data-row-idx"),0);firstVisibleTR=this.grid._getFirstVisibleTR(visibleArea);firstVisibleTRIndex=parseInt(firstVisibleTR.attr("data-row-idx"),0);endIndexToBeLoaded=lastVisibleTRIndex;startIndexToBeLoaded=endIndexToBeLoaded-parseInt(this._virtualRowCount,0)+1;if(startIndexToBeLoaded<0){startIndexToBeLoaded=0;endIndexToBeLoaded=startIndexToBeLoaded+this._virtualRowCount-1}noCancel=this.grid._trigger(this.grid.events.rowsRendering,null,{owner:this.grid,tbody:tbody,vrtWnd:{calledFromGroupBy:true,start:startIndexToBeLoaded,end:endIndexToBeLoaded}});if(noCancel){tbody.empty();rowsHtml="";for(i=startIndexToBeLoaded;i<=endIndexToBeLoaded;i++){rowsHtml+=this._groupedRows[i]}tbody.html(rowsHtml);tableId="#"+this.element[0].id;newFirstVisibleRow=$(tableId+' > tbody > tr[data-row-idx="'+firstVisibleTRIndex+'"]');this.grid._setDisplayContainerScrollTop(newFirstVisibleRow[0].offsetTop+deltaScroll)}}if(scrollResult.action==="SA_NEED_SOME_PAGE"){start=Math.floor(virtualScrollerY/this._avgRowHeight);end=start+this._virtualRowCount-1;if(start<0){start=0;end=start+this._virtualRowCount-1}if(end>=this._groupedRows.length-1){end=this._groupedRows.length-1;start=end-this._virtualRowCount+1}noCancel=this.grid._trigger(this.grid.events.rowsRendering,null,{owner:this.grid,tbody:tbody,vrtWnd:{calledFromGroupBy:true,start:start,end:end}});if(noCancel){tbody.empty();rowsHtml="";if(this.options.initialExpand){for(i=start;i<=end;i++){rowsHtml+=this._groupedRows[i]}}else{rowsHtml=this._renderInitiallyCollapsedRows(start,end)}tbody.html(rowsHtml);displayContainerScrollTop=0;maxScrollPos=this.grid._getScrollContainerHeight()-this.grid._getDisplayContainerHeight();if(maxScrollPos-3<=virtualScrollerY&&virtualScrollerY<=maxScrollPos+3){displayContainerScrollTop=1e4}if(!this.grid._persistVirtualScrollTop||displayContainerScrollTop!==0){this.grid._setDisplayContainerScrollTop(displayContainerScrollTop)}}}if(this._addScrollHeight&&this.options.initialExpand){scrollerHeight=this.grid._getScrollContainerHeight();this.grid._setScrollContainerHeight(scrollerHeight-this._addScrollHeight);this.grid.element.height("")}avgRowHeight=this.grid._calculateAvgRowHeight();if(avgRowHeight>this._avgRowHeight){this._avgRowHeight=avgRowHeight}if(this._expandedRowCount>0){this._expandedRowCount=0;this._avgRowHeight=avgRowHeight}this.grid._setScrollContainerHeight(this._avgRowHeight*this.grid._getTotalRowCount());if(noCancel){this.grid._trigger(this.grid.events.rowsRendered,null,{owner:this.grid,tbody:tbody,calledFromGroupBy:true})}return false},_checkGridNotSupportedFeatures:function(){var gridOptions=this.grid.options;if((gridOptions.virtualization===true||gridOptions.rowVirtualization===true||gridOptions.columnVirtualization===true)&&gridOptions.virtualizationMode==="fixed"){throw new Error($.ig.GridGroupBy.locale.fixedVirualizationNotSupported)}}});$.extend($.ui.igGridGroupBy,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Column Hiding 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridHiding",{options:{columnSettings:[{columnKey:null,columnIndex:null,allowHiding:true,hidden:false}],hiddenColumnIndicatorHeaderWidth:7,columnChooserContainment:"owner",columnChooserWidth:350,columnChooserHeight:"",dropDownAnimationDuration:500,columnChooserCaptionText:$.ig.GridHiding.locale.columnChooserCaptionLabel,columnChooserDisplayText:$.ig.GridHiding.locale.columnChooserDisplayText,hiddenColumnIndicatorTooltipText:$.ig.GridHiding.locale.hiddenColumnIndicatorTooltipText,columnHideText:$.ig.GridHiding.locale.columnHideText,columnChooserShowText:$.ig.GridHiding.locale.columnChooserShowText,columnChooserHideText:$.ig.GridHiding.locale.columnChooserHideText,columnChooserHideOnClick:false,columnChooserResetButtonLabel:$.ig.GridHiding.locale.columnChooserResetButtonLabel,columnChooserAnimationDuration:200,columnChooserButtonApplyText:$.ig.GridHiding.locale.columnChooserButtonApplyText,columnChooserButtonCancelText:$.ig.GridHiding.locale.columnChooserButtonCancelText,inherit:false},css:{columnChooser:"ui-dialog ui-draggable ui-resizable ui-iggrid-dialog ui-widget ui-widget-content ui-corner-all",columnChooserHeaderCaption:"ui-dialog-titlebar ui-iggrid-columnchooser-caption ui-widget-header ui-corner-top ui-helper-reset ui-helper-clearfix",columnChooserHeaderCaptionTitle:"ui-dialog-title ui-iggrid-columnchooser-caption-title",columnChooserContent:"ui-dialog-content ui-iggrid-columnchooser-content",hidingHeaderIndicator:"ui-iggrid-hiding-indicator",columnChooserHandleBar:"ui-iggrid-columnchooser-handlebar",hiddenColumnIndicator:"ui-iggrid-hiding-hiddencolumnindicator",hiddenColumnIndicatorSelected:"ui-iggrid-hiding-indicator-selected",hiddenColumnIndicatorMouseOver:"ui-iggrid-hiding-indicator-mouseover",hiddenColumnsDropDown:"ui-iggrid-hiding-dropdown-dialog ui-widget ui-widget-content ui-corner-all",hiddenColumnsDropDownList:"ui-iggrid-hiding-dropdown-list ui-menu",hiddenColumnsDropDownItem:"ui-iggrid-hiding-dropdown-ddlistitemicons ui-state-default",hiddenColumnsDropDownItemHover:"ui-iggrid-hiding-dropdown-listitem-hover ui-state-active ui-state-hover",hiddenColumnsDropDownItemText:"ui-iggrid-hiding-dropdown-ddlistitemtext",columnChooserListItems:"ui-iggrid-columnchooser-listitems",columnChooserItem:"ui-iggrid-columnchooser-item ui-widget-content",columnChooserItemHidden:"ui-iggrid-columnchooser-itemhidden",columnChooserHideButton:"ui-iggrid-columnchooser-hidebutton",columnChooserItemText:"ui-iggrid-dialog-text",featureChooserHidingIcon:"ui-icon ui-iggrid-icon-hide",featureChooserModalDialogIcon:"ui-icon ui-iggrid-icon-column-chooser"},events:{columnHiding:"columnHiding",columnHidingRefused:"columnHidingRefused",columnShowingRefused:"columnShowingRefused",multiColumnHiding:"multiColumnHiding",columnHidden:"columnHidden",columnShowing:"columnShowing",columnShown:"columnShown",columnChooserOpening:"columnChooserOpening",columnChooserOpened:"columnChooserOpened",columnChooserMoving:"columnChooserMoving",columnChooserClosing:"columnChooserClosing",columnChooserClosed:"columnChooserClosed",columnChooserContentsRendering:"columnChooserContentsRendering",columnChooserContentsRendered:"columnChooserContentsRendered",columnChooserButtonApplyClick:"columnChooserButtonApplyClick",columnChooserButtonResetClick:"columnChooserButtonResetClick"},renderInFeatureChooser:true,_headerHashDataKey:"igGrid-hiding-hash",_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_setOption:function(key){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))},destroy:function(){var fc,self=this,modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog");this.grid.element.unbind(".hiding");this.grid.headersTable().find("> thead > tr > th").not("[data-skip=true]").each(function(){var th=$(this);th.find("a[data-hiding-indicator=true]").remove();self._clearHiddenColumnIndicator(true,th);self._clearHiddenColumnIndicator(false,th)});$("div[data-hiding-inddropdown='"+this.grid.id()+"']").remove();this._detachEvents();modalDialog.igGridModalDialog("getCaptionButtonContainer");modalDialog.remove();fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){fc._removeFeature("Hiding");fc._removeFeature("ColumnChooser")}$.Widget.prototype.destroy.call(this);return this},showColumnChooser:function(){this._openColumnChooser(false)},hideColumnChooser:function(){this._closeColumnChooser(false)},showColumn:function(column,isMultiColumnHeader,callback){var i,colToShow,len,arrIds=[];if(isMultiColumnHeader===true){colToShow=this.grid._getMultiHeaderColumnById(column);if(colToShow===null){return}len=colToShow.children.length;for(i=0;i<len;i++){arrIds.push(colToShow.children[i].key)}this.showMultiColumns(arrIds,callback);colToShow.hidden=false;colToShow.colspan=len}else{this.grid.showColumn(column,callback)}},hideColumn:function(column,isMultiColumnHeader,callback){var i,colToHide,len,arrIds=[];if(isMultiColumnHeader===true){colToHide=this.grid._getMultiHeaderColumnById(column);if(colToHide===null){return}len=colToHide.children.length;for(i=0;i<len;i++){arrIds.push(colToHide.children[i].key)}this.hideMultiColumns(arrIds,callback);colToHide.hidden=true;colToHide.colspan=0}else{this.grid.hideColumn(column,callback)}},hideMultiColumns:function(columns,callback){this._setHiddenMultipleColumns([],columns,false,callback)},showMultiColumns:function(columns,callback){this._setHiddenMultipleColumns(columns,[],false,callback)},_showColumnFromUI:function(column){var columnKey,columnIndex,noCancel,self=this;if(typeof column==="number"){columnIndex=column}else{columnKey=column}noCancel=this._trigger(this.events.columnShowing,null,{owner:this,columnKey:columnKey,columnIndex:columnIndex});if(!this.grid._isShowingAllowed([column])){this._trigger(this.events.columnShowingRefused,null,{owner:this,columnKeys:[columnKey]});return false}if(noCancel){self.grid._loadingIndicator.show();setTimeout(function(){self.grid._setHidden(column,false);self._trigger(self.events.columnShown,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex});self.grid._loadingIndicator.hide()},0)}return noCancel},_setHiddenMultipleColumns:function(columnsToShow,columnsToHide,callEvents,callback){var self=this,grid=self.grid,columnKey,columnIndex;grid._loadingIndicator.show();setTimeout(function(){var i,column,noCancel,cols=[],c;for(i=0;i<columnsToShow.length;i++){column=columnsToShow[i];if(typeof column==="number"){columnIndex=column}else{columnKey=column}noCancel=true;if(callEvents){noCancel=self._trigger(self.events.columnShowing,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex})}if(noCancel){c=self.grid._setHidden(column,false);if(callEvents){self._trigger(self.events.columnShown,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex})}if(c){cols.push(c)}}}for(i=0;i<columnsToHide.length;i++){column=columnsToHide[i];if(grid._visibleColumns().length===1){break}if(typeof column==="number"){columnIndex=column}else{columnKey=column}noCancel=true;if(callEvents){noCancel=self._trigger(self.events.columnHiding,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex})}if(noCancel){c=grid._setHidden(column,true);if(callEvents){self._trigger(self.events.columnHidden,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex})}if(c){cols.push(c)}}}if(!grid._allColumnWidthsInPixels&&$.ig.util.isFF){grid._refreshUI()}grid._loadingIndicator.hide();if(callback){$.ig.util.invokeCallback(callback,[cols,columnsToShow.length===0])}},0)},_hideMultiColumnFromUI:function(id){var i,self=this,grid=this.grid,column,children,columnKey,childrenLength,noCancel,visibleChildrenLength=0,columnKeysToHide=[],columnKeysHidden=[];if(grid._visibleColumns().length===1){return false}column=grid._getMultiHeaderColumnById(id);if(column===null){return}children=column.children;childrenLength=children.length;for(i=0;i<childrenLength;i++){if(!children[i].hidden){visibleChildrenLength++}}if(grid._visibleColumns().length-visibleChildrenLength<1){return false}for(i=0;i<childrenLength;i++){columnKeysToHide.push(children[i].key)}if(!grid._isHidingAllowed(columnKeysToHide)){this._trigger(this.events.columnHidingRefused,null,{owner:this,columnKeys:columnKeysToHide});return false}noCancel=this._trigger(this.events.multiColumnHiding,null,{owner:this,columnKeys:columnKeysToHide});if(noCancel){grid._loadingIndicator.show();setTimeout(function(){for(i=0;i<childrenLength;i++){columnKey=columnKeysToHide[i];noCancel=self._trigger(self.events.columnHiding,null,{owner:self,columnKey:columnKey,columnIndex:undefined});if(noCancel){if(children[i].allowHiding&&!children[i].hidden){grid._setHidden(columnKey,true);columnKeysHidden.push(columnKey);self._trigger(self.events.columnHidden,null,{owner:self,columnKey:columnKey,columnIndex:undefined})}}}if(!grid._allColumnWidthsInPixels&&$.ig.util.isFF){grid._refreshUI()}column.hidden=true;column.colspan=0;grid._loadingIndicator.hide();self._trigger(self.events.multiColumnHidden,null,{owner:self,columnKeys:columnKeysHidden})},0)}},_fixedColumnsChanged:function(){this._renderHiddenColumnIndicators()},_hideColumnFromUI:function(column){var self=this,columnKey,columnIndex,noCancel;if(self.grid._visibleColumns().length===1){return false}if(typeof column==="number"){columnIndex=column}else{columnKey=column}if(!this.grid._isHidingAllowed([column])){this._trigger(this.events.columnHidingRefused,null,{owner:this,columnKeys:[columnKey]});return}noCancel=this._trigger(this.events.columnHiding,null,{owner:this,columnKey:columnKey,columnIndex:columnIndex});if(noCancel){self.grid._loadingIndicator.show();setTimeout(function(){self.grid._setHidden(column,true);self._trigger(self.events.columnHidden,null,{owner:self,columnKey:columnKey,columnIndex:columnIndex});if(!self.grid._allColumnWidthsInPixels&&$.ig.util.isFF){self.grid._refreshUI()}self.grid._loadingIndicator.hide()},0)}return noCancel},_headerCellRendered:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(ui.isMultiColumnHeader===true){return}var i,col,featureChooserInstance=this.grid.element.data("igGridFeatureChooser");if(!this._featureChooserInitialized&&featureChooserInstance&&this.renderInFeatureChooser){this._featureChooserInitialized=true;this._hidingIconColumnKeys=[];for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i];if(this._getColumnSettingsByIndex(i).allowHiding){if(featureChooserInstance._shouldRenderInFeatureChooser(col.key)===true){featureChooserInstance._renderInFeatureChooser(col.key,{name:"Hiding",text:this.options.columnHideText,iconClass:this.css.featureChooserHidingIcon,isSelectable:false,isSelected:false,method:$.proxy(this._featureChooserHide,this),updateOnClickAll:false,groupName:"click",groupOrder:2,order:2});featureChooserInstance._renderInFeatureChooser(col.key,{name:"ColumnChooser",text:this.options.columnChooserDisplayText,iconClass:this.css.featureChooserModalDialogIcon,method:$.proxy(this._featureChooserColumnChooser,this),groupName:"modaldialog",groupOrder:3,order:1})}else{this._hidingIconColumnKeys.push(col.key)}}}}},_featureChooserHide:function(event,columnKey){this._closeColumnChooser(true);this._hideColumnFromUI(columnKey)},_featureChooserColumnChooser:function(){this._openColumnChooser(true)},_columnMap:function(){var self=this;return $.map(this.grid.options.columns,function(col,index){return{columnKey:col.key,enabled:self._getColumnSettingsByIndex(index).allowHiding}})},_renderHidingColumnIcon:function(th,columnKey,isMultiColumnHeader){var self=this,$a,indicatorContainer=th.find(".ui-iggrid-indicatorcontainer");if(indicatorContainer.length===0){indicatorContainer=$("<div></div>").addClass("ui-iggrid-indicatorcontainer").appendTo(th)}$a=$("<a></a>").css("display","inline").attr("data-hiding-indicator","true").attr("href","#").attr("title",$.ig.GridHiding.locale.hideColumnIconTooltip).bind("keydown.hiding",function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){if(isMultiColumnHeader){self._hideMultiColumnFromUI(th.attr("data-mch-id"))}else{self._hideColumnFromUI(columnKey)}event.preventDefault();event.stopPropagation()}}).appendTo(indicatorContainer);$("<span>&laquo;</span>").addClass(this.css.hidingHeaderIndicator).appendTo($a).bind("click.hiding",function(event){$(this).parent().mouseout();self._closeColumnChooser(true);if(isMultiColumnHeader){self._hideMultiColumnFromUI(th.attr("data-mch-id"))}else{self._hideColumnFromUI(columnKey)}event.preventDefault();event.stopPropagation()});this.grid._enableHeaderCellFeature(th)},_populateMultiColumnHeadersLevel0:function(){var i,j,self=this,cols=this.grid._oldCols,colsLength=cols.length,ths=$(this.grid._headerCells),level0=[],level0Length,visibleColumns=this.grid._visibleColumns();for(i=0;i<colsLength;i++){if(cols[i].level===0){level0.push(cols[i])}else{for(j=0;j<cols[i].children.length;j++){level0.push(cols[i].children[j])}}}level0Length=level0.length;ths.each(function(index){var th=$(this),col=visibleColumns[index],cs;if(col===null||col===undefined){return true}cs=self._getColumnSettingsByKey(col.key);if(cs.allowHiding){for(i=0;i<level0.length;i++){if(level0[i].key===col.key){break}}if(i<level0Length){level0[i].allowHiding=true;level0[i].visibleIndex=index;level0[i].settings=cs}th.col=level0[i]}})},_renderHidingIcons:function(){var thsMultiHeader,self=this,ths;if(self.grid._isMultiColumnGrid===true){thsMultiHeader=this.grid.headersTable().find("> thead > tr th").not("[data-skip=true]").not("[data-isheadercell=true]");this._populateMultiColumnHeadersLevel0();thsMultiHeader.each(function(){var th=$(this),id=th.attr("id"),col,allowHiding=true;if(id){id=id.replace(self.grid.id()+"_","");if(id){col=self._getColumnSettings(null,id);if(col&&col.allowHiding===false){allowHiding=false}}}if(allowHiding){self._renderHidingColumnIcon(th,null,true)}});ths=$(this.grid._headerCells)}else{ths=this.grid.headersTable().find("> thead > tr > th").not("[data-skip=true]")}ths.find("a[data-hiding-indicator=true]").remove();ths.each(function(index){var th=$(this),visibleColumns=self.grid._visibleColumns(),visibleIndex,columnKey;if(self.grid.options.virtualizationMode==="fixed"&&(self.grid.options.virtualization===true||self.grid.options.columnVirtualization===true)){visibleIndex=(self.grid._startColIndex||0)+index}else{visibleIndex=index}columnKey=visibleColumns[visibleIndex].key;if($.inArray(columnKey,self._hidingIconColumnKeys)!==-1){self._renderHidingColumnIcon(th,columnKey)}})},_headerRendered:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}this._renderHidingIcons();this._renderColumnChooser()},_columnChooserButtonOKClick:function(){var self=this,changedColumns=self._columnsToHide,columnsToHide=[],columnsToShow=[],noCancel,modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog");$.each(this.grid.options.columns,function(columnIndex,column){var cs,columnIdentifier,col;cs=self._getColumnSettingsByIndex(columnIndex);if(!cs.allowHiding){return}columnIdentifier=cs.columnKey||cs.columnIndex||column.key;col=changedColumns[columnIdentifier];if(col!==null&&col!==undefined){if(col){if(column.hidden===false){columnsToHide.push(columnIdentifier)}}else{if(column.hidden===true){columnsToShow.push(columnIdentifier)}}}});noCancel=this._trigger(this.events.columnChooserButtonApplyClick,null,{columnChooserElement:modalDialog,owner:this,columnsToHide:columnsToHide,columnsToShow:columnsToShow});if(!this.grid._isHidingAllowed(columnsToHide)){this._trigger(this.events.columnHidingRefused,null,{owner:this,columnKeys:columnsToHide});return}if(!this.grid._isShowingAllowed(columnsToShow)){this._trigger(this.events.columnShowingRefused,null,{owner:this,columnKeys:columnsToShow});return}if(noCancel){self._setHiddenMultipleColumns(columnsToShow,columnsToHide,true);$("#"+this.grid.id()+"_hiding_modalDialog").igGridModalDialog("closeModalDialog",true)}},isToRenderButtonReset:function(){var self=this,columnsToHide=self._columnsToHide,result=false;$.each(this.grid.options.columns,function(columnIndex,column){var cs,columnIdentifier,col,isHidden;cs=self._getColumnSettingsByIndex(columnIndex);if(cs&&!cs.allowHiding){return true}columnIdentifier=cs.columnKey||cs.columnIndex||column.key;col=columnsToHide[columnIdentifier];if(column._initiallyHidden===true){isHidden=true}else{isHidden=cs.hidden}if(col!==null&&col!==undefined){if(col!==isHidden){result=true;return false}}});return result},_isVisibleColumnsNotAllowHiding:function(){var self=this,res=false;$.each(this.grid.options.columns,function(columnIndex,column){var cs;cs=self._getColumnSettingsByIndex(columnIndex);if(cs&&!cs.allowHiding&&!column.hidden){res=true;return false}});return res},_columnChooserOpening:function(){var $ul,noCancel,$content,self=this,o=this.options,css=this.css,countColumnsAllowHiding=0,modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog");noCancel=this._trigger(this.events.columnChooserOpening,null,{columnChooserElement:modalDialog,owner:this});if(noCancel){noCancel=this._trigger(this.events.columnChooserContentsRendering,null,{columnChooserElement:modalDialog,owner:this});if(noCancel){this.removeColumnChooserResetButton();$content=modalDialog.igGridModalDialog("getContent");$content.empty();$ul=$("<ul></ul>").addClass(css.columnChooserListItems).appendTo($content);this._columnsToHide={};$.each(this.grid.options.columns,function(columnIndex,column){var cs,columnIdentifier,$a,$li;cs=self._getColumnSettingsByIndex(columnIndex);if(!cs.allowHiding){return}countColumnsAllowHiding++;columnIdentifier=cs.columnKey||cs.columnIndex||column.key;$li=$("<li></li>").attr("id",self.grid.element[0].id+"_"+columnIdentifier+"_columnchooser_li").addClass(css.columnChooserItem).append('<span class="'+css.columnChooserHideButton+'"><a href="#"></a></span><span class="'+css.columnChooserItemText+'">'+column.headerText+"</span>");$li.appendTo($ul);$a=$li.find("a:first");if(o.columnChooserHideOnClick===true){$li.bind("click.hiding",function(event){var isHidden;if($a.attr("ishidden")==="1"){noCancel=self._showColumnFromUI(columnIdentifier);isHidden=false}else{noCancel=self._hideColumnFromUI(columnIdentifier);isHidden=true}if(noCancel){self._renderColumnChooserHideButton($a,isHidden)}event.preventDefault();event.stopPropagation();return false})}else{$li.bind("click.hiding",function(event){var isHidden,key,c;if($a.attr("ishidden")==="1"){isHidden=false}else{isHidden=true}if(isHidden&&self.grid.hasFixedColumns()){c=[];for(key in self._columnsToHide){if(self._columnsToHide.hasOwnProperty(key)&&self._columnsToHide[key]){c.push(key)}}c.push(columnIdentifier);if(!self.grid._isHidingAllowed(c)){return}}if(isHidden&&!self._isVisibleColumnsNotAllowHiding()&&$ul.find("a[ishidden=1]").length===countColumnsAllowHiding-1){return}self._columnsToHide[columnIdentifier]=isHidden;self._renderColumnChooserHideButton($a,isHidden);if(self.isToRenderButtonReset()){self.renderColumnChooserResetButton()}else{self.removeColumnChooserResetButton()}event.preventDefault();event.stopPropagation();return false})}self._columnsToHide[columnIdentifier]=column.hidden;self._renderColumnChooserHideButton($a,column.hidden)});this._trigger(this.events.columnChooserContentsRendered,null,{columnChooserElement:modalDialog,owner:this});if(o.columnChooserHideOnClick===false&&self.isToRenderButtonReset()){self.renderColumnChooserResetButton()}}this._trigger(this.events.columnChooserOpened,null,{columnChooserElement:modalDialog,owner:this})}return noCancel},resetHidingColumnChooser:function(){var self=this;$.each(this.grid.options.columns,function(columnIndex,column){var cs,columnIdentifier,isToHide;cs=self._getColumnSettingsByIndex(columnIndex);if(!cs){return true}if(!cs.allowHiding){return true}isToHide=cs.hidden;if(column._initiallyHidden===true){isToHide=true}columnIdentifier=cs.columnKey||cs.columnIndex||column.key;self._columnsToHide[columnIdentifier]=isToHide;self._renderColumnChooserHideButton($("#"+self.grid.id()+"_"+columnIdentifier+"_columnchooser_li a:first"),isToHide)});self.removeColumnChooserResetButton()},renderColumnChooserResetButton:function(){var o=this.options,self=this,resetButtonId=this.grid.id()+"_hiding_modalDialog_reset_button",modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog"),$captionButtonContainer,$resetButton;if($("#"+resetButtonId).length===0){$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$resetButton=$("<button></button>").attr("id",resetButtonId).appendTo($captionButtonContainer);$resetButton.igButton({labelText:o.columnChooserResetButtonLabel,click:function(e){self._trigger(self.events.columnChooserButtonResetClick,e,{columnChooserElement:modalDialog,owner:self});self.resetHidingColumnChooser()}})}},removeColumnChooserResetButton:function(){$("#"+this.grid.id()+"_hiding_modalDialog_reset_button").remove()},_renderColumnChooserHideButton:function($a,isHidden){var text,attrIsHidden,css=this.css,$li=$a.closest("li");if(isHidden===false){attrIsHidden="0";text=this.options.columnChooserHideText;$li.removeClass(css.columnChooserItemHidden)}else{attrIsHidden="1";text=this.options.columnChooserShowText;$li.addClass(css.columnChooserItemHidden)}$a.attr("ishidden",attrIsHidden).text(text)},_renderColumnChooser:function(){$("#"+this.grid.id()+"_hiding_modalDialog").remove();var $buttonOK,self=this,o=this.options,$captionButtonContainer,containment=this.grid._rootContainer(),modalDialog;if(this.options.columnChooserContainment!=="owner"){containment="window"}modalDialog=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",this.grid.id()+"_hiding_modalDialog");modalDialog.igGridModalDialog({modalDialogWidth:o.columnChooserWidth,modalDialogHeight:o.columnChooserHeight,modalDialogCaptionText:o.columnChooserCaptionText,buttonApplyText:o.columnChooserButtonApplyText,buttonCancelText:o.columnChooserButtonCancelText,containment:containment,gridContainer:this.grid.container(),renderFooterButtons:!o.columnChooserHideOnClick,animationDuration:o.columnChooserAnimationDuration,modalDialogOpening:function(event,args){return self._columnChooserOpening(event,args)},modalDialogMoving:function(e,ui){self._trigger(self.events.columnChooserMoving,null,{columnChooserElement:$(e.target),owner:self,originalPosition:ui.originalPosition,position:ui.position})},modalDialogClosing:function(){return self._trigger(self.events.columnChooserClosing,null,{columnChooserElement:modalDialog,owner:self})},modalDialogClosed:function(){self._trigger(self.events.columnChooserClosed,null,{columnChooserElement:modalDialog,owner:self})}});if(!o.columnChooserHideOnClick){$buttonOK=$("#"+this.grid.id()+"_hiding_modalDialog_footer_buttonok");$buttonOK.bind("igbuttonclick",function(e){self._columnChooserButtonOKClick(e);e.preventDefault()})}else{$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$("<span></span>").bind("click.hiding",function(event){modalDialog.igGridModalDialog("closeModalDialog",true);event.preventDefault();event.stopPropagation();return false}).addClass("ui-icon ui-icon-closethick").appendTo($("<a></a>").appendTo($captionButtonContainer).attr("title",$.ig.GridHiding.locale.columnChooserCloseButtonTooltip).attr("href","#").attr("role","button").addClass("ui-dialog-titlebar-close ui-corner-all"))}},_hidingFinished:function(){if(this.options.virtualization===true&&this.options.virtualizationMode==="fixed"){return}if(this.options.columnVirtualization===true){return}this._renderHiddenColumnIndicators()},_virtualHorizontalScroll:function(){this._renderHiddenColumnIndicators();this._renderHidingIcons()},_getIndicators:function(indicators,isFixed){var i,col,columns=this.grid.options.columns,columnsLength=columns.length,visibleIndex=0,fixed;for(i=0;i<columnsLength;i++){col=columns[i];fixed=col.fixed===true;if(fixed!==isFixed){continue}if(col.hidden){if(this._getColumnSettingsByIndex(i).allowHiding){if(indicators[visibleIndex]===undefined){indicators[visibleIndex]=[]}indicators[visibleIndex].push(col.key)}}else{visibleIndex++}}return visibleIndex},_renderHiddenColumnIndicators:function(){var self=this,ths,visibleIndex=0,indicators=[],oldDropDowns,fHCells,ufHCells,hasFixedColumns=this.grid.hasFixedColumns(),fixedIndicators=[];visibleIndex=this._getIndicators(indicators,false);if(hasFixedColumns){this._getIndicators(fixedIndicators,true)}oldDropDowns=this.grid.container().children("div[data-hiding-inddropdown='"+self.grid.id()+"']");if(oldDropDowns.length){setTimeout(function(){oldDropDowns.remove()},this.options.dropDownAnimationDuration*2+1)}if(visibleIndex===0){this.grid.headersTable().find("> thead > tr > th[data-hiddenreplacement=true]").each(function(){var a=self._renderHiddenColumnIndicator(true,$(this));self._bindDropDownToIndicator(a.find("span"),indicators[0])})}else{ths=this.grid._isMultiColumnGrid?$(this.grid._headerCells):this.grid.headersTable().find("> thead > tr > th").not("[data-skip=true]");if(hasFixedColumns){if(this.grid._isMultiColumnGrid){fHCells=$();ufHCells=$();$.each(this.grid._headerCells,function(index,cell){if(self.grid._isFixedElement(cell)){fHCells.push(cell)}else{ufHCells.push(cell)}});this._renderHiddenColumnIndicatorsHelper(ufHCells,indicators,false);this._renderHiddenColumnIndicatorsHelper(fHCells,fixedIndicators,true)}else{this._renderHiddenColumnIndicatorsHelper(ths,indicators,false);ths=this.grid.fixedHeadersTable().find("thead > tr > th").not("[data-skip=true]");this._renderHiddenColumnIndicatorsHelper(ths,fixedIndicators,true)}}else{this._renderHiddenColumnIndicatorsHelper(ths,indicators)}}},_renderHiddenColumnIndicatorsHelper:function(ths,indicators,isFixed){var self=this;ths.each(function(index){var th=$(this),div,visibleIndex;if(self.grid.options.virtualization===true&&self.grid.options.virtualizationMode==="fixed"||self.grid.options.columnVirtualization===true){visibleIndex=self.grid._startColIndex+index}else{visibleIndex=index}self._clearHiddenColumnIndicator(true,th);self._clearHiddenColumnIndicator(false,th);if(indicators[visibleIndex]!==undefined){div=self._renderHiddenColumnIndicator(true,th);self._bindDropDownToIndicator(div.find("span"),indicators[visibleIndex])}if(visibleIndex===self.grid._visibleColumns(isFixed).length-1){if(indicators[visibleIndex+1]!==undefined){div=self._renderHiddenColumnIndicator(false,th);self._bindDropDownToIndicator(div.find("span"),indicators[visibleIndex+1])}}});this.grid._fireInternalEvent("_hiddenColumnIndicatorsRendered",ths)},_renderHiddenColumnIndicator:function(left,th){var padding,margin,nonPaddedIndicatorsAttr,position,indicatorMarkup,spanMarkup,paddingValue,div,span;if(left){padding="padding-left";margin="margin-left";position="left";indicatorMarkup="<div data-hiddencolindicator='left' />";spanMarkup="<span data-nonpaddedindicator='left'></span>";nonPaddedIndicatorsAttr="[data-nonpaddedindicator=left]"}else{padding="padding-right";margin="margin-right";position="right";indicatorMarkup="<div data-hiddencolindicator='right' />";spanMarkup="<span data-nonpaddedindicator='right'></span>";nonPaddedIndicatorsAttr="[data-nonpaddedindicator=right]"}paddingValue=parseInt(th.css(padding),10)+this.options.hiddenColumnIndicatorHeaderWidth;th.css(padding,paddingValue+"px");th.find(nonPaddedIndicatorsAttr).css(margin,-paddingValue+"px");div=$(indicatorMarkup).attr("tabindex",this.grid.options.tabIndex).attr("title",this.options.hiddenColumnIndicatorTooltipText).css("position","relative").css("width","100%").css("height","0px").css("top","0px").css("left","0px").prependTo(th);span=$(spanMarkup).attr("title",this.options.hiddenColumnIndicatorTooltipText).attr("data-skip-event","true").css("position","absolute").css(margin,-paddingValue+"px").css(position,"0px").css("width",this.options.hiddenColumnIndicatorHeaderWidth+"px").addClass(this.css.hiddenColumnIndicator).appendTo(div);if($.ig.util.isIE7){span.css({top:-parseInt(th.css("padding-top"),10),height:th.innerHeight()})}return div},_clearHiddenColumnIndicator:function(left,th){var padding,paddingValue,indicatorSelector,indicator;if(left){padding="padding-left";indicatorSelector="div[data-hiddencolindicator=left]"}else{padding="padding-right";indicatorSelector="div[data-hiddencolindicator=right]"}indicator=th.find(indicatorSelector);if(indicator.length!==0){indicator.remove();paddingValue=parseInt(th.css(padding),10);th.css(padding,paddingValue-this.options.hiddenColumnIndicatorHeaderWidth+"px")}},_onBlurDDElement:function(e,button,dropDown){var self=this;self._activeDD=null;clearTimeout(self._blurTimeout);self._blurTimeout=setTimeout(function(){if(!self._activeDD||self._activeDD!==dropDown){self._toggleDropDown(button,dropDown,true)}},1)},_onFocusDDElement:function(e,button,dropDown){this._activeDD=dropDown},_bindDropDownToIndicator:function(button,columnKeys){var self=this,$hInd=button.closest("[data-hiddencolindicator]"),dropDown=this._renderDropDown(button,columnKeys);dropDown.find("ul,[tabindex],a").bind({blur:function(e){self._onBlurDDElement(e,button,dropDown)},focus:function(e){self._onFocusDDElement(e,button,dropDown)}});dropDown.bind({keydown:function(e){var $li,keyCode=e.keyCode,$target=$(e.target);switch(keyCode){case $.ui.keyCode.ESCAPE:self._toggleDropDown(button,dropDown,true);$hInd.focus();break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:if($target.is("li")){$target.mousedown();e.preventDefault()}break;case $.ui.keyCode.TAB:$li=$target;if(!$li.is("li")){$li=$target.closest("li")}if(!e.shiftKey){if($li.is(":last-child")){$li.closest("ul").find("li:first-child").focus();e.preventDefault()}}else{if($li.is(":first-child")){$li.closest("ul").find("li:last-child").focus();e.preventDefault()}}break}}});$hInd.bind({keydown:function(e){if(e.keyCode===$.ui.keyCode.ENTER||e.keyCode===$.ui.keyCode.SPACE){self._toggleDropDown(button,dropDown,false);e.preventDefault();e.stopPropagation()}}});button.parent().bind({mousedown:function(e){self._toggleDropDown(button,dropDown,false);e.preventDefault();e.stopPropagation()},mouseover:function(){if(button.attr("data-indicator-selected")!=="true"){button.addClass(self.css.hiddenColumnIndicatorMouseOver)}},mouseout:function(){button.removeClass(self.css.hiddenColumnIndicatorMouseOver)},mouseup:function(e){e.preventDefault();e.stopPropagation()},click:function(e){e.preventDefault();e.stopPropagation()}})},_renderDropDown:function(button,columnKeys){var self=this,dropDown,list;dropDown=$("<div data-hiding-inddropdown='"+this.grid.id()+"'></div>").css("position","absolute").css("display","none").addClass(this.css.hiddenColumnsDropDown).appendTo(this.grid._rootContainer());list=$('<ul tabindex="0"></ul>').addClass(this.css.hiddenColumnsDropDownList).appendTo(dropDown);$.each(columnKeys,function(index,columnKey){$('<li tabindex="0"></li>').addClass(self.css.hiddenColumnsDropDownItem).bind({mouseover:function(e){$(e.currentTarget).addClass(self.css.hiddenColumnsDropDownItemHover)},mouseout:function(e){$(e.currentTarget).removeClass(self.css.hiddenColumnsDropDownItemHover)},mousedown:function(){self._closeColumnChooser(true);self._showColumnFromUI(columnKey);self._toggleDropDown(button,dropDown,true)}}).append($("<span></span>").addClass(self.css.hiddenColumnsDropDownItemText).text(self.grid.columnByKey(columnKey).headerText)).appendTo(list)});$('<a tabindex="0"></a>').appendTo($("<li></li>").appendTo(list)).igButton({labelText:this.options.columnChooserDisplayText,mousedown:function(event){if(event.target){setTimeout(function(){$(event.target).removeClass("ui-state-active")},0)}self._openColumnChooser(true);self._toggleDropDown(button,dropDown,true)},keydown:function(e){if(e.keyCode===$.ui.keyCode.ENTER||e.keyCode===$.ui.keyCode.SPACE){$(e.target).mousedown();e.preventDefault()}}});return dropDown},_toggleDropDown:function(button,dropDown,isCalledFromBlur){var th,rOffset,isLast,offset,left,isVisible=dropDown.is(":visible")===true,self=this;if(dropDown.data("isAnimating")===true||isVisible===false&&isCalledFromBlur===true){return
}if(!isVisible){th=button.closest("th");isLast=button.closest("div").attr("data-hiddencolindicator")==="right";offset=$.ig.util.offset(th);if(isLast){left=offset.left+th.outerWidth()-dropDown.outerWidth();left=Math.max(0,left)}else{left=offset.left}rOffset=$.ig.util.getRelativeOffset(dropDown);dropDown.css("top",offset.top+th.outerHeight()-rOffset.top);dropDown.css("left",left-rOffset.left)}dropDown.data("isAnimating",true);dropDown.toggle(this.options.dropDownAnimationDuration,function(){if(dropDown.is(":visible")===true){dropDown.find("ul").focus();button.addClass(self.css.hiddenColumnIndicatorSelected);button.attr("data-indicator-selected","true")}else{button.removeClass(self.css.hiddenColumnIndicatorSelected);button.removeAttr("data-indicator-selected")}dropDown.data("isAnimating",false)})},_openColumnChooser:function(){var modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog");modalDialog.igGridModalDialog("openModalDialog")},_closeColumnChooser:function(){var modalDialog=$("#"+this.grid.id()+"_hiding_modalDialog");modalDialog.igGridModalDialog("closeModalDialog")},_columnChooserMove:function(e,ui){this._trigger(this.events.columnChooserMoving,null,{columnChooserElement:e.target,owner:this,originalPosition:ui.originalPosition,position:ui.position})},_getColumnSettings:function(index,key){var i,foundByIndex;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){return this._mergeColumnSettingsDefaults(this.options.columnSettings[i])}if(this.options.columnSettings[i].columnIndex===index){foundByIndex=this.options.columnSettings[i]}}return this._mergeColumnSettingsDefaults(foundByIndex)},_getColumnSettingsByIndex:function(index){var key=this.grid.options.columns[index].key;return this._getColumnSettings(index,key)},_getColumnSettingsByKey:function(key){var i;for(i=0;i<this.grid.options.columns.length;i++){if(this.grid.options.columns[i].key===key){return this._getColumnSettings(i,key)}}},_mergeColumnSettingsDefaults:function(columnSettings){var defaults={allowHiding:true,hidden:false},copy=$.extend({},columnSettings),key;for(key in defaults){if(defaults.hasOwnProperty(key)&&typeof copy[key]!=="boolean"){copy[key]=defaults[key]}}return copy},_columnsMoved:function(){var self=this;this.grid.headersTable().find("> thead > tr > th").not("[data-skip=true]").each(function(){var th=$(this);self._clearHiddenColumnIndicator(true,th);self._clearHiddenColumnIndicator(false,th)});this._renderHiddenColumnIndicators()},_detachEvents:function(){if(this._headerCellRenderedHandler!==null&&this._headerCellRenderedHandler!==undefined){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler)}if(this._headerRenderedHandler!==null&&this._headerRenderedHandler!==undefined){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}if(this._virtualHorizontalScrollHandler!==null&&this._virtualHorizontalScrollHandler!==undefined){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}if(this._columnsMovedHandler!==null&&this._columnsMovedHandler!==undefined){this.grid.element.unbind("iggrid_columnsmoved",this._columnsMovedHandler)}},_injectGrid:function(gridInstance){var i,j,cs,col,children;this.grid=gridInstance;this._detachEvents();this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this._virtualHorizontalScrollHandler=$.proxy(this._virtualHorizontalScroll,this);this._columnsMovedHandler=$.proxy(this._columnsMoved,this);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler);this.grid.element.bind("iggrid_columnsmoved",this._columnsMovedHandler);if(this.grid.element.igGridFeatureChooser!==undefined){this.grid.element.igGridFeatureChooser()}else{throw new Error($.ig.GridHiding.locale.featureChooserNotReferenced)}for(i=0;i<this.options.columnSettings.length;i++){cs=this.options.columnSettings[i];if(typeof cs.hidden==="boolean"){if(typeof cs.columnKey==="string"){col=this.grid.columnByKey(cs.columnKey)}else if(typeof cs.columnIndex==="number"){col=this.grid.options.columns[cs.columnIndex]}if(col!==undefined&&col!==null){if(col.hidden===undefined||cs.hidden===true&&col.hidden!==col._initiallyHidden&&col._initiallyHidden!==true){col.hidden=cs.hidden}}else if(this.grid._isMultiColumnGrid===true&&cs.columnKey!==null&&cs.columnKey!==undefined){col=this.grid._getMultiHeaderColumnById(cs.columnKey);if(col!==undefined&&col!==null&&col.children){children=col.children;for(j=0;j<children.length;j++){if(children[j].hidden===undefined||cs.hidden===true&&children[j].hidden!==children[j]._initiallyHidden&&children[j]._initiallyHidden!==true){children[j].hidden=cs.hidden}}}}}}}});$.extend($.ui.igGridHiding,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Merged Cells 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridCellMerging",{css:{mergedCellsTop:"ui-iggrid-mergedcellstop",mergedCellsBottom:"ui-iggrid-mergedcellsbottom",mergedCell:"ui-iggrid-mergedcell"},options:{initialState:"regular",inherit:false},events:{cellsMerging:"cellsMerging",cellsMerged:"cellsMerged"},_create:function(){this._sortingRequested=false;this._v=false},destroy:function(){this._removePaint();this._unregisterEvents();$.Widget.prototype.destroy.call(this);return this},_gridSorting:function(){this._sortingRequested=true},_gridSorted:function(){this._sortingRequested=false;this._notInitial=true},_gridRendered:function(){var key,index,sExp=this.grid.dataSource.settings.sorting.expressions,i,j;if(this.options.initialState==="merged"&&this._sortingRequested===false&&!this._notInitial){for(j=0;j<this.grid._visibleColumns().length;j++){this._paintMergedCells(j,this.grid._visibleColumns()[j].key)}}else{for(i=0;i<sExp.length;i++){key=sExp[i].fieldName;for(j=0;j<this.grid._visibleColumns().length;j++){if(this.grid._visibleColumns()[j].key===key){index=j;break}}if(typeof this.grid._startColIndex==="number"){index-=this.grid._startColIndex}if(index!==null&&index!==undefined&&key){this._paintMergedCells(index,key)}}}},_rrn:function(){this._gridRendered()},_rcn:function(){this._gridRendered()},_columnsCollectionModified:function(){this._gridRendered()},_paintMergedCells:function(index,key){var cells,prvCell,curCell,prvCellTxt,curCellTxt,first=true,str=false,hasFixedCols=this.grid.hasFixedColumns(),count=0,i,args,cval,noCancel;if(hasFixedCols){if(key){index=this.grid.getVisibleIndexByKey(key,true)+1}else{index=index+1+this._getSystemFixedColumnsCount()}if(this.grid.isFixedColumn(key)){cells=this.grid.container().find("#"+this.grid.id()+"_fixed tbody tr>td:nth-child("+index+")")}else{cells=this.grid.container().find("#"+this.grid.id()+" tbody tr>td:nth-child("+index+")")}}else{cells=this.grid.container().find("#"+this.grid.id()+" tbody tr>td:nth-child("+(index+1+this._getSystemColumnsCount())+")")}this._addVirtualBorderCells(cells,key);prvCell=cells.eq(0);for(i=1;i<cells.length;i++){curCell=cells.eq(i);prvCellTxt=this._getComparableCellText(prvCell);curCellTxt=this._getComparableCellText(curCell);if(prvCellTxt===curCellTxt&&prvCellTxt!==cval){if(str===false){args=this._getEventArgsForCell(prvCell);noCancel=this._trigger(this.events.cellsMerging,this,args);if(noCancel!==true){cval=prvCellTxt;prvCell=curCell;continue}}cval=null;str=true;if(first===true){if(!cells.eq(i-1)[0].fictive){cells.eq(i-1).addClass(this.css.mergedCellsTop)}first=false;count++}if(!curCell[0].fictive){curCell.addClass(this.css.mergedCell)}count++}else{if(str===true){args.count=count;count=0;this._trigger(this.events.cellsMerged,this,args);cells.eq(i-1).addClass(this.css.mergedCellsBottom);str=false}first=true}prvCell=curCell}if(str===true){args.count=count;this._trigger(this.events.cellsMerged,this,args);if(!cells.eq(cells.length-1)[0].fictive){cells.eq(cells.length-1).addClass(this.css.mergedCellsBottom)}}},_addVirtualBorderCells:function(list,key){var ds=this.grid.dataSource.dataView();if(this._v===true){if(this.grid._startRowIndex>0){list.splice(0,0,{txt:String(ds[this.grid._startRowIndex-1][key]),fictive:true})}if(this.grid._startRowIndex+this.grid._virtualRowCount<this.grid.dataSource.dataView().length){list.splice(list.length,0,{txt:String(ds[this.grid._startRowIndex+this.grid._virtualRowCount][key]),fictive:true})}}},_getSystemFixedColumnsCount:function(){var firstRow=this.grid.fixedContainer().find("tbody>tr:not([data-container='true'],[data-grouprow='true']):first");return firstRow.children("[data-parent='true'],[data-skip='true'],th").length},_getSystemColumnsCount:function(){var firstRow=this.grid.container().find("#"+this.grid.id()+" tbody>tr:not([data-container='true'],[data-grouprow='true']):first");return firstRow.children("[data-parent='true'],[data-skip='true'],th").length},_getEventArgsForCell:function(cell){var args,row,rKey,rIdx,val;if(cell[0].fictive){row=null;rKey=null;rIdx=this.grid._startRowIndex?this.grid._startRowIndex-1:-1;val=cell[0].txt}else{row=cell.closest("tr");rKey=row.attr("data-id");rIdx=this._getVisibleRowIndex(row);if(rKey===""||rKey===null||rKey===undefined){rKey=rIdx}val=cell.html()}args={owner:this,row:row,rowIndex:rIdx,rowKey:rKey,grid:this.grid,value:val};return args},_getComparableCellText:function(cell){var text=cell[0].fictive?cell[0].txt:cell.html().replace(/^&nbsp;$/,"");if(this.grid.dataSource.settings.sorting.caseSensitive===false){text=text.toLowerCase()}return text},_getVisibleRowIndex:function(row){return row.closest("tbody").children("tr:not([data-container='true'],[data-grouprow='true'])").index(row)+(this.grid._startRowIndex||0)},_removePaint:function(){var dataRows=this.grid.container().find("#"+this.grid.id()+"> tbody > tr:not([data-container='true'],[data-grouprow='true'])"),cells,i;cells=dataRows.children("td."+this.css.mergedCellsTop+",td."+this.css.mergedCell);for(i=0;i<cells.length;i++){$(cells[i]).removeClass(this.css.mergedCellsTop).removeClass(this.css.mergedCell).removeClass(this.css.mergedCellsBottom)}},_createHandlers:function(){this._sortingInitiatedHandler=$.proxy(this._gridSorting,this);this._sortingHandler=$.proxy(this._gridSorted,this);this._virtualRowsHandler=$.proxy(this._rrn,this);this._virtualColumnsHandler=$.proxy(this._rcn,this);this._columnsCollectionModifiedHandler=$.proxy(this._columnsCollectionModified,this)},_registerEvents:function(){this.grid.element.bind("iggridsortingcolumnsorting",this._sortingInitiatedHandler);this.grid.element.bind("iggridsortingcolumnsorted",this._sortingHandler);this.grid.element.bind("iggridvirtualrecordsrender",this._virtualRowsHandler);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualColumnsHandler);this.grid.element.bind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler)},_unregisterEvents:function(){this.grid.element.unbind("iggridsortingcolumnsorting",this._sortingInitiatedHandler);this.grid.element.unbind("iggridsortingcolumnsorted",this._sortingHandler);this.grid.element.unbind("iggridvirtualrecordsrender",this._virtualRowsHandler);this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualColumnsHandler);this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler)},_injectGrid:function(gridInstance){this.grid=gridInstance;this._v=this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true;this._createHandlers();this._unregisterEvents();this._registerEvents()}});$.extend($.ui.igGridCellMerging,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Paging 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.9.1.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.editors.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridPaging",{css:{pagerClass:"ui-widget ui-iggrid-pager ui-helper-clearfix ui-corner-bottom ui-widget-header ui-iggrid-footer",pageLink:"ui-iggrid-pagelink ui-helper-reset",page:"ui-iggrid-page ui-state-default ui-corner-all",pageHover:"ui-iggrid-page-hover ui-state-hover",pageList:"ui-helper-reset ui-iggrid-pagelist ui-iggrid-paging-item",pageLinkCurrent:"ui-iggrid-pagelinkcurrent",pageCurrent:"ui-iggrid-pagecurrent ui-state-active ui-corner-all",pageFocused:"ui-iggrid-pagefocused ui-state-focus",nextPage:"ui-iggrid-nextpage ui-iggrid-paging-item ui-state-default",prevPage:"ui-iggrid-prevpage ui-iggrid-paging-item ui-state-default",firstPage:"ui-iggrid-firstpage ui-iggrid-paging-item ui-state-default ui-corner-left",lastPage:"ui-iggrid-lastpage ui-iggrid-paging-item ui-state-default ui-corner-right",nextPageLabel:"ui-iggrid-nextpagelabel",prevPageLabel:"ui-iggrid-prevpagelabel",firstPageLabel:"ui-iggrid-firstpagelabel",lastPageLabel:"ui-iggrid-lastpagelabel",nextPageLabelDisabled:"ui-iggrid-nextpagelabeldisabled ui-state-disabled",prevPageLabelDisabled:"ui-iggrid-prevpagelabeldisabled ui-state-disabled",firstPageLabelDisabled:"ui-iggrid-firstpagelabeldisabled ui-state-disabled",lastPageLabelDisabled:"ui-iggrid-lastpagelabeldisabled ui-state-disabled",nextPageImage:"ui-iggrid-pageimg ui-iggrid-nextpageimg ui-icon ui-icon-triangle-1-e",prevPageImage:"ui-iggrid-pageimg ui-iggrid-prevpageimg ui-icon ui-icon-triangle-1-w",firstPageImage:"ui-iggrid-pageimg ui-iggrid-firstpageimg ui-icon ui-icon-arrowstop-1-w",lastPageImage:"ui-iggrid-pageimg ui-iggrid-lastpageimg ui-icon ui-icon-arrowstop-1-e",nextPageImageDisabled:"ui-iggrid-pageimg ui-iggrid-nextpageimgdisabled ui-icon ui-state-disabled ui-icon-triangle-1-e",prevPageImageDisabled:"ui-iggrid-pageimg ui-iggrid-prevpageimgdisabled ui-icon ui-state-disabled ui-icon-triangle-1-w",firstPageImageDisabled:"ui-iggrid-pageimg ui-iggrid-firstpageimgdisabled ui-icon ui-state-disabled ui-icon-arrowstop-1-w",lastPageImageDisabled:"ui-iggrid-pageimg ui-iggrid-lastpageimgdisabled ui-icon ui-state-disabled ui-icon-arrowstop-1-e",pagerRecordsLabel:"ui-iggrid-pagerrecordslabel ui-iggrid-results",pageSizeLabel:"ui-iggrid-pagesizelabel",pageSizeDropDown:"ui-iggrid-pagesizedropdown",pageSizeDropDownContainer:"ui-helper-clearfix ui-iggrid-pagesizedropdowncontainer",pageSizeDropDownContainerAbove:"ui-widget ui-helper-clearfix ui-iggrid-pagesizedropdowncontainerabove ui-iggrid-toolbar ui-widget-header and ui-corner-top",pageDropDownContainer:"ui-iggrid-pagedropdowncontainer",pageDropDownLabels:"ui-iggrid-pagedropdownlabels",pageDropDown:"ui-iggrid-pagedropdown",pagerRightAreaContainer:"ui-iggrid-paging",pagingResults:"ui-iggrid-results"},options:{pageSize:25,recordCountKey:null,pageSizeUrlKey:null,pageIndexUrlKey:null,currentPageIndex:0,type:null,showPageSizeDropDown:true,pageSizeDropDownLabel:$.ig.GridPaging.locale.pageSizeDropDownLabel,pageSizeDropDownTrailingLabel:$.ig.GridPaging.locale.pageSizeDropDownTrailingLabel,pageSizeDropDownLocation:"above",showPagerRecordsLabel:true,pagerRecordsLabelTemplate:$.ig.GridPaging.locale.pagerRecordsLabelTemplate,nextPageLabelText:$.ig.GridPaging.locale.nextPageLabelText,prevPageLabelText:$.ig.GridPaging.locale.prevPageLabelText,firstPageLabelText:$.ig.GridPaging.locale.firstPageLabelText,lastPageLabelText:$.ig.GridPaging.locale.lastPageLabelText,showFirstLastPages:true,showPrevNextPages:true,currentPageDropDownLeadingLabel:$.ig.GridPaging.locale.currentPageDropDownLeadingLabel,currentPageDropDownTrailingLabel:$.ig.GridPaging.locale.currentPageDropDownTrailingLabel,currentPageDropDownTooltip:$.ig.GridPaging.locale.currentPageDropDownTooltip,pageSizeDropDownTooltip:$.ig.GridPaging.locale.pageSizeDropDownTooltip,pagerRecordsLabelTooltip:$.ig.GridPaging.locale.pagerRecordsLabelTooltip,prevPageTooltip:$.ig.GridPaging.locale.prevPageTooltip,nextPageTooltip:$.ig.GridPaging.locale.nextPageTooltip,firstPageTooltip:$.ig.GridPaging.locale.firstPageTooltip,lastPageTooltip:$.ig.GridPaging.locale.lastPageTooltip,pageTooltipFormat:$.ig.GridPaging.locale.pageTooltipFormat,pageSizeList:[],pageCountLimit:10,visiblePageCount:5,defaultDropDownWidth:70,delayOnPageChanged:350,persist:true,inherit:false},events:{pageIndexChanging:"pageIndexChanging",pageIndexChanged:"pageIndexChanged",pageSizeChanging:"pageSizeChanging",pageSizeChanged:"pageSizeChanged",pagerRendering:"pagerRendering",pagerRendered:"pagerRendered"},dropDownVisibleItemsCount:10,_loadingIndicator:null,_isPaging:false,_create:function(){this._oPageIndex=this.options.currentPageIndex;this._oPageSize=this.options.pageSize},_setOption:function(key,value){var items,label,pager;pager=this._pager();$.Widget.prototype._setOption.apply(this,arguments);if(key==="type"||key==="showPageSizeDropDown"||key==="pageSizeDropDownLocation"||key==="showPagerRecordsLabel"||key==="visiblePageCount"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}if(key==="pageSize"){this.pageSize(value)}else if(key==="currentPageIndex"){this.pageIndex(value)}else if(key==="showFirstLastPages"){if(value===true){pager.find(".ui-iggrid-firstpage").show();pager.find(".ui-iggrid-lastpage").show()}else{pager.find(".ui-iggrid-firstpage").hide();pager.find(".ui-iggrid-lastpage").hide()}}else if(key==="showPrevNextPages"){if(value===true){pager.find(".ui-iggrid-prevpage").show();pager.find(".ui-iggrid-nextpage").show()}else{pager.find(".ui-iggrid-prevpage").hide();pager.find(".ui-iggrid-nextpage").hide()}}else if(key==="pageSizeList"){if($.type(value)==="string"){items=value.split(",")}else{items=value}if(this._pageSizeDD){this._pageSizeDD.igNumericEditor("option","listItems",items)}}else if(key==="nextPageLabelText"){label=pager.find(".ui-iggrid-nextpagelabel");label=label.length===0?pager.find(".ui-iggrid-nextpagelabeldisabled"):label;label.text(value)}else if(key==="prevPageLabelText"){label=pager.find(".ui-iggrid-prevpagelabel");label=label.length===0?pager.find(".ui-iggrid-prevpagelabeldisabled"):label;label.text(value)}else if(key==="firstPageLabelText"){label=pager.find(".ui-iggrid-firstpagelabel");label=label.length===0?pager.find(".ui-iggrid-firstpagelabeldisabled"):label;label.text(value)}else if(key==="lastPageLabelText"){label=pager.find(".ui-iggrid-lastpagelabel");label=label.length===0?pager.find(".ui-iggrid-nextpagelabeldisabled"):label;label.text(value)}},pageIndex:function(index){if(index!==null&&index!==undefined){if(index<0||index>=this.grid.dataSource.pageCount()){throw new Error($.ig.GridPaging.locale.invalidPageIndex)}this._overrideLabel=true;this.options.currentPageIndex=index}if(index!==undefined&&index!==null){this.grid.element.trigger("iggriduisoftdirty",{owner:this})}if(this.grid._hasUnboundColumns&&this.options.type==="remote"){this.grid._rebindUnboundColumns=true}this._savePagingData();return this.grid.dataSource.pageIndex(index)},pageSize:function(size){var noCancel=true;if(size){this.grid.dataSource.settings.paging.pageIndex=0;this.options.currentPageIndex=0;noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(noCancel){this._showLoading();if(this.grid._hasUnboundColumns&&this.options.type==="remote"){this.grid._rebindUnboundColumns=true}this._overrideLabel=true;this.options.pageSize=size;this._savePagingData();this.grid.dataSource.pageSize(size)}if(this._pageSizeDD){this._pageSizeDD.igNumericEditor("value",size)}}else{return this.grid.dataSource.pageSize()}},_savePagingData:function(){if(!this.options.persist){return}var pagingData;if(this.element.closest(".ui-iggrid-root").data("igGrid")){pagingData={pageIndex:this.options.currentPageIndex,pageSize:this.options.pageSize};this.grid._savePersistenceData(pagingData,"paging",this.grid.element[0].id)}},_loadPagingData:function(){var pagingData;if(this.element.closest(".ui-iggrid-root").data("igGrid")){pagingData=this.grid._getPersistenceData("paging",this.grid.element[0].id);if(!pagingData){return}this.grid.dataSource.settings.paging.pageIndex=pagingData.pageIndex;this.options.currentPageIndex=pagingData.pageIndex;this.options.pageSize=pagingData.pageSize}},_initLoadingIndicator:function(){this._loadingIndicator=this.grid.container().igLoading().data("igLoading").indicator()},_nextPage:function(event){var noCancel=true,noCancelBinding=true;noCancel=this._trigger(this.events.pageIndexChanging,null,{newPageIndex:this.options.currentPageIndex+1,currentPageIndex:this.options.currentPageIndex,owner:this});if(noCancel){if(this.options.currentPageIndex>=this.grid.dataSource.pageCount()-1){return}this.options.currentPageIndex=this.options.currentPageIndex+1;noCancelBinding=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});this._shouldFirePageIndexChanged=true;if(noCancelBinding){this._showLoading();this._overrideLabel=true;this.grid.element.trigger("iggriduisoftdirty",{owner:this});if(this.grid._hasUnboundColumns&&this.options.type==="remote"){this.grid._rebindUnboundColumns=true}this._savePagingData();this.grid.dataSource.nextPage()}}if(event){event.stopPropagation();event.preventDefault()}},_prevPage:function(event){var noCancel=true,noCancelBinding=true;noCancel=this._trigger(this.events.pageIndexChanging,null,{newPageIndex:this.options.currentPageIndex-1,currentPageIndex:this.options.currentPageIndex,owner:this});if(noCancel){if(this.options.currentPageIndex===0){return}this.options.currentPageIndex=this.options.currentPageIndex-1;noCancelBinding=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});this._shouldFirePageIndexChanged=true;if(noCancelBinding){this._showLoading();this._overrideLabel=true;this.grid.element.trigger("iggriduisoftdirty",{owner:this});if(this.grid._hasUnboundColumns&&this.options.type==="remote"){this.grid._rebindUnboundColumns=true}this._savePagingData();this.grid.dataSource.prevPage()}}if(event){event.stopPropagation();event.preventDefault()}},_firstPage:function(event){var noCancel=true,noCancelBinding=true;noCancel=this._trigger(this.events.pageIndexChanging,null,{newPageIndex:0,currentPageIndex:this.options.currentPageIndex,owner:this});if(noCancel){noCancelBinding=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});this._shouldFirePageIndexChanged=true;if(noCancelBinding){this._showLoading();this.pageIndex(0)}}if(event){event.stopPropagation();event.preventDefault()}},_lastPage:function(event){var noCancel=true,noCancelBinding=true;noCancel=this._trigger(this.events.pageIndexChanging,null,{newPageIndex:this.grid.dataSource.pageCount()-1,currentPageIndex:this.options.currentPageIndex,owner:this});if(noCancel){noCancelBinding=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});this._shouldFirePageIndexChanged=true;if(noCancelBinding){this._showLoading();this.pageIndex(this.grid.dataSource.pageCount()-1)}}if(event){event.stopPropagation();event.preventDefault()}},_showLoading:function(){this._loadingIndicator.show()},_hideLoading:function(){this._loadingIndicator.hide()},_bindEvents:function(){var paging=this,grid=this.grid,noCancel=true,id,noCancelBinding=true;id="#"+grid.element[0].id+"_pager";$(id+" li").bind({mousedown:function(event){var $eventTarget=$(event.target),newIndex=$eventTarget.data("pageIndex");if(newIndex===undefined){newIndex=$eventTarget.parent().data("pageIndex")}if($.type(newIndex)==="number"&&newIndex!==paging.options.currentPageIndex){noCancel=paging._trigger(paging.events.pageIndexChanging,event,{newPageIndex:newIndex,currentPageIndex:paging.options.currentPageIndex,owner:paging});paging._shouldFirePageIndexChanged=true;if(noCancel){noCancelBinding=paging.grid._trigger(paging.grid.events.dataBinding,null,{owner:paging.grid,dataSource:paging.grid.dataSource});if(noCancelBinding){paging._showLoading(grid.element.children("tbody"));paging.pageIndex(newIndex)}}}}});$(id+" li, "+id+" div.ui-iggrid-paging-item").bind({mouseover:function(event){if(!$(event.currentTarget).find("span").first().hasClass("ui-state-disabled")){$(event.currentTarget).addClass(paging.css.pageHover)}},mouseout:function(event){$(event.currentTarget).removeClass(paging.css.pageHover)}})},_fixedColumnsChanged:function(args){if(args.isInit){this._pager().css("clear","both")}},_gridRendered:function(gridContainer){var self=this;if(this.options.showPageSizeDropDown===true&&this.options.pageSizeDropDownLocation==="above"&&!this._pageSizeDropDownRendered){self._renderPageSizeDropDown(gridContainer,true)}if(this.grid.options.autoAdjustHeight){this.grid._initializeHeights();this.grid._adjustLastColumnWidth()}if(this.grid.options.caption!==null&&!($.ig.util.isIE&&$.ig.util.browserVersion>=8)){this.grid._caption().removeClass("ui-corner-top")}},_rowDeleted:function(){if(this.options.type==="remote"){return}var currentPageIndex=this.options.currentPageIndex,pageCount=this.grid.dataSource.pageCount();if(currentPageIndex>0&&currentPageIndex+1>pageCount){currentPageIndex--}this.pageIndex(currentPageIndex)},_rowAdded:function(){if(this.options.type==="remote"){return}var currentPageIndex=this.options.currentPageIndex,pageCount=this.grid.dataSource.pageCount();if(currentPageIndex<pageCount&&this.grid.options.autoCommit){this.pageIndex(pageCount-1)}else{this._dataRendered()}},_gridCommit:function(){if(this.options.type==="remote"){return}this.pageIndex(this.options.currentPageIndex);return true},_plabel:function(){return this._pager().find(".ui-iggrid-pagerrecordslabel")},_pager:function(){return this.grid.container().find(".ui-iggrid-pager")},_getDSLocalRecordsCount:function(){if(this.grid.dataSource._filter){return this.grid.dataSource._filteredData.length}return this.grid.dataSource.totalLocalRecordsCount()},_dataRendered:function(){var id=this.grid.element[0].id,filtering,tmpl,kbrdNavEvents,edtrOpts,i,html,pager=null,pageList,pagesArray,dropDownContainer,pageCount,startRecord=0,endRecord=0,recordsCount=0,localRecordsCount=0,noCancel=true,startPageIndex=0,endPageIndex=0,pagerHtml=toStaticHTML('<div id="'+id+'_pager"></div>'),pageLinkHtml=toStaticHTML('<li class="${pageClass}" tabIndex="0"><a class="${pageLinkClass}" href="javascript:void(0);" tabIndex="-1">${page}</a></li>'),template=this.options.pagerRecordsLabelTemplate,self=this,pagerRight=null,vpc=this.options.visiblePageCount,val=0,recordsLabel=null;this._deleteOld();this._initLoadingIndicator();noCancel=this._trigger(this.events.pagerRendering,null,{dataSource:this.grid.dataSource,owner:this});if(noCancel){if(this.grid._shouldResetPaging){this.options.currentPageIndex=0;this.grid._shouldResetPaging=false}if(this._plabel().length>0){this._pager().find(".ui-iggrid-paging").remove()}else{this._pager().empty()}if(this.grid.dataSource.pageSizeDirty()){this.options.currentPageIndex=this.grid.dataSource.pageIndex();this.grid.dataSource.pageSizeDirty(false)}if(this._pager().length===0){id=this.grid.element[0].id;pager=$(pagerHtml).appendTo(this.grid.container())}else{pager=this._pager()}if(this.grid.hasFixedColumns()){pager.css("clear","both")}pager.addClass(this.css.pagerClass);if(this.options.showPagerRecordsLabel){recordsCount=this.grid.dataSource.totalRecordsCount()>0?this.grid.dataSource.totalRecordsCount():this.grid.dataSource.totalLocalRecordsCount();startRecord=this.options.currentPageIndex===0?1:this.options.currentPageIndex*this.pageSize()+1;localRecordsCount=this._getDSLocalRecordsCount();if(this.grid.dataSource._filter){recordsCount=localRecordsCount;filtering=this.grid.element.data("igTreeGridFiltering");if(filtering){tmpl=filtering._getFilterSummaryPagerTemplate();if(tmpl!==undefined&&tmpl!==null){template=tmpl}}}if(startRecord>recordsCount){startRecord=this.grid.dataSource.pageIndex()*this.pageSize()+1;this.options.currentPageIndex=this.grid.dataSource.pageIndex()}endRecord=this.options.currentPageIndex===0&&this.pageSize()<=recordsCount?this.pageSize():startRecord+this.pageSize()>recordsCount?recordsCount:startRecord-1+this.pageSize();if(this.grid.dataSource.totalLocalRecordsCount()===0){startRecord=0;endRecord=0}if(endRecord>localRecordsCount&&this.options.type==="local"){endRecord=localRecordsCount}if(this.grid.container().find(".ui-iggrid-footer .ui-iggrid-results").data("overrideLabel")===0||this._overrideLabel||!this.grid.dataSource._filter){this._plabel().remove();template=template.replace("${startRecord}",startRecord).replace("${endRecord}",endRecord).replace("${recordCount}",recordsCount);recordsLabel=$("<span>"+template+"</span>").appendTo(pager).attr("id",pager[0].id+"_label").addClass(this.css.pagerRecordsLabel).attr("title",this.options.pagerRecordsLabelTooltip).show()}else if(this._plabel().length===0){recordsLabel=$("<span></span>").appendTo(pager).attr("id",pager[0].id+"_label").addClass(this.css.pagerRecordsLabel).attr("title",this.options.pagerRecordsLabelTooltip).show()}if(recordsLabel){recordsLabel.data("hideflag",false)}this._plabel().show();this._overrideLabel=false}pageCount=this.grid.dataSource.pageCount();pagerRight=$("<div></div>").appendTo(pager).addClass(this.css.pagerRightAreaContainer);if(this.options.showFirstLastPages===true){this._renderFirstPage(pagerRight)}if(this.options.showPrevNextPages===true){this._renderPrevPage(pagerRight)}if(this.grid.dataSource.pageCount()<=this.options.pageCountLimit){pageList=$("<ul></ul>").appendTo(pagerRight).addClass(this.css.pageList);if(!this._pagerEvents){this._pagerEvents={keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){var noCancel=true,noCancelBinding=true,newIndex=$(event.currentTarget).closest("li").data("pageIndex");if(newIndex!==self.options.currentPageIndex){noCancel=self._trigger(self.events.pageIndexChanging,null,{newPageIndex:newIndex,currentPageIndex:self.options.currentPageIndex,owner:self});self._shouldFirePageIndexChanged=true;if(noCancel){noCancelBinding=self.grid._trigger(self.grid.events.dataBinding,null,{owner:self.grid,dataSource:self.grid.dataSource});if(noCancelBinding){self._showLoading();self.pageIndex(newIndex)}}}event.stopPropagation();event.preventDefault()}},focus:function(event){$(event.currentTarget).closest("li").addClass(self.css.pageFocused)},blur:function(event){$(event.currentTarget).closest("li").removeClass(self.css.pageFocused)}}}else{this._pager().undelegate("li",this._pagerEvents)}this._pager().delegate("li",this._pagerEvents);val=Math.floor(parseInt(vpc,10)/2);startPageIndex=this.options.currentPageIndex-val;if(startPageIndex<0){startPageIndex=0}endPageIndex=this.options.currentPageIndex+val;if(this.options.currentPageIndex-startPageIndex<val){endPageIndex+=val-(this.options.currentPageIndex-startPageIndex)}if(this.grid.dataSource.pageCount()-(this.options.currentPageIndex+1)<val&&vpc%2!==0){startPageIndex=startPageIndex-(val-(this.grid.dataSource.pageCount()-(this.options.currentPageIndex+1)))}if(endPageIndex>=this.grid.dataSource.pageCount()){endPageIndex=this.grid.dataSource.pageCount()-1}if(startPageIndex<0){startPageIndex=0}if(vpc%2===0&&endPageIndex-startPageIndex<vpc-1){startPageIndex-=vpc-1-(endPageIndex-startPageIndex)}if(startPageIndex<0){startPageIndex=0}for(i=startPageIndex;i<=endPageIndex&&i-startPageIndex<vpc;i++){html=pageLinkHtml.replace("${page}",i+1).replace("${pageLinkClass}",i===this.options.currentPageIndex?this.css.pageLinkCurrent:this.css.pageLink);html=html.replace("${pageClass}",i===this.options.currentPageIndex?this.css.pageCurrent:this.css.page);$(html).appendTo(pageList).attr("title",this.options.pageTooltipFormat.replace("${index}",i+1)).data("pageIndex",i)}}else{pagesArray=[];for(i=1;i<=pageCount;i++){pagesArray.push(i+this._empty())}dropDownContainer=$("<div></div>").appendTo(pagerRight).addClass(this.css.pageDropDownContainer).attr("title",this.options.currentPageDropDownTooltip);$("<span></span>").appendTo(dropDownContainer).text(this.options.currentPageDropDownLeadingLabel).addClass(this.css.pageDropDownLabels);kbrdNavEvents=this._getEditorKeyboardNavigation();edtrOpts={listItems:pagesArray,dropDownAttachedToBody:true,visibleItemsCount:this.dropDownVisibleItemsCount,suppressNotifications:true,isLimitedToListValues:true,width:this.options.defaultDropDownWidth,allowNullValue:false,buttonType:"dropdown",value:this.options.currentPageIndex+1,minValue:1,maxValue:pagesArray[pagesArray.length-1],dropDownListOpened:$.proxy(this._onSelectDropDownOpened,this),textChanged:$.proxy(this._onSelectDropDownPageIndex,this)};edtrOpts=$.extend(edtrOpts,kbrdNavEvents);this._curPageDD=$("<span />").appendTo(dropDownContainer).addClass(this.css.pageDropDownContainer).igNumericEditor(edtrOpts);this._curPageDD.igNumericEditor("selectedListIndex",this.options.currentPageIndex);$("<span></span>").appendTo(dropDownContainer).text(this.options.currentPageDropDownTrailingLabel.replace("${count}",this.grid.dataSource.pageCount())).addClass(this.css.pageDropDownLabels)}if(this.options.showPrevNextPages===true){this._renderNextPage(pagerRight)}if(this.options.showFirstLastPages===true){this._renderLastPage(pagerRight)}if(this.options.showPageSizeDropDown&&this.options.pageSizeDropDownLocation==="inpager"){this._renderPageSizeDropDown(pagerRight)}this._bindEvents(pager);this._hideLoading(this.grid.element.children("tbody"));pager.show();if(this._shouldFirePageSizeChanged){this._shouldFirePageSizeChanged=false;this._trigger(this.events.pageSizeChanged,null,{pageSize:this.pageSize(),owner:this})}this._trigger(this.events.pagerRendered,null,{dataSource:this.grid.dataSource,owner:this});if(this._shouldFirePageIndexChanged){this._shouldFirePageIndexChanged=false;this._trigger(this.events.pageIndexChanged,null,{pageIndex:this.options.currentPageIndex,owner:this})}}},_getEditorKeyboardNavigation:function(){return{focus:function(e,args){var edtr=args.owner;if(edtr._dropDownList&&!edtr._dropDownList.is(":visible")){edtr.showDropDown()}},keydown:function(e,args){var edtr=args.owner,$activeItem;if(edtr._dropDownList&&edtr._dropDownList.is(":visible")){if(e.keyCode===$.ui.keyCode.DOWN){edtr._hoverNextDropDownListItem();e.preventDefault()}else if(e.keyCode===$.ui.keyCode.UP){edtr._hoverPreviousDropDownListItem();e.preventDefault()}else if(e.keyCode===$.ui.keyCode.ENTER){$activeItem=edtr._dropDownList.children(".ui-igedit-listitem").filter("[data-active='true']");if($activeItem.length){edtr._triggerListItemClick($activeItem)}e.preventDefault()}}}}},_onSelectDropDownOpened:function(event,args){var dd=args.owner,$ddCont=dd.dropDownContainer(),$selItem=dd.getSelectedListItem();if(!$selItem.length){return}$ddCont.scrollTop($selItem.position().top-(this.dropDownVisibleItemsCount-1)*$selItem.outerHeight())},_onSelectDropDownPageIndex:function(event,args){var self=this;if(this._timeoutId!==undefined){clearTimeout(this._timeoutId)}if(parseInt(this.options.delayOnPageChanged,10)===0||event&&event.originalEvent&&event.originalEvent.type!=="keypress"){this._dropDownPageIndex(event,args)}else{this._timeoutId=setTimeout(function(){self._dropDownPageIndex(event,args)},this.options.delayOnPageChanged)}},_dropDownPageIndex:function(event,args){var noCancel=true,noCancelBinding=true,parsedString,editor=args.owner,val=args.text,pageInd=parseInt(val,10),mapping={"１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","０":"0"};if(val===""){return}if(isNaN(pageInd)){parsedString=val;$.each(mapping,function(jpVal,engVal){parsedString=parsedString.replace(new RegExp(jpVal,"g"),engVal)});pageInd=parseInt(parsedString,10);if(isNaN(pageInd)){editor.value(this.options.currentPageIndex+1);return}}if(pageInd<=0||pageInd>this.grid.dataSource.pageCount()){editor.hideDropDown();editor.value(this.options.currentPageIndex+1);return}if(pageInd-1===this.options.currentPageIndex){editor.hideDropDown();return}noCancel=this._trigger(this.events.pageIndexChanging,null,{newPageIndex:pageInd-1,currentPageIndex:this.options.currentPageIndex,owner:this});if(noCancel){noCancelBinding=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(noCancelBinding){editor.selectedListIndex(pageInd-1);this._shouldFirePageIndexChanged=true;if(!isNaN(pageInd)){this._showLoading();this.pageIndex(pageInd-1)}}}},_renderPrevPage:function(pager){var prev,self=this,imgspan;prev=$("<div></div>").appendTo(pager).addClass(this.css.prevPage).attr("title",this.options.prevPageTooltip);if(this.options.currentPageIndex===0){$("<span></span>").appendTo(prev).addClass(this.css.prevPageImageDisabled);$("<span></span>").appendTo(prev).addClass(this.css.prevPageLabelDisabled).append(this.options.prevPageLabelText)}else{prev.bind("mousedown",$.proxy(this._prevPage,this));imgspan=$("<span></span>").appendTo(prev).addClass(this.css.prevPageImage);$("<span></span>").appendTo(prev).addClass(this.css.prevPageLabel).append(this.options.prevPageLabelText);imgspan.wrap(toStaticHTML('<a href="javascript:void(0);" tabIndex="-1"></a>'));prev.attr("tabIndex","0").bind({keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._prevPage();event.stopPropagation();event.preventDefault()}},focus:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-default").addClass("ui-state-focus")},blur:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-focus").addClass("ui-state-default")}})}},_renderNextPage:function(pager){var next,self=this,imgspan;next=$("<div></div>").appendTo(pager).addClass(this.css.nextPage).attr("title",this.options.nextPageTooltip);if(this.options.currentPageIndex===this.grid.dataSource.pageCount()-1){$("<span></span>").appendTo(next).addClass(this.css.nextPageLabelDisabled).append(this.options.nextPageLabelText);$("<span></span>").appendTo(next).addClass(this.css.nextPageImageDisabled)}else{next.bind("mousedown",$.proxy(this._nextPage,this));$("<span></span>").appendTo(next).addClass(this.css.nextPageLabel).append(this.options.nextPageLabelText);imgspan=$("<span></span>").appendTo(next).addClass(this.css.nextPageImage);imgspan.wrap(toStaticHTML('<a href="javascript:void(0);" tabIndex="-1"></a>'));next.attr("tabIndex","0").bind({keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._nextPage();event.stopPropagation();event.preventDefault()}},focus:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-default").addClass("ui-state-focus")},blur:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-focus").addClass("ui-state-default")}})}},_renderFirstPage:function(pager){var first,self=this,imgspan;first=$("<div></div>").appendTo(pager).addClass(this.css.firstPage).attr("title",this.options.firstPageTooltip);if(this.options.currentPageIndex===0){$("<span></span>").appendTo(first).addClass(this.css.firstPageImageDisabled);$("<span></span>").appendTo(first).addClass(this.css.firstPageLabelDisabled).append(this.options.firstPageLabelText)}else{first.bind("mousedown",$.proxy(this._firstPage,this));imgspan=$("<span></span>").appendTo(first).addClass(this.css.firstPageImage);$("<span></span>").appendTo(first).addClass(this.css.firstPageLabel).append(this.options.firstPageLabelText);imgspan.wrap(toStaticHTML('<a href="javascript:void(0);" tabIndex="-1"></a>'));first.attr("tabIndex","0").bind({keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._firstPage();event.stopPropagation();event.preventDefault()}},focus:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-default").addClass("ui-state-focus")},blur:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-focus").addClass("ui-state-default")}})}},_renderLastPage:function(pager){var last,self=this,imgspan;last=$("<div></div>").appendTo(pager).addClass(this.css.lastPage).attr("title",this.options.lastPageTooltip);if(this.options.currentPageIndex===this.grid.dataSource.pageCount()-1){$("<span></span>").appendTo(last).addClass(this.css.lastPageLabelDisabled).append(this.options.lastPageLabelText);$("<span></span>").appendTo(last).addClass(this.css.lastPageImageDisabled)}else{last.bind("mousedown",$.proxy(this._lastPage,this));$("<span></span>").appendTo(last).addClass(this.css.lastPageLabel).append(this.options.lastPageLabelText);imgspan=$("<span></span>").appendTo(last).addClass(this.css.lastPageImage);imgspan.wrap(toStaticHTML('<a href="javascript:void(0);" tabIndex="-1"></a>'));last.attr("tabIndex","0").bind({keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._lastPage();event.stopPropagation();event.preventDefault()}},focus:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-default").addClass("ui-state-focus")},blur:function(event){$(event.currentTarget).closest("div").removeClass("ui-state-focus").addClass("ui-state-default")}})}},_renderPageSizeDropDown:function(parent,prepend){var i,ps,editorId=this.grid.id()+"_editor",cClass,items,self=this,edtrOpts,kbrdNavEvents;cClass=this.options.pageSizeDropDownLocation==="above"?this.css.pageSizeDropDownContainerAbove:this.css.pageSizeDropDownContainer;if(prepend){parent=$("<div></div>").prependTo(parent).addClass(cClass)}else{parent=$("<div></div>").appendTo(parent).addClass(cClass)}parent.attr("title",this.options.pageSizeDropDownTooltip);parent=$("<div></div>").appendTo(parent).addClass(this.css.pagingResults);if(prepend){$("<span>"+this.options.pageSizeDropDownTrailingLabel+"</span>").prependTo(parent).addClass(this.css.pageSizeLabel);$("<span></span>").prependTo(parent).attr("id",editorId);$("<span>"+this.options.pageSizeDropDownLabel+"</span>").prependTo(parent).addClass(this.css.pageSizeLabel)}else{$("<span>"+this.options.pageSizeDropDownLabel+"</span>").appendTo(parent).addClass(this.css.pageSizeLabel);$("<span></span>").appendTo(parent).attr("id",editorId).addClass(this.css.pageSizeDropDown);$("<span>"+this.options.pageSizeDropDownTrailingLabel+"</span>").appendTo(parent).addClass(this.css.pageSizeLabel)}items=this.options.pageSizeList===null||this.options.pageSizeList.length===0?[5,10,20,25,50,75,100]:this.options.pageSizeList;if($.type(items)==="string"){items=items.split(",")}ps=this.pageSize();kbrdNavEvents=this._getEditorKeyboardNavigation();edtrOpts={width:this.options.defaultDropDownWidth,dropDownAttachedToBody:true,suppressNotifications:true,buttonType:"dropdown",dropDownOnReadOnly:true,listItems:items,allowNullValue:false,readOnly:true,textAlign:"left",value:ps,valueChanged:function(e,args){if(self.options.pageSizeDropDownLocation==="inpager"){setTimeout(function(){self._changePageSize(e,args)},0)}else{self._changePageSize(e,args)}},rendered:function(e,args){var edtr=args.owner;edtr.editorContainer().addClass(self.css.pageSizeDropDown);edtr.field().removeClass("ui-state-disabled");edtr.editorContainer().removeClass("ui-state-disabled")}};edtrOpts=$.extend(edtrOpts,kbrdNavEvents);this._pageSizeDD=this.grid.container().find("#"+editorId).igNumericEditor(edtrOpts);for(i=0;i<items.length;i++){if(items[i]===ps){this._pageSizeDD.igNumericEditor("selectedListIndex",i);break}}if($.ig.util.isIE8===true&&this.grid.options._isHierarchicalGrid&&this.grid.options.fixedHeaders){$("<col></col>").appendTo(this.grid.headersTable().find("colgroup")).remove()}this._pageSizeDropDownRendered=true;this._trigger("pagingdropdownrendered")},_changePageSize:function(event,args){var noCancel=true,size=args.owner.value();noCancel=this._trigger(this.events.pageSizeChanging,null,{currentPageSize:this.pageSize(),newPageSize:size,owner:this});if(noCancel){if(this.options.type==="remote"){this.grid.element.trigger("iggriduidirty",{owner:this})}else{this.grid.element.trigger("iggriduisoftdirty",{owner:this})}this.pageSize(size);if(this.options.type==="remote"){this._shouldFirePageSizeChanged=true}else{this._trigger(this.events.pageSizeChanged,null,{pageSize:size,owner:this})
}}else{args.owner.value(this.pageSize())}},_deleteOld:function(destroy){if(this._curPageDD){this._curPageDD.igNumericEditor("destroy");delete this._curPageDD}if(destroy&&this._pageSizeDD&&this._pageSizeDD.closest("body").length>0){this._pageSizeDD.igNumericEditor("destroy");delete this._pageSizeDD}},destroy:function(){var pager=this._pager();this.pageSize(0);this._deleteOld(true);if(this.options.showPageSizeDropDown===true&&this.options.pageSizeDropDownLocation==="above"){$("#"+this.grid.container()[0].id+" .ui-iggrid-pagesizedropdowncontainerabove").remove()}pager.remove();if(this._loadingIndicator){delete this._loadingIndicator}$.Widget.prototype.destroy.call(this);return this},_injectGrid:function(gridInstance,isRebind){this.grid=gridInstance;if(this.options.type===null){this.options.type=this.grid._inferOpType()}if(!this.options.persist){if(isRebind){this.options.currentPageIndex=this._oPageIndex;this.options.pageSize=this._oPageSize}}else{this._loadPagingData()}this.grid.dataSource.settings.paging.type=this.options.type||"remote";this.grid.dataSource.settings.paging.pageIndex=this.options.currentPageIndex;if(this.options.type==="local"){this.grid.dataSource.persistedPageIndex(this.grid.dataSource.settings.paging.pageIndex)}this.grid.dataSource.settings.paging.pageSize=parseInt(this.options.pageSize,10);if(this.options.pageSizeUrlKey!==null&&this.options.pageIndexUrlKey){this.grid.dataSource.settings.paging.pageSizeUrlKey=this.options.pageSizeUrlKey;this.grid.dataSource.settings.paging.pageIndexUrlKey=this.options.pageIndexUrlKey}if(this.options.recordCountKey!==null){this.grid.dataSource.settings.responseTotalRecCountKey=this.options.recordCountKey}this.grid.dataSource.settings.paging.enabled=true;if(this._pageSizeDD){this._pageSizeDD.igNumericEditor("option","value",this.options.pageSize)}},_empty:function(){return""}});$.extend($.ui.igGridPaging,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Column Resizing 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridResizing",{options:{allowDoubleClickToResize:true,deferredResizing:false,columnSettings:[{columnKey:null,columnIndex:null,allowResizing:true,minimumWidth:20,maximumWidth:null}],handleThreshold:5,inherit:false},css:{columnResizeLine:"ui-iggrid-resize-line",resizingHandleCursor:"ui-iggrid-resizing-handle-cursor",resizingHandle:"ui-iggrid-resizing-handle"},events:{columnResizing:"columnResizing",columnResizingRefused:"columnResizingRefused",columnResized:"columnResized"},_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_setOption:function(key){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))},destroy:function(){this._clearResizingHandles();this.grid.element.unbind(".resizing");$.Widget.prototype.destroy.call(this);return this},resize:function(column,width){var columnIndex,gridWidth;if(typeof column==="number"){columnIndex=column}else{$.each(this.grid._visibleColumns(),function(index,col){if(col.key===column){columnIndex=index}});if(columnIndex===undefined){throw new Error($.ig.GridResizing.locale.noSuchVisibleColumn)}}if(width===undefined||width===null){this._autoResize(columnIndex,false,null)}else{if($.type(width)==="string"&&width.indexOf("%")>0){gridWidth=this.grid.element.width();width=parseInt(width,10)*gridWidth/100}this._resizeColumn(columnIndex,width,false,null)}},_headerRendered:function(){if(this.grid.element.igGridColumnFixing!==undefined){this._columnFixing=this.grid.element.data("igGridColumnFixing")}this._renderResizingHandles()},_columnsCollectionModified:function(){this._renderResizingHandles()},_columnsMoved:function(e,args){var ths,grid=this.grid,len=args.len,startIndex=args.start,endIndex=args.index,ind,after=endIndex-startIndex>0,$th;this._populateMultiColumnHeadersLevel0();if(after){endIndex-=len}if(grid._isMultiColumnGrid){ths=$(grid._headerCells)}else{if(grid.options.virtualization===true||grid.options.rowVirtualization===true){ths=grid.headersTable().find("> thead > tr").eq(0).children("th").not("[data-skip=true]")}else{ths=grid.headersTable().find("> thead > tr[data-header-row]").eq(0).children("th").not("[data-skip=true]")}}function funcCalibrateResizingHandle(ind){if(ths&&ths[ind]){$th=$(ths[ind]);$th.find("span[data-nonpaddedindicator='right']").css("margin-right",-parseInt($th.css("padding-right"),10)+"px")}}if(after){ind=endIndex-1}else{ind=startIndex+len-1}funcCalibrateResizingHandle(ind);funcCalibrateResizingHandle(endIndex+len-1)},_hiddenColumnIndicatorsRendered:function(ths){ths.find("span[data-nonpaddedindicator='right']").each(function(ind,span){var $span=$(span),$th=$span.closest("th");$span.css("margin-right",-parseInt($th.css("padding-right"),10)+"px")})},_fixedColumnsChanged:function(){this._renderResizingHandles()},_renderResizingHandles:function(){var self=this,i,ths,visibleColumns=this.grid._visibleColumns(),thsMultiHeader,gridId=this.grid.element.attr("id"),hasFixedColumns=this.grid.hasFixedColumns();this._clearResizingHandles();if(visibleColumns.length===0){return}if(this.grid._isMultiColumnGrid){thsMultiHeader=this.grid.headersTable().find("> thead > tr th").not("[data-skip=true]").not("[data-isheadercell=true]");if(hasFixedColumns){$.each(this.grid.fixedHeadersTable().find("> thead > tr th").not("[data-skip=true]").not("[data-isheadercell=true]"),function(index,th){thsMultiHeader.push($(th))})}this._populateMultiColumnHeadersLevel0();thsMultiHeader.each(function(){var a,th=$(this),mchId=th.data("mchId"),i,cs=self._oColumnSettings;for(i=0;i<cs.length;i++){if(cs[i].columnKey===mchId&&cs[i].allowResizing===false){return true}}a=self._renderResizingHandle(th);self._bindMultipleResizingHandle(th,a.find("span"))});ths=$(this.grid._headerCells)}else{if(this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true){if(hasFixedColumns){ths=$();for(i=0;i<visibleColumns.length;i++){ths.push($("#"+gridId+"_"+visibleColumns[i].key))}}else{ths=this.grid.headersTable().find("> thead > tr").eq(0).children("th").not("[data-skip=true]")}}else{if(hasFixedColumns){ths=$();for(i=0;i<visibleColumns.length;i++){ths.push($("#"+gridId+"_"+visibleColumns[i].key))}}else{ths=this.grid.headersTable().find("> thead > tr[data-header-row]").eq(0).children("th").not("[data-skip=true]")}}}ths.each(function(index){var a,cs,th=$(this),col=visibleColumns[index];if(col===null||col===undefined){return true}cs=self._findColumnSettingsByKey(col.key);if(cs.allowResizing){a=self._renderResizingHandle(th);self._bindResizingHandle(th,a.find("span"),col)}})},_renderResizingHandle:function(th){var div,a;if(!this._resizingHandles){this._resizingHandles=[]}div=$("<div data-resizinghandle='true' />").css("position","relative").css("width","100%").css("height","0px").css("top","0px").css("left","0px").prependTo(th);a=$("<a />").attr("title","").prependTo(div);if($.ig.util.isIE9){a.addClass(this.css.resizingHandleCursor)}$("<span data-nonpaddedindicator='right'></span>").attr("title","").css("position","absolute").css("margin-right",-parseInt(th.css("padding-right"),10)+"px").css("right","0px").css("width",this.options.handleThreshold+"px").addClass(this.css.resizingHandleCursor).addClass(this.css.resizingHandle).appendTo(a);this._resizingHandles.push(div);return a},_populateMultiColumnHeadersLevel0:function(){var i,j,self=this,cols=this.grid._oldCols||[],colsLength=cols.length,ths=$(this.grid._headerCells),level0=[],level0Length,visibleColumns=this.grid._visibleColumns();for(i=0;i<colsLength;i++){if(cols[i].level===0){level0.push(cols[i])}else{for(j=0;j<cols[i].children.length;j++){level0.push(cols[i].children[j])}}}level0Length=level0.length;ths.each(function(index){var th=$(this),col=visibleColumns[index],cs;if(col===null||col===undefined){return true}cs=self._findColumnSettingsByKey(col.key);if(cs.allowResizing){for(i=0;i<level0.length;i++){if(level0[i].key===col.key){break}}if(i<level0Length){level0[i].allowResizing=true;level0[i].visibleIndex=index;level0[i].settings=cs}th.col=level0[i]}})},_bindMultipleResizingHandle:function($th,button){var self=this,id=$th.attr("data-mch-id"),column;column=this.grid._getMultiHeaderColumnById(id);button.mouseWrapper({distance:5,start:function(){return self._startResizing($th)},drag:function(event){return self._doResizingMultiColumnHeader(event.originalEvent,$th,column)},stop:function(event){return self._stopResizingMiltiColumnHeader(event.originalEvent,$th,column)}}).bind("dblclick.resizing",function(event){self._handleMouseMultiColumnHeaderDbClick(event,$th,column)}).bind("click.resizing",function(event){event.preventDefault();event.stopPropagation()})},_bindResizingHandle:function(th,button,column){var self=this;button.mouseWrapper({distance:5,start:function(){return self._startResizing(th)},drag:function(event){return self._doResizing(event.originalEvent,th,column)},stop:function(event){return self._stopResizing(event.originalEvent,th,column)}}).bind("dblclick.resizing",function(event){self._handleMouseDbClick(event,th,column)}).bind("click.resizing",function(event){event.preventDefault();event.stopPropagation()})},_clearResizingHandles:function(){var i;if(this._resizingHandles){for(i=0;i<this._resizingHandles.length;i++){this._resizingHandles[i].remove()}this._resizingHandles=[]}},_handleMouseDbClick:function(event,th,column){if(!this.options.allowDoubleClickToResize){return}this._autoResize($.inArray(column,this.grid._visibleColumns()),true,event)},_handleMouseMultiColumnHeaderDbClick:function(event,$th,column){var i,children=column.children,childrenLength=children.length;if(!this.options.allowDoubleClickToResize){return}for(i=0;i<childrenLength;i++){if(children[i].allowResizing===true){this._autoResize(children[i].visibleIndex,true,event)}}},_autoResize:function(columnIndex,fireEvents,event){var maxWidth=this.grid.calculateAutoFitColumnWidth(columnIndex);if(maxWidth>-1){return this._resizeColumn(columnIndex,maxWidth,fireEvents,event)}},_cancelHoveringEffects:function(cancel){var topmostGrid=this.grid.element.closest(".ui-iggrid-root").data("igGrid");if(topmostGrid===undefined||topmostGrid===null){topmostGrid=this.grid}topmostGrid._cancelHoveringEffects=cancel},_startResizing:function(th){var body=$(document.body),resizeLineTop,heightOffset;this._resizing=true;this._cancelHoveringEffects(true);if(!$.ig.util.isIE10){$(document.activeElement).blur()}else{body.focus()}body.addClass(this.css.resizingHandleCursor);if(this.grid._isMultiColumnGrid){heightOffset=th.offset().top-this._gridContainerPositioningOffset().top}resizeLineTop=th.offset().top+this._gridContainerPositioningOffset().top;if(this.grid.options.height!==null&&this.grid.options.showHeader===true&&this.grid.options.fixedHeaders===false){resizeLineTop+=this.grid.scrollContainer().scrollTop()}this._resizeLine=$("<div></div>").addClass(this.css.columnResizeLine).data("efh","1").css({height:this._calculateGridResizableHeight(heightOffset),top:resizeLineTop,visibility:"hidden"}).appendTo(this.grid.container());if($.ig.util.isIE8){this.grid.container().attr("tabIndex",this.grid.container().attr("tabIndex"))}return true},_doResizingMultiColumnHeader:function(event,$th,column){var i,width,resizeCellRange,resizeResult,range,vI,offsetLeft,offsetHeight,children=column.children,childrenLength=children.length,child=null,cellToResize;width=event.pageX-$th.offset().left;if(width<0){width=0}offsetHeight=$th.offset().top-this.grid.headersTable().offset().top;if(!this.options.deferredResizing){for(i=childrenLength-1;i>=0;i--){if(children[i].allowResizing&&!children[i].hidden){child=children[i];child.resized=!child.resized;if(child.resized){break}}}if(child!==null&&!child.hidden){cellToResize=$("#"+this.grid.element[0].id+"_"+child.key);vI=$.inArray(child,this.grid._visibleColumns());width=cellToResize[0].offsetWidth-$th[0].offsetWidth+width;resizeResult=this._resizeColumn(vI,width,true,event,vI)}if(!resizeResult){return true}if(!resizeResult.canceled){this._resizeLine.css("height",this._calculateGridResizableHeight(offsetHeight));this._resizeLine.css({left:$th.offset().left+$th.outerWidth()+this._gridContainerPositioningOffset().left,visibility:"visible"})}}else{offsetLeft=$th.offset().left;range={min:offsetLeft,max:offsetLeft};for(i=0;i<childrenLength;i++){child=children[i];if(child.hidden){continue}if(child.allowResizing){resizeCellRange=this._getRange(this.options.columnSettings[child.visibleIndex]);range.min+=resizeCellRange.min;if(resizeCellRange.max===Infinity){range.max=Infinity}else if(range.max!==Infinity){range.max+=resizeCellRange.max}}else{range.min+=$("#"+this.grid.element[0].id+"_"+child.key)[0].offsetWidth}}this._resizeLine.css("height",this._calculateGridResizableHeight(offsetHeight));this._resizeLine.css({left:this._coerceRange(range,event.pageX)+this._gridContainerPositioningOffset().left,visibility:"visible"})}return true},_doResizing:function(event,th,column){var width,resizeResult,columnIndex=$.inArray(column,this.grid._visibleColumns()),range,offsetLeft,offsetHeight;if(!this.options.deferredResizing){width=event.pageX-th.offset().left;if(width<0){width=0}if(this.grid._isMultiColumnGrid){offsetHeight=th.offset().top-this.grid.headersTable().offset().top}resizeResult=this._resizeColumn(columnIndex,width,true,event);if(!resizeResult.canceled){this._resizeLine.css("height",this._calculateGridResizableHeight(offsetHeight));this._resizeLine.css({left:th.offset().left+th.outerWidth()+this._gridContainerPositioningOffset().left,visibility:"visible"})}}else{range=this._getRange(this.options.columnSettings[columnIndex]);offsetLeft=th.offset().left;range.min+=offsetLeft;range.max+=offsetLeft;this._resizeLine.css({left:this._coerceRange(range,event.pageX)+this._gridContainerPositioningOffset().left,visibility:"visible"})}return true},_stopResizingMiltiColumnHeader:function(event,th,column){var i,width,cs,columnKey,self=this,children,childrenLength,childrenLengthAllowResizing=0,childrenToResize;if(this.options.deferredResizing){width=event.pageX-th.offset().left;children=column.children;childrenLength=children.length;childrenToResize=[];for(i=0;i<childrenLength;i++){columnKey=children[i].key;cs=this._findColumnSettingsByKey(columnKey);if(children[i].allowResizing===false||cs&&cs.allowResizing===false){width-=$("#"+this.grid.element[0].id+"_"+columnKey)[0].offsetWidth;continue}childrenToResize.push(children[i]);childrenLengthAllowResizing++}if(childrenLengthAllowResizing>0){this._resizeMCHDeffered(width,childrenToResize)}}$("body").removeClass(this.css.resizingHandleCursor);setTimeout(function(){self._resizing=false},0);this._cancelHoveringEffects(false);this._resizeLine.remove();this._resizeLine=undefined;return true},_resizeMCHDeffered:function(width,columns){var i,column,columnIndex,columnsLength=columns.length,visibleColumns=[],gridVC=this.grid._visibleColumns(),resizeInfo,newWidth=width,newColumnsToResize=[],avgWidth;if(columnsLength===0){return}for(i=0;i<columnsLength;i++){columnIndex=$.inArray(columns[i],gridVC);if(columnIndex===-1||this.options.columnSettings[columnIndex].allowResizing===false){continue}visibleColumns.push({column:column,columnIndex:columnIndex})}columnsLength=visibleColumns.length;if(columnsLength>0){avgWidth=parseInt(width/columnsLength,10);for(i=0;i<columnsLength;i++){column=visibleColumns[i].column;columnIndex=visibleColumns[i].columnIndex;resizeInfo=this._resizeColumn(columnIndex,avgWidth,true);if(resizeInfo.newWidth!==avgWidth){newWidth-=resizeInfo.newWidth}else{newColumnsToResize.push(column)}}}if(newWidth>5&&newWidth!==width&&newColumnsToResize.length>0){this._resizeMCHDeffered(newWidth,newColumnsToResize)}},_stopResizing:function(event,th,column){var width,self=this,columnIndex=$.inArray(column,this.grid._visibleColumns());if(this.options.deferredResizing){width=event.pageX-th.offset().left;width=this._coerceRange(this._getRange(this.options.columnSettings[columnIndex]),width);this._resizeColumn(columnIndex,width,true,event)}$("body").removeClass(this.css.resizingHandleCursor);setTimeout(function(){self._resizing=false},0);this._cancelHoveringEffects(false);this._resizeLine.remove();this._resizeLine=undefined;return true},_resizeColumn:function(columnIndex,width,fireEvents,originalEvent,startIndex){var gridWidth,minimalVisibleAreaWidth=0,widthFixedContainer,visibleColumns=this.grid._visibleColumns(),columnKey=visibleColumns[columnIndex].key,typeW,hasWidthPx,w,tmpW,visibleIndex=columnIndex,headersTable=this.grid.headersTable(),cs,isFixed,headers,headerWidth,headerColumns,columnSettings=this.options.columnSettings,hasFixedCols=this.grid.hasFixedColumns(),columnsLength,headerColStyleWidth,hasPercentageWidth,actualColumnStyleWidths=[],actualColumnWidths=[],requiredColumnPercentageWidths=[],newColumnStyleWidths=[],i,widthToDistribute,shrinkColumns,widthDistributed,widthUsed,coercedWidth,widthPerColumn,range,totalWidth,readyColumns,readyColumnsCount,finalPixelWidth,allColumnsHaveWidth,noCancel,containerWidth,isResized=true;if(hasFixedCols){visibleIndex=this.grid.getVisibleIndexByKey(columnKey);isFixed=visibleColumns[columnIndex].fixed===true;if(isFixed){headersTable=this.grid.fixedHeadersTable()}}if(this.grid._isMultiColumnGrid){headers=$(this.grid._headerCells);headerWidth=headers.length>0?$(headers[columnIndex])[0].offsetWidth:headerWidth}else{if(this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true){headers=headersTable.find("> thead > tr").first().children("th").not("[data-skip=true]")}else{headers=headersTable.find("> thead > tr[data-header-row]").first().children("th").not("[data-skip=true]")}headerWidth=headers.length>0?headers.get(visibleIndex).offsetWidth:headerWidth}headerColumns=headersTable.find("> colgroup > col").not("[data-skip=true]");columnSettings=this.options.columnSettings;columnsLength=headerColumns.length;headerColStyleWidth=headerColumns[visibleIndex].style.width;hasPercentageWidth=/%$/.test(headerColStyleWidth);if(headerColStyleWidth===""){hasPercentageWidth=true;headerColumns.each(function(ind,col){if(col.style.width!==""){hasPercentageWidth=false;return false}})}if(fireEvents){noCancel=this._trigger(this.events.columnResizing,originalEvent,{owner:this,columnIndex:columnIndex,columnKey:columnKey,desiredWidth:width});if(!noCancel){return{canceled:true,originalWidth:width,newWidth:width}}}if(columnKey!==undefined){cs=this._findColumnSettingsByKey(columnKey)}else{cs=columnSettings[columnIndex]}range=this._getRange(cs);width=this._coerceRange(range,width);width=Math.floor(width);if(width===range.min||width===range.max){isResized=false}if(isFixed){widthToDistribute=headerWidth-width;gridWidth=parseInt(this.grid.options.width,10);if(isNaN(gridWidth)||this.grid._gridHasWidthInPercent()){gridWidth=this.grid.container().outerWidth()}if(widthToDistribute<0){minimalVisibleAreaWidth=this._columnFixing.options.minimalVisibleAreaWidth;if(this._columnFixing._isVirtualGrid()){widthFixedContainer=this.grid._virtualcontainer().find("colgroup:first>col[data-fixed-col]").width()}else{widthFixedContainer=this.grid.fixedContainer().outerWidth()}if(widthFixedContainer-widthToDistribute>gridWidth-this.grid._scrollbarWidth()-minimalVisibleAreaWidth){if(fireEvents){this._trigger(this.events.columnResizingRefused,originalEvent,{owner:this,columnIndex:columnIndex,columnKey:columnKey,desiredWidth:width})}return{canceled:true,originalWidth:width,newWidth:width}}}}if($.ig.util.isWebKit&&hasPercentageWidth){totalWidth=headersTable[0].offsetWidth;for(i=0;i<columnsLength;i++){w=headerColumns[i].style.width;if(w===""){actualColumnWidths[i]=parseFloat(headers[i].offsetWidth)}else{actualColumnWidths[i]=w.indexOf("%")>0?parseFloat(w)/100*totalWidth:parseFloat(w)}}}else if(headers.length>0){for(i=0;i<columnsLength;i++){actualColumnStyleWidths[i]=headerColumns[i].style.width;actualColumnWidths[i]=this.grid._isMultiColumnGrid?headers[i][0].offsetWidth:headers[i].offsetWidth}}if(hasPercentageWidth){widthToDistribute=headerWidth-width;shrinkColumns=widthToDistribute<0;readyColumns=[];readyColumnsCount=0;widthDistributed=0;if(startIndex===undefined||startIndex===null){startIndex=0}while(readyColumnsCount<columnsLength-1-startIndex&&(shrinkColumns&&widthToDistribute<-.05||!shrinkColumns&&widthToDistribute>.05)){widthPerColumn=widthToDistribute/(columnsLength-1);for(i=startIndex;i<columnsLength;i++){if(i!==columnIndex&&!readyColumns[i]){if(shrinkColumns){widthUsed=Math.max(widthPerColumn,widthToDistribute)}else{widthUsed=Math.min(widthPerColumn,widthToDistribute)}actualColumnWidths[i]+=widthUsed;range=this._getRange(columnSettings[i]);coercedWidth=this._coerceRange(range,actualColumnWidths[i]);if(Math.abs(actualColumnWidths[i]-coercedWidth)>5e-6){widthUsed-=actualColumnWidths[i]-coercedWidth;actualColumnWidths[i]=coercedWidth;readyColumns[i]=true;readyColumnsCount++}widthDistributed+=widthUsed;widthToDistribute-=widthUsed}}}actualColumnWidths[columnIndex]-=widthDistributed;totalWidth=0;for(i=0;i<columnsLength;i++){totalWidth+=actualColumnWidths[i]}for(i=0;i<columnsLength;i++){requiredColumnPercentageWidths[i]=100*actualColumnWidths[i]/totalWidth}for(i=0;i<columnsLength;i++){newColumnStyleWidths[i]=requiredColumnPercentageWidths[i]+"%";visibleColumns[i].width=newColumnStyleWidths[i]}finalPixelWidth=actualColumnWidths[columnIndex];this._applyToEachGridCOL(function(index,col){col.css("width",newColumnStyleWidths[index])},isFixed)}else{allColumnsHaveWidth=true;for(i=0;i<columnsLength;i++){if(i===visibleIndex){newColumnStyleWidths[i]=width+"px";finalPixelWidth=width;typeW=$.type(visibleColumns[columnIndex].width);hasWidthPx=typeW==="string"&&visibleColumns[columnIndex].width.indexOf("px")>0;if(typeW==="number"){visibleColumns[columnIndex].width=width}else if(typeW==="string"){if(!hasWidthPx){visibleColumns[columnIndex].width=String(width)}else{visibleColumns[columnIndex].width=newColumnStyleWidths[i]}}else{visibleColumns[columnIndex].width=newColumnStyleWidths[i]}}else{newColumnStyleWidths[i]=actualColumnStyleWidths[i];allColumnsHaveWidth=allColumnsHaveWidth&&parseInt(actualColumnStyleWidths[i],10)>0}}this._applyToEachGridCOL(function(index,col){col.css("width",newColumnStyleWidths[index])},isFixed);containerWidth=this.grid._calculateContainerWidth(false);if(allColumnsHaveWidth){if(this.grid.options.width&&parseInt(this.grid.options.width,10)>0){if(!isFixed){this.grid._updateGridContentWidth()}$("#"+this.grid.element[0].id+"_horizontalScrollContainer").children("div").css("width",containerWidth);if(this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true){this.grid._oldScrollLeft=$("#"+this.grid.id()+"_horizontalScrollContainer").scrollLeft()}if(this.grid.options.rowVirtualization||this.grid.options.virtualization===true){tmpW=containerWidth+this.grid._scrollbarWidth();$("#"+this.grid.element[0].id+"_headers").css("width",tmpW).css("max-width",tmpW);this.grid.element.css("width",containerWidth).css("max-width",containerWidth);$("#"+this.grid.id()+"_footers").css("width",tmpW).css("max-width",tmpW)}}else{if(hasFixedCols&&!isFixed){this.grid._updateGridContentWidth()}this.grid._setContainerWidth($("#"+this.grid.id()+"_container"));if(this.grid.options.rowVirtualization||this.grid.options.virtualization===true){tmpW=containerWidth+this.grid._scrollbarWidth();$("#"+this.grid.element[0].id+"_headers_v").css("width",tmpW).css("max-width",tmpW);$("#"+this.grid.element[0].id+"_displayContainer").css("width",containerWidth).css("max-width",containerWidth);$("#"+this.grid.element[0].id+"_virtualContainer > colgroup > col").first().attr("width",containerWidth);$("#"+this.grid.id()+"_footer_container").css("width",tmpW).css("max-width",tmpW)}}}}if(hasFixedCols){this._columnFixing._containerResized(isFixed,widthToDistribute)}if(fireEvents){this._trigger(this.events.columnResized,originalEvent,{owner:this,columnIndex:columnIndex,columnKey:columnKey,originalWidth:headerWidth,newWidth:finalPixelWidth})}return{canceled:false,originalWidth:headerWidth,newWidth:finalPixelWidth,isResized:isResized}},_applyToEachGridCOL:function(appliedFunction,isFixed){var headersTable,footersTable;if(this.grid.options.showHeader){if(isFixed){headersTable=this.grid.fixedHeadersTable()}else{headersTable=this.grid.headersTable()}headersTable.find("> colgroup > col").not("[data-skip=true]").each(function(i){appliedFunction(i,$(this))})}if(this.grid.options.fixedHeaders===true&&this.grid.options.height!==null||this.grid.options.showHeader===false){if(isFixed){$("#"+this.grid.id()+"_fixed").find("> colgroup > col").not("[data-skip=true]").each(function(i){appliedFunction(i,$(this))})}else{this.grid.element.find("> colgroup > col").not("[data-skip=true]").each(function(i){appliedFunction(i,$(this))})}}if(this.grid.options.fixedFooters===true&&this.grid.options.height!==null){if(isFixed){footersTable=this.grid.fixedFootersTable()}else{footersTable=this.grid.footersTable()}footersTable.find("> colgroup > col").not("[data-skip=true]").each(function(i){appliedFunction(i,$(this))})}},_getRange:function(column){var min=column.minimumWidth,max=column.maximumWidth,gridWidth;if($.type(min)==="string"&&min.indexOf("%")>0){gridWidth=this.grid.element.width();min=parseInt(min,10)*gridWidth/100}if($.type(max)==="string"&&max.indexOf("%")>0){gridWidth=this.grid.element.width();max=parseInt(max,10)*gridWidth/100}min=isNaN(min)?0:min;min=Math.max(0,min);max=isNaN(max)?Infinity:max;return{min:min,max:max}},_coerceRange:function(range,value){value=Math.max(range.min,value);value=Math.min(range.max,value);return value},_gridContainerPositioningOffset:function(){var gridContainer=this.grid.container(),containerPosition=gridContainer.css("position"),gridContainerOffsetParent=gridContainer.offsetParent(),gridContainerPosition=gridContainer.position(),gridContainerOffset=gridContainer.offset(),offsetParentScrollTop,offsetParentScrollLeft;if(containerPosition==="relative"||containerPosition==="absolute"){return{top:-gridContainerOffset.top,left:-gridContainerOffset.left}}if(gridContainerOffsetParent.is("body")){offsetParentScrollTop=0;offsetParentScrollLeft=0}else{offsetParentScrollTop=gridContainerOffsetParent.scrollTop();offsetParentScrollLeft=gridContainerOffsetParent.scrollLeft()}return{top:offsetParentScrollTop+gridContainerPosition.top-gridContainerOffset.top,left:offsetParentScrollLeft+gridContainerPosition.left-gridContainerOffset.left}},_calculateGridResizableHeight:function(heightOffset){var height,caption,headersTable,footersTable,scrollerContainer,hasVirtualization=this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true||this.grid.options.columnVirtualization===true,hasWidthOrHeight=this.grid.options.height!==null||this.grid.options.width!==null;if(hasVirtualization){height=$("#"+this.grid.element[0].id+"_displayContainer").height()}else if(hasWidthOrHeight){height=this.grid.scrollContainer().height()}else{height=this.grid.element.height()}if(hasVirtualization||hasWidthOrHeight){headersTable=this.grid.headersTable();footersTable=this.grid.footersTable();if(this.grid.options.fixedHeaders===true&&this.grid.options.showHeader===true){if(headersTable.length!==0&&this.grid.element[0].id!==headersTable[0].id){height+=headersTable.height()}caption=headersTable.children("#"+this.grid.element[0].id+"_caption");if(caption.length!==0){if(!$.ig.util.isFF){height-=caption.outerHeight(true)}}}scrollerContainer=$("#"+this.element[0].id+"_hscroller_container");if(scrollerContainer.is(":visible")){height+=scrollerContainer.height()}if(this.grid.options.fixedFooters===true&&this.grid.options.showFooter===true&&footersTable.length!==0&&this.grid.element[0].id!==footersTable[0].id){height+=footersTable.height()}}if(heightOffset){height-=heightOffset}return height},_findColumnSettingsByKey:function(key,settings){var i;if(!settings){settings=this.options.columnSettings}for(i=0;i<settings.length;i++){if(settings[i].columnKey===key){return settings[i]}}},_initDefaultSettings:function(){var settings=[],key,cs=this.options.columnSettings,i,j,mch,s;if(this.grid.options.columns&&this.grid.options.columns.length>0){for(i=0;i<this.grid.options.columns.length;i++){settings[i]={columnIndex:i,columnKey:this.grid.options.columns[i].key,allowResizing:true,minimumWidth:20}}}for(i=0;i<cs.length;i++){for(j=0;j<settings.length;j++){if(settings[j].columnKey===cs[i].columnKey||settings[j].columnIndex===cs[i].columnIndex){break}}if(j===settings.length){if(this.grid._isMultiColumnGrid&&cs[i].allowResizing===false){mch=this.grid._getMultiHeaderColumnById(cs[i].columnKey);if(mch&&mch.children){mch.allowResizing=false;for(j=0;j<mch.children.length;j++){s=this._findColumnSettingsByKey(mch.children[j].key,settings);if(s){s.allowResizing=false}mch.children[j].allowResizing=false}}}continue}for(key in cs[i]){if(cs[i].hasOwnProperty(key)&&key!=="columnIndex"&&key!=="columnKey"){settings[j][key]=cs[i][key]}}}this._oColumnSettings=this.options.columnSettings;this.options.columnSettings=settings},_injectGrid:function(gridInstance){this.grid=gridInstance;this._checkGridNotSupportedFeatures();this.grid.element.unbind(".resizing");this._initDefaultSettings();this.grid.element.bind("iggridheaderrendered.resizing",$.proxy(this._headerRendered,this));this.grid.element.bind("iggridcolumnscollectionmodified.resizing",$.proxy(this._columnsCollectionModified,this));this.grid.element.bind("iggrid_columnsmoved.resizing",$.proxy(this._columnsMoved,this))},_checkGridNotSupportedFeatures:function(){var gridOptions=this.grid.options;if((gridOptions.virtualization===true||gridOptions.columnVirtualization===true)&&gridOptions.virtualizationMode==="fixed"){throw new Error($.ig.GridResizing.locale.resizingAndFixedVirtualizationNotSupported)}}});$.extend($.ui.igGridResizing,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Tooltips 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.editors.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridRowSelectors",{options:{enableRowNumbering:true,enableCheckBoxes:false,rowNumberingSeed:0,rowSelectorColumnWidth:null,requireSelection:true,showCheckBoxesOnFocus:false,inherit:false,enableSelectAllForPaging:true,selectAllForPagingTemplate:null,deselectAllForPagingTemplate:null},css:{rowSelector:"ui-iggrid-rowselector-class",rowSelectorSelected:"ui-iggrid-selectedcell ui-state-active",rowSelectorActivated:"ui-iggrid-activecell ui-state-focus",headerRowSelector:"ui-iggrid-rowselector-header",footerRowSelector:"ui-iggrid-rowselector-footer",checkBox:"ui-state-default ui-corner-all ui-igcheckbox-normal",checkBoxOff:"ui-icon ui-icon-check ui-igcheckbox-normal-off",checkBoxOn:"ui-icon ui-icon-check ui-igcheckbox-normal-on",nodeHovered:"ui-state-hover"},events:{rowSelectorClicked:"rowSelectorClicked",checkBoxStateChanging:"checkBoxStateChanging",checkBoxStateChanged:"checkBoxStateChanged"},_createWidget:function(){$.Widget.prototype._createWidget.apply(this,arguments);if(this.options.rowSelectorColumnWidth===null){this.options.rowSelectorColumnWidth=55;if(this.options.enableCheckBoxes===true&&this.options.enableRowNumbering===true){this.options.rowSelectorColumnWidth+=15}}},_create:function(){this._cIdx=0;this._functionsRedirected=false;this._hovTR=null;this._gridRenderRecord=null;this._gridRenderRecordInArray=null;this._checkBoxesShown=false;this._nTmpl="{{html ig_rs_idx}}";this._sTmpl="{{if ${ig_rs_sel} === true}}"+this.css.rowSelectorSelected+"{{/if}}";this._v=false;this._ms=false},destroy:function(){this._unregisterEvents();this._unregisterCellEvents();this._unregisterSelectAllEvents();if(this._gridRenderRecordHandler!==undefined){this.grid._renderColgroup=this._flatRenderColgroup;this.grid._renderRecord=this._gridRenderRecordHandler;this.grid._renderRecordInArray=this._gridRenderRecordInArrayHandler}if(this.options.enableCheckBoxes===true){this._unregisterCheckBoxEvents()}this._cleanInterface(false);if(this.grid._selection){this.grid._selection.removeSubscriber(this._subId,this.grid.id())}$.Widget.prototype.destroy.call(this);return this},_shouldRenderHeaderCheckBoxes:function(){return this.options.enableCheckBoxes===true&&this._ms},_renderHeaderRowSelectors:function(owner){var rows,i,cell,header,$thDataSkip;if(owner.id()!==this.grid.id()){return}rows=this.grid.headersTable().children("thead").children();if(rows.length>0){cell=rows.eq(0).find("th.ui-iggrid-expandheadercell").first();if(cell.length===0){this._index=0}else{this._index=cell.index()+1}if(this.grid._isMultiColumnGrid){$thDataSkip=$("<th></th>").prependTo(this.grid.headersTable().find("thead tr:nth-child(1)")).addClass(this.css.headerRowSelector).addClass(this.grid.css.headerClass).attr("data-role","rs").attr("data-skip","true");$thDataSkip.attr("rowspan",this.grid._maxLevel+1);if(this._shouldRenderHeaderCheckBoxes()){$(this._getCheckBox(true)).appendTo($thDataSkip)}}else{for(i=0;i<rows.length;i++){if(rows.eq(i).find("th[data-role='rs']").length>0){continue}header=$("<th>"+($.ig.util.isIE7?"&nbsp;":"")+"</th>").addClass(this.css.headerRowSelector).addClass(i===0?this.grid.css.headerClass:"").attr("data-role","rs").attr("data-skip","true").insertBefore(rows.eq(i).children().eq(this._index));if(this._shouldRenderHeaderCheckBoxes()&&i===0){$(this._getCheckBox(true)).appendTo(header)}}}}},_renderFooterRowSelectors:function(owner){var rows,i;if(owner.id()!==this.grid.id()){return}rows=this.grid.footersTable().children("tfoot").children();if(rows.length>0){for(i=0;i<rows.length;i++){if(rows.eq(i).find("td[data-role='rs']").length>0){continue}$("<td>"+($.ig.util.isIE7?"&nbsp;":"")+"</td>").addClass(this.css.footerRowSelector).attr("data-role","rs").attr("data-skip","true").insertBefore(rows.eq(i).children().eq(this._index))}}},_headerRendered:function(event,ui){this._ms=!this._skipRefresh&&this._getSelectionInstance().options.multipleSelection===true;this._renderHeaderRowSelectors(ui.owner);this._getColumnFixingInstance()},_footerRendered:function(event,ui){this._renderFooterRowSelectors(ui.owner)},_getColumnFixingInstance:function(){if(!this._columnFixing&&this.grid.element.data("igGridColumnFixing")){this._columnFixing=this.grid.element.data("igGridColumnFixing")}return this._columnFixing},_getSelectionInstance:function(){if(!this._selection&&this.grid.element.data("igGridSelection")){this._selection=this.grid.element.data("igGridSelection")}return this._selection},_recordsRendering:function(event,ui){if(this.grid.id()!==ui.owner.id()){return}this._cIdx=ui.vrtWnd.start&&ui.vrtWnd.end?ui.vrtWnd.start:0;this._redirectFunctions()},_redirectFunctions:function(){if(this._functionsRedirected===false){this._renderRecordHandler=$.proxy(this._rsRenderRecord,this);this._renderRecordInArrayHandler=$.proxy(this._rsRenderRecordInArray,this);this._gridRenderRecordHandler=$.proxy(this.grid._renderRecord,this.grid);this._gridRenderRecordInArrayHandler=$.proxy(this.grid._renderRecordInArray,this.grid);this._gridRenderRecord=this._gridRenderRecordHandler;this._gridRenderRecordInArray=this._gridRenderRecordInArrayHandler;this.grid._renderRecord=this._renderRecordHandler;this.grid._renderRecordInArray=this._renderRecordInArrayHandler}this._functionsRedirected=true},_recordsRendered:function(event,ui){if(this.grid.id()!==ui.owner.id()){return}if(this.options.enableCheckBoxes===true){this._registerCheckBoxEvents();this._updateHeader()}},_gridRendered:function(event,ui){if(ui===undefined){return}if(this.grid.id()!==ui.owner.id()){return}this._ms=!this._skipRefresh&&this._getSelectionInstance().options.multipleSelection===true;this._unregisterCellEvents();this._registerCellEvents();if(this.options.enableCheckBoxes===true){this._registerCheckBoxEvents()}this._bindToSelectionCollection()},_hidingFinished:function(){this._unregisterCellEvents();this._registerCellEvents()},_rsRenderColgroup:function(flatRenderColgroup,rs,table,isHeader,isFooter,autofitLastColumn,md){var fdLeft,fixed,id=table.id;flatRenderColgroup.apply(this,[table,isHeader,isFooter,autofitLastColumn,md]);if(rs.grid.hasFixedColumns()){fdLeft=this.fixingDirection()==="left";fixed=!!(md&&md.fixed);id=fdLeft&&fixed||!fdLeft&&!fixed?id:id+"_fixed";table=document.getElementById(id)}rs._rsRenderColgroupHelper(table)},_rsRenderColgroupHelper:function(table){var cgrp;cgrp=$(table).find("colgroup");if(cgrp.find("col[data-role='rs']").length===0){$("<col></col>").prependTo(cgrp).css("width",this.options.rowSelectorColumnWidth).attr("data-skip","true").attr("data-role","rs")}},_rsRenderRecord:function(data,rowIndex,isFixed){var markup=this._gridRenderRecord(data,rowIndex,isFixed),pre,app,idx,fCols=this.grid.hasFixedColumns(),fdLeft=this.grid.fixingDirection()==="left",rs;if(fCols&&!(isFixed&&fdLeft||!isFixed&&!fdLeft)){return markup}rs=this._getRowSelectorCellMarkup(false,isFixed&&!this.grid._fixedColumns.length?this._rowHasSelection(data):markup.indexOf("ui-iggrid-selectedcell")!==-1,data);idx=markup.indexOf("ui-iggrid-expandcolumn");if(idx>=0){app=markup.substr(idx);idx=idx+app.indexOf("</td>")+4;pre=markup.substring(0,idx+1);app=markup.substring(idx+1)}else{idx=markup.indexOf(">")+1;pre=markup.substring(0,idx);app=markup.substring(idx)}markup=pre+rs+app;return markup},_rsRenderRecordInArray:function(darr,tbody,data,rowIndex){var i,j,sel=false;this._gridRenderRecordInArray(darr,tbody,data,rowIndex);for(i=darr.length-1;i>=0;i--){if(darr[i].indexOf&&darr[i].indexOf("<tr")!==-1){for(j=i;j<darr.length;j++){if(darr[j].indexOf&&darr[j].indexOf("ui-iggrid-selectedcell")!==-1){sel=true;break}}for(j=i;j<darr.length;j++){if(darr[j].indexOf&&darr[j].indexOf("<td")!==-1){if(darr[j].indexOf("ui-iggrid-expandcolumn")!==-1){darr[j]+=this._getRowSelectorCellMarkup(false,sel);sel=false;break}darr[j]=this._getRowSelectorCellMarkup(false,sel)+darr[j];sel=false;break}}break}}},_renderExtraHeaderCells:function(row,colgroup,prepend){this._renderExtraCells(row,colgroup,prepend,true)},_renderExtraFooterCells:function(row,colgroup,prepend,cssClass){this._renderExtraCells(row,colgroup,prepend,false,cssClass)},_renderExtraCells:function(row,colgroup,prepend,header,cssClass){var rHeader,rCol,index,cell;if(row.find("[data-role='rs']").length>0){return}if(header===true){rHeader=$("<th>"+($.ig.util.isIE7?"&nbsp;":"")+"</th>").addClass(this.css.headerRowSelector).attr("data-role","rs").attr("data-skip","true")}else{rHeader=$("<td>"+($.ig.util.isIE7?"&nbsp;":"")+"</td>").addClass(this.css.footerRowSelector).addClass(cssClass).attr("data-role","rs").attr("data-skip","true")}cell=row.find("th.ui-iggrid-expandheadercell,td.ui-iggrid-expandheadercellgb");if(cell.length===0){cell=row.children().first();index=0}else{index=cell.last().index()+1}if(index===0){rHeader.prependTo(row)}else{rHeader.insertBefore(row.children().eq(index))}if(colgroup){rCol=$("<col></col>").attr("data-skip","true").attr("data-role","rs").css("width",this.options.rowSelectorColumnWidth);rCol.insertBefore(colgroup.children().eq(index))}},_registerCellEvents:function(){this._allRowSelectorCells().bind({click:this._rsClickHandler});this.grid.element.children("tbody").bind({mousemove:this._rrHoverHandler,mouseleave:this._rrLeaveHandler})},_unregisterCellEvents:function(){this._allRowSelectorCells().unbind({click:this._rsClickHandler});this.grid.element.children("tbody").unbind({mousemove:this._rrHoverHandler,mouseleave:this._rrLeaveHandler})},_registerCheckBoxEvents:function(){this._allCheckboxes().unbind({click:this._checkboxClickHandler,keydown:this._checkboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler}).bind({click:this._checkboxClickHandler,keydown:this._checkboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler});this._headerCheckbox().unbind({click:this._hCheckboxClickHandler,keydown:this._hCheckboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler}).bind({click:this._hCheckboxClickHandler,keydown:this._hCheckboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler})},_unregisterCheckBoxEvents:function(){this._allCheckboxes().unbind({click:this._checkboxClickHandler,keydown:this._checkboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler});this._headerCheckbox().unbind({click:this._hCheckboxClickHandler,keydown:this._hCheckboxClickHandler,mouseover:this._checkboxMouseOverHandler,mouseout:this._checkboxMouseOutHandler})},_checkboxMouseOver:function(event){$(event.target).closest("span[data-role='checkbox']").addClass(this.css.nodeHovered)},_checkboxMouseOut:function(event){$(event.target).closest("span[data-role='checkbox']").removeClass(this.css.nodeHovered)},_checkBoxClicked:function(event){if(event.type==="keydown"&&event.keyCode!==$.ui.keyCode.ENTER&&event.keyCode!==$.ui.keyCode.SPACE){return}var trg=$(event.target).closest("span[name='chk']"),rCell=trg.parent(),rRow=rCell.parent(),args,rIdx=this._getVisibleRowIndex(rRow),rKey=rRow.attr("data-id"),noCancel,state=trg.attr("data-chk");if(rKey===""||rKey===null||rKey===undefined){rKey=rIdx}args={row:rRow,rowIndex:rIdx,rowKey:rKey,rowSelector:rCell,owner:this,grid:this.grid,currentState:state,newState:state==="off"?"on":"off",isHeader:false};noCancel=this._triggerCheckingEvent(event,args);if(noCancel===true){this._handleCheck(trg);delete args.currentState;args.state=args.newState;delete args.newState;this._triggerCheckedEvent(event,args)}event.preventDefault();event.stopPropagation()},_headerCheckBoxClicked:function(event){var trg=$(event.target).closest("span[name='hchk']"),args,noCancel,state=trg.attr("data-chk");if(event.type==="keydown"&&event.keyCode!==$.ui.keyCode.ENTER&&event.keyCode!==$.ui.keyCode.SPACE){return}args={owner:this,grid:this.grid,currentState:state,newState:state==="off"?"on":"off",isHeader:true};noCancel=this._triggerCheckingEvent(event,args);if(noCancel===true){this._handleHeaderCheck(trg);delete args.currentState;args.state=args.newState;delete args.newState;this._triggerCheckedEvent(event,args)}event.stopPropagation();event.preventDefault()},_handleCheck:function(checkbox){var row,rowId,upd,sel,offset;if(!checkbox){return}upd=this.grid.element.data("igGridUpdating");sel=this._getSelectionInstance();if(sel&&sel._suspend){if(upd){if(upd.findInvalid()){return}upd._endEdit(null,true)}else{return}}offset=this._v?this.grid._startRowIndex:0;row=checkbox.parent().parent();if(this.grid.hasFixedColumns()&&sel){row=row.add(sel._getRowByIndex(row.index(),!this.grid._isFixedElement(row)))}rowId=this.grid._fixPKValue(row.attr("data-id"));if(rowId===null||rowId===undefined){rowId=row.closest("tbody").children("tr:not([data-container])").index(row)+offset}if(this.grid._selection.settings.owner!==this.grid){this.grid._selection.changeOwner(this.grid)}if(checkbox.attr("data-chk")==="off"){if(sel.options.activation){this.grid._selection.activate(rowId,row)}this.grid._selection.select(rowId,true,{element:row,checkbox:checkbox})}else{this.grid._selection.deselect(rowId,{element:row,checkbox:checkbox})}},_handleHeaderCheck:function(checkbox){var sel,go=this.grid.options,v=go.virtualization||go.rowVirtualization,templateData,toCheck=checkbox.attr("data-chk")==="off",dataViewLength,allCheckedRecs;sel=this._getSelectionInstance();if(this.grid._selection.settings.owner!==this.grid){this.grid._selection.changeOwner(this.grid)}if(toCheck){if(v){this._selectAllVirtualRows(sel)}else{this._selectAllRows(sel)}this._alterCheckbox(checkbox,true)}else{if(v){this._deselectAllVirtualRows(sel)}else{this._deselectAllRows(sel)}this._alterCheckbox(checkbox,false)}if(this.options.enableSelectAllForPaging&&this.grid.element.data("igGridPaging")){dataViewLength=this._getDataView().length;allCheckedRecs=this._getSelectionInstance().selectedRows().length;templateData=[{checked:dataViewLength,unchecked:dataViewLength,allCheckedRecords:allCheckedRecs,totalRecordsCount:this._getDSLocalRecords().length}];this._renderOverlay(templateData,toCheck)}},_getDSLocalRecords:function(){var ds=this.grid.dataSource,trecCount=ds.totalLocalRecordsCount();if(ds._filteredData&&ds._filteredData.length>=trecCount){return ds._filteredData}return this._getAllData()},_renderOverlay:function(templateData,toCheck){var hTable=this.grid.headersTable(),overlay;if(toCheck){overlay=this._getSelectAllOverlay(templateData)}else{overlay=this._getDeselectAllOverlay(templateData)}if(overlay){overlay.css({"z-index":"1000",width:"inherit",position:"absolute",top:(this.grid.options.height||this.grid.options.width?hTable.parent().position().top:hTable.position().top)+hTable.find("thead:first").outerHeight()});overlay.children("div:first").css("padding-left",this.options.rowSelectorColumnWidth);overlay.appendTo(this.grid.container());this._registerSelectAllEvents(overlay)}},_getSelectAllOverlay:function(templateData){var ti=this.grid.options.tabIndex,overlay,selectAllTemplate;if(templateData[0].allCheckedRecords>=templateData[0].totalRecordsCount){return null}if(this.options.selectAllForPagingTemplate){overlay=this._jsr?$($.render([this.grid.id()+"_selectAllForPagingTemplate"](templateData))):$($.ig.tmpl(this.options.selectAllForPagingTemplate,templateData))}else{selectAllTemplate=$.ig.GridRowSelectors.locale.selectedRecordsText.replace("${checked}",templateData[0].checked)+" <a href='#' data-rs-select-all tabindex='"+ti+"'>"+$.ig.GridRowSelectors.locale.selectAllText.replace("${totalRecordsCount}",templateData[0].totalRecordsCount)+"</a>";overlay=this._getDefaultOverlay(selectAllTemplate,true)}return overlay},_getDeselectAllOverlay:function(templateData){var ti=this.grid.options.tabIndex,overlay,deselectAllTemplate;if(templateData[0].allCheckedRecords===0){return null}if(this.options.deselectAllForPagingTemplate){overlay=this._jsr?$($.render([this.grid.id()+"_deselectAllForPagingTemplate"](templateData))):$($.ig.tmpl(this.options.deselectAllForPagingTemplate,templateData))}else{deselectAllTemplate=$.ig.GridRowSelectors.locale.deselectedRecordsText.replace("${unchecked}",templateData[0].unchecked)+" <a href='#' data-rs-deselect-all tabindex='"+ti+"'>"+$.ig.GridRowSelectors.locale.deselectAllText.replace("${totalRecordsCount}",templateData[0].totalRecordsCount)+"</a>";overlay=this._getDefaultOverlay(deselectAllTemplate,false)}return overlay},_getDefaultOverlay:function(template,toCheck){var ti=this.grid.options.tabIndex;return $("<div>").attr({"class":"ui-widget-header ui-priority-secondary",tabIndex:ti,id:this.grid.id()+(toCheck?"_":"_de")+"select_all_overlay"}).append($("<div>").html(template).append($("<div>").css("float","right").append($("<span>").addClass("ui-icon-close").addClass("ui-icon").addClass("ui-button").attr("data-rs-close-all","").attr("tabindex",ti))))},_registerSelectAllEvents:function(overlay){var self=this,overlayId=overlay.attr("id");this.grid.container().bind("mouseup.containerselectall",function(event){if(event.type==="mouseup"&&$(event.target).closest("#"+overlayId).length===0){$(this).unbind(".containerselectall");if($(overlay)){overlay.remove()}}});overlay.bind("blur.containerselectall",function(){$(this).unbind(".containerselectall");if($(overlay)){overlay.remove()}});overlay.find("[data-rs-select-all]").bind("mouseup",function(event){self._selectAllFromOverlay();event.stopPropagation();overlay.remove()});overlay.find("[data-rs-deselect-all]").bind("mouseup",function(event){self._deselectAllFromOverlay();event.stopPropagation();overlay.remove()});overlay.find("[data-rs-select-all]").bind("keypress",function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._selectAllFromOverlay();overlay.remove()}});overlay.find("[data-rs-deselect-all]").bind("keypress",function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._deselectAllFromOverlay();overlay.remove()}});overlay.find("[data-rs-close-all]").bind("mouseup",function(event){event.stopPropagation();overlay.remove()});overlay.find("[data-rs-close-all]").bind("keypress",function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){overlay.remove()}})},_selectAllFromOverlay:function(){this._changeCheckStateForAllRecords(this._getSelectionInstance(),true)},_deselectAllFromOverlay:function(){this._changeCheckStateForAllRecords(this._getSelectionInstance(),false)},_unregisterSelectAllEvents:function(){if(this.grid.element.data("igGridPaging")&&this.options.enableSelectAllForPaging){this.grid.container().unbind(".containerselectall");$(this.grid.id()+"_select_all_overlay").remove();$(this.grid.id()+"_deselect_all_overlay").remove()}},_updateHeader:function(){var dvl,sl,checkboxes,check=true,i;if(this.grid.element.data("igGridPaging")){checkboxes=this._allCheckboxes();if(checkboxes.length===0){check=false}else{for(i=0;i<checkboxes.length;i++){if(checkboxes.eq(i).attr("data-chk")==="off"){check=false;break}}}}else{dvl=this._getDataView().length;sl=this.grid._selection?this.grid._selection.selectionLength():0;check=sl===dvl&&this._isFirstRowSelected()}this._alterCheckbox(this._headerCheckbox(),check)},_alterCheckbox:function(checkbox,check){var inner=checkbox.children().first();if(checkbox.length>0&&inner.length>0){if(check===true){checkbox.attr("data-chk","on");inner.removeClass(this.css.checkBoxOff).addClass(this.css.checkBoxOn)}else{checkbox.attr("data-chk","off");inner.removeClass(this.css.checkBoxOn).addClass(this.css.checkBoxOff)}}},_getRowSelectorCellMarkup:function(template,selected){var markup="";markup+='<th role="rowheader" tabindex="'+this.grid.options.tabIndex+'" class="'+this.css.rowSelector;if(selected){markup+=" "+this.css.rowSelectorSelected}if(template){markup+=" "+this._sTmpl}markup+='"><span class="ui-icon ui-icon-triangle-1-e" style="margin-left: -5px"></span>';if(this.options.enableRowNumbering){markup+=template===true?this._nTmpl:this._getCurrentNumber()}if(this.options.enableCheckBoxes){markup+=this._getCheckBox(false,selected)}markup+="</th>";return markup},_getCheckBox:function(header,checked){var markup="";markup+='<span name="'+(header===true?"hchk":"chk")+'" ';markup+='data-chk="'+(checked?"on":"off")+'" ';markup+='data-role="checkbox" class="'+this.css.checkBox+' "';markup+='tabindex="'+this.grid.options.tabIndex+' "';if(this.options.showCheckBoxesOnFocus===true&&this._checkBoxesShown===false){markup+=' style="visibility: hidden;"'}markup+='><span class="'+(checked?this.css.checkBoxOn:this.css.checkBoxOff)+'">';markup+="</span></span>";return markup},_getCurrentNumber:function(id){var seed;if(id!==undefined&&id!==null){seed=id}else{seed=++this._cIdx}return'<span class="ui-iggrid-rowselector-row-number">'+(seed+this.options.rowNumberingSeed+this._getStartingIndexForPage())+"</span>"},_getStartingIndexForPage:function(){return this.grid.dataSource.pageIndex()*this.grid.dataSource.pageSize()},_selectAllRows:function(selection){var checkboxes=this._allCheckboxes(),i,range=[],row,rowId;if(checkboxes.length===0){return}for(i=0;i<checkboxes.length;i++){row=checkboxes.eq(i).parent().parent();if(this.grid.hasFixedColumns()){if(this.grid.fixedBodyContainer().attr("data-fixing-direction")==="left"){row=row.add(this.grid.element.find("tbody > tr").eq(row.index()))}else{row=row.add(this.grid.fixedBodyContainer().find("tbody > tr").eq(row.index()))}}rowId=selection._pkProp?this.grid._fixPKValue(row.attr("data-id")):i;range.push({id:rowId,element:row,checkbox:checkboxes.eq(i)})}this._suspendHeader=true;this.grid._selection.rangeSelect(range,true,null,false,false);this._suspendHeader=false},_selectAllVirtualRows:function(selection){var dv=this._getDataView(),fr,lr,rangeStats;if(dv.length===0){return}if(selection._pkProp){fr=dv[0][selection._pkProp];lr=dv[dv.length-1][selection._pkProp]}else{fr=0;lr=dv.length-1}rangeStats=selection._getRecordRange(fr,lr);this._suspendHeader=true;this.grid._selection.rangeSelect(rangeStats.range,true,null,rangeStats,false);if(this.grid.options.virtualizationMode==="continuous"){this.grid._correctScrollPosition(this.grid._getTotalRowsCount())}this._suspendHeader=false},_changeCheckStateForAllRecords:function(selection,toCheck){var dv=this._getDSLocalRecords(),fr,lr,rangeStats;if(dv.length===0){return}if(selection._pkProp){fr=dv[0][selection._pkProp];lr=dv[dv.length-1][selection._pkProp]}else{fr=0;lr=dv.length-1}rangeStats=selection._getRecordRange(fr,lr,dv);this._suspendHeader=true;if(toCheck){this.grid._selection.rangeSelect(rangeStats.range,true,null,rangeStats,false)}else{this.grid._selection.rangeDeselect(rangeStats.range,rangeStats,false)}this._suspendHeader=false},_deselectAllRows:function(selection){var checkboxes=this._allCheckboxes(),i,row,rowId,range=[];if(checkboxes.length===0){return}if(this.grid.element.data("igGridPaging")){for(i=0;i<checkboxes.length;i++){row=checkboxes.eq(i).parent().parent();if(this.grid.hasFixedColumns()){row=row.add(this.grid.scrollContainer().find("tbody > tr").eq(i))}rowId=selection._pkProp?this.grid._fixPKValue(row.attr("data-id")):i;range.push({id:rowId,element:row,checkbox:checkboxes.eq(i)})}this._suspendHeader=true;this.grid._selection.rangeDeselect(range,false,false);this._suspendHeader=false}else{this.grid._selection.deselectAll(false)}},_deselectAllVirtualRows:function(selection){var dv=this._getDataView(),rangeStats,fr,lr;if(dv.length===0){return}if(this.grid.element.data("igGridPaging")){if(selection._pkProp){fr=dv[0][selection._pkProp];lr=dv[dv.length-1][selection._pkProp]}else{fr=0;lr=dv.length-1}rangeStats=selection._getRecordRange(fr,lr);this._suspendHeader=true;this.grid._selection.rangeDeselect(rangeStats.range,false,false);this._suspendHeader=false}else{this.grid._selection.deselectAll(false)}},_isFirstRowSelected:function(){var row=this.grid.element.find("tbody > tr:not([data-grouprow='true']):first"),rowId=row.attr("data-id");rowId=rowId!==null&&rowId!==undefined?this.grid._fixPKValue(rowId):this._getStartingIndexForPage();return this.grid._selection.isSelected(rowId,this.grid)},_rowHasSelection:function(data){var sel=this._getSelectionInstance(),rowId=data[this.grid.options.primaryKey||"ig_pk"];if(!sel||rowId===null||rowId===undefined){return false}if(sel.options.mode==="cell"){return this.grid._selection.atLeastOneSelected(rowId,sel)}return this.grid._selection.isSelected(rowId,this.grid)},_rsRenderVirtualRecords:function(event,ui){var i=0,rs,rows,rowsLen;this._cIdx=0;if(this.grid.hasFixedColumns()&&this._getColumnFixingInstance().options.fixingDirection==="left"){rows=ui.fixedRows}else{rows=ui.rows}rowsLen=rows.length;for(i;i<rowsLen;i++){rs=$(this._getRowSelectorCellMarkup());rs.prependTo(rows.eq(i))}this._unregisterCellEvents();this._registerCellEvents();if(this.options.enableCheckBoxes===true){this._registerCheckBoxEvents()}},_rrn:function(){var rs=this._allRowSelectorCells(),cb=this._allCheckboxes(),cbx,i=0,self=this,sri=this.grid._startRowIndex||0,row,rowId;if(this.grid.options.virtualization===true&&this.grid.options.virtualizationMode==="continuous"){this._unregisterCellEvents();this._registerCellEvents();if(this.options.enableCheckBoxes===true){this._unregisterCheckBoxEvents();this._registerCheckBoxEvents()}}if(this.grid.options.virtualizationMode==="fixed"){for(i=0;i<rs.length;i++){rs.eq(i).removeClass(this.css.nodeHovered);if(this.options.enableRowNumbering===true){rs.eq(i).children("span.ui-iggrid-rowselector-row-number").text(sri+i+this.options.rowNumberingSeed+1)}}}if(!this._skipRefresh){rs.removeClass(this.css.rowSelectorSelected);cb.map(function(){self._alterCheckbox($(this),false)});for(i=0;i<rs.length;i++){row=rs.eq(i).closest("tr");rowId=this.grid._fixPKValue(row.attr("data-id"));if(rowId===null||rowId===undefined){rowId=i+sri}if(this.grid._selection.selection[rowId]!==undefined){rs.eq(i).addClass(this.css.rowSelectorSelected);cbx=cb.eq(i);if(cbx.length===1){this._alterCheckbox(cbx,true)}}}}},_bindToSelectionCollection:function(){if(this.grid._selection&&!this._subId){this._subId=this.grid._selection.addSubscriber(this,this.grid.id())}},_select:function(info){var res;info.element=info.element||this.grid._selection.elementFromIdentifier(info.id);res=this._rowSelectorFromSelection(info);if(!res){return}res.rowSelector.addClass(this.css.rowSelectorSelected);if(this.options.enableCheckBoxes){this._alterCheckbox(res.checkbox,true);if(this._ms&&!this._suspendHeader){this._updateHeader()}}},_deselect:function(info){var res,shouldDeselect;info.element=info.element||this.grid._selection.elementFromIdentifier(info.id);res=this._rowSelectorFromSelection(info);if(!res||!res.rowSelector.length){return}shouldDeselect=this.grid._selection instanceof $.ig.SelectedRowsCollection||!this.grid._selection.atLeastOneSelected(this.grid._fixPKValue(info.element.parent().attr("data-id")));if(shouldDeselect){res.rowSelector.removeClass(this.css.rowSelectorSelected);if(this.options.enableCheckBoxes){this._alterCheckbox(res.checkbox,false);if(this._ms&&!this._suspendHeader){this._updateHeader()}}}},_activate:function(element){if(element.is("th")){element.addClass(this.css.rowSelectorActivated)}},_deactivate:function(){if(this.grid.hasFixedColumns()){this.grid.fixedBodyContainer().find("tbody").find("th.ui-iggrid-activecell").removeClass(this.css.rowSelectorActivated)}this.grid.element.find("tbody").find("th.ui-iggrid-activecell").removeClass(this.css.rowSelectorActivated)},_clearSelection:function(){var rsCells,self=this;if(this.grid.hasFixedColumns()&&this.grid.fixingDirection()==="left"){rsCells=this.grid.fixedBodyContainer().find("tbody").find("th.ui-iggrid-selectedcell").removeClass(this.css.rowSelectorSelected)}else{rsCells=this.grid.element.children("tbody").find("th.ui-iggrid-selectedcell").removeClass(this.css.rowSelectorSelected)}if(this.options.enableCheckBoxes){$.each(rsCells,function(){self._alterCheckbox($(this).children("span:last"),false)});this._alterCheckbox(this._headerCheckbox(),false)}},_cellClick:function(event){var args,target=$(event.target),fRow,rCell=target.closest("th"),rRow=rCell.parent(),rIdx=this._getVisibleRowIndex(rRow),rKey=rRow.attr("data-id"),fdCell,gridContainer,sel=this._getSelectionInstance();if(this.options.showCheckBoxesOnFocus===true&&this._checkBoxesShown===false){this._animateCheckboxes(true)}if(!sel){return}if(target.is("span")&&target.attr("unselectable")){return}if(rKey===""||rKey===null||rKey===undefined){rKey=rIdx}if(this.grid.hasFixedColumns()){if(this.grid._isFixedElement(rCell)){if(this.grid.options.virtualization||this.grid.options.rowVirtualization){gridContainer=this.grid._vdisplaycontainer()}else{gridContainer=this.grid.scrollContainer()}fRow=rRow;rRow=gridContainer.find("tbody > tr").eq(fRow.index())}else{fRow=this.grid.fixedBodyContainer().find("tbody > tr").eq(rRow.index())}}fdCell=this._getFirstDataCell(rRow,fRow);if(event.shiftKey&&this._ms){sel._shiftSelectChange(fdCell)}else{sel._singleSelectChange(fdCell,event.ctrlKey)}args={row:rRow,fixedRow:fRow,rowIndex:rIdx,rowKey:rKey,rowSelector:rCell,owner:this,grid:this.grid};this._triggerClickEvent(event,args)},_getFirstDataCell:function(row,frow){if(frow&&frow.length>0){frow.children("td").not("[data-skip='true'],[data-parent='true']").first()}return row.children("td").not("[data-skip='true'],[data-parent='true']").first()},_mouseHoverRow:function(event){var par,tag,tr=event.target;while(tr){par=tr.parentNode;tag=tr.nodeName;if(tag==="TR"&&par.nodeName==="TBODY"){break}tr=tag==="TABLE"?null:par}if(this._hovTR!==tr){this._mouseHoverRowHelper(this._hovTR,tr);if(this.grid.hasFixedColumns()){this._mouseHoverFixedRow($(this._hovTR),$(tr))}this._hovTR=tr}},_mouseHoverRowHelper:function(hovTr,tr){if(hovTr&&$(hovTr).attr("data-container")!=="true"){$("th."+this.css.rowSelector,hovTr).removeClass(this.css.nodeHovered)}if(tr&&$(tr).attr("data-container")!=="true"){$("th."+this.css.rowSelector,tr).addClass(this.css.nodeHovered)}},_mouseHoverFixedRow:function($hovTR,$tr){var $fHTR,$fTR,ind;ind=$hovTR.index();$fHTR=this.grid.fixedBodyContainer().find("tr:nth-child("+(ind+1)+")");ind=$tr.index();$fTR=this.grid.fixedBodyContainer().find("tr:nth-child("+(ind+1)+")");this._mouseHoverRowHelper($fHTR,$fTR)},_mouseLeaveRow:function(){var ind,$fHTR;if(this._hovTR){$("th",this._hovTR).removeClass(this.css.nodeHovered);if(this.grid.hasFixedColumns()){ind=$(this._hovTR).index();$fHTR=this.grid.fixedBodyContainer().find("tr:nth-child("+(ind+1)+")");$fHTR.find("th").removeClass(this.css.nodeHovered)}this._hovTR=null}},_triggerClickEvent:function(event,args){this._trigger(this.events.rowSelectorClicked,event,args)},_triggerCheckingEvent:function(event,args){return this._trigger(this.events.checkBoxStateChanging,event,args)},_triggerCheckedEvent:function(event,args){this._trigger(this.events.checkBoxStateChanged,event,args)},_getVisibleRowIndex:function(row){return row.closest("tbody").children("tr:not([data-container='true'],[data-grouprow='true'])").index(row)},_getVisibleHRowIndex:function(row){return row.closest("tbody").children("tr:not([data-container='true'])").index(row)},_animateCheckboxes:function(trans){var h=this._headerCheckbox(),c=this._allCheckboxes(),all=h.add(c);if(trans===true){all.css("visibility","visible").css("opacity",0).animate({opacity:1},1e3)}else{all.css("opacity",1e3).animate({opacity:0},1e3,function(){$(this).css("visibility","hidden")})}this._checkBoxesShown=trans},_rowAdded:function(){this._unregisterCellEvents();this._registerCellEvents();if(this.options.enableCheckBoxes===true){this._registerCheckBoxEvents()}},_resetIndexing:function(){this._cIdx=0},_groupedColumnsChanging:function(){this._resetIndexing()},_cleanInterface:function(isRebind){var header,footer,cols,rsCells,w;if(isRebind===true){this._alterCheckbox(this._headerCheckbox(),false);return}cols=this.grid.element.children("colgroup").children("[data-role='rs']");cols=cols.add(this.grid.fixedBodyContainer().find("colgroup").children("[data-role='rs']"));if(this.grid.options.fixedHeaders===true){cols=cols.add(this.grid.headersTable().children("colgroup").children("[data-role='rs']"));
cols=cols.add(this.grid.fixedHeadersTable().children("colgroup").children("[data-role='rs']"))}if(this.grid.options.fixedFooters===true){cols=cols.add(this.grid.footersTable().children("colgroup").children("[data-role='rs']"));cols=cols.add(this.grid.fixedFootersTable().children("colgroup").children("[data-role='rs']"))}footer=this._footerRowSelectorCells();header=this._headerRowSelectorCells();rsCells=this._allRowSelectorCells();if(!this.grid.options.width&&this._functionsRedirected){w=this.grid.container().css("width");if(w&&!w.endsWith("%")){this.grid.container().css("width",parseInt(w,10)-this.options.rowSelectorColumnWidth)}}cols.remove();footer.remove();header.remove();rsCells.remove()},_allRowSelectorCells:function(){var rowSelectors,grid=this.grid;if(grid.hasFixedColumns()&&this._getColumnFixingInstance().options.fixingDirection==="left"){if(grid.options.virtualization||grid.options.rowVirtualization){rowSelectors=grid.fixedBodyContainer().find("tbody > tr > th."+this.css.rowSelector)}else{rowSelectors=grid.fixedBodyContainer().find("tbody > tr > th."+this.css.rowSelector)}}else{rowSelectors=grid.element.children("tbody").children("tr").children("th."+this.css.rowSelector)}return rowSelectors},_headerRowSelectorCells:function(){var headerCells=this.grid.headersTable().children("thead").find("th[data-role='rs']");if(headerCells.length===0&&this.grid.hasFixedColumns()){headerCells=this.grid.fixedHeadersTable().children("thead").find("th[data-role='rs']")}return headerCells},_footerRowSelectorCells:function(){var footerCells=this.grid.footersTable().children("tfoot").find("td[data-role='rs']");if(footerCells.length===0&&this.grid.hasFixedColumns()){footerCells=this.grid.fixedFootersTable().children("tfoot").find("td[data-role='rs']")}return footerCells},_allCheckboxes:function(){var checkboxes=this.grid.element.children("tbody").children("tr").children("th").find("span[name='chk']");if(checkboxes.length===0&&this.grid.hasFixedColumns()&&this._getColumnFixingInstance().options.fixingDirection==="left"){checkboxes=this.grid.fixedBodyContainer().find("tbody > tr > th span[name='chk']")}return checkboxes},_headerCheckbox:function(){var checkbox=this.grid.headersTable().children("thead").find("tr > th span[name='hchk']");if(checkbox.length===0&&this.grid.hasFixedColumns()&&this._getColumnFixingInstance().options.fixingDirection==="left"){checkbox=this.grid.fixedHeadersTable().children("thead").find("tr > th span[name='hchk']")}return checkbox},_rowSelectorFromSelection:function(info){var element=info.element,rs,checkbox=info.checkbox,fixingDir;if(element.is("th")){return}if(checkbox){rs=checkbox.parent()}else{if(element.is("tr")||element.length===2){rs=element.children("th:first")}else if(this.grid.hasFixedColumns()){fixingDir=this.grid.fixedBodyContainer().attr("data-fixing-direction");if(fixingDir==="left"&&!this.grid._isFixedElement(element)){rs=this.grid.fixedBodyContainer().find("tbody > tr").eq(element.closest("tr").index()).children("th:first")}else if(fixingDir==="right"&&this.grid._isFixedElement(element)){rs=this.grid.element.find("tbody > tr").eq(element.closest("tr").index()).children("th:first")}}if(!rs){rs=element.closest("tr").children("th:first")}checkbox=this.options.enableCheckBoxes?rs.children("span:last"):null}return{rowSelector:rs,checkbox:checkbox}},_checkForSelection:function(){var i,isSelection=false;for(i=0;i<this.grid.options.features.length;i++){if(this.grid.options.features[i].name==="Selection"){isSelection=true;if(this.options.enableCheckBoxes===true){this.grid.options.features[i].mode="row"}break}}if(isSelection===false){if(this.options.requireSelection===true){throw new Error($.ig.GridRowSelectors.locale.selectionNotLoaded)}this._skipRefresh=true}},_checkForColumnVirtualization:function(){return this.grid.options.virtualizationMode!=="continuous"&&(this.grid.options.virtualization===true&&this.grid.options.width||this.grid.options.columnVirtualization===true)},_checkForRequireSelectionWithCheckboxes:function(){return this.options.requireSelection===false&&this.options.enableCheckBoxes===true},_createHandlers:function(){this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._footerRenderedHandler=$.proxy(this._footerRendered,this);this._recordsRenderingHandler=$.proxy(this._recordsRendering,this);this._recordsRenderedHandler=$.proxy(this._recordsRendered,this);this._gridRenderedHandler=$.proxy(this._gridRendered,this);this._virtualDomBuiltHandler=$.proxy(this._rsRenderVirtualRecords,this);this._virtualRowsHandler=$.proxy(this._rrn,this);this._renderExtraHeaderCellHandler=$.proxy(this._renderExtraHeaderCells,this);this._renderExtraFooterCellHandler=$.proxy(this._renderExtraFooterCells,this);this._rsClickHandler=$.proxy(this._cellClick,this);this._rrHoverHandler=$.proxy(this._mouseHoverRow,this);this._rrLeaveHandler=$.proxy(this._mouseLeaveRow,this);this._newRowAddedHandler=$.proxy(this._rowAdded,this);if(this.options.enableCheckBoxes===true){this._checkboxMouseOverHandler=$.proxy(this._checkboxMouseOver,this);this._checkboxMouseOutHandler=$.proxy(this._checkboxMouseOut,this);this._checkboxClickHandler=$.proxy(this._checkBoxClicked,this);this._hCheckboxClickHandler=$.proxy(this._headerCheckBoxClicked,this)}},_registerEvents:function(){this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.bind("iggridfooterrendered",this._footerRenderedHandler);this.grid.element.bind("iggridrowsrendering ",this._recordsRenderingHandler);this.grid.element.bind("iggridrowsrendered",this._recordsRenderedHandler);this.grid.element.bind("iggriddatarendered",this._gridRenderedHandler);this.grid.element.bind("iggridvirtualdombuilt",this._virtualDomBuiltHandler);this.grid.element.bind("iggridvirtualrecordsrender",this._virtualRowsHandler);this.grid.element.bind("iggridappendrowsondemandrowsrequested",this._newRowAddedHandler)},_unregisterEvents:function(){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.unbind("iggridfooterrendered",this._footerRenderedHandler);this.grid.element.unbind("iggridrowsrendering ",this._recordsRenderingHandler);this.grid.element.unbind("iggridrowsrendered",this._recordsRenderedHandler);this.grid.element.unbind("iggriddatarendered",this._gridRenderedHandler);this.grid.element.unbind("iggridvirtualdombuilt",this._virtualDomBuiltHandler);this.grid.element.unbind("iggridvirtualrecordsrender",this._virtualRowsHandler);this.grid.element.unbind("iggridappendrowsondemandrowsrequested",this._newRowAddedHandler)},_injectGrid:function(gridInstance,isRebind){if(isRebind===true){this._cleanInterface(true);return}var self=this;this.grid=gridInstance;this._v=this.grid.options.virtualization===true||this.grid.options.rowVirtualization===true;this._flatRenderColgroup=this.grid._renderColgroup;this._createHandlers();this.grid._headerInitCallbacks.push({type:"RowSelectors",func:this._renderExtraHeaderCellHandler});this.grid._footerInitCallbacks.push({type:"RowSelectors",func:this._renderExtraFooterCellHandler});this._registerEvents();this.grid._renderColgroup=function(){if(self._flatRenderColgroup!==undefined){self._rsRenderColgroup.apply(self.grid,$.merge([self._flatRenderColgroup,self],arguments))}};this._checkForSelection();if(this._checkForColumnVirtualization()){throw new Error($.ig.GridRowSelectors.locale.columnVirtualizationEnabled)}if(this._checkForRequireSelectionWithCheckboxes()){throw new Error($.ig.GridRowSelectors.locale.requireSelectionWithCheckboxes)}if(String(this.grid.options.templatingEngine).toLowerCase()==="jsrender"){this._jsr=true;if(this.options.selectAllForPagingTemplate&&typeof this.options.selectAllForPagingTemplate==="string"){$.templates(this.grid.id()+"_selectAllForPagingTemplate",this.options.selectAllForPagingTemplate)}if(this.options.deselectAllForPagingTemplate&&typeof this.options.deselectAllForPagingTemplate==="string"){$.templates(this.grid.id()+"_deselectAllForPagingTemplate",this.options.deselectAllForPagingTemplate)}}},_getDataView:function(){return this.grid.dataSource.dataView()},_getAllData:function(){return this.grid.dataSource.data()}});$.extend($.ui.igGridRowSelectors,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Selection (and Keyboard navigation) 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridSelection",{css:{selectedCell:"ui-iggrid-selectedcell ui-state-active",selectedRow:"ui-iggrid-selectedrow ui-state-active",activeCell:"ui-iggrid-activecell ui-state-focus",activeRow:"ui-iggrid-activerow ui-state-focus"},options:{multipleSelection:false,mouseDragSelect:true,mode:"row",activation:true,wrapAround:true,skipChildren:true,multipleCellSelectOnClick:false,touchDragSelect:true,persist:true,allowMultipleRangeSelection:true},events:{rowSelectionChanging:"rowSelectionChanging",rowSelectionChanged:"rowSelectionChanged",cellSelectionChanging:"cellSelectionChanging",cellSelectionChanged:"cellSelectionChanged",activeCellChanging:"activeCellChanging",activeCellChanged:"activeCellChanged",activeRowChanging:"activeRowChanging",activeRowChanged:"activeRowChanged"},_create:function(){this._isMouseDown=false;this._pkProp=null;this._rsCellKey="##ROWSEL##";this._gbExpandCellKey="##GBXCEL##";this._gbSummaryCellKey="##GBSCEL##";this._gbEmptyCellKey="##GBECEL##";this._hgCellKey="##HIEGRD##";this._tgExpandKey="##TGXCEL##";this.element.attr("aria-multiselectable",this.options.multipleSelection)},destroy:function(){this.grid.element.unbind({iggriddatarendering:this._dataRenderingHandler,iggridvirtualrendering:this._virtualRecordsRenderingHandler,igtreegridvirtualrendering:this._virtualRecordsRenderingHandler,iggridvirtualrecordsrender:this._virtualRecordsRendererHandler,igtreegridvirtualrecordsrender:this._virtualRecordsRendererHandler,iggridcolumnscollectionmodified:this._columnsCollectionModifiedHandler});this.clearSelection();this._unregisterEvents();this._selection.removeSubscriber(this._subId,this.grid.id());$.Widget.prototype.destroy.call(this);return this},_setOption:function(key){$.Widget.prototype._setOption.apply(this,arguments);if(key==="mode"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}},_dataRendering:function(event,ui){var tbody;if(ui.owner.id()!==this.grid.id()){return}tbody=this.grid.element.find("tbody").add(this.grid.fixedBodyContainer().find("tbody"));if(this._tbodyBinding){tbody.unbind(this._tbodyBinding)}this._pkProp=this.grid.options.primaryKey;if(this.options.persist&&!this.grid.options.primaryKey){this._createUidForData();this._pkProp="ig_pk"}},_dataRendered:function(){this._unregisterEvents();this._registerEvents();if(this._hc===undefined){this._hc=this.grid.container().closest(".ui-iggrid-root").length>0;if(this._hc===false){this._hc=this.grid.element.hasClass("ui-iggrid-root")}}this.grid._startRowIndex=this.grid._startRowIndex||0;this._defaultAttributes();if(this.options.persist){this._paintActive();this._renderAttributes();this._selection.invalid=true}else{this.clearSelection()}},_fixedColumnsChanged:function(args){if(args.isToFix&&args.isInit){this._unregisterEvents();this._registerEvents();this._selection.invalid=true}},_virtualRecordsRendering:function(){this._storedActiveElement=this.activeCell()||this.activeRow()},_virtualRecordsRender:function(evt,ui){var ae;if(ui.owner.id()!==this.grid.id()){return}this._selection.invalid=true;$(document).unbind("keydown."+this.grid.id());if(this.grid.options.virtualization===true&&this.grid.options.virtualizationMode==="continuous"){this._unregisterEvents();this._registerEvents()}this._paintActive();this._renderAttributes();if(this.options.mode==="cell"){ae=this.activeCell()}else{ae=this.activeRow()}if(ae&&ae.element instanceof jQuery){ae.element.focus()}else if(this._storedActiveElement){if(this.options.mode==="cell"){this._getCellByIdentifier(this._storedActiveElement).focus()}else{this._getRowsByIdentifier(this._storedActiveElement.id).focus()}}},_columnsCollectionModified:function(evt,ui){if(ui.owner.id()===this.grid.id()){this._unregisterEvents();this._registerEvents();this._selection.invalid=true;this._paintActive()}},_hidingFinished:function(){if(this.options.persist){this._paintActive();this._selection.invalid=true}},_rowDeleted:function(rowId){var cellsForRow,colKey,cellId;this._selection.invalid=true;if(this.options.mode==="cell"){if(this._selection.settings.owner===this.grid){if(this._selection.activeElement&&this._selection.activeElement.id===rowId){this._selection.deactivate()}cellsForRow=this._selection.selection[rowId];for(colKey in cellsForRow){if(cellsForRow.hasOwnProperty(colKey)){cellId={id:rowId,columnKey:colKey};this._selection.deselect(cellId,null,false)}}}}else{if(this._selection.isActive(rowId,this.grid)){this._selection.deactivate()}if(this._selection.isSelected(rowId,this.grid)){this._selection.deselect(rowId,null,false)}}},_mouseDown:function(event){var target,targetGrid,re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),gOpts=this.grid.options,hasVirtualization=gOpts.virtualization||gOpts.rowVirtualization||gOpts.columnVirtualization,scrollCont=hasVirtualization?this.grid._vdisplaycontainer():this.grid.scrollContainer();if(event&&event.which!==1){return}target=event&&event.target?$(event.target):null;this._mouseDownTarget=target;this._mouseDownScroll=scrollCont.length?scrollCont.scrollTop():0;this._prevDragTar=target[0];this._previousRangeCache=event.ctrlKey?[]:null;if(this.options.allowMultipleRangeSelection&&this.options.mode==="cell"){this._selection._lockSelection()}targetGrid=target?target.closest(".ui-iggrid-table"):null;if(target&&target.hasClass("ui-iggrid-scrolldiv")){return}if(targetGrid&&targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}this._isMouseDown=true;if(this.options.mouseDragSelect===false||this.options.multipleSelection===false||this.options.mode==="row"){return}this._firstDragCell=target},_mouseMove:function(event){var target=event&&event.target?$(event.target):null,fdc=this._firstDragCell,re;if(event&&this._suspend){return}if(this.options.mode!=="cell"||!this.options.mouseDragSelect||!this._isMouseDown){return}target=target.closest("td,th");if(fdc&&fdc.length>0){re=new RegExp("^"+this.grid.id()+"(_fixed)?$");if(target[0]!==this._prevDragTar&&target.closest(".ui-iggrid-table").attr("id").match(re)&&fdc.closest(".ui-iggrid-table").attr("id").match(re)&&!(target.is("th")||target.attr("data-skip"))){this._selection.rangeSelectStart=this._identifierForTarget(fdc);this._dragSelect=true;this._prevDragTar=target[0];this._shiftSelectChange(target,false);this._storedActiveIndex=target.closest("td").index()}}},_mouseUp:function(event){var gOpts=this.grid.options,hasVirtualization=gOpts.virtualization||gOpts.rowVirtualization||gOpts.columnVirtualization,scrollCont=hasVirtualization?this.grid._vdisplaycontainer():this.grid.scrollContainer(),target=event&&event.target?$(event.target):null,targetGrid=target?target.closest(".ui-iggrid-table"):null,re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),shouldCancel,self=this;if(targetGrid&&targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}this._isMouseDown=false;if(!target||this._dragSelect||this._suspend||!this._mouseDownTarget||this._mouseDownTarget[0]!==target[0]||event.which>1||$.ig.util.isTouch&&(scrollCont.length?scrollCont.scrollTop():0)!==this._mouseDownScroll){this._dragSelect=false;this._prevDragTar=null;this._firstDragCell=null;this._mouseDownTarget=null;return}if(target.closest(".ui-iggrid-rowselector-class").length===1||target.hasClass("ui-iggrid-childarea")||target.parent().hasClass("ui-iggrid-childarea")||target.hasClass("ui-widget-header")){return}if(this._hc){target.parents("tr[data-container]").each(function(){if($(this).closest(".ui-iggrid-table").attr("id")===self.grid.element.attr("id")){shouldCancel=true;return false}});if(shouldCancel){return}}if(event.shiftKey&&this.options.multipleSelection){this._shiftSelectChange(target,true)}else{this._singleSelectChange(target,event.ctrlKey)}},_touchStart:function(event){event.target=$(document.elementFromPoint(event.originalEvent.touches[0].clientX,event.originalEvent.touches[0].clientY));event.which=1;if(event.target.hasClass("ui-iggrid-selectedcell")){this._canDrag=true}else{this._canDrag=false}this._mouseDown(event)},_touchEnd:function(event){event.target=$(document.elementFromPoint(event.originalEvent.changedTouches[0].clientX,event.originalEvent.changedTouches[0].clientY));this._canDrag=false;this._mouseUp(event)},_touchMove:function(event){if(!this._isMouseDown||!this._canDrag){return true}event.preventDefault();event.target=$(document.elementFromPoint(event.originalEvent.touches[0].clientX,event.originalEvent.touches[0].clientY));this._mouseMove(event)},_pointerDown:function(event){this.grid.element.css("-ms-touch-action","none");this._mouseDown(event)},_pointerMove:function(event){this._mouseMove(event)},_pointerUp:function(event){this.grid.element.css("-ms-touch-action","auto");this._mouseUp(event)},_keyDown:function(event){var target,targetGrid,re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),el;if(event&&this._suspend){return}if(this.grid!==this._selection.settings.owner){return}if(this._isMouseDown===true){return}if(this.options.activation!==true){return}if(event.keyCode!==$.ui.keyCode.ENTER&&event.keyCode!==$.ui.keyCode.SPACE&&event.keyCode!==$.ui.keyCode.UP&&event.keyCode!==$.ui.keyCode.DOWN&&event.keyCode!==$.ui.keyCode.LEFT&&event.keyCode!==$.ui.keyCode.RIGHT){return}target=event&&event.target?$(event.target):null;targetGrid=target?target.closest(".ui-iggrid-table"):null;if(targetGrid&&targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}if(this._selection.activeElement===null||this._selection.activeElement===undefined){if(this.options.mode==="cell"){el=target.children("td:not([data-skip='true']):first");if(!el.length){return}this._singleSelectChange(el,false,false)}else{el=target.closest("tr");if(!el.length){return}this._selection.activate(this._identifierForRow(el),el);this._selection.toggle()}if(event.keyCode===$.ui.keyCode.SPACE){event.preventDefault()}return}event.preventDefault();if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){if(this._suppressKey(event.keyCode)){return}if(!this._isDataElement(this._selection.activeElement)){this._handleToggle(event.ctrlKey)}else{this._selection.toggle()}return}this._navigate(event.keyCode,event.ctrlKey,event.shiftKey)},_selectStart:function(event){var re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),target=event.target?$(event.target):null,targetGrid=target?target.closest(".ui-iggrid-table"):$();if(targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}if(event&&this._suspend){return}if(this.options.mouseDragSelect===false||this.options.multipleSelection===false){return false}event.stopPropagation();event.preventDefault()},_selectStartContainer:function(event){if(event.target&&$(event.target).hasClass("ui-iggrid-fixedcontainer")){event.preventDefault()}},_tbodyFocusIn:function(event){var target=event&&event.target?$(event.target):null,targetGrid=target?target.closest(".ui-iggrid-table"):null,re=new RegExp("^"+this.grid.id()+"(_fixed)?$");if(targetGrid&&targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}if(this.options.mode==="row"){if(target.is("tr")){this._selection.activate(this._identifierForRow(target),target)}}else{if(target.is("td")){this._selection.activate(this._identifierForTarget(target),target);if(!target.attr("data-gbsummary")){this._storedActiveIndex=target.index()}}}},_tbodyFocusOut:function(event){var target=event&&event.target?$(event.target):null,targetGrid=target?target.closest(".ui-iggrid-table"):null,re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),id;if(targetGrid&&targetGrid.length>0&&!targetGrid.attr("id").match(re)){return}if(this.options.mode==="row"){if(target.is("tr")){id=this._identifierForRow(target);if(this._selection.isActive(id)){this._selection.deactivate()}}}else{if(target.is("td")){id=this._identifierForTarget(target);if(this._selection.isActive(id)){this._selection.deactivate()}}}},_preventDefault:function(event){if($(event.target).is("td")){event.preventDefault()}},_releaseMouse:function(){this._dragSelect=false;this._firstDragCell=null;this._isMouseDown=false},_applyCellStyle:function(data,col){var identifier={id:data[this._pkProp],columnKey:col};return this._selection.isSelected(identifier,this.grid)?this.css.selectedCell:""},_applyRowStyle:function(data){return this._selection.isSelected(data[this._pkProp],this.grid)?this.css.selectedCell:""},_paintActive:function(){if(this._selection.activeElement&&this._selection.settings.owner===this.grid){if(this.options.mode==="row"){this._getRowsByIdentifier(this._selection.activeElement).addClass(this.css.activeRow)}else{this._getCellByIdentifier(this._selection.activeElement).addClass(this.css.activeCell)}}},_renderAttributes:function(){if(this._selection.selectionLength()){if(this.options.mode==="row"){this.grid.element.children("tbody").find("td.ui-iggrid-selectedcell").closest("tr").attr("aria-selected",true);this.grid.fixedBodyContainer().find("tbody").find("td.ui-iggrid-selectedcell").closest("tr").attr("aria-selected",true)}else{this.grid.element.children("tbody").find("td.ui-iggrid-selectedcell").attr("aria-selected",true);this.grid.fixedBodyContainer().find("tbody").find("td.ui-iggrid-selectedcell").attr("aria-selected",true)}}else{if(this.options.mode==="row"){this.grid.element.children("tbody").find("td:not('.ui-iggrid-selectedcell')").closest("tr").attr("aria-selected",false);this.grid.fixedBodyContainer().find("tbody").find("td:not('.ui-iggrid-selectedcell')").closest("tr").attr("aria-selected",false)}else{this.grid.element.children("tbody").find("td:not('.ui-iggrid-selectedcell')").attr("aria-selected",false);this.grid.fixedBodyContainer().find("tbody").find("td:not('.ui-iggrid-selectedcell')").attr("aria-selected",false)}}},_defaultAttributes:function(){if(this.options.mode==="row"){this.grid.element.children("tbody").children("tr").attr("aria-selected",false);this.grid.fixedBodyContainer().find("tbody").children("tr").attr("aria-selected",false)}else{this.grid.element.children("tbody").find("td").attr("aria-selected",false);this.grid.fixedBodyContainer().find("tbody").find("td").attr("aria-selected",false)}},clearSelection:function(){this._selection.cleanAll(this.grid)},selectCell:function(row,col,isFixed){var rowElement,cellId,cellElement,record;if(this.options.mode==="row"){return}if(this._isOutOfView(row,col)){record=this._getDataView()[row];if(!record){return}if(this.grid._visibleColumns().length<col||col<0){return}cellId={id:this._pkProp?row[this._pkProp]:row,columnKey:this.grid._visibleColumns()[col].key};cellElement=$()}else{row-=this.grid._startRowIndex||0;col-=this.grid._startColIndex||0;rowElement=this._getRowByIndex(row,isFixed);cellId=this._identifierForCell(this._getCellByIndex(col,rowElement));cellElement=this._getCellByIdentifier(cellId)}if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}if(this.options.activation){this._selection.activate(cellId,cellElement)}if(!this._selection.isSelected(cellId,this.grid)){this._selection.select(cellId,true,{element:cellElement},true)}},selectCellById:function(id,colKey){var identifier={id:id,columnKey:colKey};if(this.options.mode==="row"){return}if(!this._selection.isSelected(identifier,this.grid)){if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}this._selection.select(identifier,true,{element:this._getCellByIdentifier(identifier)},true)}},deselectCell:function(row,col,isFixed){var rowElement=this._getRowByIndex(row,isFixed),cellId=this._identifierForCell(this._getCellByIndex(col,rowElement)),cellElement=this._getCellByIdentifier(cellId);if(this.options.mode==="row"){return}if(this._selection.isSelected(cellId,this.grid)){this._selection.deselect(cellId,{element:cellElement},true)}},deselectCellById:function(id,colKey){var identifier={id:id,columnKey:colKey};if(this.options.mode==="row"){return}if(this._selection.isSelected(identifier,this.grid)){this._selection.deselect(identifier,{element:this._getCellByIdentifier(identifier)},true)}},selectRow:function(index){var row,rowId;if(this.options.mode==="cell"){return}if(this._isOutOfView(index)){row=this._getDataView()[index];if(!row){return}rowId=this._pkProp?row[this._pkProp]:index;row=$()}else{index-=this.grid._startRowIndex||0;row=this._getRowByIndex(index,false).add(this._getRowByIndex(index,true));rowId=this._identifierForRow(row.eq(0))}if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}if(this.options.activation){this._selection.activate(rowId,row)}if(!this._selection.isSelected(rowId,this.grid)){this._selection.select(rowId,true,{element:row},true)}},selectRowById:function(id){if(this.options.mode==="cell"){return}if(!this._selection.isSelected(id,this.grid)){if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}this._selection.select(id,true,{element:this._getRowsByIdentifier(id)},true)}},deselectRow:function(index){var row=this._getRowByIndex(index,false).add(this._getRowByIndex(index,true)),rowId=this._identifierForRow(row.eq(0));if(this.options.mode==="cell"){return}if(this._selection.isSelected(rowId,this.grid)){this._selection.deselect(rowId,{element:row},true)}},deselectRowById:function(id){if(this.options.mode==="cell"){return}if(this._selection.isSelected(id,this.grid)){this._selection.deselect(id,{element:this._getRowsByIdentifier(id)},true)}},selectedCells:function(){if(this._selection.settings.owner!==this.grid){return[]}return this.options.multipleSelection?this._selection.selectedCells():null},selectedRows:function(){if(this._selection.settings.owner!==this.grid){return[]}return this.options.multipleSelection?this._selection.selectedRows():null},selectedCell:function(){var selectedCells;if(this._selection.settings.owner!==this.grid){return null}selectedCells=this._selection.selectedCells();return this.options.multipleSelection?null:selectedCells.length===1?selectedCells[0]:null},selectedRow:function(){var selectedRows;if(this._selection.settings.owner!==this.grid){return null}selectedRows=this._selection.selectedRows();return this.options.multipleSelection?null:selectedRows.length===1?selectedRows[0]:null},activeCell:function(){if(this.options.mode==="row"){return null}if(this._selection.settings.owner!==this.grid){return null}return this._selection.activeCell()},activeRow:function(){if(this.options.mode==="cell"){return null}if(this._selection.settings.owner!==this.grid){return null}return this._selection.activeRow()},_singleSelectChange:function(target,ctrlKey){var tId,tIdx,oldT=target;if(this.options.mode==="row"){target=target.closest("tr");target.addClass("initially-focused");if(this.grid.hasFixedColumns()){tIdx=target.index();target=target.add(this._getRowByIndex(tIdx,!this.grid._isFixedElement(target)))}}else{target=target.closest("td")}if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}tId=this._identifierForTarget(target);if(this.options.activation&&(oldT.is("tr")||oldT.is("td"))){this._selection.activate(tId,target)}if(this._canBeSelected(tId)){this._selection.select(tId,ctrlKey,{element:target})}},_shiftSelectChange:function(target){var tId,rangeStats,keep=this.options.mode==="cell"&&this.options.allowMultipleRangeSelection,v=this.grid.options.virtualization||this.grid.options.rowVirtualization||this.grid.options.columnVirtualization;target=this.options.mode==="row"?target.closest("tr"):target.closest("td");if(this._selection.settings.owner!==this.grid){this._selection.changeOwner(this.grid)}tId=this._identifierForTarget(target);if(!this._canBeSelected(tId)){return}if(this._selection.rangeSelectStart===null||this._selection.rangeSelectStart===undefined){this._selection.rangeSelectStart=tId}if(v){rangeStats=this._getRecordRange(this._selection.rangeSelectStart,tId)}else{rangeStats=this._getElementRange(this._selection.rangeSelectStart,tId)}if(keep){this._selection.rangeSelect(rangeStats.range,false,this._previousRangeCache,rangeStats,false);this._previousRangeCache=rangeStats.range}else{this._selection.rangeSelect(rangeStats.range,false,null,rangeStats,false)}},_navigate:function(code,ctrlKey,shiftKey,prevElementOverride){var prevActiveElement=prevElementOverride||this._selection.activeElement,nextActiveElementParent,childSelection,nextActiveElement=this._getNextActiveElement(code,!shiftKey&&this.options.wrapAround,prevActiveElement);if(!nextActiveElement||nextActiveElement.length===0){return}nextActiveElementParent=nextActiveElement.closest(".ui-iggrid-table");if(nextActiveElementParent.attr("id")!==this.grid.id()&&nextActiveElement.closest(".ui-iggrid").attr("id")!==this.grid.container().attr("id")){childSelection=nextActiveElementParent.data("igGridSelection");this._selection.changeOwner(childSelection.grid);nextActiveElementParent.closest(".ui-iggrid").focus();childSelection._storedActiveIndex=null;childSelection._navigateOwn(nextActiveElement,prevActiveElement,code,ctrlKey,shiftKey)}else{this._navigateOwn(nextActiveElement,prevActiveElement,code,ctrlKey,shiftKey)}},_navigateOwn:function(nextActiveElement,prevActiveElement,code,ctrlKey,shiftKey){var nextId=this._identifierForTarget(nextActiveElement);if(nextActiveElement.is("tr")&&this.grid.hasFixedColumns()){nextActiveElement.addClass("initially-focused");nextActiveElement=nextActiveElement.add(this._getRowByIndex(nextActiveElement.index(),!this.grid._isFixedElement(nextActiveElement)))}if(!nextActiveElement.is("tr")&&nextId.columnKey.startsWith("##")&&shiftKey){this._navigate(code,ctrlKey,shiftKey,nextId);return}this._selection.activate(nextId,nextActiveElement);if(ctrlKey){this._setScroll(code,nextActiveElement);return}if(shiftKey){if(this.options.mode==="row"||!this.options.multipleSelection){if(this._selection.isSelected(this._selection.activeElement,this.grid)){this._selection.deselect(prevActiveElement)}else{this._selection.toggle(nextActiveElement)}}else{this._shiftSelectChange(nextActiveElement,false)}}else{if(nextId.columnKey&&nextId.columnKey.startsWith("##")){if(this._selection.isSelected(prevActiveElement)){this._selection.clearSelection()}}else{this._selection.select(nextId,false,{element:nextActiveElement})}}this._setScroll(code,nextActiveElement)},_handleToggle:function(ctrlKey){var element=this._selection.elementFromIdentifier(this._selection.activeElement),row,cell;if(element.is("th")){row=this._getRowsByIdentifier(this._selection.activeElement.id);if(this.grid.hasFixedColumns()&&this.grid._isFixedElement(element)){cell=this._firstDataCellForRow(row.first())}else{cell=this._firstDataCellForRow(row.last())}this._singleSelectChange(cell,ctrlKey)}else if(element.attr("data-parent")){element.closest(".ui-iggrid-root").igHierarchicalGrid("toggle",element.closest("tr"))}else if(element.hasClass("ui-igtreegrid-expansion-indicator-cell")&&element.attr("data-expand-cell")){element.closest(".ui-iggrid-table").igTreeGrid("toggleRow",element.closest("tr"))}},_getNextActiveElement:function(code,wrapAround,override){var currentActiveElement=override instanceof jQuery?override:this._selection.elementFromIdentifier(override||this._selection.activeElement),currentRow=currentActiveElement.closest("tr"),currentCellIndex=currentActiveElement.index(),hasFixedCols=this.grid.hasFixedColumns(),isFixedElement=hasFixedCols?this.grid._isFixedElement(currentActiveElement):false,fixingDir=this.grid.fixingDirection(),nextElement,nextElementIndex,nextRow,wrapped,go=this.grid.options,vVirt=go.virtualization||go.rowVirtualization;if(code===$.ui.keyCode.UP){nextRow=this._getPrevRow(currentRow,wrapAround,isFixedElement,false,vVirt);if(this.options.mode==="row"||!nextRow){return nextRow}nextElementIndex=currentCellIndex>=nextRow.children().length?nextRow.children().length-1:this._storedActiveIndex||currentCellIndex;nextElement=nextRow.children().eq(nextElementIndex)}else if(code===$.ui.keyCode.DOWN){nextRow=this._getNextRow(currentRow,wrapAround,isFixedElement,false,vVirt);if(this.options.mode==="row"||!nextRow){return nextRow}nextElementIndex=currentCellIndex>=nextRow.children().length?nextRow.children().length-1:this._storedActiveIndex||currentCellIndex;nextElement=nextRow.children().eq(nextElementIndex)}else if(code===$.ui.keyCode.LEFT&&this.options.mode==="cell"){if(currentActiveElement.is(":first-child")){if(hasFixedCols&&!isFixedElement&&fixingDir==="left"){nextRow=this._getRowByIndex(currentRow.index(),true)}else if(hasFixedCols&&isFixedElement&&fixingDir==="right"){nextRow=this._getRowByIndex(currentRow.index(),false)}else{nextRow=this._getPrevRow(currentRow,wrapAround,isFixedElement,hasFixedCols,vVirt)}wrapped=true}else{nextRow=currentRow}if(!nextRow){return null}nextElementIndex=wrapped?nextRow.children().length-1:currentCellIndex-1;nextElement=nextRow.children().eq(nextElementIndex);this._revertH=wrapped}else if(code===$.ui.keyCode.RIGHT&&this.options.mode==="cell"){if(currentActiveElement.is(":last-child")){if(hasFixedCols&&isFixedElement&&fixingDir==="left"){nextRow=this._getRowByIndex(currentRow.index(),false)}else if(hasFixedCols&&!isFixedElement&&fixingDir==="right"){nextRow=this._getRowByIndex(currentRow.index(),true)}else{nextRow=this._getNextRow(currentRow,wrapAround,isFixedElement,hasFixedCols,vVirt)}wrapped=true}else{nextRow=currentRow}if(!nextRow){return null}nextElementIndex=wrapped?0:currentCellIndex+1;nextElement=nextRow.children().eq(nextElementIndex);this._revertH=wrapped}if(nextElement&&!nextElement.attr("data-gbsummary")){this._storedActiveIndex=nextElementIndex}return nextElement},_getNextRow:function(currentRow,wrapAround,isFixed,swap,virt){var hierRowSkip=this.options.skipChildren?"[data-container=true]":"",nextRow,cIdx;if(virt){cIdx=currentRow.index();if(cIdx>=this.grid._virtualRowCount-1){this._scrollVmanual(true);return null}}if(currentRow.first().parent().children((hierRowSkip.length>0?":not("+hierRowSkip+")":"")+":visible:last")[0]===currentRow[0]){if(wrapAround){nextRow=this._firstRow(null,swap?!isFixed:isFixed,hierRowSkip)}else{return}this._revertV=true}else{if(isFixed&&$.ig.util.isIE){currentRow.width()}if(swap){nextRow=this._getRowByIndex(currentRow.index()+1,!isFixed)}else{nextRow=currentRow.nextAll("tr"+(hierRowSkip.length>0?":not("+hierRowSkip+")":"")+":visible").first()}this._revertV=false}if(nextRow.attr("data-container")){nextRow=this._firstRow(nextRow,swap?!isFixed:isFixed,hierRowSkip)}return nextRow},_getPrevRow:function(currentRow,wrapAround,isFixed,swap,virt){var hierRowSkip=this.options.skipChildren?"[data-container=true]":"",nextRow,cIdx;if(virt){cIdx=currentRow.index();if(cIdx<=0){this._scrollVmanual(false);return null}}if(currentRow.is(":first-child")){if(wrapAround){nextRow=this._lastRow(null,swap?!isFixed:isFixed,hierRowSkip)}else{return}this._revertV=true}else{if(isFixed&&$.ig.util.isIE){currentRow.width()}if(swap){nextRow=this._getRowByIndex(currentRow.index()-1,!isFixed)}else{nextRow=currentRow.prevAll("tr"+(hierRowSkip.length>0?":not("+hierRowSkip+")":"")+":visible").first()}this._revertV=false}if(nextRow.attr("data-container")){nextRow=this._lastRow(nextRow,swap?!isFixed:isFixed,hierRowSkip)}return nextRow},_lastRow:function(container,fixed,rowSkip){var body;if(container){body=container.find("tbody")}else if(fixed){body=this.grid.fixedBodyContainer().find("tbody")}else{body=this.grid.element.children("tbody")}return body.children("tr"+(rowSkip.length>0?":not("+rowSkip+")":"")+":visible").last()},_firstRow:function(container,fixed,rowSkip){var body;if(container){body=container.find("tbody")}else if(fixed){body=this.grid.fixedBodyContainer().find("tbody")}else{body=this.grid.element.children("tbody")}return body.children("tr"+(rowSkip.length>0?":not("+rowSkip+")":"")).first()},_createUidForData:function(){var i=0,ds=this.grid.dataSource?this.grid.dataSource._data:[];for(i=0;i<ds.length;i++){if(!ds[i].ig_pk){ds[i].ig_pk=$.ig.util.getCheckSumForObject(ds[i])}}},_initSelectionCollection:function(){var rootGrid,opts;rootGrid=this.grid.element.closest(".ui-iggrid-root");if(rootGrid.length>0){rootGrid=rootGrid.data("igGrid")}else{rootGrid=this.grid}opts={multipleSelection:this.options.multipleSelection,byIndex:this._pkProp===null,owner:this.grid};if(this.options.mode==="row"){rootGrid._selectionCollection=rootGrid._selectionCollection||new $.ig.SelectedRowsCollection(opts)}else{rootGrid._selectionCollection=rootGrid._selectionCollection||new $.ig.SelectedCellsCollection(opts)}this._selection=rootGrid._selectionCollection;this.grid._selection=this._selection;if(!this._subId){this._subId=this._selection.addSubscriber(this,this.grid.id())}},_setScroll:function(code,nextActiveElement){var scrollHDir;var scrollVDir=this._revertV?code===$.ui.keyCode.DOWN||code===$.ui.keyCode.RIGHT?"up":"down":code===$.ui.keyCode.DOWN||code===$.ui.keyCode.RIGHT?"down":"up";this._setScrollTop(this.grid.element.parent(),nextActiveElement.closest("tr"),scrollVDir,nextActiveElement.closest("tr").index());if(this.options.mode==="cell"&&(code===$.ui.keyCode.LEFT||code===$.ui.keyCode.RIGHT)){scrollHDir=this._revertH?code===$.ui.keyCode.LEFT?"right":"left":code===$.ui.keyCode.LEFT?"left":"right";this._setScrollLeft(this.grid._hscrollbarcontent(),nextActiveElement,scrollHDir,nextActiveElement.index())}},_setScrollTop:function(parent,child,direction,index){var parentOffset=parent.offset(),childOffset=child.offset(),childh,isDown,isUp,v,c;if(!child||child.length===0){return}v=this.grid.options.virtualization||this.grid.options.rowVirtualization;c=v&&this.grid.options.virtualizationMode==="continuous";childh=v&&!c?parseInt(this.grid.options.avgRowHeight,10):child.outerHeight();if(!v||c){isDown=childOffset.top+childh+this.grid._scrollbarWidth()>parentOffset.top+$(parent).outerHeight();isUp=childOffset.top-childh/2<=parentOffset.top||c&&index<0}if(index===0&&(!v||c)){parent[0].scrollTop=0}else if(direction==="down"){if(isDown){if(c){this.grid._onVirtualVerticalScroll({},childh,direction)}}}else{if(isUp){if(c){this.grid._onVirtualVerticalScroll({},childh,direction)}}}},_setScrollLeft:function(parent,child,direction,index){var parentOffset=parent.offset(),sc,childOffset=child.offset(),fullLeft;if(!child||!child.length||!parent.length){return}sc=this.grid.scrollContainer();fullLeft=childOffset.left+(sc.length>0?sc.scrollLeft():0);if(index===0){parent[0].scrollLeft=0;this.grid._synchronizeHScroll()}else if(direction==="right"){if(fullLeft+child.outerWidth()>parentOffset.left+parent.outerWidth()){parent[0].scrollLeft=parent[0].scrollLeft+fullLeft-(parentOffset.left+parent.outerWidth())+child.outerWidth();this.grid._synchronizeHScroll()}}else{if(childOffset.left<parentOffset.left){parent[0].scrollLeft=parent[0].scrollLeft-child.outerWidth();this.grid._synchronizeHScroll()}}},_scrollVmanual:function(down){var sc=$("#"+this.grid.element[0].id+"_scrollContainer"),h=parseInt(this.grid.options.avgRowHeight,10);this.grid._ignoreScroll=true;if(down){sc.scrollTop(sc.scrollTop()+h)}else{sc.scrollTop(sc.scrollTop()-h)}this.grid._onVirtualVerticalScroll();this.grid._ignoreScroll=false},_getRecordRange:function(start,end,data){var startRecord,endRecord,startRecordIndex,endRecordIndex,startPropIndex,endPropIndex,range=[],recordRange,propRange,i,j,dv=data?data:this._getDataView(),srId,erId,vcols=this.grid._visibleColumns();if(this.options.mode==="row"){srId=start;erId=end}else{srId=start.id;erId=end.id}if(this._pkProp){for(i=0;i<dv.length;i++){if(dv[i][this._pkProp]===srId){startRecord=dv[i];startRecordIndex=i}if(dv[i][this._pkProp]===erId){endRecord=dv[i];endRecordIndex=i}if(startRecord&&endRecord){break}}}else{startRecord=srId>=0&&srId<dv.length?dv[srId]:null;startRecordIndex=srId;endRecord=erId>=0&&erId<dv.length?dv[erId]:null;endRecordIndex=erId}if(!startRecord||!endRecord){return}if(startRecordIndex>endRecordIndex){recordRange=dv.slice(endRecordIndex,startRecordIndex+1)}else{recordRange=dv.slice(startRecordIndex,endRecordIndex+1)}startRecordIndex=Math.min(startRecordIndex,endRecordIndex);if(this.options.mode==="row"){if(!this._pkProp){for(i=0;i<recordRange.length;i++){range.push({id:i+startRecordIndex})}}else{for(i=0;i<recordRange.length;i++){range.push({id:recordRange[i][this._pkProp]})
}}return{startIndex:startRecordIndex,endIndex:endRecordIndex,active:end,element:this._getRowsByIdentifier(end),range:range}}for(i=0;i<vcols.length;i++){if(vcols[i].key===start.columnKey){startPropIndex=i}if(vcols[i].key===end.columnKey){endPropIndex=i}if(startPropIndex!==undefined&&endPropIndex!==undefined){break}}if(startPropIndex===undefined||endPropIndex===undefined){return}if(startPropIndex>endPropIndex){propRange=vcols.slice(endPropIndex,startPropIndex+1)}else{propRange=vcols.slice(startPropIndex,endPropIndex+1)}if(!this._pkProp){for(i=0;i<recordRange.length;i++){for(j=0;j<propRange.length;j++){range.push({id:{id:i+startRecordIndex,columnKey:propRange[j].key}})}}}else{for(i=0;i<recordRange.length;i++){for(j=0;j<propRange.length;j++){range.push({id:{id:recordRange[i][this._pkProp],columnKey:propRange[j].key}})}}}return{firstRowIndex:startRecordIndex,lastRowIndex:endRecordIndex,firstColumnIndex:startPropIndex,lastColumnIndex:endPropIndex,active:end,element:this._getCellByIdentifier(end),range:range}},_getElementRange:function(start,end){var startElement,endElement,startRowIndex,endRowIndex,range=[],i,reverse,rowRange,fixedRowRange,cellRange,rowIndex,isStartFixed,isEndFixed;startElement=this._selection.elementFromIdentifier(start);endElement=this._selection.elementFromIdentifier(end);startRowIndex=this._getIndexForRow(startElement.closest("tr"));endRowIndex=this._getIndexForRow(endElement.closest("tr"));reverse=startRowIndex>endRowIndex;if(reverse){startRowIndex=startRowIndex+endRowIndex;endRowIndex=startRowIndex-endRowIndex;startRowIndex=startRowIndex-endRowIndex}rowRange=this.grid.element.find("tbody").children("tr:not([data-container]):visible").slice(startRowIndex,endRowIndex+1);if(this.grid.hasFixedColumns()){fixedRowRange=this.grid.fixedBodyContainer().find("tbody").children("tr:not([data-container]):visible").slice(startRowIndex,endRowIndex+1)}if(this.options.mode==="row"){for(i=0;i<rowRange.length;i++){rowIndex=i+startRowIndex;range.push({id:this._pkProp?this._identifierForRow(rowRange.eq(i)):rowIndex,index:rowIndex,element:rowRange.eq(i).add(fixedRowRange?fixedRowRange.eq(i):null)})}return{startIndex:startRowIndex,endIndex:endRowIndex,active:end,element:endElement,range:range}}if(this.grid.hasFixedColumns()){isStartFixed=this.grid._isFixedElement(startElement);isEndFixed=this.grid._isFixedElement(endElement);if(isStartFixed&&isEndFixed){cellRange=this._getCellRangeFor(fixedRowRange,startElement,endElement,startRowIndex)}else if(isStartFixed!==isEndFixed){cellRange=this._getCrossCellRange(rowRange,fixedRowRange,startElement,endElement,startRowIndex)}else{cellRange=this._getCellRangeFor(rowRange,startElement,endElement,startRowIndex)}}else{cellRange=this._getCellRangeFor(rowRange,startElement,endElement,startRowIndex)}return $.extend(cellRange,{firstRowIndex:startRowIndex,lastRowIndex:endRowIndex,active:end,element:endElement})},_getCrossCellRange:function(rowRange,fixedRowRange,startElement,endElement,startRowIndex){var fixingDir=this.grid.fixedBodyContainer().attr("data-fixing-direction"),startFixedElement,endFixedElement,startUnfixedElement,endUnfixedElement,startFixedRow,endFixedRow,startUnfixedRow,endUnfixedRow,unfixedRange,fixedRange;if(this.grid._isFixedElement(startElement)){startFixedRow=startElement.parent();startFixedElement=startElement;endUnfixedRow=endElement.parent();endUnfixedElement=endElement;endFixedRow=this._getRowByIndex(endUnfixedRow.index(),true);startUnfixedRow=this._getRowByIndex(startFixedRow.index(),false);if(fixingDir==="left"){endFixedElement=endFixedRow.children("td:not([data-skip=true])").last();startUnfixedElement=startUnfixedRow.children("td:not([data-skip=true])").first()}else{endFixedElement=endFixedRow.children("td:not([data-skip=true])").first();startUnfixedElement=startUnfixedRow.children("td:not([data-skip=true])").last()}}else{startUnfixedRow=startElement.parent();startUnfixedElement=startElement;endFixedRow=endElement.parent();endFixedElement=endElement;endUnfixedRow=this._getRowByIndex(endFixedRow.index(),false);startFixedRow=this._getRowByIndex(startUnfixedRow.index(),true);if(fixingDir==="left"){endUnfixedElement=endUnfixedRow.children("td:not([data-skip=true])").first();startFixedElement=startFixedRow.children("td:not([data-skip=true])").last()}else{endUnfixedElement=endUnfixedRow.children("td:not([data-skip=true])").last();startFixedElement=startFixedRow.children("td:not([data-skip=true])").first()}}fixedRange=this._getCellRangeFor(fixedRowRange,startFixedElement,endFixedElement,startRowIndex);unfixedRange=this._getCellRangeFor(rowRange,startUnfixedElement,endUnfixedElement,startRowIndex);return{range:fixedRange.range.concat(unfixedRange.range),firstColumnIndex:fixedRange.startCellIndex,lastColumnIndex:fixedRange.endCellIndex}},_getCellRangeFor:function(rowRange,startElement,endElement,startRowIndex){var startCellIndex,endCellIndex,reverse,crLength,cellRange,range=[],row,rowIndex,cell,cellIndex,i,startElementIndex;startCellIndex=startElement.parent().children("td").index(startElement);endCellIndex=endElement.parent().children("td").index(endElement);reverse=startCellIndex>endCellIndex;if(reverse){startCellIndex=startCellIndex+endCellIndex;endCellIndex=startCellIndex-endCellIndex;startCellIndex=startCellIndex-endCellIndex}crLength=endCellIndex-startCellIndex+1;cellRange=rowRange.find("td:nth-of-type(n+"+(startCellIndex+1)+"):nth-of-type(-n+"+(endCellIndex+1)+")");if(!cellRange.length){return{range:range}}row=cellRange.eq(0).parent();rowIndex=startRowIndex;startElementIndex=startElement.index();for(i=0;i<cellRange.length;i++){cell=cellRange.eq(i);if(cell.parent()[0]!==row[0]){row=cell.parent();rowIndex=startRowIndex+Math.floor(i/crLength)}cellIndex=i%crLength+startElementIndex;range.push({id:this._identifierForCell(cell),element:cell,rowIndex:rowIndex,index:cellIndex})}return{firstColumnIndex:startCellIndex,lastColumnIndex:endCellIndex,range:range}},_isOutOfView:function(rowIdx,colIdx){var rv=this.grid.options.rowVirtualization||this.grid.options.virtualization,cv=this.grid.options.columnVirtualization||this.grid.options.virtualization,sri=this.grid._startRowIndex||0,sci=this.grid._startColIndex||0,vrc=this.grid._virtualRowCount,vcc=this.grid._virtualColumnCount;if(colIdx===null||colIdx===undefined){return rv?rowIdx<sri||rowIdx>=sri+vrc:false}return rv||cv?rowIdx<sri||rowIdx>=sri+vrc||colIdx<sci||colIdx>=sci+vcc:false},_isDataElement:function(identifier){var type=$.type(identifier);return type==="number"||type==="string"||!identifier.columnKey.startsWith("##")},_suppressKey:function(keyCode){var updating=this.grid.element.data("igGridUpdating"),key;switch(keyCode){case $.ui.keyCode.ENTER:key="enter";break;case $.ui.keyCode.SPACE:key="space";break}if(updating){return updating.options.startEditTriggers.indexOf(key)>=0}return false},_firstDataCellForRow:function(row){return row.children("td:not([data-skip='true'],td[data-parent]):first")},_canBeSelected:function(identifier){return!identifier.columnKey||identifier.columnKey&&!identifier.columnKey.startsWith("##")},_identifierForTarget:function(target){if(target.is("tr")){return this._identifierForRow(target)}if(target.hasClass("ui-iggrid-nongrouprowemptycell")){return this._identifierForDataSkipCell(target,this._gbEmptyCellKey)}if(target.hasClass("ui-iggrid-expandcolumn")){if(target.attr("data-parent")){return this._identifierForDataSkipCell(target,this._hgCellKey)}return this._identifierForDataSkipCell(target,this._gbExpandCellKey)}if(target.attr("data-gbsummary")){return this._identifierForDataSkipCell(target,this._gbSummaryCellKey)}if(target.hasClass("ui-igtreegrid-non-data-column")&&target.attr("data-skip")){return this._identifierForDataSkipCell(target,this._tgExpandKey)}if(target.is("td")){return this._identifierForCell(target)}if(target.is("th")){return this._identifierForDataSkipCell(target,this._rsCellKey)}return null},_identifierForCell:function(cell){var row=cell.parent(),id=this.grid._fixPKValue(row.attr("data-id"));if(id===null||id===undefined){id=this._getIndexForRow(row)}return{id:id,columnKey:this._getColKeyForCell(cell)}},_identifierForRow:function(row){var id=this.grid._fixPKValue(row.attr("data-id"));if(id!==null&&id!==undefined){return id}return this._getIndexForRow(row)},_identifierForDataSkipCell:function(cell,key){var row=cell.parent(),id=this.grid._fixPKValue(row.attr("data-id"));if(id===null||id===undefined){id=this._getIndexForRow(row)}return{id:id,columnKey:key}},_getRowsByIdentifier:function(identifier){var urow,frow=$();if(!this._pkProp){if(this.grid.hasFixedColumns()){frow=this._getRowByIndex(identifier,true)}urow=this._getRowByIndex(identifier,false)}else{if(this.grid.hasFixedColumns()){frow=this.grid.rowById(identifier,true)}urow=this.grid.rowById(identifier,false)}return urow instanceof jQuery?urow.add(frow):$()},_getCellByIdentifier:function(identifier){var cellRow,isFixed,skippedCells,colIndex,i,cols,sci=this.grid._startColIndex||0;if(identifier.columnKey&&identifier.columnKey.startsWith("##")){return this._getNonDataCellByIdentifier(identifier)}if(!this._pkProp){isFixed=this.grid.isFixedColumn(identifier.columnKey);cellRow=this._getRowByIndex(identifier.id,isFixed);cols=this.grid._visibleColumns(isFixed);skippedCells=cellRow.children("th,[data-skip=true],[data-parent]").length;for(i=0;i<cols.length;i++){if(cols[i].key===identifier.columnKey){colIndex=i;break}}return cellRow.children("td:nth-child("+(colIndex+1+skippedCells-sci)+")")}return this.grid.cellById(identifier.id,identifier.columnKey)||$()},_getNonDataCellByIdentifier:function(identifier){var cellRow;if(!this._pkProp){cellRow=this._getRowByIndex(identifier.id,this.grid.hasFixedColumns())}else{cellRow=this._getRowsByIdentifier(identifier.id)}switch(identifier.columnKey){case this._rsCellKey:return cellRow.children("th:first");case this._gbEmptyCellKey:return cellRow.children(".ui-iggrid-nongrouprowemptycell:first");case this._gbExpandCellKey:return cellRow.children().first();case this._gbSummaryCellKey:return cellRow.children().last();case this._hgCellKey:return cellRow.children("td[data-parent='true']");case this._tgExpandKey:return cellRow.children(".ui-igtreegrid-non-data-column:first");default:return $()}},_getRecordByIdentifier:function(identifier){var dv=this._getDataView(),i,record=null,index=-1;if(this._pkProp){for(i=0;i<dv.length;i++){if(dv[i][this._pkProp]===identifier){record=dv[i];index=i;break}}}else{if(identifier>=0&&identifier<dv.length){record=dv[identifier];index=identifier}}return{record:record,index:index}},_getRowByIndex:function(index,fixed){var tbody=fixed?this.grid.fixedBodyContainer().find("tbody"):this.grid.element.find("tbody");return tbody.children("tr:not([data-container])").eq(index)},_getCellByIndex:function(index,row){return row.children("td").eq(index)},_getIndexForRow:function(row){return row.closest("tbody").children("tr:not([data-container])").index(row)+(this.grid._startRowIndex||0)},_getColKeyForCell:function(cell){var col=this.grid.getColumnByTD(cell);return col?col.column.key:null},_getColIndexByKey:function(key){var i,columns=this.grid._visibleColumns();for(i=0;i<columns.length;i++){if(columns[i].key===key){return i}}return-1},_getDataView:function(){return this.grid.dataSource.dataView()},_onRowSelectionChanging:function(a){var args={owner:this,selectedRows:this._selection.selectedRows()};if(a.element&&a.element.length){args.row={element:a.element,index:a.index!==undefined?a.index:this._getIndexForRow(a.element)};if(this._pkProp){args.row.id=a.id||this._identifierForRow(a.element)}}else{args.row={element:$(),index:-1};if(this._pkProp){args.row.id=a.id}}if(a.startIndex!==undefined){args.startIndex=a.startIndex;args.endIndex=a.endIndex}return this._trigger(this.events.rowSelectionChanging,null,args)},_onRowSelectionChanged:function(a){var args={owner:this,selectedRows:this._selection.selectedRows()};if(a.element&&a.element.length){args.row={element:a.element,index:a.index!==undefined?a.index:this._getIndexForRow(a.element)};if(this._pkProp){args.row.id=a.id||this._identifierForRow(a.element)}}else{args.row={element:$(),index:-1};if(this._pkProp){args.row.id=a.id}}return this._trigger(this.events.rowSelectionChanged,null,args)},_onCellSelectionChanging:function(a){var args={owner:this,selectedCells:this._selection.selectedCells()};if(a.element&&a.element.length){args.cell={element:a.element,row:a.row||a.element.closest("tr"),columnKey:a.id?a.id.columnKey:this._getColKeyForCell(a.element)};args.cell.index=a.index!==undefined?a.index:this._getColIndexByKey(args.cell.columnKey);args.cell.rowIndex=a.rowIndex!==undefined?a.rowIndex:this._getIndexForRow(args.cell.row);if(this._pkProp){args.cell.rowId=a.id?a.id.id:this._identifierForRow(args.cell.row)}}else{args.cell={element:$(),row:$(),columnKey:a.id.columnKey};args.cell.index=-1;args.cell.rowIndex=-1;if(this._pkProp){args.cell.rowId=a.id?a.id.id:null}}if(a.firstColumnIndex!==undefined){args.firstColumnIndex=a.firstColumnIndex;args.firstRowIndex=a.firstRowIndex;args.lastColumnIndex=a.lastColumnIndex;args.lastRowIndex=a.lastRowIndex}return this._trigger(this.events.cellSelectionChanging,null,args)},_onCellSelectionChanged:function(a){var args={owner:this,selectedCells:this._selection.selectedCells()};if(a.element&&a.element.length){args.cell={element:a.element,row:a.row||a.element.closest("tr"),columnKey:a.id?a.id.columnKey:this._getColKeyForCell(a.element)};args.cell.index=a.index!==undefined?a.index:this._getColIndexByKey(args.cell.columnKey);args.cell.rowIndex=a.rowIndex!==undefined?a.rowIndex:this._getIndexForRow(args.cell.row);if(this._pkProp){args.cell.rowId=a.rowId||this._identifierForRow(args.cell.row)}}else{args.cell={element:$(),row:$(),columnKey:a.id.columnKey};args.cell.index=-1;args.cell.rowIndex=-1;if(this._pkProp){args.cell.rowId=a.id?a.id.id:null}}return this._trigger(this.events.cellSelectionChanged,null,args)},_onRowActivationChanging:function(a){var args={owner:this,row:a?{element:a.element,index:this._getIndexForRow(a.element)}:null};if(this._pkProp&&a){args.row.id=a.id}return this._trigger(this.events.activeRowChanging,null,args)},_onRowActivationChanged:function(a){var args={owner:this,row:a?{element:a.element,index:this._getIndexForRow(a.element)}:null};if(this._pkProp&&a){args.row.id=a.id}return this._trigger(this.events.activeRowChanged,null,args)},_onCellActivationChanging:function(a){var args={owner:this,cell:a?{element:a.element,row:a.element.closest("tr")}:null};if(a){args.cell.index=this._getColIndexByKey(a.id.columnKey);args.cell.rowIndex=this._getIndexForRow(args.cell.row);args.cell.columnKey=a.id.columnKey;if(this._pkProp){args.cell.rowId=a.id.id}}return this._trigger(this.events.activeCellChanging,null,args)},_onCellActivationChanged:function(a){var args={owner:this,cell:a?{element:a.element,row:a.element.closest("tr")}:null};if(a){args.cell.index=this._getColIndexByKey(a.id.columnKey);args.cell.rowIndex=this._getIndexForRow(args.cell.row);args.cell.columnKey=a.id.columnKey;if(this._pkProp){args.cell.rowId=a.id.id}}return this._trigger(this.events.activeCellChanged,null,args)},_select:function(info){var element=info.element||this._selection.elementFromIdentifier(info.id);if(element.is("tr")){element.children("td").not("[data-skip=true]").addClass(this.css.selectedCell)}else{element.addClass(this.css.selectedCell)}element.attr("aria-selected",true)},_deselect:function(info){var element=info.element||this._selection.elementFromIdentifier(info.id);if(element.is("tr")){element.children("td").removeClass(this.css.selectedCell)}else{element.removeClass(this.css.selectedCell)}element.attr("aria-selected",false)},_resizeGridWidth:function(decrease){if(decrease&&this._gridWidthDecreased||!decrease&&!this._gridWidthDecreased){return}var grid=this.grid,diff,padding=parseInt(grid.element.find("tbody tr td:last-child").css(grid._padding),10),$col=grid.element.find("colgroup:first>col:last");this._scrollbarWidth=this._scrollbarWidth||grid._scrollbarWidth();diff=this._scrollbarWidth;this._gridWidthDecreased=false;if(decrease){diff=-diff;this._gridWidthDecreased=true}grid.element.find("tbody tr td:last-child").css({"padding-right":padding+diff,"border-right":diff>0?"1px":"0px"});grid.element.css("width",grid.element.width()+diff);$col.width($col.width()+diff)},_isScrollbarOverLastCells:function(){if(this._isScrollbarOverLastCellsCache===undefined||this._isScrollbarOverLastCellsCache===null){var opts=this.grid.options,hasFixedHeaders=opts.showHeader&&opts.fixedHeaders===true&&opts.height!==null,hasVirtualization=opts.virtualization===true||opts.columnVirtualization===true||opts.rowVirtualization===true,lastColInPixels=this.grid.headersTable().children("colgroup").length>0&&this.grid.headersTable().children("colgroup").first().children("col:last").css("width").indexOf("%")===-1,hasHorizontalScrollbar=this.grid._hscrollbar().length>0;this._isScrollbarOverLastCellsCache=this.grid._hasVerticalScrollbar&&hasFixedHeaders&&!hasVirtualization&&hasHorizontalScrollbar&&lastColInPixels}return this._isScrollbarOverLastCellsCache},_activate:function(element){var initiallyFocused,me=this;if(element.is("tr")){element.addClass(this.css.activeRow);initiallyFocused=element.filter(".initially-focused");if(initiallyFocused.length){initiallyFocused.focus();initiallyFocused.removeClass("initially-focused");return}}else{element.addClass(this.css.activeCell)}if(this.options.mode==="cell"&&$.ig.util.isIE&&element.is(":last-child")&&this._isScrollbarOverLastCells()){this._resizeGridWidth(true);element.focus();if(this._timeoutResizeGrid){clearTimeout(this._timeoutResizeGrid);this._timeoutResizeGrid=null}this._timeoutResizeGrid=setTimeout(function(){me._resizeGridWidth(false)},100)}else{element.focus()}},_deactivate:function(){if(this.grid.hasFixedColumns()){if(this.options.mode==="row"){this.grid.fixedBodyContainer().find("tbody").find("tr.ui-iggrid-activerow").removeClass(this.css.activeRow)}else{this.grid.fixedBodyContainer().find("tbody").find("td.ui-iggrid-activecell").removeClass(this.css.activeCell)}}if(this.options.mode==="row"){this.grid.element.find("tbody").find("tr.ui-iggrid-activerow").removeClass(this.css.activeRow)}else{this.grid.element.find("tbody").find("td.ui-iggrid-activecell").removeClass(this.css.activeCell)}},_clearSelection:function(){this.grid.fixedBodyContainer().find("tbody").find("td.ui-iggrid-selectedcell").removeClass(this.css.selectedCell).attr("aria-selected",false);this.grid.fixedBodyContainer().find("tbody").find("tr[aria-selected]").attr("aria-selected",false);this.grid.element.children("tbody").find("td.ui-iggrid-selectedcell").removeClass(this.css.selectedCell).attr("aria-selected",false);this.grid.element.children("tbody").find("tr[aria-selected]").attr("aria-selected",false)},_createHandlers:function(){this._dataRenderingHandler=$.proxy(this._dataRendering,this);this._virtualRecordsRenderingHandler=$.proxy(this._virtualRecordsRendering,this);this._virtualRecordsRendererHandler=$.proxy(this._virtualRecordsRender,this);this._columnsCollectionModifiedHandler=$.proxy(this._columnsCollectionModified,this);this._mouseDownHandler=$.proxy(this._mouseDown,this);this._mouseMoveHandler=$.proxy(this._mouseMove,this);this._mouseUpHandler=$.proxy(this._mouseUp,this);this._pointerDownHandler=$.proxy(this._pointerDown,this);this._pointerMoveHandler=$.proxy(this._pointerMove,this);this._pointerUpHandler=$.proxy(this._pointerUp,this);this._selectStartHandler=$.proxy(this._selectStart,this);this._selectStartContainerHandler=$.proxy(this._selectStartContainer,this);this._releaseMouseHandler=$.proxy(this._releaseMouse,this);this._touchStartHandler=$.proxy(this._touchStart,this);this._touchEndHandler=$.proxy(this._touchEnd,this);this._touchMoveHandler=$.proxy(this._touchMove,this);this._keyDownHandler=$.proxy(this._keyDown,this);this._containerFocusHandler=$.proxy(this._containerFocus,this);this._focusInHandler=$.proxy(this._tbodyFocusIn,this);this._focusOutHandler=$.proxy(this._tbodyFocusOut,this);this._preventDefaultHandler=$.proxy(this._preventDefault,this)},_unregisterEvents:function(){var gOpts=this.grid.options,tbody=this.grid.element.find("tbody").add(this.grid.fixedBodyContainer().find("tbody")),hasVirtualization=gOpts.virtualization||gOpts.rowVirtualization||gOpts.columnVirtualization,scrollCont=hasVirtualization?this.grid._vdisplaycontainer():this.grid.scrollContainer();if(this._tbodyBinding){tbody.unbind(this._tbodyBinding)}$(document).unbind("mouseup",this._releaseMouseHandler);scrollCont.unbind("scroll",this._releaseMouseHandler);this.grid.container().unbind("selectstart",this._selectStartContainerHandler);this.grid.element.removeClass("ui-iggrid-canceltextselection");if(this.options.mode==="row"){this.grid.element.find("tbody td").unbind("mousedown",this._preventDefaultHandler)}},_registerEvents:function(){var gOpts=this.grid.options,tbody=this.grid.element.find("tbody").add(this.grid.fixedBodyContainer().find("tbody")),hasVirtualization=gOpts.virtualization||gOpts.rowVirtualization||gOpts.columnVirtualization,scrollCont=hasVirtualization?this.grid._vdisplaycontainer():this.grid.scrollContainer();this._tbodyBinding=this._tbodyBinding||this._generateTbodyBinding();tbody.unbind(this._tbodyBinding).bind(this._tbodyBinding);$(document).bind("mouseup",this._releaseMouseHandler);scrollCont.bind("scroll",this._releaseMouseHandler);this.grid.container().bind("selectstart",this._selectStartContainerHandler);if(this.options.multipleSelection===true){this.grid.element.addClass("ui-iggrid-canceltextselection")}if(this.options.mode==="row"){this.grid.element.find("tbody td").bind("mousedown",this._preventDefaultHandler)}},_generateTbodyBinding:function(){var binding={};binding.selectstart=this._selectStartHandler;binding.focusin=this._focusInHandler;binding.focusout=this._focusOutHandler;binding.keydown=this._keyDownHandler;if($.ig.util.isTouch){binding.touchstart=this._touchStartHandler;binding.touchend=this._touchEndHandler;binding.touchmove=this._touchMoveHandler}if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled){binding.MSPointerDown=this._pointerDownHandler;binding.MSPointerMove=this._pointerMoveHandler;binding.MSPointerUp=this._pointerUpHandler;binding.pointerdown=this._pointerDownHandler;binding.pointermove=this._pointerMoveHandler;binding.pointerup=this._pointerUpHandler}else{binding.mousedown=this._mouseDownHandler;binding.mousemove=this._mouseMoveHandler;binding.mouseup=this._mouseUpHandler}return binding},_injectGrid:function(gridInstance,isRebind){var i;this.grid=gridInstance;for(i=0;i<this.grid.options.features.length;i++){if(this.grid.options.features[i].name==="Selection"){this.grid.options.features[i].inherit=true}if(this.grid.options.features[i].name==="RowSelectors"){if(this.grid.options.features[i].enableCheckBoxes===true&&this.grid.options.features[i].checkBoxMode!=="triState"){this.options.mode="row"}}}this._initSelectionCollection(isRebind);if(!isRebind){this._createHandlers()}this.grid.element.unbind("iggriddatarendering",this._dataRenderingHandler).bind("iggriddatarendering",this._dataRenderingHandler);this.grid.element.unbind("iggridvirtualrendering",this._virtualRecordsRenderingHandler).bind("iggridvirtualrendering",this._virtualRecordsRenderingHandler);this.grid.element.unbind("igtreegridvirtualrendering",this._virtualRecordsRenderingHandler).bind("igtreegridvirtualrendering",this._virtualRecordsRenderingHandler);this.grid.element.unbind("iggridvirtualrecordsrender",this._virtualRecordsRendererHandler).bind("iggridvirtualrecordsrender",this._virtualRecordsRendererHandler);this.grid.element.unbind("igtreegridvirtualrecordsrender",this._virtualRecordsRendererHandler).bind("igtreegridvirtualrecordsrender",this._virtualRecordsRendererHandler);this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler).bind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler);if(!isRebind){this.grid._cellStyleSubscribers.push(this.options.mode==="row"?$.proxy(this._applyRowStyle,this):$.proxy(this._applyCellStyle,this))}}});$.extend($.ui.igGridSelection,{version:"16.1.20161.1009"});$.ig.SelectionCollection=$.ig.SelectionCollection||Class.extend({settings:{multipleSelection:false,subscribers:{},owner:null},init:function(options){if(options){this.settings=$.extend(true,{},$.ig.SelectionCollection.prototype.settings,options)}this.selection={};return this},addSubscriber:function(subscriber,owner){var suid=$.ig.uid();if(!this.settings.subscribers[owner]){this.settings.subscribers[owner]={}}this.settings.subscribers[owner][suid]=subscriber;return suid},removeSubscriber:function(subscriberId,owner){delete this.settings.subscribers[owner][subscriberId]},changeOwner:function(newOwner){this.cleanAll();this.settings.owner=newOwner},isSelected:function(identifier,forOwner){return false},isActive:function(identifier,forOwner){return false},elementFromIdentifier:function(identifier){return $()},toggle:function(element){if(this.activeElement===null){return}this.select(this.activeElement,true,{element:element||this.elementFromIdentifier(this.activeElement)})},activate:function(identifier,element,suppress){var info={element:element,id:identifier};if(!this.isActive(identifier)){if(this._requestTrigger("ActivationChanging",suppress,info)){this._notify("deactivate");this.activeElement=identifier;this._notify("activate",element);this._requestTrigger("ActivationChanged",suppress,info)}}},deactivate:function(suppress){if(this._requestTrigger("ActivationChanging",suppress,null)){this._notify("deactivate");this.activeElement=null;this._requestTrigger("ActivationChanged",suppress,null)}},select:function(identifier,add,info,suppress){info=info||{};info.element=info.element||this.elementFromIdentifier(identifier);info.id=identifier;if(this.isSelected(identifier)){if(add){if(this._requestTrigger("SelectionChanging",suppress,info)){this._markUnselected(identifier);this._notify("deselect",info);this._requestTrigger("SelectionChanged",suppress,info)}}else{if(this.onlyOneSelected()){return}if(this._requestTrigger("SelectionChanging",suppress,info)){this.clearSelection();this._markSelected(identifier,info);this._notify("select",info);this._requestTrigger("SelectionChanged",suppress,info)}}}else{if(this._requestTrigger("SelectionChanging",suppress,info)){if(!add||!this.settings.multipleSelection){this.clearSelection()}this._markSelected(identifier,info);this._notify("select",info);this._requestTrigger("SelectionChanged",suppress,info)}}this.rangeSelectStart=identifier},rangeSelect:function(range,add,prevRange,info,suppress){var i;if(!this._requestTrigger("SelectionChanging",suppress,info)){return}if(!prevRange||!this._rangeUnlock){if(!add){this.clearSelection()}}else{this._rangeUnlock(prevRange)}for(i=0;i<range.length;i++){if(!this.isSelected(range[i].id)){this._markSelected(range[i].id,range[i]);this._notify("select",range[i])}}this.activate(info.active,info.element||this.elementFromIdentifier(info.active));this._requestTrigger("SelectionChanged",suppress,info)},rangeDeselect:function(range,info,suppress){var i;if(!this._requestTrigger("SelectionChanging",suppress,info)){return}for(i=0;i<range.length;i++){this._markUnselected(range[i].id);this._notify("deselect",range[i])}this._requestTrigger("SelectionChanged",suppress,info)},deselect:function(identifier,info,suppress){info=info||{};info.element=info.element||this.elementFromIdentifier(identifier);info.id=identifier;this.select(identifier,true,info,suppress)},deselectAll:function(suppress){if(!this._requestTrigger("SelectionChanging",suppress,{})){return}this.clearSelection();this._requestTrigger("SelectionChanged",suppress,{})},clearSelection:function(forOwner){if(!forOwner||forOwner===this.settings.owner){this.selection={};this._notify("clearSelection")}},cleanAll:function(forOwner){if(!forOwner||forOwner===this.settings.owner){this.deactivate(true);this.clearSelection()}},onlyOneSelected:function(){return false},selectedCells:function(){return[]},selectedRows:function(){return[]},selectionLength:function(){return Object.keys(this.selection).length},_requestTrigger:function(type,suppress,args){var subs=this.settings.subscribers[this.settings.owner.id()],func="_on"+this._selectionMode()+type,key,result=true;if(suppress){return true}for(key in subs){if(subs.hasOwnProperty(key)&&typeof subs[key][func]==="function"){result=result&&subs[key][func](args)}}return result},_notify:function(message,info){var subs=this.settings.subscribers[this.settings.owner.id()],func="_"+message,key;for(key in subs){if(subs.hasOwnProperty(key)&&typeof subs[key][func]==="function"){subs[key][func](info)}}}});$.ig.SelectedRowsCollection=$.ig.SelectedRowsCollection||$.ig.SelectionCollection.extend({isSelected:function(identifier,forOwner){if(forOwner&&this.settings.owner!==forOwner){return false}return this.selection[identifier]!==undefined},isActive:function(identifier,forOwner){if(forOwner&&this.settings.owner!==forOwner){return false}return this.activeElement===identifier},selectedRows:function(){var rows=this._rowscache||[],rowKey;for(rowKey in this.selection){if(this.selection.hasOwnProperty(rowKey)){rows.push(this._selectedRowObject(this.settings.owner._fixPKValue(rowKey)))}}this.invalid=false;return rows},activeRow:function(){var row;if(this.activeElement!==null&&this.activeElement!==undefined){row=this.elementFromIdentifier(this.activeElement);return{id:this.activeElement,index:this.elementPosition(this.activeElement,row),element:row}}return null},elementFromIdentifier:function(identifier){return this.settings.owner.element.data("igGridSelection")._getRowsByIdentifier(identifier)},elementPosition:function(identifier,element){var ownSelection=this.settings.owner.element.data("igGridSelection");if(element&&element.length>0){return ownSelection._getIndexForRow(element)}return ownSelection._getRecordByIdentifier(identifier).index},onlyOneSelected:function(){return Object.keys(this.selection).length===1},_markSelected:function(identifier,info){this.selection[identifier]=info||true},_markUnselected:function(identifier){delete this.selection[identifier]},_selectedRowObject:function(identifier){var rowInfo=this.selection[identifier];if($.type(rowInfo)!=="object"){rowInfo={};this.selection[identifier]=rowInfo}if(this.invalid){rowInfo.element=this.elementFromIdentifier(identifier);rowInfo.index=this.elementPosition(identifier,rowInfo.element)}else{rowInfo.element=rowInfo.element||this.elementFromIdentifier(identifier);rowInfo.index=rowInfo.index!==undefined&&rowInfo.index!==null?rowInfo.index:this.elementPosition(identifier,rowInfo.element)}return $.extend(true,{},rowInfo,{id:identifier})},_selectionMode:function(){return"Row"}});$.ig.SelectedCellsCollection=$.ig.SelectedCellsCollection||$.ig.SelectionCollection.extend({isSelected:function(identifier,forOwner){if(forOwner&&this.settings.owner!==forOwner){return false}return this.selection[identifier.id]!==undefined&&this.selection[identifier.id][identifier.columnKey]!==undefined},atLeastOneSelected:function(rowId,forOwner){if(forOwner&&this.settings.owner!==forOwner){return false}return Object.keys(this.selection[rowId]).length>0},isActive:function(identifier,forOwner){if(forOwner&&this.settings.owner!==forOwner){return false}return this.activeElement&&this.activeElement.id===identifier.id&&this.activeElement.columnKey===identifier.columnKey},selectedCells:function(){var cells=[],sid,rowKey,columnKey;for(rowKey in this.selection){if(this.selection.hasOwnProperty(rowKey)){for(columnKey in this.selection[rowKey]){if(this.selection[rowKey].hasOwnProperty(columnKey)){sid={id:this.settings.owner._fixPKValue(rowKey),columnKey:columnKey};cells.push(this._selectedCellObject(sid))}}}}this.invalid=false;return cells},activeCell:function(){var cell,pos;if(this.activeElement){cell=this.elementFromIdentifier(this.activeElement);pos=this.elementPosition(this.activeElement,cell);return{row:cell.parent(),id:this.activeElement.id,columnKey:this.activeElement.columnKey,rowIndex:pos.x,index:pos.y,element:cell}
}return null},elementFromIdentifier:function(identifier){return this.settings.owner.element.data("igGridSelection")._getCellByIdentifier(identifier)},elementPosition:function(identifier,element){var ownSelection=this.settings.owner.element.data("igGridSelection");if(element&&element.length>0){return{x:ownSelection._getIndexForRow(element.parent()),y:element.index()}}return{x:ownSelection._getRecordByIdentifier(identifier.id).index,y:ownSelection._getColIndexByKey(identifier.columnKey)}},onlyOneSelected:function(){var rKeys=Object.keys(this.selection);if(rKeys.length===1){return Object.keys(this.selection[rKeys[0]]).length===1}return false},_lockSelection:function(){var rowId,cellId;for(rowId in this.selection){if(this.selection.hasOwnProperty(rowId)){for(cellId in this.selection[rowId]){if(this.selection[rowId].hasOwnProperty(cellId)){if($.type(this.selection[rowId][cellId]==="object")){this.selection[rowId][cellId].locked=true}else{this.selection[rowId][cellId]={locked:true}}}}}}},_markSelected:function(identifier,info){this.selection[identifier.id]=this.selection[identifier.id]||{};this.selection[identifier.id][identifier.columnKey]=info||true},_markUnselected:function(identifier){if(!this.selection[identifier.id]){return}delete this.selection[identifier.id][identifier.columnKey]},_unlockSelected:function(identifier){var c;if(!this.selection[identifier.id]){return false}c=this.selection[identifier.id][identifier.columnKey];if($.type(c)==="object"){if(!c.locked){delete this.selection[identifier.id][identifier.columnKey];return true}return false}delete this.selection[identifier.id][identifier.columnKey];return true},_rangeUnlock:function(range){var i;for(i=0;i<range.length;i++){if(this._unlockSelected(range[i].id)){this._notify("deselect",range[i])}}},_selectedCellObject:function(identifier){var cellInfo=this.selection[identifier.id][identifier.columnKey],pos;if($.type(cellInfo)!=="object"){cellInfo={};this.selection[identifier.id][identifier.columnKey]=cellInfo}if(this.invalid){cellInfo.element=this.elementFromIdentifier(identifier);cellInfo.row=cellInfo.element.parent();pos=this.elementPosition(identifier,cellInfo.element);cellInfo.rowIndex=pos.x;cellInfo.index=pos.y}else{cellInfo.element=cellInfo.element||this.elementFromIdentifier(identifier);cellInfo.row=cellInfo.row||cellInfo.element.parent();if(!(cellInfo.rowIndex!==undefined&&cellInfo.rowIndex!==null&&cellInfo.index!==undefined&&cellInfo.index!==null)){pos=this.elementPosition(identifier,cellInfo.element);cellInfo.rowIndex=pos.x;cellInfo.index=pos.y}}return $.extend(true,{},cellInfo,{id:identifier.id,columnKey:identifier.columnKey})},_selectionMode:function(){return"Cell"}})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Sorting 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridSorting",{css:{sortableColumnHeader:"ui-iggrid-sortableheader ui-state-default",sortableColumnHeaderActive:"ui-iggrid-sortableheaderactive ui-state-active",sortableColumnHeaderHover:"ui-iggrid-sortableheaderhover ui-state-hover",sortableColumnHeaderFocus:"ui-iggrid-sortableheaderfocus ui-state-focus",ascendingColumnHeader:"ui-iggrid-colheaderasc",descendingColumnHeader:"ui-iggrid-colheaderdesc",ascendingColumn:"ui-iggrid-colasc ui-state-highlight",descendingColumn:"ui-iggrid-coldesc ui-state-highlight",sortIndicator:"ui-iggrid-colindicator",fcSortIndicatorAscending:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-sort-a-z",fcSortIndicatorDescending:"ui-iggrid-featurechooser-li-iconcontainer ui-icon ui-iggrid-icon-sort-z-a",sortIndicatorAscending:"ui-iggrid-colindicator-asc ui-icon ui-icon-arrowthick-1-n",sortIndicatorDescending:"ui-iggrid-colindicator-desc ui-icon ui-icon-arrowthick-1-s",dialogSortedColumns:"ui-iggrid-sorting-dialog-sortedcolumns",dialogUnsortedColumns:"ui-iggrid-sorting-dialog-unsortedcolumns",dialogUnsortedColumnsSortByButton:"ui-iggrid-sorting-dialog-unsortedcolumns-sortbybutton",dialogAsdDescButton:"ui-iggrid-sorting-dialog-ascdescbutton",modalDialogSortByColumn:"ui-iggrid-sorting-dialog-sortbybutton",dialogSortedColumnsItem:"ui-widget-content",dialogUnsortedColumnsItem:"ui-widget-content",dialogButtonAsc:"ui-button ui-corner-all ui-button-icon-only ig-sorting-indicator",dialogButtonAscIcon:"ui-button-icon-primary ui-icon ui-icon-arrowthick-1-n",dialogButtonDesc:"ui-button ui-corner-all ui-button-icon-only ig-sorting-indicator",dialogButtonDescIcon:"ui-button-icon-primary ui-icon ui-icon-arrowthick-1-s",dialogButtonUnsort:"ui-iggrid-sorting-dialog-sortbybuttons ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-igbutton ui-widget-content ui-igbutton-remove",dialogButtonUnsortContainer:"ui-button-icon-primary ui-icon ui-icon-circle-close",dialogSortedColumnTextContainer:"ui-iggrid-dialog-text",dialogItemText:"ui-iggrid-dialog-text",dialogButtonsHover:"ui-state-hover",featureChooserModalDialogIcon:"ui-icon ui-iggrid-icon-multiple-sorting"},options:{type:null,caseSensitive:false,applySortedColumnCss:true,sortUrlKey:null,sortUrlKeyAscValue:null,sortUrlKeyDescValue:null,mode:"single",customSortFunction:null,firstSortDirection:"ascending",sortedColumnTooltip:$.ig.GridSorting.locale.sortedColumnTooltipFormat,modalDialogSortOnClick:false,modalDialogSortByButtonText:$.ig.GridSorting.locale.modalDialogSortByButtonText,modalDialogResetButtonLabel:$.ig.GridSorting.locale.modalDialogResetButton,modalDialogCaptionButtonDesc:$.ig.GridSorting.locale.modalDialogCaptionButtonDesc,modalDialogCaptionButtonAsc:$.ig.GridSorting.locale.modalDialogCaptionButtonAsc,modalDialogCaptionButtonUnsort:$.ig.GridSorting.locale.modalDialogCaptionButtonUnsort,modalDialogWidth:350,modalDialogHeight:"",modalDialogAnimationDuration:200,featureChooserText:$.ig.GridSorting.locale.featureChooserText,unsortedColumnTooltip:$.ig.GridSorting.locale.unsortedColumnTooltip,columnSettings:[{columnKey:null,columnIndex:null,firstSortDirection:null,currentSortDirection:null,allowSorting:true,compareFunc:null}],modalDialogCaptionText:$.ig.GridSorting.locale.modalDialogCaptionText,modalDialogButtonApplyText:$.ig.GridSorting.locale.modalDialogButtonApplyText,modalDialogButtonCancelText:$.ig.GridSorting.locale.modalDialogButtonCancelText,featureChooserSortAsc:$.ig.GridSorting.locale.featureChooserSortAsc,featureChooserSortDesc:$.ig.GridSorting.locale.featureChooserSortDesc,persist:true,sortingDialogContainment:"owner",inherit:false},renderInFeatureChooser:true,events:{columnSorting:"columnSorting",columnSorted:"columnSorted",modalDialogOpening:"modalDialogOpening",modalDialogOpened:"modalDialogOpened",modalDialogMoving:"modalDialogMoving",modalDialogClosing:"modalDialogClosing",modalDialogClosed:"modalDialogClosed",modalDialogContentsRendering:"modalDialogContentsRendering",modalDialogContentsRendered:"modalDialogContentsRendered",modalDialogSortingChanged:"modalDialogSortingChanged",modalDialogButtonUnsortClick:"modalDialogButtonUnsortClick",modalDialogSortClick:"modalDialogSortClick",modalDialogButtonApplyClick:"modalDialogButtonApplyClick",modalDialogButtonResetClick:"modalDialogButtonResetClick"},_createWidget:function(){this.options.columnSettings=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var self=this;this._headers=[];this._clickHandler=function(event){var th,id,scrLeft,$scrContainer;id=$(event.target).closest(".ui-iggrid").attr("id").replace("_container","");if(self.grid.element.attr("id")!==id){return}th=$(event.currentTarget).closest("th");if(th.attr("data-skip")!=="true"&&(self.grid._isMultiColumnGrid!==true||th.attr("data-isheadercell")==="true")){if(!self._checkSortingAllowed(th)){return}self._handleSort(event);scrLeft=$("#"+self.grid.id()+"_hscroller").scrollLeft();if(scrLeft>0){if(self.grid.options.fixedHeaders===true){self.grid.headersTable().parent().scrollLeft(scrLeft)}if(self.grid.options.fixedFooters===true){self.grid.footersTable().parent().scrollLeft(scrLeft)}$scrContainer=self.grid.scrollContainer();if(!$scrContainer.length){$scrContainer=self.grid._vdisplaycontainer()}$scrContainer.scrollLeft(scrLeft)}}};this._dragStartHandler=function(event){var id,noCancel=true;noCancel=self.grid._trigger("headercelldragcancel",event,{});if(noCancel){id=$(event.target).closest(".ui-iggrid").attr("id").replace("_container","");if(self.grid.element.attr("id")!==id){return}event.stopPropagation();event.preventDefault()}else{return true}return false};this._mouseOverHandler=function(event){var id,$target=$(event.currentTarget),cs;id=$(event.target).closest(".ui-iggrid").attr("id").replace("_container","");if(self.grid.element.attr("id")!==id){return}cs=self._getColSettingFromElement(event.currentTarget);if(cs&&cs.allowSorting!==false){$target.addClass(self.css.sortableColumnHeaderHover)}};this._mouseOutHandler=function(event){var id;id=$(event.target).closest(".ui-iggrid").attr("id").replace("_container","");if(self.grid.element.attr("id")!==id){return}$(event.currentTarget).removeClass(self.css.sortableColumnHeaderHover)};$("#"+this.element[0].id).delegate("thead th",{click:this._clickHandler,mouseover:this._mouseOverHandler,mouseout:this._mouseOutHandler});$("#"+this.element[0].id+" thead th").bind("dragstart",this._dragStartHandler);$("#"+this.element[0].id+"_headers thead th").bind("dragstart",this._dragStartHandler);$(document).delegate("#"+this.element[0].id+"_headers thead th",{click:this._clickHandler,mouseover:this._mouseOverHandler,mouseout:this._mouseOutHandler});this._keyDownHandler=function(event){self._handleSortKb(event)};this._focusHandler=function(event){self._handleFocusKb(event)};this._blurHandler=function(event){self._handleBlurKb(event)};$("#"+this.element[0].id).delegate("thead th",{keydown:this._keyDownHandler,focus:this._focusHandler,blur:this._blurHandler});$(document).delegate("#"+this.element[0].id+"_headers thead th",{keydown:this._keyDownHandler,focus:this._focusHandler,blur:this._blurHandler})},_setOption:function(key,value){var i,col,featureChooserInstance,modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"type":throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key));case"caseSensitive":this.grid.dataSource.settings.sorting.caseSensitive=this.options.caseSensitive;break;case"modalDialogSortOnClick":modalDialog.remove();this._renderMultipleSortingDialog();break;case"modalDialogAnimationDuration":modalDialog.igGridModalDialog("option","animationDuration",value);break;case"modalDialogWidth":modalDialog.igGridModalDialog("option","modalDialogWidth",value);break;case"modalDialogHeight":modalDialog.igGridModalDialog("option","modalDialogHeight",value);break;case"modalDialogButtonApplyText":modalDialog.igGridModalDialog("option","buttonApplyText",value);break;case"modalDialogButtonCancelText":modalDialog.igGridModalDialog("option","buttonCancelText",value);break;case"modalDialogCaptionText":modalDialog.igGridModalDialog("option","modalDialogCaptionText",value);break;case"featureChooserText":featureChooserInstance=this.grid.element.data("igGridFeatureChooser");if(featureChooserInstance){for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i].key;featureChooserInstance._setListItemText(col,"Sorting",value)}}break;default:break}},_getColSettingFromElement:function(e){var index,cs=this.options.columnSettings,$e=$(e);index=parseInt($e.data("columnIndex"),10);return cs[index]},_handleSortKb:function(event){if($(event.target).attr("id")===undefined||$(event.target).attr("id")===null){return}var $el=$(event.target),key=$el.attr("id").replace(this.grid.element.attr("id")+"_",""),id;id=$el.closest(".ui-iggrid").attr("id").replace("_container","");if(this.grid.element.attr("id")!==id){return}if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){if(this._checkSortingAllowed($el)){if(this._currentActiveHeader){this._currentActiveHeader.removeClass(this.css.sortableColumnHeaderActive)}$el.addClass(this.css.sortableColumnHeaderActive);this._currentActiveHeader=$el;if(event.shiftKey){this.unsortColumn(key,$el)}else{this.sortColumn(key,null,$el)}}event.stopPropagation();event.preventDefault()}},_handleFocusKb:function(event){if(this._resizing&&this._resizing._resizing){return}var $target=$(event.target),id=$target.closest(".ui-iggrid").attr("id").replace("_container","");if(this.grid.element.attr("id")!==id||$target.attr("data-fixing-indicator")!==undefined||!this._checkSortingAllowed($target)){return}$target.addClass(this.css.sortableColumnHeaderFocus)},_handleBlurKb:function(event){var id=$(event.target).closest(".ui-iggrid").attr("id").replace("_container","");if(this.grid.element.attr("id")!==id){return}$(event.target).removeClass(this.css.sortableColumnHeaderFocus)},_handleSort:function(event){if(this._resizing&&this._resizing._resizing){this._resizing._resizing=false;return}var $currentTarget=$(event.currentTarget),$th=$currentTarget.closest("th"),key=$th.attr("id").replace(this.grid.element.attr("id")+"_",""),isShiftClicked=false;if(this._currentActiveHeader){this._currentActiveHeader.removeClass(this.css.sortableColumnHeaderActive).removeClass(this.css.sortableColumnHeaderFocus)}isShiftClicked=event.shiftKey;if(isShiftClicked){$th.removeClass(this.css.sortableColumnHeaderFocus).removeClass(this.css.sortableColumnHeaderActive);this.unsortColumn(key,$th)}else{$currentTarget.addClass(this.css.sortableColumnHeaderActive);this._currentActiveHeader=$th;this.sortColumn(key,null,$currentTarget)}event.stopPropagation();event.preventDefault()},_checkSortingAllowed:function($th){$th=$th.is("th")?$th:$th.closest("th");var id=$th.attr("id")||"",colKey=id.replace(this.grid.id()+"_",""),s=this._findColumnSetting(colKey);if(!s||s.allowSorting===false){return false}return true},_initLoadingIndicator:function(){this._loadingIndicator=this.grid.container().length>0?this.grid.container().igLoading().data("igLoading").indicator():this.grid.element.igLoading().data("igLoading").indicator()},_getHeaderCellByIdentifier:function(identifier){var $headerCell,colKey;if($.type(identifier)==="number"){colKey=this.grid.options.columns[identifier].key}else{colKey=identifier}$headerCell=$("#"+this.grid.element[0].id+"_"+colKey);return $headerCell},sortColumn:function(index,direction,header){var colKey,expr,noCancel=true,s,se,i,visualIndex,groupby,reset=true,newDir,apiCall=header===null||header===undefined,addSE=false,isHidden=false,sortingNewExprs,curNewExpr,cs,compareFunc;this._activeSortedCol=null;if($.type(index)==="number"){colKey=this.grid.options.columns[index].key;if(this.grid.options.columns[index].hidden){isHidden=true}}else{colKey=index;if(header===null||header===undefined){header=$("#"+this.grid.element[0].id+"_"+colKey)}index=header.data("columnIndex");if(index===undefined){isHidden=true}}this._curColKey=colKey;expr=this.grid.dataSource.settings.sorting.expressions;s=this._findColumnSetting(colKey);if(this.grid.options.virtualizationMode==="fixed"&&(this.grid.options.virtualization===true||this.grid.options.columnVirtualization===true)){visualIndex=index-this.grid._startColIndex}else{visualIndex=index}if(apiCall&&this._currentActiveHeader){this._currentActiveHeader.removeClass(this.css.sortableColumnHeaderActive)}if(header===null||header===undefined){visualIndex+=this.grid.headersTable().children("thead").children("tr").children("th[data-skip=true]").length;if(colKey){header=$("#"+this.grid.element[0].id+"_"+colKey)}else{header=this.grid.headersTable().children("thead").children("tr").children("th:nth-child("+(visualIndex+1)+")")}apiCall=true}if(s&&s.allowSorting===false){return}if(direction!==null&&direction!==undefined){newDir=direction}else{if(s.currentSortDirection!==undefined&&s.currentSortDirection!==null&&!s.currentSortDirection.startsWith("asc")&&!s.currentSortDirection.startsWith("desc")||s.currentSortDirection===undefined||s.currentSortDirection===null){newDir=s.firstSortDirection===undefined?this.options.firstSortDirection:s.firstSortDirection}else{newDir=s.currentSortDirection!==undefined&&s.currentSortDirection!==null&&s.currentSortDirection.indexOf("asc")!==-1?"descending":"ascending"}}this._trigger("internalcolumnsorting",null,{owner:this});for(i=0;this.grid.options.features&&i<this.grid.options.features.length;i++){if(this.grid.options.features[i]&&this.grid.options.features[i].name==="GroupBy"){groupby=this.grid.element.data("igGridGroupBy");if(groupby&&groupby.options.groupedColumns&&groupby.options.groupedColumns.length>0){reset=false}}}cs=this._findColumnSetting(colKey);if(cs&&$.type(cs.compareFunc)==="function"){compareFunc=cs.compareFunc}else if(cs&&typeof cs.compareFunc==="string"){if(window[cs.compareFunc]&&typeof window[cs.compareFunc]==="function"){compareFunc=cs.compareFunc}}curNewExpr={fieldName:colKey,isSorting:true,dir:newDir.startsWith("asc")?"asc":"desc",compareFunc:compareFunc};if(this.options.mode==="single"){if(reset){sortingNewExprs=[{fieldName:colKey,isSorting:true,dir:newDir.startsWith("asc")?"asc":"desc",compareFunc:compareFunc}]}else{sortingNewExprs=[];se=this.grid.dataSource.settings.sorting.expressions;addSE=true;for(i=0;i<se.length;i++){if(se[i].isGroupBy===true){if(se[i].fieldName===colKey){addSE=false}sortingNewExprs.push(se[i])}}if(addSE){sortingNewExprs.push({fieldName:colKey,isSorting:true,dir:newDir.startsWith("asc")?"asc":"desc",compareFunc:compareFunc})}}}else{sortingNewExprs=expr.slice();for(i=0;i<expr.length;i++){if(sortingNewExprs[i].fieldName===colKey){sortingNewExprs.splice(i,1);break}}sortingNewExprs=sortingNewExprs.concat([{fieldName:colKey,isSorting:true,dir:newDir.startsWith("asc")?"asc":"desc",compareFunc:compareFunc}])}if(!apiCall){noCancel=this._trigger(this.events.columnSorting,null,{columnKey:colKey,direction:newDir,owner:this,newExpressions:sortingNewExprs})}if(noCancel){s.currentSortDirection=curNewExpr.dir.startsWith("asc")?"ascending":"descending";this._loadingIndicator.show();header.attr("title",s.currentSortDirection.startsWith("asc")?this.options.sortedColumnTooltip.replace("${direction}",$.ig.GridSorting.locale.ascending):this.options.sortedColumnTooltip.replace("${direction}",$.ig.GridSorting.locale.descending));if(this.options.mode==="single"){if(isHidden){this._clearSortStates(header,-1)}for(i=0;i<this.grid.options.columns.length;i++){if(this.options.columnSettings[i]&&this.options.columnSettings[i].allowSorting!==false&&this.options.columnSettings[i].columnKey!==colKey){delete this.options.columnSettings[i].currentSortDirection;this._clearSortStateByColKey(this.options.columnSettings[i].columnKey)}}if(isHidden){s.currentSortDirection=direction||s.currentSortDirection}}this.grid.dataSource.settings.sorting.expressions=sortingNewExprs;noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(this.grid._hasUnboundColumns&&this.options.type==="remote"){this.grid._rebindUnboundColumns=true}if(noCancel){this._saveSortingExpressions();this.grid.element.trigger("iggriduisoftdirty",{owner:this});this._currentHeader=header;this._curColKey=colKey;if(this.options.type==="remote"){if(!apiCall){this._shouldFireColumnSorted=true}this.grid.dataSource.dataBind()}else{this.grid.dataSource.sort(this.grid.dataSource.settings.sorting.expressions,s.currentSortDirection);this.grid._renderData();if(!apiCall){this._trigger(this.events.columnSorted,null,{columnKey:colKey,direction:s.currentSortDirection,owner:this,expressions:this.grid.dataSource.settings.sorting.expressions})}}this._curSortDir=s.currentSortDirection}}},sortMultiple:function(){var self=this,exprLen,id=self.grid.element[0].id,noCancel,expr=this.grid.dataSource.settings.sorting.expressions;noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource});if(noCancel){this._currentHeader=null;this._curColKey=null;if(this._currentActiveHeader){this._currentActiveHeader.removeClass(this.css.sortableColumnHeaderActive)}exprLen=expr&&expr.length;if(!exprLen){exprLen=0}$.each(this.grid.options.columns,function(index,column){var i,cs,colKey=column.key,header=$("#"+id+"_"+colKey);for(i=0;i<exprLen;i++){if(expr[i].fieldName===colKey){if(i===exprLen-1){self._currentHeader=header;self._curColKey=colKey}break}}cs=self._findColumnSetting(colKey);if(cs){if(i===exprLen){cs.currentSortDirection=undefined;if(cs.allowSorting!==false){self._clearSortState(header,cs.columnIndex,colKey)}}else{cs.currentSortDirection=expr[i].dir;self._applySortStyles(header,colKey)}}});this.grid.element.trigger("iggriduisoftdirty",{owner:this});if(this._isResetClick===true){this._isResetClick=false}this._saveSortingExpressions();if(this.options.type==="remote"){this.grid.dataSource.dataBind()}else{this.grid.dataSource.sort(this.grid.dataSource.settings.sorting.expressions);this.grid._renderData()}}},clearSorting:function(){var i,se=[],exprs=this.grid.dataSource.settings.sorting.expressions;for(i=0;i<exprs.length;i++){se.push(exprs[i].fieldName)}for(i=0;i<se.length;i++){this.unsortColumn(se[i],undefined)}},unsortColumn:function(index,header){var colKey,expr,noCancel=true,s,i,exprLen,headerId,apiCall=header===null||header===undefined;this._activeSortedCol=null;if($.type(index)==="number"){colKey=this.grid.options.columns[index].key}else{colKey=index}headerId=this.grid.id()+"_"+colKey;expr=this.grid.dataSource.settings.sorting.expressions;s=this._findColumnSetting(colKey);if(s===null||s===undefined){return}if(s&&s.allowSorting===false){return}s.currentSortDirection=undefined;if(s.userSet_currentSortDirection){delete s.userSet_currentSortDirection}exprLen=expr.length;for(i=0;i<expr.length;i++){if(expr[i].fieldName===colKey){expr.splice(i,1);break}}if(i===exprLen){return}this._curColKey=this._curColKey===colKey?null:this._curColKey;this._currentHeader=this._currentHeader&&this._currentHeader.attr("id")===headerId?null:this._currentHeader;this._applySortStyles($("#"+headerId),index);if(!apiCall&&!(this.grid.dataSource.settings.sorting.expressions.length===0&&this.options.type==="local")){noCancel=this.grid._trigger(this.grid.events.dataBinding,null,{owner:this.grid,dataSource:this.grid.dataSource})}if(noCancel){this.grid.element.trigger("iggriduisoftdirty",{owner:this});this._saveSortingExpressions();if(this.options.type==="remote"){if(!this._loadingIndicator){this._initLoadingIndicator()}this._loadingIndicator.show();if(!apiCall){this._shouldFireColumnSorted=true}this.grid.dataSource.dataBind()}else{if(this.grid.dataSource.settings.sorting.expressions.length===0&&exprLen>0){this.grid.dataBind()}else{this.grid.dataSource.sort(this.grid.dataSource.settings.sorting.expressions);this.grid._renderData()}if(!apiCall){this._trigger(this.events.columnSorted,null,{columnKey:colKey,direction:s.currentSortDirection,owner:this,expressions:this.grid.dataSource.settings.sorting.expressions})}}this._curSortDir=s.currentSortDirection}},_excludeExpr:function(key){if(this.options.persist&&!this._couldPreserveData()){return}var expr=this.grid.dataSource.settings.sorting.expressions,i;for(i=0;i<expr.length;i++){if(expr[i].fieldName===key){$.ig.removeFromArray(expr,i)}}},_applySortStyles:function(header,columnKey,ignoreActiveSelection){var oldHeight=null,span,col,indicatorContainer,indexResolved,i,currentColumnSetting,$tbody,toolTip=this.options.sortedColumnTooltip,isMrl=!!this.grid._rlp,hasFixedColumns=this.grid.hasFixedColumns(),sortAsc=toolTip.replace("${direction}",$.ig.GridSorting.locale.ascending),sortDesc=toolTip.replace("${direction}",$.ig.GridSorting.locale.descending);if(this.grid.options.fixedHeaders){oldHeight=this.grid.headersTable().outerHeight()}span=header.find(".ui-iggrid-colindicator");if(span.length===0){span=$("<span></span>").addClass(this.css.sortIndicator)}indicatorContainer=header.find(".ui-iggrid-indicatorcontainer");if(indicatorContainer.length===0){indicatorContainer=$("<div></div>").appendTo(header).addClass("ui-iggrid-indicatorcontainer")}indicatorContainer.append(span);indexResolved=this.grid.getVisibleIndexByKey(columnKey,true)+1;if(columnKey!==null&&columnKey!==undefined){for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===columnKey){currentColumnSetting=this.options.columnSettings[i];break}}}if(hasFixedColumns&&this.grid._isFixedElement(header)){$tbody=$("#"+this.element[0].id+"_fixed").find("tbody")}else{if(this.grid.options.fixedHeaders!==true){$tbody=header.closest("thead").parent().find(">tbody")}else if(this.options.applySortedColumnCss!==false){$tbody=this.grid.element.find(">tbody")}}if($tbody){col=isMrl?$tbody.find('>tr:not([data-grouprow])>td[aria-describedby="'+this.grid.id()+"_"+columnKey+'"]'):$tbody.find(">tr:not([data-grouprow])>td:nth-child("+indexResolved+")")}this._activeSortedCol=null;if(!!currentColumnSetting&&!!currentColumnSetting.currentSortDirection){if(currentColumnSetting.currentSortDirection.indexOf("asc")!==-1){span.removeClass(this.css.sortIndicatorDescending).addClass(this.css.sortIndicatorAscending);header.removeClass(this.css.descendingColumnHeader).addClass(this.css.ascendingColumnHeader);header.attr("title",sortAsc);header.attr("aria-sort","ascending");header.siblings("th").removeAttr("aria-sort");if(this.options.applySortedColumnCss!==false&&ignoreActiveSelection!==true){this._activeSortedCol={key:currentColumnSetting.columnKey,asc:true};col.removeClass(this.css.descendingColumn).addClass(this.css.ascendingColumn)}}else{span.removeClass(this.css.sortIndicatorAscending).addClass(this.css.sortIndicatorDescending);header.removeClass(this.css.ascendingColumnHeader).addClass(this.css.descendingColumnHeader);header.attr("title",sortDesc);header.attr("aria-sort","descending");header.siblings("th").removeAttr("aria-sort");if(this.options.applySortedColumnCss!==false&&ignoreActiveSelection!==true){this._activeSortedCol={key:currentColumnSetting.columnKey,asc:false};col.removeClass(this.css.ascendingColumn).addClass(this.css.descendingColumn)}}}else{header.attr("title",this.options.unsortedColumnTooltip);header.removeAttr("aria-sort");if(this.grid._isMultiColumnGrid===true||isMrl){span=header.find(".ui-iggrid-colindicator")}else{span=header.parent("tr").find("th:nth-child("+indexResolved+") .ui-iggrid-colindicator")}span.removeClass(this.css.sortIndicatorAscending).removeClass(this.css.sortIndicatorDescending).removeClass(this.css.descendingColumnHeader);header.removeClass(this.css.ascendingColumnHeader).removeClass(this.css.descendingColumnHeader)}if(oldHeight!==null&&oldHeight!==this.grid.headersTable().outerHeight()){this.grid._initializeHeights()}},_clearSortStates:function(header,index){var i,cs=this.options.columnSettings,realIndex=index,isSingleMode=this.options.mode==="single";for(i=0;i<this.grid.options.columns.length;i++){if(i<index&&this.grid.options.columns[i].hidden){realIndex--}}index=realIndex;for(i=0;i<this.options.columnSettings.length;i++){if(cs[i].allowSorting!==false){if(index!==undefined&&cs[i].columnIndex!==index){delete cs[i].currentSortDirection;this._clearSortState(header,cs[i].columnIndex,cs[i].columnKey)}if(this.grid._detachedHeaderCells&&isSingleMode&&cs[i].columnKey&&this.grid._detachedHeaderCells[cs[i].columnKey]){if(cs[i].currentSortDirection!==undefined&&cs[i].currentSortDirection!==null){delete cs[i].currentSortDirection}this._clearHeaderCellSortState(this.grid._detachedHeaderCells[cs[i].columnKey][0])}}}},_clearSortState:function(header,i,columnKey){if(columnKey!==undefined&&(this.grid.hasFixedColumns()||this.grid._rlp)){this._clearSortStateByColKey(columnKey);return}var th,ths,fixedColumnsLength,$thead;if(this.grid._isMultiColumnGrid===true){ths=this.grid._headerCells;th=ths[i];if(th===undefined){return}}else{if(this.grid.hasFixedColumns()){fixedColumnsLength=this.grid._fixedColumns.length;if(i<fixedColumnsLength){$thead=this.grid.fixedHeadersTable().find("thead")}else{$thead=this.grid.headersTable().find("thead");i-=fixedColumnsLength}}else{$thead=this.grid.headersTable().find("thead")}ths=$thead.find(">tr").first().find(">th").not("[data-skip=true]");th=ths.eq(i)}this._clearSortStateByVisibleIndex(i,th)},_clearSortStateByColKey:function(key){if(key===undefined||key===null){return}var hk=this.grid.id()+"_"+key,$cells,csInd,i,$tbl;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){csInd=i;break}}if(this.options.applySortedColumnCss!==false){$tbl=this.grid.isFixedColumn(key)?$("#"+this.grid.id()+"_fixed"):this.grid.element;$cells=$tbl.find('>tbody>tr>td[aria-describedby="'+hk+'"]')}this._clearSotrStateForCells($("#"+hk),$cells,csInd)},_clearSortStateByVisibleIndex:function(i,th){var col,$tbl;if(this.options.applySortedColumnCss!==false){$tbl=this.grid._isFixedElement(th)?$("#"+this.element[0].id+"_fixed"):this.grid.element;col=this.grid.options.fixedHeaders!==true?th.closest("table").find(">tbody>tr>td:nth-child("+(i+1)+")"):$tbl.find("tbody>tr>td:nth-child("+(i+1)+")")}this._clearSotrStateForCells(th,col,i)},_clearSotrStateForCells:function($th,$cells,csIndex){this._clearHeaderCellSortState($th);if(csIndex!==undefined&&this.options.columnSettings.length>csIndex&&this.options.columnSettings[csIndex].allowSorting){$th.attr("title",this.options.unsortedColumnTooltip)}else{$th.attr("title","")}if($cells){$cells.removeClass(this.css.descendingColumn).removeClass(this.css.ascendingColumn)}},_clearHeaderCellSortState:function(spanHeader){var span=spanHeader.find(".ui-iggrid-colindicator");if(span.hasClass("ui-iggrid-colindicator-desc")||span.hasClass("ui-iggrid-colindicator-asc")){span.removeClass(this.css.sortIndicatorDescending).removeClass(this.css.sortIndicatorAscending);spanHeader.removeClass(this.css.ascendingColumnHeader).removeClass(this.css.descendingColumnHeader).removeClass(this.css.sortableColumnHeaderFocus)}},_initDefaultSettings:function(suppressUsrOpts){var settings=[],key,cs=this.options.columnSettings,i,j,k,colIndex=0,defaultExpressions=[],defExpLength,isToSkipGroupBySortingExpr=false,dir,allowSorting,isToCheckUnboundColumns=this.grid._hasUnboundColumns===true&&this.options.type==="remote";if(this.grid.dataSource.settings.sorting.expressions!==null&&this.grid.dataSource.settings.sorting.expressions!==undefined){defaultExpressions=this.grid.dataSource.settings.sorting.expressions}defExpLength=defaultExpressions.length;if(this.grid.options.columns&&this.grid.options.columns.length>0){for(i=0;i<this.grid.options.columns.length;i++){allowSorting=true;if(isToCheckUnboundColumns&&this.grid.getUnboundColumnByKey(this.grid.options.columns[i].key)!==null){allowSorting=false}settings[i]={columnIndex:colIndex,columnKey:this.grid.options.columns[i].key,allowSorting:allowSorting};if(this.grid.options.columns[i].hidden!==true){colIndex++}}}for(i=0;i<cs.length;i++){for(key in cs[i]){if(cs[i].hasOwnProperty(key)&&key!=="columnKey"&&key!=="columnIndex"){if(key==="userSet_currentSortDirection"){if(cs[i].userSet_currentSortDirection==="undefined"||cs[i].userSet_currentSortDirection===undefined){delete cs[i].currentSortDirection}else{cs[i].currentSortDirection=cs[i].userSet_currentSortDirection}}else if(key==="userSet_allowSorting"){cs[i].allowSorting=cs[i][key];delete cs[i][key]}}}}if(settings.length===0&&this.grid.options.autoGenerateColumns&&cs.length>0){for(i=0;i<cs.length;i++){if(!cs[i].columnKey||typeof cs[i].currentSortDirection!=="string"){continue}dir=cs[i].currentSortDirection.startsWith("asc")?"asc":"desc";defaultExpressions.push({fieldName:cs[i].columnKey,isSorting:true,dir:dir})}}else{for(i=0;i<cs.length;i++){for(j=0;j<settings.length;j++){if(settings[j].columnKey!==null&&settings[j].columnKey!==undefined&&cs[i].columnKey!==null&&cs[i].columnKey!==undefined){if(settings[j].columnKey===cs[i].columnKey){break}}else if(settings[j].columnIndex===cs[i].columnIndex){break}}if(j===settings.length){continue}for(key in cs[i]){if(cs[i].hasOwnProperty(key)&&key!=="columnKey"&&key!=="columnIndex"&&!key.startsWith("userSet")){settings[j][key]=cs[i][key];if(!suppressUsrOpts){settings[j]["userSet_"+key]=cs[i][key]}if(key==="currentSortDirection"&&cs[i][key]){if($.type(settings[j].columnKey)!=="number"){isToSkipGroupBySortingExpr=false;if(defExpLength>0){for(k=0;k<defExpLength;k++){if(defaultExpressions[k].fieldName===settings[j].columnKey){if(defaultExpressions[k].isGroupBy===true){isToSkipGroupBySortingExpr=true}else{defaultExpressions.splice(k,1)}break}}}if(isToSkipGroupBySortingExpr===true){continue}defaultExpressions.push({fieldName:settings[j].columnKey,isSorting:true,dir:cs[i][key].startsWith("asc")?"asc":"desc"})}else{defaultExpressions.push({fieldIndex:settings[j].columnKey,isSorting:true,dir:cs[i][key].startsWith("asc")?"asc":"desc"})}}}}}}for(i=0;i<settings.length;i++){if(!settings[i].hasOwnProperty("currentSortDirection")){settings[i].userSet_currentSortDirection="undefined"}for(j=0;j<this.grid.dataSource.settings.sorting.expressions.length;j++){if(this.grid.dataSource.settings.sorting.expressions[j].fieldName===settings[i].columnKey){settings[i].currentSortDirection=this.grid.dataSource.settings.sorting.expressions[j].dir}}}this.options.columnSettings=settings;this.grid.dataSource.settings.sorting.expressions=defaultExpressions;this.grid.dataSource.settings.sorting.defaultFields=defaultExpressions},_headerCellRendered:function(event,ui){var cs=this._findColumnSetting(ui.columnKey),i,col,initialSorting,featureChooserInstance=this.grid.element.data("igGridFeatureChooser");if(event.target.id!==this.grid.element[0].id){return}if(ui.isMultiColumnHeader===true){return}if(ui.columnKey&&cs){this._headers.push({header:ui.th,index:cs.columnIndex});if(cs.allowSorting!==false){ui.th.addClass(this.css.sortableColumnHeader);if(cs.currentSortDirection===undefined||cs.currentSortDirection===null){ui.th.attr("title",this.options.unsortedColumnTooltip)}else{ui.th.attr("title",cs.currentSortDirection.startsWith("asc")?this.options.sortedColumnTooltip.replace("${direction}",$.ig.GridSorting.locale.ascending):this.options.sortedColumnTooltip.replace("${direction}",$.ig.GridSorting.locale.descending))}$("<span></span>").appendTo(ui.th).addClass(this.css.sortIndicator);if(cs.currentSortDirection!==undefined){this._applySortStyles(ui.th,cs.columnKey)}}}if(!this._featureChooserInitialized&&featureChooserInstance&&this.renderInFeatureChooser){this._featureChooserInitialized=true;if(this._featureChooserMenuTogglingHandler){this.grid.element.unbind("iggridfeaturechoosermenutoggling",this._featureChooserMenuTogglingHandler)}this._featureChooserMenuTogglingHandler=$.proxy(this._featureChooserMenuToggling,this);this.grid.element.bind("iggridfeaturechoosermenutoggling",this._featureChooserMenuTogglingHandler);if(featureChooserInstance._isTouchDevice()){for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i];
cs=this._getColumnSettingsByIndex(i);if(cs.allowSorting){if(featureChooserInstance&&featureChooserInstance._shouldRenderInFeatureChooser(col.key)===true){initialSorting=cs.currentSortDirection;if(initialSorting===null){initialSorting=false}featureChooserInstance._renderInFeatureChooser(col.key,{name:"SortingAscending",text:this.options.featureChooserSortAsc,textHide:this.options.featureChooserSortAsc,iconClass:this.css.fcSortIndicatorAscending,iconClassOff:this.css.fcSortIndicatorAscending,isSelected:initialSorting&&typeof initialSorting==="string"?initialSorting.toLowerCase().indexOf("asc")>-1:false,method:$.proxy(this._sortAscFromFeatureChooser,this),updateOnClickAll:false,groupName:"toggle",groupOrder:1,order:0,type:"toggle"});featureChooserInstance._renderInFeatureChooser(col.key,{name:"SortingDescending",text:this.options.featureChooserSortDesc,textHide:this.options.featureChooserSortDesc,iconClass:this.css.fcSortIndicatorDescending,iconClassOff:this.css.fcSortIndicatorDescending,isSelected:initialSorting&&typeof initialSorting==="string"?initialSorting.toLowerCase().indexOf("desc")>-1:false,method:$.proxy(this._sortDescFromFeatureChooser,this),updateOnClickAll:false,groupName:"toggle",groupOrder:1,order:0,type:"toggle"})}}}}if(this.options.mode!=="single"){for(i=0;i<this.grid.options.columns.length;i++){col=this.grid.options.columns[i];if(this._getColumnSettingsByIndex(i).allowSorting){if(featureChooserInstance._shouldRenderInFeatureChooser(col.key)===true){featureChooserInstance._renderInFeatureChooser(col.key,{name:"MultipleSorting",text:this.options.featureChooserText,iconClass:this.css.featureChooserModalDialogIcon,method:$.proxy(this.openMultipleSortingDialog,this),groupName:"modaldialog",groupOrder:3,order:2})}}}}}},_featureChooserMenuToggling:function(event,args){var i,expr,isAsc,hasSorting=false,columnKey=args.columnKey,featureChooserInstance=this.grid.element.data("igGridFeatureChooser"),exprs=this.grid.dataSource.settings.sorting.expressions,exprsLength=exprs.length;if(!args.isVisible){for(i=0;i<exprsLength;i++){expr=exprs[i];if(expr.fieldName===columnKey){hasSorting=true;isAsc=false;if(expr.dir&&expr.dir.toLowerCase().indexOf("asc")>-1){isAsc=true}featureChooserInstance._setSelectedState("SortingDescending",columnKey,!isAsc,false);featureChooserInstance._setSelectedState("SortingAscending",columnKey,isAsc,false)}}if(!hasSorting){featureChooserInstance._setSelectedState("SortingDescending",columnKey,false,false);featureChooserInstance._setSelectedState("SortingAscending",columnKey,false,false)}}},_sortAscFromFeatureChooser:function(event,columnKey,isSelected){var featureChooserInstance=this.grid.element.data("igGridFeatureChooser"),gridId=this.grid.id(),$th=$("#"+gridId+"_"+columnKey);if(!featureChooserInstance){return}featureChooserInstance._setSelectedState("SortingDescending",columnKey,false,false);if(isSelected){this.sortColumn(columnKey,"asc",$th)}else{this.unsortColumn(columnKey,$th)}},_sortDescFromFeatureChooser:function(event,columnKey,isSelected){var featureChooserInstance=this.grid.element.data("igGridFeatureChooser"),gridId=this.grid.id(),$th=$("#"+gridId+"_"+columnKey);featureChooserInstance._setSelectedState("SortingAscending",columnKey,false,false);if(!featureChooserInstance){return}if(isSelected){this.sortColumn(columnKey,"desc",$th)}else{this.unsortColumn(columnKey,$th)}},_fixedColumnsChanged:function(args){var i,grid=this.grid,stngs=this.options.columnSettings,start=args.start,len=args.length,at=args.at,fixedTable=grid.fixedHeadersTable(),isAttachedSortingHandlers=fixedTable.data("attachedSortingHandlers");if(isAttachedSortingHandlers!==true){fixedTable.data("attachedSortingHandlers",true);fixedTable.delegate("thead th",{click:this._clickHandler,mouseover:this._mouseOverHandler,mouseout:this._mouseOutHandler})}grid._rearrangeArray(stngs,start,len,at);for(i=0;i<stngs.length;i++){stngs[i].columnIndex=i}},_columnsRearranged:function(){this._initDefaultSettings(true)},_columnMap:function(){var self=this,isMultiple=self.options.mode!=="single";return $.map(this.grid.options.columns,function(col,index){var allowSorting=false;if(isMultiple&&self._getColumnSettingsByIndex(index).allowSorting){allowSorting=true}return{columnKey:col.key,enabled:allowSorting}})},_findColumnSetting:function(key){var i;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){return this.options.columnSettings[i]}}},_dataRendered:function(){var i,cs,expr,col,colKey,gridId=this.grid.element[0].id,ignoreActiveSelection;if(!this._loadingIndicator){this._initLoadingIndicator()}expr=this._sortingExpressions;if(this._shouldFireColumnSorted){this._trigger(this.events.columnSorted,null,{columnKey:this._curColKey,direction:this._curSortDir,owner:this,expressions:this.grid.dataSource.settings.sorting.expressions});this._shouldFireColumnSorted=false}this._loadingIndicator.hide();if(this._curColKey!==undefined&&this._curColKey!==null&&this._currentHeader){this._applySortStyles(this._currentHeader,this._curColKey)}else if(this.options.persist&&this._restoreSorting&&expr&&expr.length>0){for(i=0;i<expr.length;i++){if(expr[i].isGroupBy){continue}colKey=expr[i].fieldName;cs=this._findColumnSetting(colKey);if(cs){cs.currentSortDirection=expr[i].dir}ignoreActiveSelection=true;col=$("#"+gridId+"_"+colKey);if(i===expr.length-1){col.addClass(this.css.sortableColumnHeaderActive);this._currentActiveHeader=col;ignoreActiveSelection=false;this._curColKey=colKey}this._applySortStyles(col,colKey,ignoreActiveSelection)}this._restoreSorting=false}if(this._hc===undefined){this._hc=this.grid.container().find(".ui-iggrid-expandheadercell").length>0}if((this.grid.options.rowVirtualization||this.grid.options.virtualization)&&!this.grid._persistVirtualScrollTop){$("#"+this.grid.element.attr("id")+"_scrollContainer").scrollTop(0)}},_onUIDirty:function(e,args){if(this.options.persist&&this.options.type==="remote"){return}var i,j,exprs=this.grid.dataSource.settings.sorting.expressions,defaultExprs=this.grid.dataSource.settings.sorting.defaultFields,cs=this.options.columnSettings,skip=false;if(args.owner===this||args.owner.element[0].id!==this.element[0].id){return}this._curColKey=null;this._currentHeader=null;this._clearUi(true);for(i=0;i<exprs.length;i++){skip=false;for(j=0;j<cs.length;j++){if(cs[j].columnKey===exprs[i].fieldName&&cs[j].userSet_currentSortDirection){skip=true;break}}if(!skip){if(exprs.length>i){$.ig.removeFromArray(exprs,i)}if(defaultExprs.length>i){$.ig.removeFromArray(defaultExprs,i)}}}},_clearUi:function(){var i,header,csd,isMCH=this.grid._isMultiColumnGrid,persist=this.options.persist;for(i=0;this._headers&&i<this._headers.length;i++){csd=this.options.columnSettings[i].userSet_currentSortDirection;if((isMCH||persist)&&this.options.columnSettings[i].columnKey){header=$("#"+this.grid.element[0].id+"_"+this.options.columnSettings[i].columnKey)}else{header=this._headers[i].header}if(csd===undefined||csd===null||csd==="undefined"){this._clearSortState(header,i,this.options.columnSettings[i].columnKey);if(this.options.mode!=="single"){delete this.options.columnSettings[i].currentSortDirection;this._excludeExpr(this.options.columnSettings[i].columnKey)}}else{this._applySortStyles(header,this.options.columnSettings[i].columnKey)}header.removeClass(this.css.sortableColumnHeaderActive).removeClass(this.css.sortableColumnHeaderHover).addClass(this.grid.css.headerClass);if(this.options.columnSettings[i].allowSorting){header.addClass(this.css.sortableColumnHeader)}}},_virtualHorizontalScroll:function(event,args){var start=args.startColIndex,end=args.endColIndex,i,j,cs=this.options.columnSettings,header,ths=this.grid.headersTable().find("thead > tr").first().find("th").not("[data-skip=true]"),visibleColumns=this.grid._visibleColumns();for(i=0;i<ths.length;i++){header=ths.eq(i);this._clearSortState(header,i);header.removeClass(this.css.sortableColumnHeaderActive).removeClass(this.css.sortableColumnHeaderHover).addClass(this.grid.css.headerClass).addClass(this.css.sortableColumnHeader)}for(i=start;i<=end;i++){header=ths.eq(i-start);header.data("columnIndex",i);for(j=0;j<cs.length;j++){if(cs[j].currentSortDirection&&cs[j].columnKey===visibleColumns[i].key){this._applySortStyles(header,cs[j].columnKey)}}}},_columnsCollectionModified:function(event,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}var i,j,found,colKey,cs,col;for(i=0;i<this.options.columnSettings.length;i++){j=0;found=false;for(j=0;j<this.grid._visibleColumns().length;j++){if(this.grid._visibleColumns()[j].key===this.options.columnSettings[i].columnKey){found=true;colKey=this.grid._visibleColumns()[j].key;break}}if(found){this.options.columnSettings[i].columnIndex=j;cs=this._findColumnSetting(colKey);if(cs&&cs.currentSortDirection!==undefined&&this.options.applySortedColumnCss!==false){col=$("#"+this.grid.element[0].id+"_"+colKey);this._applySortStyles(col,colKey,true)}}}if(this._curColKey){col=$("#"+this.grid.element[0].id+"_"+this._curColKey);this._applySortStyles(col,this._curColKey)}$("#"+this.element[0].id+" thead th").removeClass(this.css.sortableColumnHeaderHover)},_detachEvents:function(){if(this._headerCellRenderedHandler){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler)}if(this._virtualHorizontalScrollHandler){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}if(this._uiDirtyHandler){this.grid.element.unbind("iggriduidirty",this._uiDirtyHandler)}if(this._headerRenderedHandler){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}if(this._columnsCollectionModifiedHandler){this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler)}if(this._columnsRearangedHandler){this.grid.element.unbind("iggrid_columnsmoved",this._columnsRearangedHandler)}if(this._featureChooserMenuTogglingHandler){this.grid.element.unbind("iggridfeaturechoosermenutoggling",this._featureChooserMenuTogglingHandler)}},destroy:function(){var i,a,fc,header,span,text,modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");if(!this.grid){return}$("#"+this.element[0].id+" thead th").unbind("dragstart",this._dragStartHandler);$("#"+this.element[0].id+"_headers thead th").unbind("dragstart",this._dragStartHandler);$(document).undelegate("#"+this.element[0].id+"_headers thead th",{click:this._clickHandler,mouseover:this._mouseOverHandler,mouseout:this._mouseOutHandler});$("#"+this.element[0].id).undelegate("thead th",{click:this._clickHandler,mouseover:this._mouseOverHandler,mouseout:this._mouseOutHandler});$("#"+this.element[0].id).undelegate("thead th",{keydown:this._keyDownHandler,focus:this._focusHandler,blur:this._blurHandler});$(document).undelegate("#"+this.element[0].id+"_headers thead th",{keydown:this._keyDownHandler,focus:this._focusHandler,blur:this._blurHandler});this._detachEvents();delete this._blurHandler;delete this._clickHandler;delete this._headerCellRenderedHandler;delete this._focusHandler;delete this._keyDownHandler;delete this._mouseOutHandler;delete this._mouseOverHandler;delete this._dragStartHandler;delete this._uiDirtyHandler;delete this._virtualHorizontalScrollHandler;delete this._headerRenderedHandler;delete this._columnsRearangedHandler;this.grid.element.find(".ui-iggrid-colasc").removeClass("ui-iggrid-colasc ui-state-highlight");this.grid.element.find(".ui-iggrid-coldesc").removeClass("ui-iggrid-coldesc ui-state-highlight");this._clearUi(true);for(i=0;this._headers&&i<this._headers.length;i++){header=this._headers[i].header;header.removeClass("ui-iggrid-sortableheader ui-state-default ui-state-active ui-state-hover ui-state-focus");header.attr("title","");span=header.find("a span");text=span.text();a=header.find("a:not([th-remove-focus])");$("<span>"+text+"</span>").appendTo(header).addClass("ui-iggrid-headertext");a.remove()}fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){fc._removeFeature("SortingAscending");fc._removeFeature("SortingDescending");fc._removeFeature("MultipleSorting")}this._headers=null;if(this._loadingIndicator){delete this._loadingIndicator}modalDialog.igGridModalDialog("getCaptionButtonContainer");modalDialog.remove();$.Widget.prototype.destroy.apply(this,arguments);return this},_renderMultipleSortingDialog:function(){var $buttonOK,containment,self=this,o=this.options,modalDialogId=this.grid.element[0].id+"_multiplesorting_modalDialog",$captionButtonContainer,modalDialog;if(this.options.sortingDialogContainment==="owner"){containment=this.grid.container()}else{containment="window"}$("#"+modalDialogId).remove();modalDialog=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",modalDialogId);modalDialog.igGridModalDialog({containment:containment,buttonApplyText:o.modalDialogButtonApplyText,buttonCancelText:o.modalDialogButtonCancelText,renderFooterButtons:!o.modalDialogSortOnClick,modalDialogCaptionText:o.modalDialogCaptionText,modalDialogWidth:o.modalDialogWidth,modalDialogHeight:o.modalDialogHeight,animationDuration:o.modalDialogAnimationDuration,gridContainer:this.grid.container(),modalDialogOpening:function(event,args){var noCancel=self._trigger(self.events.modalDialogOpening,null,{modalDialogElement:modalDialog,owner:self});if(noCancel){self._multiplesortingDialogOpening(event,args);self._trigger(self.events.modalDialogOpened,null,{modalDialogElement:modalDialog,owner:self})}return noCancel},modalDialogMoving:function(e,ui){self._trigger(self.events.modalDialogMoving,null,{modalDialogElement:e.target,owner:self,originalPosition:ui.originalPosition,position:ui.position})},modalDialogClosing:function(){return self._trigger(self.events.modalDialogClosing,null,{modalDialogElement:modalDialog,owner:self})},modalDialogClosed:function(){self._trigger(self.events.modalDialogClosed,null,{modalDialogElement:modalDialog,owner:self})}});if(o.modalDialogSortOnClick){$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$("<span></span>").bind("click.hiding",function(event){modalDialog.igGridModalDialog("closeModalDialog",true);event.preventDefault();event.stopPropagation();return false}).addClass("ui-icon ui-icon-closethick").appendTo($("<a></a>").appendTo($captionButtonContainer).attr("title",$.ig.GridHiding.locale.columnChooserCloseButtonTooltip).attr("href","#").attr("role","button").addClass("ui-dialog-titlebar-close ui-corner-all"))}else{$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$buttonOK=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog_footer_buttonok");$buttonOK.bind("igbuttonclick",function(e){self._multiplesortingDialogButtonOKClick(e);e.preventDefault()})}},openMultipleSortingDialog:function(){var modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");modalDialog.igGridModalDialog("openModalDialog")},closeMultipleSortingDialog:function(){var modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");modalDialog.igGridModalDialog("closeModalDialog")},_multiplesortingDialogOpening:function(){this._tempExpr=this.grid.dataSource.settings.sorting.expressions.slice(0);this.renderMultipleSortingDialogContent(true)},renderMultipleSortingDialogContent:function(isToCallEvents){var $content,$sortedColumns,$unsortedColumns,i,j,noCancel=true,self=this,columns=this.grid.options.columns,css=this.css,se=this.grid.dataSource.settings.sorting.expressions,seLength=se.length,sortedColumns=[],modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");if(isToCallEvents){noCancel=this._trigger(this.events.modalDialogContentsRendering,null,{modalDialogElement:modalDialog,owner:this})}if(noCancel){this.removeDialogClearButton();$content=modalDialog.igGridModalDialog("getContent");$content.empty();$sortedColumns=$("<div></div>").attr("id",this.grid.element[0].id+"_multiplesorting_modalDialog_sortedcolumns").addClass(css.dialogSortedColumns).appendTo($content);$unsortedColumns=$("<div></div>").attr("id",this.grid.element[0].id+"_multiplesorting_modalDialog_unsortedcolumns").addClass(css.dialogUnsortedColumns).appendTo($content);$("<ul></ul>").addClass(css.dialogSortedColumnsList).appendTo($sortedColumns);$("<ul></ul>").addClass(css.dialogUnsortedColumnsList).appendTo($unsortedColumns);$.each(columns,function(columnIndex,column){var cs,columnIdentifier,direction;cs=self._getColumnSettingsByIndex(columnIndex);if(cs===null||cs===undefined||cs.allowSorting===false){return true}columnIdentifier=cs.columnKey||cs.columnIndex||column.key;for(i=0;i<self._tempExpr.length;i++){if(self._tempExpr[i].fieldName===columnIdentifier){break}}if(i!==self._tempExpr.length){sortedColumns.push({column:column,columnIndex:cs.columnIndex,dir:self._tempExpr[i].dir,columnIdentifier:columnIdentifier})}else{direction=cs.currentSortDirection||cs.firstSortDirection||self.options.firstSortDirection;self._renderDialogUnsortedColumn(column,cs.columnIndex,direction,columnIdentifier)}});for(i=0;i<seLength;i++){for(j=0;j<sortedColumns.length;j++){if(se[i].fieldName===sortedColumns[j].columnIdentifier){self._renderDialogSortedColumn(sortedColumns[j].column,sortedColumns[j].columnIndex,sortedColumns[j].dir,sortedColumns[j].columnIdentifier);break}}}if(isToCallEvents){this._trigger(this.events.modalDialogContentsRendered,null,{modalDialogElement:modalDialog,owner:this})}if(this._checkRenderButtonReset()){this._renderDialogButtonClearAll()}}},_addSlideButtonSortingColumns:function(){var css=this.css,o=this.options,$sortedColumns=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog_sortedcolumns"),buttonId=this.grid.element[0].id+"_multiplesorting_modalDialog_slidebutton",$button,innerHTML;innerHTML='<div class="'+css.dialogSlideArea+'">'+'	<div class="'+css.dialogSlideAreaContainer+'">'+'		<button id="'+buttonId+'" class="'+css.dialogButtonSlide+'" role="button" aria-disabled="false" title="'+o.dialogButtonSlideCaption+'">'+'			<span class="'+css.dialogButtonSlideContainer+'"></span>'+'			<span class="ui-button-text">'+o.dialogButtonSlideCaption+"</span>"+"		</button>"+"	</div>"+"</div>";$(innerHTML).insertAfter($sortedColumns);$button=$("#"+buttonId);$button.bind({click:function(){$sortedColumns.slideToggle("slow");$(this).find("span:eq(0)").toggleClass(css.dialogButtonSlideUp);return false}})},_renderDialogSortedColumn:function(column,columnIndex,direction,columnIdentifier){var self=this,$li,css=this.css,$buttonUnsort,liHTML,o=this.options,buttonAscDescId=this.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_modalDialog_sortedcolumns_buttonascdesc",buttonUnsortId=this.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_modalDialog_sortedcolumns_buttonunsort",$ul=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog_sortedcolumns ul");$ul.css("width");$li=$('<li  tabIndex="0"></li>').attr("id",self.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_sorted_li").addClass(css.dialogSortedColumnsItem);$li.appendTo($ul);if(columnIndex!==null&&columnIndex!==undefined){$li.attr("li-order",columnIndex)}liHTML='<span id="'+buttonAscDescId+'" class="'+css.dialogButtonAsc+'" role="button" title="'+o.modalDialogCaptionButtonDesc+'" >'+'	<span class="'+css.dialogButtonAscIcon+'"></span>'+"</span>"+'<span class="'+css.dialogSortedColumnTextContainer+'">'+column.headerText+"</span>"+'<button id="'+buttonUnsortId+'" class="'+css.dialogButtonUnsort+'" role="button" title="'+o.modalDialogCaptionButtonUnsort+'" >'+'	<span class="'+css.dialogButtonUnsortContainer+'"></span>'+'	<span class="ui-button-text">'+o.modalDialogCaptionButtonUnsort+"</span>"+"</button>";$li.bind({click:function(e){self._curColKey=columnIdentifier;self._dialogButtonAscDescClick(columnIdentifier);if(self._checkRenderButtonReset()){self._renderDialogButtonClearAll()}else{self.removeDialogClearButton()}e.preventDefault();e.stopPropagation()}});$li.html(liHTML);$buttonUnsort=$("#"+buttonUnsortId);if(direction!==undefined){if(direction.indexOf("asc")!==-1){self._setDialogButtonAscDesc(true,columnIdentifier);self._setTempExpr(columnIdentifier,"asc")}else{self._setDialogButtonAscDesc(false,columnIdentifier);self._setTempExpr(columnIdentifier,"desc")}}else{self._setDialogButtonAscDesc(true,columnIdentifier);self._setTempExpr(columnIdentifier,"asc")}$buttonUnsort.bind({keydown:function(e){if(e.keyCode===$.ui.keyCode.ENTER||e.keyCode===$.ui.keyCode.SPACE){e.target.click();e.preventDefault();e.stopPropagation()}},click:function(e){var noCancel,gridId=self.grid.element[0].id,$nextLi,modalDialog=$("#"+gridId+"_multiplesorting_modalDialog");noCancel=self._trigger(self.events.modalDialogButtonUnsortClick,e,{modalDialogElement:modalDialog,owner:self,columnKey:columnIdentifier});if(noCancel){$li.remove();if(o.modalDialogSortOnClick===true){self.unsortColumn(columnIdentifier,$("#"+gridId+"_"+columnIdentifier))}else{self._setTempExpr(columnIdentifier)}$nextLi=self._renderDialogUnsortedColumn(column,columnIndex,direction,columnIdentifier);$nextLi.find(":focusable").first().focus(1);if(self._checkRenderButtonReset()){self._renderDialogButtonClearAll()}else{self.removeDialogClearButton()}}e.preventDefault();e.stopPropagation()},mouseover:function(){if(!$(this).hasClass(css.dialogButtonsHover)){$(this).addClass(css.dialogButtonsHover)}},mouseout:function(){if($(this).hasClass(css.dialogButtonsHover)){$(this).removeClass(css.dialogButtonsHover)}}});return $li},_dialogButtonAscDescClick:function(columnIdentifier){var o=this.options,noCancel,modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog"),$buttonAscDesc=$("#"+this.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_modalDialog_sortedcolumns_buttonascdesc"),isAsc=$buttonAscDesc.data("isAsc");noCancel=this._trigger(this.events.modalDialogSortingChanged,null,{modalDialogElement:modalDialog,owner:this,columnKey:columnIdentifier,isAsc:!isAsc});if(noCancel){if(isAsc===true){if(o.modalDialogSortOnClick===true){this.sortColumn(columnIdentifier,"descending",this._getHeaderCellByIdentifier(columnIdentifier))}else{this._setTempExpr(columnIdentifier,"desc")}this._setDialogButtonAscDesc(false,columnIdentifier)}else{if(o.modalDialogSortOnClick===true){this.sortColumn(columnIdentifier,"ascending",this._getHeaderCellByIdentifier(columnIdentifier))}else{this._setTempExpr(columnIdentifier,"asc")}this._setDialogButtonAscDesc(true,columnIdentifier)}}},_setDialogButtonAscDesc:function(isAsc,columnIdentifier){var css=this.css,buttonAscDescId=this.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_modalDialog_sortedcolumns_buttonascdesc",$buttonAscDesc=$("#"+buttonAscDescId),$spanIcon=$buttonAscDesc.find("span:eq(0)");$buttonAscDesc.data("isAsc",isAsc);if(isAsc===true){$buttonAscDesc.attr("title",this.options.modalDialogCaptionButtonDesc).removeClass(css.dialogButtonDesc).addClass(css.dialogButtonAsc);$spanIcon.removeClass(css.dialogButtonDescIcon).addClass(css.dialogButtonAscIcon);this._setTempExpr(columnIdentifier,"asc")}else{$buttonAscDesc.attr("title",this.options.modalDialogCaptionButtonAsc).removeClass(css.dialogButtonAsc).addClass(css.dialogButtonDesc);$spanIcon.removeClass(css.dialogButtonAscIcon).addClass(css.dialogButtonDescIcon);this._setTempExpr(columnIdentifier,"desc")}},_setTempExpr:function(colKey,dir){var i,expr=this._tempExpr;for(i=0;i<expr.length;i++){if(expr[i].fieldName===colKey){expr.splice(i,1);if(dir===null||dir===undefined){this._tempExpr=expr;return}}}this._tempExpr=expr.concat([{fieldName:colKey,isSorting:true,dir:dir}])},_renderDialogUnsortedColumn:function(column,columnIndex,direction,columnIdentifier){var self=this,$li,$a,o=this.options,css=this.css,$ul=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog_unsortedcolumns ul");$ul.css("width");$li=$("<li></li>").attr("id",self.grid.element[0].id+"_"+columnIdentifier+"_multiplesorting_unsorted_li").addClass(css.dialogUnsortedColumnsItem).append('<span class="'+css.dialogUnsortedColumnsSortByButton+'"><a href="#"></a></span> <span class="'+css.dialogItemText+'">'+column.headerText+"</span>");this._insertColumnModalDialog($ul,$li,columnIndex);if(columnIndex!==null&&columnIndex!==undefined){$li.attr("li-order",columnIndex)}$a=$li.find("a:first");$a.addClass(css.modalDialogSortByColumn);$a.html(o.modalDialogSortByButtonText);$li.bind({keydown:function(e){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){$li.click();e.preventDefault();e.stopPropagation()}},click:function(e){var noCancel,modalDialog=$("#"+self.grid.element[0].id+"_multiplesorting_modalDialog"),$nextLi;noCancel=self._trigger(self.events.modalDialogSortClick,e,{modalDialogElement:modalDialog,owner:self,columnKey:columnIdentifier});if(noCancel){$li.remove();$nextLi=self._renderDialogSortedColumn(column,columnIndex,direction,columnIdentifier);$nextLi.find(":focusable").first().focus(1);if(o.modalDialogSortOnClick){self.sortColumn(columnIdentifier,null,self._getHeaderCellByIdentifier(columnIdentifier))}else{if(self._checkRenderButtonReset()){self._renderDialogButtonClearAll()}else{self.removeDialogClearButton()}}}e.preventDefault();e.stopPropagation()}});return $li},_checkRenderButtonReset:function(){var i,j,cs,columnKey,expr=this._tempExpr;this._isResetClick=false;for(i=0;i<this.options.columnSettings.length;i++){cs=this.options.columnSettings[i];if(cs.allowSorting===false){continue}columnKey=cs.columnKey;for(j=0;j<expr.length;j++){if(expr[j].fieldName===columnKey){if(cs.userSet_currentSortDirection!==expr[j].dir){return true}break}}if(j===expr.length&&cs.userSet_currentSortDirection!=="undefined"&&cs.userSet_currentSortDirection!==undefined){return true}}this._isResetClick=true;return false},removeDialogClearButton:function(){$("#"+this.grid.element[0].id+"_sorting_modalDialog_reset_button").remove()},_renderDialogButtonClearAll:function(){if(this.options.modalDialogSortOnClick===true){return}var self=this,o=this.options,resetButtonId=self.grid.element[0].id+"_sorting_modalDialog_reset_button",modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog"),$captionButtonContainer,$resetButton;if($("#"+resetButtonId).length===0){$captionButtonContainer=modalDialog.igGridModalDialog("getCaptionButtonContainer");$resetButton=$("<button></button>").attr("id",resetButtonId).appendTo($captionButtonContainer);$resetButton.igButton({labelText:o.modalDialogResetButtonLabel,click:function(e){var noCancel,i,cs=self.options.columnSettings;noCancel=self._trigger(self.events.modalDialogButtonResetClick,e,{modalDialogElement:modalDialog,owner:self});if(noCancel){self._tempExpr=[];for(i=0;i<cs.length;i++){if(cs[i].allowSorting!==false&&cs[i].userSet_currentSortDirection!=="undefined"&&cs[i].userSet_currentSortDirection!==undefined){self._tempExpr.push({fieldName:cs[i].columnKey,isSorting:true,dir:cs[i].userSet_currentSortDirection})}}self.renderMultipleSortingDialogContent(false);self.removeDialogClearButton();self._isResetClick=true}}})}},_multiplesortingDialogButtonOKClick:function(){var noCancel,modalDialog=$("#"+this.grid.element[0].id+"_multiplesorting_modalDialog");noCancel=this._trigger(this.events.modalDialogButtonApplyClick,null,{modalDialogElement:modalDialog,owner:this,columnsToSort:this._tempExpr});if(noCancel){this.grid.dataSource.settings.sorting.expressions=this._tempExpr;this.sortMultiple();modalDialog.igGridModalDialog("closeModalDialog")}},_insertColumnModalDialog:function($ul,$li,pos){var i,$currLi,currPos,listItems=$ul.find("li"),listItemsLength=listItems.length;if(listItemsLength===0||pos===null||pos===undefined){$li.appendTo($ul);return}for(i=0;i<listItemsLength;i++){$currLi=$(listItems[i]);currPos=$currLi.attr("li-order");if(currPos>=pos){$li.insertBefore($currLi);break}}if(i===listItemsLength){$li.appendTo($ul)}},_getColumnSettings:function(index,key){var i,foundByIndex=null;for(i=0;i<this.options.columnSettings.length;i++){if(this.options.columnSettings[i].columnKey===key){foundByIndex=this.options.columnSettings[i];break}if(this.options.columnSettings[i].columnIndex===index){foundByIndex=this.options.columnSettings[i];break}}return foundByIndex},_getColumnSettingsByIndex:function(index){var key=this.grid.options.columns[index].key;return this._getColumnSettings(index,key)},_headerRendered:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(this.grid.element.data("igGridResizing")){this._resizing=this.grid.element.data("igGridResizing")}if(!this._columnFixing&&this.grid.element.data("igGridColumnFixing")){this._columnFixing=this.grid.element.data("igGridColumnFixing")}if(this.options.mode!=="single"){this._renderMultipleSortingDialog()}},_getDataColumnSortingExpressions:function(se){if(!this.grid._hasUnboundColumns){return se}var grid=this.grid,newSE;newSE=$.grep(se,function(s){var col=grid.columnByKey(s.fieldName);return!col||col.unbound!==true});return newSE},_saveSortingExpressions:function(){if(this.options.persist){var se;if(this._restoreSorting===undefined||this._restoreSorting){$.each(this.options.columnSettings,function(i,setting){delete setting.userSet_currentSortDirection})}se=this._getDataColumnSortingExpressions(this.grid.dataSource.settings.sorting.expressions);this.grid._savePersistenceData(se,"sorting",this.grid.element[0].id);this._sortingExpressions=se;this._restoreSorting=false}},_preserveSorting:function(){var se=this.grid._getPersistenceData("sorting",this.grid.element[0].id);if(se){this._restoreSorting=true;if(se!==this._sortingExpressions){this._sortingExpressions=se}this.grid.dataSource.settings.sorting.expressions=se;this.grid.dataSource.settings.sorting.defaultFields=se}},_applyActiveSortCellStyle:function(data,col){if(this._activeSortedCol&&col===this._activeSortedCol.key){return this._activeSortedCol.asc?this.css.ascendingColumn:this.css.descendingColumn}return""},_couldPreserveData:function(){return!this.options.persist||this.grid.dataSource.settings.sorting.expressions!==this.grid._getPersistenceData("sorting",this.grid.element[0].id)},_injectGrid:function(gridInstance,isRebind){var i,cs,col,restoreSortingExpr,topmostGrid;this.grid=gridInstance;this._detachEvents();if(this.options.type===null){this.options.type=this.grid._inferOpType()}if(this.options.persist&&this.options.type==="remote"){topmostGrid=this.element.closest(".ui-iggrid-root").data("igGrid");if(topmostGrid&&topmostGrid.element.attr("id")!==this.grid.element[0].id&&topmostGrid.options.initialDataBindDepth===-1){this.options.persist=false}}if(this.options.type){this.grid.dataSource.settings.sorting.type=this.options.type}else{this.grid.dataSource.settings.sorting.type="remote"}this.grid.dataSource.settings.sorting.caseSensitive=this.options.caseSensitive;this.grid.dataSource.settings.sorting.defaultFields=this.grid.dataSource.settings.sorting.expressions;this.grid.dataSource.settings.sorting.enabled=true;this.grid.dataSource.settings.sorting.sortUrlKey=this.options.sortUrlKey;this.grid.dataSource.settings.sorting.sortUrlAscValueKey=this.options.sortUrlKeyAscValue;this.grid.dataSource.settings.sorting.sortUrlDescValueKey=this.options.sortUrlKeyDescValue;if($.type(this.options.customSortFunction)==="function"){this.grid.dataSource.settings.sorting.customFunc=this.options.customSortFunction}else if(typeof this.options.customSortFunction==="string"){if(window[this.options.customSortFunction]&&typeof window[this.options.customSortFunction]==="function"){this.grid.dataSource.settings.sorting.customFunc=window[this.options.customSortFunction]}}this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this._columnsCollectionModifiedHandler=$.proxy(this._columnsCollectionModified,this);this._uiDirtyHandler=$.proxy(this._onUIDirty,this);this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._columnsRearangedHandler=$.proxy(this._columnsRearranged,this);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this._virtualHorizontalScrollHandler=$.proxy(this._virtualHorizontalScroll,this);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler);
this.grid.element.bind("iggriduidirty",this._uiDirtyHandler);this.grid.element.bind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.bind("iggrid_columnsmoved",this._columnsRearangedHandler);if(this.options.persist&&this.grid._hasUnboundColumns){cs=this.options.columnSettings;for(i=0;i<cs.length;i++){if(cs[i].columnKey&&cs[i].currentSortDirection){col=this.grid.columnByKey(cs[i].columnKey);if(col&&col.unbound===true){delete cs[i].currentSortDirection}}}}this._initDefaultSettings();restoreSortingExpr=null;if(this.options.persist&&this.grid.element.data("igGridGroupBy")&&this.options.mode!=="single"){if(this.grid.element.data("igGridGroupBy")._getSortingExpressions()===this.grid.dataSource.settings.sorting.expressions){restoreSortingExpr=this.grid.dataSource.settings.sorting.expressions.slice(0)}}this._clearUi();if(restoreSortingExpr){this.grid.dataSource.settings.sorting.expressions=restoreSortingExpr;this._saveSortingExpressions()}this._currentActiveHeader=null;this._currentHeader=null;this._curColKey=null;if(this.options.persist){this._preserveSorting()}if(!isRebind&&!this._cellStyleSubscriberAdded&&(this.grid.options.rowVirtualization||this.grid.options.virtualization)){this._cellStyleSubscriberAdded=true;this.grid._cellStyleSubscribers.push($.proxy(this._applyActiveSortCellStyle,this))}}});$.extend($.ui.igGridSorting,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Column Summaries 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 *	infragistics.ui.grid.shared.js
 *	infragistics.ui.grid.featurechooser.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridSummaries",{grid:null,css:{columnSummariesDropdown:"ui-iggrid-summaries-dialog",footerRowTextContainer:"ui-iggrid-summaries-footer-text-container",footerRowIconContainer:"ui-corner-all ui-iggrid-summaries-footer-icon-container",footerDropdownButtonsContainer:"ui-iggrid-summaries-footer-dialog-buttons-container",footerButtonIcon:"ui-icon ui-icon-calculator ui-iggrid-icon-summaries",footerButtonIconHover:"ui-iggrid-filterbuttonhover ui-state-hover",footerButtonIconActive:"ui-iggrid-filterbuttonactive ui-state-active",featureChooserIconClass:"ui-icon ui-iggrid-icon-summaries",dropDownListContainer:"ui-iggrid-summaries-dropdown-listcontainer ui-widget",dropDownListItem:"ui-iggrid-summaries-dialog-listitem",headerButtonContainer:"ui-iggrid-summaries-headerbuttoncontainer ui-corner-all",headerButtonIcon:"ui-iggrid-summaries-header-icon ui-corner-all ui-icon ui-icon-calculator ui-icon-summaries",headerButtonIconHover:"ui-iggrid-summaries-header-icon-hover ui-state-hover",footerRowCell:"ui-widget-footer ui-state-default",footerRowCellHover:"ui-state-hover",checkbox:"ui-state-default ui-corner-all ui-igcheckbox-normal",checkboxOff:"ui-icon ui-icon-check ui-igcheckbox-normal-off",checkboxOn:"ui-icon ui-icon-check ui-igcheckbox-normal-on",checkboxHovered:"ui-state-hover",footerRowIconContainerEmpty:"ui-iggrid-summaries-footer-icon-container-empty",footerRowTextContainerEmpty:"ui-iggrid-summaries-footer-text-container-empty",baseClassIE7:"ui-ie7"},defaultDecimalDisplay:2,defaultSummaryMethods:[{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelCount,type:"count",allowed:"all",active:true,order:0,decimalDisplay:this.defaultDecimalDisplay},{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelMin,type:"min",allowed:["number","date","numeric"],active:true,order:1,decimalDisplay:this.defaultDecimalDisplay},{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelMax,type:"max",allowed:["number","date","numeric"],active:true,order:2,decimalDisplay:this.defaultDecimalDisplay},{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelSum,type:"sum",allowed:["number","numeric"],active:true,order:3,decimalDisplay:this.defaultDecimalDisplay},{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelAvg,type:"avg",allowed:["number","numeric"],active:true,order:4,decimalDisplay:this.defaultDecimalDisplay},{rowDisplayLabel:$.ig.GridSummaries.locale.defaultSummaryRowDisplayLabelCustom,type:"custom",allowed:"all",active:true,summaryCalculator:null,order:5,decimalDisplay:this.defaultDecimalDisplay}],renderInFeatureChooser:true,options:{type:null,dialogButtonOKText:$.ig.GridSummaries.locale.dialogButtonOKText,dialogButtonCancelText:$.ig.GridSummaries.locale.dialogButtonCancelText,calculateRenderMode:"okcancelbuttons",featureChooserText:$.ig.GridSummaries.locale.featureChooserText,featureChooserTextHide:$.ig.GridSummaries.locale.featureChooserTextHide,compactRenderingMode:true,defaultDecimalDisplay:2,showSummariesButton:true,summariesResponseKey:"summaries",summaryExprUrlKey:"summaries",callee:null,dropDownHeight:"",dropDownWidth:"",showDropDownButton:true,summaryExecution:"afterfilteringbeforepaging",dropDownDialogAnimationDuration:400,emptyCellText:$.ig.GridSummaries.locale.emptyCellText,summariesHeaderButtonTooltip:$.ig.GridSummaries.locale.summariesHeaderButtonTooltip,resultTemplate:"{0} = {1}",isGridFormatter:true,renderSummaryCellFunc:null,columnSettings:[{allowSummaries:true,columnKey:null,columnIndex:-1,summaryOperands:[{rowDisplayLabel:"",type:"custom",active:true,summaryCalculator:null,order:5,decimalDisplay:2,isGridFormatter:false}]}],inherit:false},events:{dropDownOpening:"dropDownOpening",dropDownOpened:"dropDownOpened",dropDownClosing:"dropDownClosing",dropDownClosed:"dropDownClosed",summariesCalculating:"summariesCalculating",summariesCalculated:"summariesCalculated",summariesMethodSelectionChanged:"summariesMethodSelectionChanged",summariesToggling:"summariesToggling",summariesToggled:"summariesToggled",dropDownOKClicked:"dropDownOKClicked",dropDownCancelClicked:"dropDownCancelClicked"},_createWidget:function(){this.options.columnSettings=[];this._summariesRows=[];this._data={};this._currentOpenedColumnKey=null;this._isRenderedSummariesRows=false;this._footerInitialized=false;this._currentRowShownIcons=null;this._customInitMethods=[];this._fcData={};this._isInitFC=false;this._isSummariesRowsHidden=false;this._disallowedSummaries=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var compactRenderingMode=this.options.compactRenderingMode;this._setRenderSummaryCellFunction(this.options.renderSummaryCellFunc);if(compactRenderingMode==="true"){compactRenderingMode=true}else if(compactRenderingMode==="false"){compactRenderingMode=false}this.options.compactRenderingMode=compactRenderingMode},_setRenderSummaryCellFunction:function(func){if(func&&$.type(func)!=="function"){if(window[func]&&typeof window[func]==="function"){func=window[func]}}if(func&&$.type(func)==="function"){this._renderCellHandler=func}else{this._renderCellHandler=$.proxy(this._renderCell,this)}},_initColumnSettings:function(){var settings=[],i,j,k,l,cs=$.extend(true,[],this.options.columnSettings),csetting,columnSettingsLength=cs.length,gridColumnsLength=this.grid.options.columns?this.grid.options.columns.length:0;this.newColumnSettings=[];this._disallowedSummaries=[];for(i=0;i<gridColumnsLength;i++){settings.push({columnIndex:i,columnKey:this.grid.options.columns[i].key,dataType:this.grid.options.columns[i].dataType})}if(columnSettingsLength>0){for(i=0;i<columnSettingsLength;i++){csetting=cs[i];if(csetting.summaryOperands===null||csetting.summaryOperands===undefined){continue}if(csetting.columnKey!==null&&csetting.columnKey!==undefined||csetting.columnIndex!==null&&csetting.columnIndex!==undefined){for(j=0;j<gridColumnsLength;j++){for(l=0;l<csetting.summaryOperands.length;l++){if(csetting.summaryOperands[l].active===null||csetting.summaryOperands[l].active===undefined){csetting.summaryOperands[l].active=true}if(csetting.summaryOperands[l].type.startsWith("custom")===true){if(csetting.summaryOperands[l].type!=="custom"){for(k=0;k<this._customInitMethods.length;k++){if(csetting.summaryOperands[l].summaryCalculator===this._customInitMethods[k].summaryCalculator){break}}if(this._customInitMethods.length===k){this._customInitMethods.push({summaryCalculator:csetting.summaryOperands[l].summaryCalculator,type:csetting.summaryOperands[l].type,index:csetting.summaryOperands[l].type.replace("custom","")})}}}}}}}for(i=0;i<columnSettingsLength;i++){csetting=cs[i];if(csetting.columnKey!==null&&csetting.columnKey!==undefined||csetting.columnIndex!==null&&csetting.columnIndex!==undefined){for(j=0;j<gridColumnsLength;j++){if(settings[j].columnIndex===csetting.columnIndex&&csetting.columnIndex!==undefined&&csetting.columnIndex!==null||settings[j].columnKey===csetting.columnKey&&csetting.columnKey!==undefined&&csetting.columnKey!==null){csetting.dataType=settings[j].dataType;csetting.columnIndex=settings[j].columnIndex;csetting.columnKey=settings[j].columnKey;csetting.summaryOperands=this._initAllowedSummaryMethods(csetting);if(csetting.allowSummaries!==false){this.newColumnSettings.push(csetting)}else{this._disallowedSummaries[settings[j].columnKey]=true}break}}}}for(i=0;i<gridColumnsLength;i++){for(j=0;j<this.newColumnSettings.length;j++){if(this.newColumnSettings[j].columnKey===settings[i].columnKey){break}}if(j===this.newColumnSettings.length&&this._disallowedSummaries[settings[i].columnKey]!==true){this.newColumnSettings.push({dataType:settings[i].dataType,columnIndex:i,columnKey:settings[i].columnKey,summaryOperands:this._initAllowedSummaryMethods(settings[i],false)})}}}else{for(i=0;i<gridColumnsLength;i++){this.newColumnSettings.push({dataType:settings[i].dataType,columnIndex:i,columnKey:settings[i].columnKey,summaryOperands:this._initAllowedSummaryMethods(settings[i])})}}this.columnSettings=this.newColumnSettings},_initAllowedSummaryMethods:function(column,isNotActive){var i,j,k,z,c,lastCustomSummaryOperandIndex,defaultSummaryMethodsLength=this.defaultSummaryMethods.length,columnDataType,methods=[],allowedMethods=[],methodName,methodsLength,isActive,defaultMethodName;if(column===null||column===undefined){return}columnDataType=column.dataType;if(columnDataType==="object"){columnDataType=this.grid.dataSource._getFieldTypeFromSchema(column.columnKey)}if(column!==null&&column!==undefined&&column.summaryOperands!==undefined&&column.summaryOperands!==null){for(i=0;i<column.summaryOperands.length;i++){if(column.summaryOperands[i].type===undefined||column.summaryOperands[i].type===null){return}methodName=column.summaryOperands[i].type.toLowerCase();if(this._isAllowedMethodName(methodName)===true){if(isNotActive===true){column.summaryOperands[i].active=false}if(column.summaryOperands[i].type==="custom"){if(column.summaryOperands[i].summaryCalculator===null||column.summaryOperands[i].summaryCalculator===undefined){continue}lastCustomSummaryOperandIndex=1;for(k=0;k<this._customInitMethods.length;k++){if(column.summaryOperands[i].summaryCalculator===this._customInitMethods[k].summaryCalculator){column.summaryOperands[i].type=this._customInitMethods[k].type;break}if(this._customInitMethods[k].index>lastCustomSummaryOperandIndex){lastCustomSummaryOperandIndex=this._customInitMethods[k].index}}if(this._customInitMethods.length===k){lastCustomSummaryOperandIndex++;column.summaryOperands[i].type="custom"+lastCustomSummaryOperandIndex;this._customInitMethods.push({summaryCalculator:column.summaryOperands[i].summaryCalculator,type:"custom"+lastCustomSummaryOperandIndex,index:lastCustomSummaryOperandIndex})}}methods.push(column.summaryOperands[i])}}}else{for(i=0;i<defaultSummaryMethodsLength;i++){c=this.defaultSummaryMethods[i];if(c.type.startsWith("custom")){continue}isActive=c.active;if(isNotActive===true){isActive=false}methods.push({rowDisplayLabel:c.rowDisplayLabel,type:c.type,allowed:c.allowed,active:isActive,order:c.order,decimalDisplay:c.decimalDisplay,isGridFormatter:c.isGridFormatter})}}methodsLength=methods.length;for(i=0;i<methodsLength;i++){for(j=0;j<defaultSummaryMethodsLength;j++){defaultMethodName=this.defaultSummaryMethods[j].type.toUpperCase();if(defaultMethodName===methods[i].type.toUpperCase()||methods[i].type.startsWith("custom")){if(methods[i].type.toLowerCase().startsWith("custom")){if(methods[i].order<this.defaultSummaryMethods[j].order){methods[i].order=this.defaultSummaryMethods[j].order}}else if(methods[i].order!==this.defaultSummaryMethods[j].order){methods[i].order=this.defaultSummaryMethods[j].order}if(methods[i].rowDisplayLabel===null||methods[i].rowDisplayLabel===undefined){methods[i].rowDisplayLabel=this.defaultSummaryMethods[j].rowDisplayLabel}if(this.defaultSummaryMethods[j].allowed==="all"){allowedMethods.push(methods[i])}else{for(z=0;z<this.defaultSummaryMethods[j].allowed.length;z++){if(this.defaultSummaryMethods[j].allowed[z]===columnDataType){allowedMethods.push(methods[i]);break}}}break}}}return allowedMethods},_setOption:function(key,value){var i,o=this.options,columns,columnsLength,cs,csLength,$colCell,columnKey,gridId=this.grid.element[0].id;switch(key){case"dialogButtonOKText":if(o.dialogButtonOKText!==value){columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","dialog_button_ok",columns[i].key)).igButton("option","labelText",value)}}break;case"dialogButtonCancelText":if(o.dialogButtonCancelText!==value){columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","dialog_button_cancel",columns[i].key)).igButton("option","labelText",value)}}break;case"calculateRenderMode":if(o.calculateRenderMode!==value){o.calculateRenderMode=value;columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){this._renderDropDown(columns[i].key)}}break;case"compactRenderingMode":if(o.compactRenderingMode!==value){o.compactRenderingMode=value;this._clearAllRows();this.calculateSummaries()}break;case"showSummariesButton":if(o.showSummariesButton!==value){o.showSummariesButton=value;cs=this.columnSettings;csLength=cs.length;for(i=0;i<csLength;i++){columnKey=cs[i].columnKey;if(value===true){$colCell=$("#"+gridId+"_"+columnKey);if(this._fcData!==null&&this._fcData!==undefined&&$colCell.length>0&&this._fcData[columnKey]!==true){this._renderHeaderCellButton($colCell,columnKey)}}else{$("#"+this._id("summaries","header_column_icon",columnKey)).remove()}}}break;case"disabled":if(o.disabled!==value){o.disabled=value;if(value===true){this._clearAllRows()}else{this.calculateSummaries()}}break;case"type":if(o.type!==value){o.type=value;this._setDataSourceColumnSettingsOptions()}break;case"summaryExprUrlKey":if(o.summaryExprUrlKey!==value){o.summaryExprUrlKey=value;this._setDataSourceColumnSettingsOptions()}break;case"dropDownHeight":if(o.dropDownHeight!==value){o.dropDownHeight=value;columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","methods_dialog",columns[i].key)).css("height",value)}}break;case"dropDownWidth":if(o.dropDownWidth!==value){o.dropDownWidth=value;columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","methods_dialog",columns[i].key)).css("width",value)}}break;case"showDropDownButton":if(o.showDropDownButton!==value){o.showDropDownButton=value;if(value===true){this._renderFooterIcons()}else{this._clearFooterIcons()}}break;case"emptyCellText":if(o.emptyCellText!==value){o.emptyCellText=value;this._clearAllRows();this.calculateSummaries()}break;case"resultTemplate":if(o.resultTemplate!==value){o.resultTemplate=value;this._clearAllRows();this.calculateSummaries()}break;case"isGridFormatter":if(o.isGridFormatter!==value){o.isGridFormatter=value;this._clearAllRows();this.calculateSummaries()}break;case"defaultDecimalDisplay":if(o.defaultDecimalDisplay!==value){o.defaultDecimalDisplay=value;this._clearAllRows();this.calculateSummaries()}break;case"columnSettings":if(o.columnSettings!==value){o.columnSettings=value;this.columnSettings=[];this.newColumnSettings=[];this._data={};this._clearAllRows();this._initColumnSettings();columns=this.grid.options.columns;columnsLength=columns.length;this.grid.dataSource.dataBind();for(i=0;i<columnsLength;i++){this._renderDropDown(columns[i].key)}}break;case"renderSummaryCellFunc":if(o.renderSummaryCellFunc!==value){this._setRenderSummaryCellFunction(value)}break}$.Widget.prototype._setOption.apply(this,arguments)},_removeHeaderColumnIcons:function(){var i,cs=this.columnSettings,csLength=cs.length;for(i=0;i<csLength;i++){$("#"+this._id("summaries","header_column_icon",cs[i].columnKey)).remove()}},destroy:function(){var i,columns,columnsLength,fc;this._detachEvents();this._clearAllRows();this.newColumnSettings=null;this.options.columnSettings=null;this.options=null;this._summariesRows.length=0;this._summariesRows=null;if(this._activeDialog){this._activeDialog.remove();this._activeDialog=null}this._data=null;this._currentOpenedColumnKey=null;this._isRenderedSummariesRows=null;this._footerInitialized=null;this._currentRowShownIcons=null;this._customInitMethods=null;this._fcData=null;this._isInitFC=null;this._isSummariesRowsHidden=null;this._disallowedSummaries=null;this._activeDialog=null;this.defaultSummaryMethods=null;columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","methods_dialog",columns[i].key)).remove()}fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){fc._removeFeature("Summaries")}$.Widget.prototype.destroy.call(this);return this},_detachEvents:function(){this.grid.footersTable().find("tr:first td").unbind(".summaries");if(this._headerRenderedHandler){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}if(this._footerRenderedHandler){this.grid.element.unbind("iggridfooterrendered",this._footerRenderedHandler)}if(this._headerCellRenderedHandler){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler)}if(this._headerFooterInitHandler){this.grid.element.unbind("iggridheaderextracellsmodified",this._headerFooterInitHandler)}if(this._columnsCollectionModifiedHandler){this.grid.element.unbind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler)}if(this._virtualHorizontalScrollHandler){this.grid.element.unbind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler)}},_headerCellRendered:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(this._isInitFC!==true){this._initFC()}},_initFC:function(){var i,fc,o=this.options,cs=this.columnSettings,csLength=cs.length,columnKey;this._isInitFC=true;fc=this.grid.element.data("igGridFeatureChooser");if(fc!==null&&fc!==undefined&&this.renderInFeatureChooser&&o.showSummariesButton){for(i=0;i<csLength;i++){if(cs[i].allowSummaries===false){continue}columnKey=cs[i].columnKey;if(fc._shouldRenderInFeatureChooser(columnKey)===true){fc._renderInFeatureChooser(columnKey,{name:"Summaries",text:o.featureChooserText,textHide:o.featureChooserTextHide,iconClass:this.css.featureChooserIconClass,iconClassOff:this.css.featureChooserIconClass,isSelected:true,method:$.proxy(this._togglefromfc,this),updateOnClickAll:true,order:1,groupName:"toggle",groupOrder:1,type:"toggle",state:"hide"});this._fcData[columnKey]=true}}}},_footerRendered:function(sender,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}var i,cs=this.columnSettings,csLength=cs.length,columnKey;for(i=0;i<csLength;i++){if(cs[i].allowSummaries===false){continue}columnKey=cs[i].columnKey;this._renderDropDown(columnKey)}},_headerRendered:function(sender,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}var i,cs=this.columnSettings,csLength=cs.length,$colCell,columnKey,gridId=this.grid.element[0].id;for(i=0;i<csLength;i++){if(cs[i].allowSummaries===false){continue}columnKey=cs[i].columnKey;$colCell=this.grid.headersTable().find("#"+gridId+"_"+columnKey);if($colCell.length>0&&this._fcData[columnKey]!==true&&this.options.showSummariesButton!==false){this._renderHeaderCellButton($colCell,columnKey)}}},_columnMap:function(){var o=this.options,cs=this.newColumnSettings,i,csLength=cs.length,elem,result=[];if(o.showSummariesButton===false){return false}for(i=0;i<csLength;i++){elem={columnKey:cs[i].columnKey,enabled:true};if(cs[i].allowSummaries===false){elem.enabled=false}result.push(elem)}return result},_dataRendered:function(){var grid=this.grid;if(this.options.disabled!==true&&this._isSummariesRowsHidden===false){this.calculateSummaries();if(!grid._initialized&&this._isVirtualization()&&grid.options.virtualizationMode==="fixed"){grid._resetVirtualDom();grid._renderVirtualRecordsFixed()}}},_updatingApplied:function(){if(this.grid.options.autoCommit&&this._isRenderedSummariesRows){this.calculateSummaries()}},_rowDeleted:function(){this._updatingApplied()},_rowAdded:function(){this._updatingApplied()},_internalRowUpdated:function(){this._updatingApplied()},_internalCellUpdated:function(){this._updatingApplied()},isSummariesRowsHidden:function(){return this._isSummariesRowsHidden},calculateSummaries:function(){this._trigger(this.events.rowsInitialize,null,{});this._calculateInternalSummaries();if(this.options.showDropDownButton===true){this._renderFooterIcons()}this._adjustHeights()},_adjustHeights:function(){var grid=this.grid,gridHeight=grid.options.height;if(gridHeight===null||gridHeight===undefined){return}grid._fireInternalEvent("_summariesHeightsAdjusting");if(grid.hasFixedColumns()){this._syncFixedUnfixedRowHeights()}grid._initializeHeights();if(this._isVirtualization()===true){grid._resetVirtualDom();grid._renderVirtualRecords()}if(grid.hasVerticalScrollbar()!==grid._hasVerticalScrollbar){grid._adjustLastColumnWidth(false)}},_removeFooterRows:function(){var i,sr=this._summariesRows,hasFixedColumns=this.grid.hasFixedColumns(),srLength=sr.length;for(i=0;i<srLength;i++){$("#"+this._id("summaries","footer_row",sr[i].type)).remove();if(hasFixedColumns){$("#"+this._id("summaries","footer_row",sr[i].type,"fixed")).remove()}}this._isRenderedSummariesRows=false;this._summariesRows=[]},_calculateSelectedSummaries:function(columnKey){var i,k,methods,hasFixedColumns=this.grid.hasFixedColumns(),res=[],csLength,$checkbox,methodsLength,summariesRowsLength,isToCalculate=false,data,newMax,max,cs=null,isChecked,j,compactRenderingMode=this.options.compactRenderingMode,selectedColumnSettingsIndex,columnSettingsLength=this.columnSettings.length,isToRerender=false,isToRemoveRow=false,methodNameToRemove,unactiveMethods=[],unactiveMethodsLength=0,activeMethods=[],isToRemoveFirstRow=false,elemDataCalculating,rowToRemoveMethodName="";if(columnKey===undefined||columnKey===null){return}for(j=0;j<columnSettingsLength;j++){if(this.columnSettings[j].columnKey===columnKey&&this._isVisibleColumn(columnKey)){cs=this.columnSettings[j];selectedColumnSettingsIndex=j;break}}if(cs===null||cs===undefined){return}methods=cs.summaryOperands;methodsLength=methods.length;for(i=0;i<methodsLength;i++){$checkbox=$("#"+this._id("summaries_footer_checkbox",methods[i].type.toLowerCase(),columnKey));isChecked=$checkbox.attr("data-chk").toLowerCase()==="on";if(isChecked!==methods[i].active){isToRerender=true;this.newColumnSettings[selectedColumnSettingsIndex].summaryOperands[i].active=isChecked;if(isChecked===true){isToCalculate=true;activeMethods.push(this.newColumnSettings[selectedColumnSettingsIndex].summaryOperands[i])}else{unactiveMethods.push(methods[i])}}}this.columnSettings[selectedColumnSettingsIndex].summaryOperands=this.newColumnSettings[selectedColumnSettingsIndex].summaryOperands;this.isToCalculateInRemoteMode=false;if(this.options.compactRenderingMode==="auto"){if(this._summariesRows.length===1&&this._analyzeAutoCompactRenderingMode()===false){$("#"+this._summariesRows[0].id).remove();if(hasFixedColumns){$("#"+this._summariesRows[0].id+"_fixed").remove()}this._summariesRows=[];this.calculateSummaries();return}if(this._summariesRows.length>1&&this._analyzeAutoCompactRenderingMode()===true){for(i=0;i<this._summariesRows.length;i++){$("#"+this._summariesRows[i].id).remove();if(hasFixedColumns){$("#"+this._summariesRows[i].id+"_fixed").remove()}}this._summariesRows=[];this.calculateSummaries();return}}if(isToCalculate===true){if((compactRenderingMode===false||compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===false)&&this._summariesRows.length===1){rowToRemoveMethodName=this._summariesRows[0].type.toLowerCase();isToRemoveFirstRow=true;for(j=0;j<this.columnSettings.length;j++){if(!this._isVisibleColumn(this.columnSettings[j].columnKey)){continue}for(k=0;k<this.columnSettings[j].summaryOperands.length;k++){if(this.columnSettings[j].summaryOperands[k].type.toLowerCase()===rowToRemoveMethodName&&this.columnSettings[j].summaryOperands[k].active!==false){isToRemoveFirstRow=false;break}}if(isToRemoveFirstRow===false){break}}}if(this.options.type==="remote"){if(this.options.calculateRenderMode==="onselect"){this.isToCalculateInRemoteMode=true;elemDataCalculating={type:activeMethods[0].type,result:"calculating",rowDisplayLabel:activeMethods[0].rowDisplayLabel,order:activeMethods[0].order,decimalDisplay:activeMethods[0].decimalDisplay,dataType:this.newColumnSettings[selectedColumnSettingsIndex].dataType};if(this._data[columnKey]===null||this._data[columnKey]===undefined){this._data[columnKey]=[]}this._data[columnKey].push(elemDataCalculating);this._renderFooterColumnInfo(columnKey,this._data[columnKey])}else{this._setDataSourceColumnSettingsOptions();this.grid.dataSource.dataBind()}}else{data=this._dataSummaries();if(this._trigger(this.events.summariesCalculating,null,{owner:this})!==false){res=this.calculateSummaryColumn(columnKey,activeMethods,data,this.newColumnSettings[selectedColumnSettingsIndex].dataType);if(compactRenderingMode===false||compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===false){this._renderFooterColumnInfo(columnKey,res)}this._trigger(this.events.summariesCalculated,null,{data:data,owner:this})}}}unactiveMethodsLength=unactiveMethods.length;if(compactRenderingMode===true||compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===true){cs=this.newColumnSettings;csLength=cs.length;max=0;newMax=0;if(compactRenderingMode==="auto"){unactiveMethods=[];for(i=0;i<methodsLength;i++){$checkbox=$("#"+this._id("summaries_footer_checkbox",methods[i].type.toLowerCase(),columnKey));isChecked=$checkbox.attr("data-chk").toLowerCase()==="on";if(isChecked===false){unactiveMethods.push(methods[i])}}unactiveMethodsLength=unactiveMethods.length}for(i=0;i<unactiveMethodsLength;i++){this._removeDataResult(columnKey,unactiveMethods[i].type.toLowerCase())}if(unactiveMethodsLength>activeMethods.length){for(i=0;i<csLength;i++){if(!this._isVisibleColumn(cs[i].columnKey)){continue}newMax=0;for(j=0;j<cs[i].summaryOperands.length;j++){if(cs[i].summaryOperands[j].active===true){newMax++}}if(newMax>max){max=newMax}}summariesRowsLength=this._summariesRows.length;if(max>summariesRowsLength){return}for(i=0;i<max;i++){$("#"+this._id("summaries","footer_row_text_container",this._summariesRows[i].type.toLowerCase(),columnKey)).html(this.options.emptyCellText)}for(i=max;i<summariesRowsLength;i++){$("#"+this._summariesRows[i].id).remove();if(hasFixedColumns){$("#"+this._summariesRows[i].id+"_fixed").remove()}}for(i=max;i<summariesRowsLength;i++){this._summariesRows.pop()}if(hasFixedColumns&&this.grid.options.height===null&&$.ig.util.isIE&&$.ig.util.browserVersion>=9){this._getColumnFixingInstance()._syncTableHeights()}}else if(activeMethods.length>unactiveMethodsLength){this._initCompactModeSummariesRows()}this._renderFooterColumnInfo(columnKey,this._data[columnKey]);if(this._summariesRows.length===0){this._insertSummariesRows(this.defaultSummaryMethods[0].type.toLowerCase(),this.defaultSummaryMethods[0].order);this._renderFooterIcons()}this._adjustHeights()}if(isToRerender&&(compactRenderingMode===false||compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===false)){for(i=0;i<unactiveMethodsLength;i++){methodNameToRemove=unactiveMethods[i].type.toLowerCase();$("#"+this._id("summaries","footer_row_text_container",methodNameToRemove,columnKey)).html(this.options.emptyCellText);this._removeDataResult(columnKey,methodNameToRemove);if(this._summariesRows.length<=1){continue}isToRemoveRow=true;for(j=0;j<this.columnSettings.length;j++){if(!this._isVisibleColumn(this.columnSettings[j].columnKey)){continue}for(k=0;k<this.columnSettings[j].summaryOperands.length;k++){if(this.columnSettings[j].summaryOperands[k].type.toLowerCase()===methodNameToRemove&&this.columnSettings[j].summaryOperands[k].active!==false){isToRemoveRow=false;break}}if(isToRemoveRow===false){break}}if(isToRemoveRow===true&&this._summariesRows.length>1){this._removeRowsDataByType(methodNameToRemove);$("#"+this._id("summaries","footer_row",methodNameToRemove)).remove();if(hasFixedColumns){$("#"+this._id("summaries","footer_row",methodNameToRemove,"fixed")).remove()}}}if(this._summariesRows.length>=1&&isToRemoveFirstRow===true){for(i=0;i<activeMethods.length;i++){if(activeMethods[i].type.toLowerCase()===rowToRemoveMethodName){break}}if(i===activeMethods.length){this._removeRowsDataByType(rowToRemoveMethodName);$("#"+this._id("summaries","footer_row",rowToRemoveMethodName)).remove();if(hasFixedColumns){$("#"+this._id("summaries","footer_row",rowToRemoveMethodName,"fixed")).remove()}}}if(this._summariesRows.length>0&&$("#"+this._id("summaries","footer_row_button_dd",this._summariesRows[0].type,columnKey)).length===0){this._renderFooterIcons()}this._adjustHeights()}},_analyzeAutoCompactRenderingMode:function(){var i,j,methods,cs,methodsLength,activeMethodsCount,columnSettingsLength=this.columnSettings.length;for(j=0;j<columnSettingsLength;j++){cs=this.columnSettings[j];methods=cs.summaryOperands;methodsLength=methods.length;activeMethodsCount=0;for(i=0;i<methodsLength;i++){if(methods[i].active===true&&++activeMethodsCount>1){return false}}}return true},_removeRowsDataByType:function(methodNameToRemove){if(methodNameToRemove===undefined||methodNameToRemove===null){return}var hasFixedColumns=this.grid.hasFixedColumns();this._summariesRows=$.grep(this._summariesRows,function(n){if(n.type===methodNameToRemove){$(n).remove();if(hasFixedColumns){$("#"+n.id+"_fixed").remove()}}return n.type!==methodNameToRemove})},_syncFixedUnfixedRowHeights:function(){var $tfoot=this.grid.footersTable().find("tfoot"),$fixedTFoot=this.grid.fixedFootersTable().find("tfoot"),summariesRows=$tfoot.find("tr[data-role]"),fixedSummariesRows=$fixedTFoot.find("tr[data-role]"),$fixedRow;$.each(summariesRows,function(index,r){var h,fixedRowHeight,rowHeight,$row=$(r);$fixedRow=fixedSummariesRows.eq(index);if($fixedRow.length===0){return true}fixedRowHeight=$fixedRow.height();rowHeight=$row.height();if(fixedRowHeight>rowHeight){h=fixedRowHeight}else{h=rowHeight}$row.height(h);$fixedRow.height(h)})},_clearFooterIcons:function(){var i,currentRow=this._currentRowShownIcons,columns,columnsLength;if(currentRow===null||currentRow===undefined){return}columns=this.grid.options.columns;columnsLength=columns.length;for(i=0;i<columnsLength;i++){$("#"+this._id("summaries","footer_row_button_dd",currentRow.type,columns[i].key)).remove()}},clearAllFooterIcons:function(){var i,j,rows=this._summariesRows,rowsLength=rows.length,columns=this.grid.options.columns,columnsLength=columns.length;for(i=0;i<rowsLength;i++){for(j=0;j<columnsLength;j++){$("#"+this._id("summaries","footer_row_button_dd",rows[i].type,columns[j].key)).remove()}}},_clearAllRows:function(){var i,summaryRowsLength=this._summariesRows.length,hasFixedColumns=this.grid.hasFixedColumns(),$row;for(i=0;i<summaryRowsLength;i++){$row=$("#"+this._summariesRows[i].id);$row.remove();if(hasFixedColumns){$("#"+this._summariesRows[i].id+"_fixed").remove()}}this._summariesRows.length=0},_removeUnusedFooterRows:function(oldRows){var i,j,sr=this._summariesRows,summariesRowsLength=this._summariesRows.length,hasFixedColumns=this.grid.hasFixedColumns(),oldRowsLength=oldRows.length;if(summariesRowsLength===0){for(i=0;i<oldRowsLength;i++){$("#"+oldRows.id).remove()}return}for(i=0;i<oldRowsLength;i++){for(j=0;j<summariesRowsLength;j++){if(sr[j].id===oldRows[i].id){continue}}if(j===summariesRowsLength){$("#"+oldRows[i].id).remove();if(hasFixedColumns){$("#"+oldRows[i].id+"_fixed").remove()}}}},_renderFooterIcons:function(startInd,endInd){var i,columnKey,sr=this._summariesRows,columnSetting,isToRemoveRow=true,gridColumns=this.grid.options.columns,gridColumnsLength=gridColumns.length,methodName;if(startInd===null||startInd===undefined){startInd=0}if(endInd===null||endInd===undefined){endInd=gridColumnsLength}if(sr.length===0){return}this._clearFooterIcons();methodName=sr[0].type;this._currentRowShownIcons=sr[0];for(i=startInd;i<endInd;i++){columnKey=gridColumns[i].key;if(this._disallowedSummaries[columnKey]===true){continue}columnSetting=this._getColumnSettingByKey(columnKey);if(columnSetting===null||columnSetting===undefined||columnSetting.length===0||columnSetting.allowSummaries===false){continue}isToRemoveRow=false;this._renderFooterIconMarkup(methodName,columnKey)}if(isToRemoveRow===true){this._removeRowsDataByType(methodName)}},_renderFooterIconMarkup:function(methodName,columnKey){var self=this,$td,$button;$button=$("<span></span>").appendTo($("#"+this._id("summaries","footer_row_icon_container",methodName,columnKey))).addClass(self.css.footerButtonIcon);$button.wrap('<a id="'+this._id("summaries","footer_row_button_dd",methodName,columnKey)+'" href="#" title="" tabindex="'+this.grid.options.tabIndex+'"></a>');
$button.data("columnKey",columnKey);$td=$button.closest("td");$td.data("columnKey",columnKey);$td.unbind(".summaries");$td.bind({"mousedown.summaries":function(e){self.toggleDropDown(columnKey,e);e.stopPropagation()}});$button.parent().bind({mousedown:$.proxy(self._onMouseDownFooterIcon,self),click:$.proxy(self._onClickFooterIcon,self),mouseover:$.proxy(self._onMouseOverFooterIcon,self),mouseout:$.proxy(self._onMouseOutFooterIcon,self),focus:$.proxy(self._onMouseOverFooterIcon,self),blur:$.proxy(self._onMouseOutFooterIcon,self),keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){event.stopPropagation();event.preventDefault();self.toggleDropDown(null,event)}}})},_onMouseOverFooterIcon:function(e){var $button=$(e.target);if($button.closest("div").hasClass(this.css.footerButtonIconActive)===false){$button.closest("div").addClass(this.css.footerButtonIconHover)}},_onMouseOutFooterIcon:function(e){var $button=$(e.target);if($button.closest("div").hasClass(this.css.footerButtonIconActive)===false){$button.closest("div").removeClass(this.css.footerButtonIconHover)}},_onClickFooterIcon:function(e){e.preventDefault()},_onMouseDownFooterIcon:function(event){this.toggleDropDown(null,event)},_isFirstRowEmpty:function(){var i,res=true,columnKey,sr=this._summariesRows,data=null,row,gridColumns=this.grid.options.columns,gridColumnsLength=gridColumns.length;if(sr.length===0){return false}row=sr[0];for(i=0;i<gridColumnsLength;i++){columnKey=gridColumns[i].key;data=this._getDataByKeyMethodName(columnKey,row.type);if(data!==null){return false}}return res},toggleDropDown:function(columnKey,event){var $target,$dialog,top,left,self,isVisible,rOffset,$footersTable,$td;if(!event){if(this.grid.isFixedColumn(columnKey)){$footersTable=this.grid.fixedFootersTable()}else{$footersTable=this.grid.footersTable()}$target=$footersTable.find("tfoot tr:first-child td[data-key="+columnKey+"] a>span")}else{$td=$(event.target).closest("td");columnKey=$td.data("columnKey");$target=$td.find("a>span");if(!$target.length){return}}if(columnKey===null||columnKey===undefined){$target=$target.find("span");columnKey=$target.data("columnKey")}$dialog=$("#"+this._id("summaries","methods_dialog",columnKey));top=$.ig.util.offset($target).top;left=$.ig.util.offset($target).left;self=this;isVisible=$dialog.is(":visible")===true;if($dialog.length===0||$dialog.data("isAnimating")===true){return}top-=$target.height()-2;if($target.is("span")===true){$dialog.data("buttonId",$target.parent().attr("id"))}if(!isVisible){rOffset=$.ig.util.getRelativeOffset($dialog);$dialog.css({top:top-$dialog.height()-rOffset.top,left:left-rOffset.left})}if(self._activeDialog!==null&&self._activeDialog!==undefined&&$dialog!==self._activeDialog&&columnKey!==self._activeDialog.data("columnKey")){self.showHideDialog(self._activeDialog)}if(isVisible===true){self._currentOpenedColumnKey=null}else{self._currentOpenedColumnKey=columnKey}self.showHideDialog($dialog)},showHideDialog:function($dialog){if($dialog===null||$dialog===undefined){return}var self=this,e=this.events,$button=$("#"+$dialog.data("buttonId")),columnKey=$dialog.data("columnKey"),animationDuration=self.options.dropDownDialogAnimationDuration;if($dialog.data("isAnimating")===true&&self._activeDialog===$dialog){return}if($dialog.is(":visible")===true){if(this._trigger(e.dropDownClosing,null,{columnKey:columnKey,owner:this})===false){return}if($button!==null&&$button!==undefined){$button.closest("div").removeClass(self.css.footerButtonIconActive)}}else{if(this._trigger(e.dropDownOpening,null,{columnKey:columnKey,owner:this})===false){return}if($button!==null&&$button!==undefined){$button.closest("div").removeClass(self.css.footerButtonIconHover);$button.closest("div").addClass(self.css.footerButtonIconActive);this._rollbackCheckboxState(columnKey)}}if(animationDuration<=0){animationDuration=1}$dialog.data("isAnimating",true);$dialog.toggle("slide",{duration:animationDuration,direction:"down"},function(){$dialog.data("isAnimating",false);if($dialog.is(":visible")===true){$dialog.focus();self.grid._focusedElement=$dialog;self._activeDialog=$dialog;self._trigger(e.dropDownOpened,null,{columnKey:columnKey,owner:this})}else{self._trigger(e.dropDownClosed,null,{columnKey:columnKey,owner:this});self.grid._focusedElement=null;if(self.options.type==="remote"&&self.options.calculateRenderMode==="onselect"&&self.isToCalculateInRemoteMode===true){self.isToCalculateInRemoteMode=false;self._setDataSourceColumnSettingsOptions();self.grid.dataSource.dataBind()}if(self._activeDialog!==null&&self._activeDialog!==undefined&&self._activeDialog.data("columnKey")===columnKey){self._activeDialog=null}}})},_closeDropDown:function(){var $dialog=this._activeDialog;this.showHideDialog($dialog)},_setDataSourceColumnSettingsOptions:function(){var o=this.options;this.grid.dataSource.settings.summaries.columnSettings=this.newColumnSettings;this.grid.dataSource.settings.summaries.type=o.type;this.grid.dataSource.settings.summaries.summaryExecution=o.summaryExecution;this.grid.dataSource.settings.summaries.summaryExprUrlKey=o.summaryExprUrlKey;this.grid.dataSource.settings.summaries.summariesResponseKey=o.summariesResponseKey;if(this.grid.dataSource.type&&this.grid.dataSource.type()==="remoteUrl"&&this.grid._dataOptions&&$.type(this.grid._dataOptions.dataSource)==="string"){this.grid.dataSource.settings.dataSource=this.grid._dataOptions.dataSource}},_getColumnSettingByKey:function(columnKey){var i,len=this.columnSettings.length;if(columnKey===null||columnKey===undefined){return null}for(i=0;i<len;i++){if(this.columnSettings[i].columnKey===columnKey){return this.columnSettings[i]}}return null},_renderHeaderCellButton:function(columnCell,columnKey){var summaryHeaderIconContainer,self=this,css=self.css,buttonId=this._id("summaries","header_column_icon",columnKey),$button,$divHeaderButtonContainer;summaryHeaderIconContainer=columnCell.find(".ui-iggrid-indicatorcontainer");this.grid._enableHeaderCellFeature(columnCell);if(summaryHeaderIconContainer.length===0){summaryHeaderIconContainer=$("<div></div>").appendTo(columnCell);summaryHeaderIconContainer.addClass("ui-iggrid-indicatorcontainer")}$("#"+buttonId).remove();$button=$("<a></a>").attr({href:"#",id:buttonId,tabindex:this.grid.options.tabIndex,title:this.options.summariesHeaderButtonTooltip});$divHeaderButtonContainer=summaryHeaderIconContainer.find(".ui-iggrid-summaries-headerbuttoncontainer");if($divHeaderButtonContainer.length===0){$divHeaderButtonContainer=$("<div></div>").addClass(css.headerButtonContainer).appendTo(summaryHeaderIconContainer)}$button.appendTo($divHeaderButtonContainer);$("<span></span>").addClass(css.headerButtonIcon).appendTo($button);if($.ig.util.isIE7===true){$button.parent().addClass(this.css.baseClassIE7)}$button.hover(function(){$(this).parent().addClass(css.headerButtonIconHover)},function(){$(this).parent().removeClass(css.headerButtonIconHover)});$button.bind({click:function(event){event.preventDefault();event.stopPropagation();self._internalToggleSummariesRow(null,event)}})},_togglefromfc:function(event,columnKey,isSelected){this._internalToggleSummariesRow(isSelected,event)},_internalToggleSummariesRow:function(isToShow,event){if(isToShow===null||isToShow===undefined){isToShow=!this._isRenderedSummariesRows}if(this._trigger(this.events.summariesToggling,event,{isToShow:isToShow,owner:this})===false){return}this.toggleSummariesRows(isToShow,true);this._trigger(this.events.summariesToggled,event,{isShown:isToShow,owner:this})},toggleSummariesRows:function(isToShow,isInternalCall){var fc,cs,csLength,i,$hScroller,hScrollerLeft,grid=this.grid;if(isToShow===true){$hScroller=$("#"+grid.id()+"_horizontalScrollContainer");if($hScroller.length>0&&(grid.options.columnVirtualization||grid._isColumnVirtualizationEnabled())){hScrollerLeft=$hScroller.scrollLeft();$hScroller.scrollLeft(0)}this.calculateSummaries();if(hScrollerLeft){setTimeout(function(){$hScroller.scrollLeft(hScrollerLeft)},0)}grid._synchronizeHScroll();this._isSummariesRowsHidden=false;if(this._summariesRows.length===0){cs=this.newColumnSettings;csLength=cs.length;this._insertSummariesRows(this.defaultSummaryMethods[0].type,this.defaultSummaryMethods[0].order);for(i=0;i<csLength;i++){if(!this._isVisibleColumn(cs[i].columnKey)){continue}this._renderFooterIconMarkup(this.defaultSummaryMethods[0].type,cs[i].columnKey)}}}else{this._removeFooterRows();this._isSummariesRowsHidden=true}this._adjustHeights();if(isInternalCall===undefined||isInternalCall===false){fc=grid.element.data("igGridFeatureChooser");if(fc!==null&&fc!==undefined){fc._toggleSelectedItems("Summaries",!isToShow)}}if(grid.hasFixedColumns()){if($.ig.util.isIE&&$.ig.util.browserVersion>=9){grid.element.data("igGridColumnFixing")._syncTableHeights()}this._syncFixedUnfixedRowHeights()}},_renderDropDown:function(columnKey){var $dialog,$ul,i,j,$buttonOK,$buttonCancel,$div,minInd,swap,$li,id=this._id("summaries","methods_dialog",columnKey),methodsLength,cs=this._getColumnSettingByKey(columnKey),css=this.css,checkboxId,allowedMethods,self=this,o=this.options,isChecked=false,cssClassCheckBox,onFocusLi,onMousedownLi,toggleState,onBlurLi,onKeydownLi,onMousedown,onMouseover,onMouseout,$checkbox,onClick;if(cs===null||cs===undefined){return}allowedMethods=cs.summaryOperands;if(allowedMethods===null||allowedMethods===undefined){return}$("#"+id).remove();$dialog=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",id).css("position","absolute").css("width",this.options.dropDownWidth).css("height",this.options.dropDownHeight).addClass(this.css.columnSummariesDropdown).attr("tabindex",this.grid.options.tabIndex).hide();$dialog.data("methods",allowedMethods);$ul=$("<ul></ul>").addClass(css.dropDownListContainer);$ul.appendTo($dialog);methodsLength=allowedMethods.length;for(i=0;i<methodsLength;i++){minInd=i;for(j=i;j<methodsLength;j++){if(allowedMethods[j].order===null||allowedMethods[j].order===undefined){allowedMethods[j].order=0}if(allowedMethods[minInd].order>allowedMethods[j].order){minInd=j}}if(minInd!==i){swap=allowedMethods[minInd];allowedMethods[minInd]=allowedMethods[i];allowedMethods[i]=swap}}toggleState=function($checkbox,event){self.toggleCheckstate($checkbox);self._trigger(self.events.summariesMethodSelectionChanged,event,{columnKey:columnKey,isSelected:$checkbox.attr("data-chk").toLowerCase()==="on",methodName:$checkbox.data("methodName"),owner:this});if(o.calculateRenderMode==="onselect"){self._calculateSelectedSummaries(columnKey);if(self.grid.hasFixedColumns()){self._syncFixedUnfixedRowHeights()}}};onClick=function(event){toggleState($(event.currentTarget),event);if(self._activeDialog){self._activeDialog.data("focussed",true);self._activeDialog.focus()}event.preventDefault();event.stopPropagation()};onMousedown=function(event){if(self._activeDialog){self._activeDialog.data("focussed",true);self._activeDialog.focus()}event.preventDefault();event.stopPropagation()};onMouseover=function(event){$(event.currentTarget).addClass(css.checkboxHovered)};onMouseout=function(event){$(event.currentTarget).removeClass(css.checkboxHovered)};$dialog.bind({blur:function(){$dialog.data("focussed",false);setTimeout(function(){self._checkCloseDropDown($dialog)},10)},focus:function(){$dialog.data("focussed",true)},keydown:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE||event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER){event.stopPropagation();event.preventDefault();self.toggleDropDown(null,event);if(self._summariesRows.length>0){$("#"+self._id("summaries","footer_row_button_dd",self._summariesRows[0].type,columnKey)).focus()}}}});onFocusLi=function(){if(self._activeDialog){self._activeDialog.data("focussed",true)}};onBlurLi=function(){if(self._activeDialog){self._activeDialog.data("focussed",false)}setTimeout($.proxy(self._checkCloseDropDown,self),300)};onKeydownLi=function(event){var $liFocused=$(this),keyCode=event.keyCode;if(keyCode===$.ui.keyCode.ENTER||keyCode===$.ui.keyCode.SPACE){toggleState($("#"+$liFocused.data("checkboxId")),event);event.stopPropagation();event.preventDefault()}else if(keyCode===$.ui.keyCode.ESCAPE){$dialog.blur()}};onMousedownLi=function(event){toggleState($("#"+$(this).data("checkboxId")),event)};for(i=0;i<methodsLength;i++){checkboxId=this._id("summaries_footer_checkbox",allowedMethods[i].type.toLowerCase(),columnKey);if(allowedMethods[i].active===true||allowedMethods[i].active===1){isChecked="on";cssClassCheckBox=css.checkboxOn}else{isChecked="off";cssClassCheckBox=css.checkboxOff}$li=$("<li></li>").data("checkboxId",checkboxId).addClass(css.dropDownListItem).appendTo($ul).attr("tabindex",this.grid.options.tabIndex);$li.bind({focus:onFocusLi,blur:onBlurLi,keydown:onKeydownLi,mousedown:onMousedownLi});$('<span id="'+checkboxId+'" class="'+css.checkbox+'"></span>').appendTo($li);$("<label></label>").html(allowedMethods[i].rowDisplayLabel).appendTo($li);$checkbox=$("#"+checkboxId);$('<span class="'+cssClassCheckBox+'"></span>').appendTo($checkbox);$checkbox.attr("data-chk",isChecked).attr("data-role","checkbox");$checkbox.data("methodName",allowedMethods[i].type);$checkbox.bind({click:onClick,mouseover:onMouseover,mouseout:onMouseout,mousedown:onMousedown})}$div=$("<div></div>").addClass(this.css.footerDropdownButtonsContainer).appendTo($dialog);if(o.calculateRenderMode==="okcancelbuttons"){$buttonOK=$('<a href="http://localhost/"></a>');$buttonOK.attr({id:this._id("summaries","dialog_button_ok",columnKey),tabindex:this.grid.options.tabIndex}).appendTo($div);$buttonOK.igButton({link:{href:"#",title:""},labelText:this.options.dialogButtonOKText,keydown:function(event){if(event.keyCode===$.ui.keyCode.ENTER||event.keyCode===$.ui.keyCode.SPACE){self._clickOKButton(columnKey)}if(event.keyCode!==$.ui.keyCode.TAB){event.stopPropagation();event.preventDefault()}},click:function(e){self._clickOKButton(columnKey);e.preventDefault();e.stopPropagation()},mousedown:function(event){event.preventDefault();event.stopPropagation()},focus:function(){if(self._activeDialog){self._activeDialog.data("focussed",true)}},blur:function(){if(self._activeDialog){self._activeDialog.data("focussed",false)}setTimeout($.proxy(self._checkCloseDropDown,self),300)}});$buttonCancel=$("<a></a>");$buttonCancel.attr({id:this._id("summaries","dialog_button_cancel",columnKey),tabindex:this.grid.options.tabIndex}).appendTo($div);$buttonCancel.igButton({link:{href:"#",title:""},labelText:this.options.dialogButtonCancelText,click:function(e){self._clickCancelButton(columnKey);e.preventDefault();e.stopPropagation()},mousedown:function(event){event.preventDefault();event.stopPropagation()},focus:function(){if(self._activeDialog){self._activeDialog.data("focussed",true)}},blur:function(){if(self._activeDialog){self._activeDialog.data("focussed",false)}setTimeout($.proxy(self._checkCloseDropDown,self),300)}})}$dialog.data("columnKey",columnKey)},_checkCloseDropDown:function($dialog){if(this._activeDialog===null){return}if(this._activeDialog.data("focussed")===false){setTimeout($.proxy(this._closeDropDown,this),10);return}if($dialog&&$dialog.is(":visible")&&$dialog.attr("id")!==this._activeDialog.attr("id")){this.showHideDialog($dialog)}},toggleCheckstate:function($checkbox){var noCancel;noCancel=true;if(noCancel){if($checkbox.attr("data-chk")==="on"){this.selectCheckBox($checkbox,false)}else{this.selectCheckBox($checkbox,true)}}},selectCheckBox:function($checkbox,isToSelect){var css=this.css,$innerSpan=$checkbox.children("span");if(isToSelect===true){$innerSpan.removeClass(css.checkboxOff).addClass(css.checkboxOn);$checkbox.attr("data-chk","on")}else{$innerSpan.removeClass(css.checkboxOn).addClass(css.checkboxOff);$checkbox.attr("data-chk","off")}},_clickOKButton:function(columnKey){var i,j,cs,$checkbox,columnSettingsLength=this.columnSettings.length,methods,methodsLength,eventData=[],elem;if(columnKey===null||columnKey===undefined){return}for(j=0;j<columnSettingsLength;j++){if(this.columnSettings[j].columnKey===columnKey){cs=this.columnSettings[j];break}}if(cs===null||cs===undefined){return}methods=cs.summaryOperands;methodsLength=methods.length;for(i=0;i<methodsLength;i++){$checkbox=$("#"+this._id("summaries_footer_checkbox",methods[i].type.toLowerCase(),columnKey));elem={type:methods[i].type.toLowerCase(),active:false};if($checkbox.attr("data-chk")!==undefined&&$checkbox.attr("data-chk").toLowerCase()==="on"){elem.active=true}eventData.push(elem)}this._trigger(this.events.dropDownOKClicked,null,{columnKey:columnKey,eventData:eventData,owner:this});this.showHideDialog($("#"+this._id("summaries","methods_dialog",columnKey)));this._calculateSelectedSummaries(columnKey);if(this.grid.hasFixedColumns()){this._syncFixedUnfixedRowHeights()}},_clickCancelButton:function(columnKey){this._trigger(this.events.dropDownCancelClicked,null,{columnKey:columnKey,owner:this});this.showHideDialog($("#"+this._id("summaries","methods_dialog",columnKey)))},_rollbackCheckboxState:function(columnKey){var cs,i,j,methods,isChecked,methodsLength,columnSettingsLength=this.columnSettings.length,$checkbox;if(columnKey===undefined||columnKey===null){return}for(j=0;j<columnSettingsLength;j++){if(this.columnSettings[j].columnKey===columnKey){cs=this.columnSettings[j];break}}if(cs===null||cs===undefined){return}methods=cs.summaryOperands;methodsLength=methods.length;for(i=0;i<methodsLength;i++){$checkbox=$("#"+this._id("summaries_footer_checkbox",methods[i].type.toLowerCase(),columnKey));if($checkbox.attr("data-chk")!==undefined){isChecked=$checkbox.attr("data-chk").toLowerCase()==="on";if(methods[i].active!==isChecked){if(methods[i].active===true){this.selectCheckBox($checkbox,true)}else{this.selectCheckBox($checkbox,false)}}}}},_initCompactModeSummariesRows:function(){var i,j,k,cs=this.newColumnSettings,csLength=cs.length,columnMaxMethods=cs[0],cmm,cmmLength,countRowsToAdd,methodName,maxMethods=-1,summariesRowsLength,newMaxMethods;for(i=0;i<csLength;i++){if(!this._isVisibleColumn(cs[i].columnKey)){continue}newMaxMethods=0;if(cs[i].summaryOperands===null||cs[i].summaryOperands===undefined){continue}for(j=0;j<cs[i].summaryOperands.length;j++){if(cs[i].summaryOperands[j].active===true){newMaxMethods++}}if(newMaxMethods>maxMethods){maxMethods=newMaxMethods;columnMaxMethods=cs[i]}}if(columnMaxMethods===undefined||columnMaxMethods===null){return}cmm=columnMaxMethods.summaryOperands;cmmLength=cmm.length;summariesRowsLength=this._summariesRows.length;if(summariesRowsLength>maxMethods){return}countRowsToAdd=maxMethods-summariesRowsLength;if(countRowsToAdd===0){return}k=0;for(i=0;i<cmmLength;i++){methodName=cmm[i].type.toLowerCase();if($("#"+this._id("summaries","footer_row",methodName)).length===0){this._insertSummariesRows(methodName,null);if(++k===countRowsToAdd){break}}}},_calculateInternalSummaries:function(){var cs=this.newColumnSettings,csLength=cs.length,i,o=this.options,data,res,e=this.events;if(this._trigger(e.summariesCalculating,null,{owner:this})===false){return}data=this._dataSummaries();if(o.callee!==null&&o.callee!==undefined&&$.type(o.callee)==="function"){data=o.callee(data)}if(data===null||data===undefined){data=[]}if(o.compactRenderingMode===true||o.compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===true){this._initCompactModeSummariesRows()}for(i=0;i<csLength;i++){if(!this._isVisibleColumn(cs[i].columnKey)){continue}res=this.calculateSummaryColumn(cs[i].columnKey,cs[i].summaryOperands,data,cs[i].dataType);this._renderFooterColumnInfo(cs[i].columnKey,res)}this._isRenderedSummariesRows=true;this._trigger(e.summariesCalculated,null,{data:data,owner:this})},_isVisibleColumn:function(columnKey){var cols=this.grid._visibleColumns(),ret=false;$.each(cols,function(index,value){if(value.key===columnKey){ret=true;return false}});return ret},calculateSummaryColumn:function(ck,columnMethods,data,dataType){var i,j,val,o=this.options,columnMethodsLength,tmpArr=[],rowsCount=0,res=[],order,resultCalculated,resElement,methodName,gridDataSource,isDate;if(ck===null||ck===undefined){throw new Error($.ig.GridSummaries.locale.calculateSummaryColumnKeyNotSpecified)}if(columnMethods===undefined||columnMethods===null){return}columnMethodsLength=columnMethods.length;if(o.type==="local"){rowsCount=data.length;isDate=dataType==="date";if(isDate===true){for(i=0;i<rowsCount;i++){if(data[i][ck]!==null&&data[i][ck]!==undefined){if(data[i][ck].getTime){tmpArr.push(this.grid.dataSource.getCellValue(ck,data[i]).getTime())}else{tmpArr.push(this.grid.dataSource.getCellValue(ck,data[i]))}}}}else{for(i=0;i<rowsCount;i++){if(data[i][ck]===undefined){data[i][ck]=null}tmpArr.push(this.grid.dataSource.getCellValue(ck,data[i]))}}for(i=0;i<columnMethodsLength;i++){methodName=columnMethods[i].type.toLowerCase();if(methodName.startsWith("custom")){methodName="custom"}if(columnMethods[i].active===true||columnMethods[i].active===1){order=columnMethods[i].order;if(order===undefined){order=null}if(methodName==="count"){resultCalculated=rowsCount}else{resultCalculated=$.ig.calcSummaries(methodName,tmpArr,columnMethods[i].summaryCalculator,dataType)}resElement={type:columnMethods[i].type,result:resultCalculated,rowDisplayLabel:columnMethods[i].rowDisplayLabel,order:order,decimalDisplay:columnMethods[i].decimalDisplay,isGridFormatter:columnMethods[i].isGridFormatter,dataType:dataType};res.push(resElement);this._addDataResult(ck,resElement)}}}else if(o.type==="remote"){if(data[ck]!==undefined&&data[ck]!==null){for(i=0;i<columnMethodsLength;i++){val=data[ck][columnMethods[i].type];if(columnMethods[i].active===true||columnMethods[i].active===1){order=columnMethods[i].order;if(order===undefined){order=null}if(val===null||val===undefined){if(columnMethods[i].summaryCalculator!==undefined){gridDataSource=this.grid.dataSource._data;rowsCount=gridDataSource.length;isDate=dataType==="date";if(isDate===true){for(j=0;j<rowsCount;j++){if(gridDataSource[j][ck]!==null&&gridDataSource[j][ck]!==undefined){tmpArr.push(this.grid.dataSource.getCellValue(ck,gridDataSource[j]).getTime())}}}else{for(j=0;j<rowsCount;j++){tmpArr.push(this.grid.dataSource.getCellValue(ck,gridDataSource[j]))}}val=$.ig.calcSummaries(columnMethods[i].type.toLowerCase(),tmpArr,columnMethods[i].summaryCalculator,dataType)}else{val=""}}res.push({type:columnMethods[i].type,result:val,rowDisplayLabel:columnMethods[i].rowDisplayLabel,order:order,decimalDisplay:columnMethods[i].decimalDisplay,isGridFormatter:columnMethods[i].isGridFormatter,dataType:dataType})}}}this._data[ck]=res}return res},summaryCollection:function(){return this._data},summariesFor:function(columnKey){return this._data[columnKey]},_addDataResult:function(columnKey,resElement){var d=this._data[columnKey],i,dLen;if(d===null||d===undefined){this._data[columnKey]=[];this._data[columnKey].push(resElement);return}dLen=d.length;for(i=0;i<dLen;i++){if(d[i].type.toLowerCase()===resElement.type.toLowerCase()){d[i]=resElement;break}}if(i===dLen){this._data[columnKey].push(resElement)}},_removeDataResult:function(columnKey,methodName){var d=this._data[columnKey];if(d===undefined||d===null){return}d=$.grep(d,function(n){return n.type.toLowerCase()!==methodName.toLowerCase()});this._data[columnKey]=d},_getDataByKeyMethodName:function(columnKey,methodName){var i,d=this._data[columnKey],dLength,res=null;methodName=methodName.toLowerCase();if(d===undefined||d===null){return null}dLength=d.length;for(i=0;i<dLength;i++){if(d[i].type.toLowerCase()===methodName){return d[i]}}return res},_renderFooterColumnInfo:function(columnKey,data){if(data===null||data===undefined){return}var i,j,methodName,result,decimalDisplay,footerRowId,$footerRow,order,compactRenderingMode=this.options.compactRenderingMode,dataLength=data.length,min,swapElement;if(compactRenderingMode===true||this.options.compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===true){if(dataLength>1){for(i=0;i<dataLength;i++){min=i;for(j=i+1;j<dataLength;j++){if(data[j].order<data[min].order){swapElement=data[j];data[j]=data[min];data[min]=swapElement;min=j}}}}for(i=0;i<dataLength;i++){if(this._summariesRows[i]===undefined||this._summariesRows[i]===null||data[i]===undefined||data[i]===null){continue}result=data[i].result;decimalDisplay=data[i].decimalDisplay;if(decimalDisplay===undefined||decimalDisplay===null){decimalDisplay=this.defaultDecimalDisplay}if(decimalDisplay!==null&&decimalDisplay!==undefined&&this._isNumber(result)===true){result=parseFloat(result).toFixed(decimalDisplay)}this._renderCellHandler(this._summariesRows[i].type,columnKey,data[i])}}else if(compactRenderingMode===false||this.options.compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===false){for(i=0;i<dataLength;i++){methodName=data[i].type.toLowerCase();footerRowId=this._id("summaries","footer_row",methodName);$footerRow=this.grid.container().find("#"+footerRowId);if($footerRow.length===0){order=data[i].order;if(order===undefined){order=null}this._addDataResult(columnKey,data[0]);this._insertSummariesRows(methodName,order)}this._renderCellHandler(methodName,columnKey,data[i])}}},_renderCell:function(methodName,columnKey,data){var i,resultTemplate=this.options.resultTemplate,column,value=data.result,format,res,parseToDate=false,oColumnType,oColumnFormat,summaryOperand=data.type,rowDisplayLabel=data.rowDisplayLabel,isGridFormatter=data.isGridFormatter,dataType=data.dataType,defaultDecimalDisplay=this.options.defaultDecimalDisplay,decimalDisplay=data.decimalDisplay,isNumber=this._isNumber(value);if(isNumber&&dataType==="bool"){isGridFormatter=false}if(dataType==="date"&&isNumber&&(summaryOperand==="min"||summaryOperand==="max")){parseToDate=true;value=new Date(parseInt(value,10))}if(isGridFormatter===true||isGridFormatter===undefined&&this.options.isGridFormatter===true){column=this._getGridColumnFor(columnKey);if(column!==null){oColumnFormat=column.format;oColumnType=column.dataType;if(isNumber&&!parseToDate){if(this._isNumber(decimalDisplay)||(oColumnFormat===undefined||oColumnFormat===null)&&this._isNumber(defaultDecimalDisplay)||summaryOperand==="count"&&oColumnFormat&&oColumnFormat.indexOf&&oColumnFormat.indexOf(".")===-1&&oColumnFormat!=="0"){if(oColumnFormat===undefined||oColumnFormat===null||decimalDisplay===undefined){decimalDisplay=defaultDecimalDisplay}if(decimalDisplay>0){format="0.";for(i=0;i<decimalDisplay;i++){format+="0"}}else{format="0"}column.format=format}}if(summaryOperand==="count"){column.dataType="number"}value=this.grid._renderCell(value,column);column.format=oColumnFormat;column.dataType=oColumnType}}else if(isNumber&&!parseToDate){if(decimalDisplay===undefined||decimalDisplay===null){decimalDisplay=defaultDecimalDisplay}value=parseFloat(value).toFixed(decimalDisplay)}if(value===null||value===undefined){value=""}if(resultTemplate){res=resultTemplate.replace("{0}",rowDisplayLabel).replace("{1}",value)}else{res=value}this.grid.container().find("#"+this._id("summaries","footer_row_text_container",methodName,columnKey)).html(res)},_getGridColumnFor:function(columnKey){var i,gridColumnsLength=this.grid.options.columns?this.grid.options.columns.length:0;for(i=0;i<gridColumnsLength;i++){if(this.grid.options.columns[i].key===columnKey){return this.grid.options.columns[i]}}return null},_isNumber:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},_columnsCollectionModified:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(this._isSummariesRowsHidden===true){return}this._clearAllRows();this.calculateSummaries()},_insertSummariesRows:function(methodName,order){methodName=methodName.toLowerCase();var srLength,i,j,srOrder,hasFixed=this.grid.hasFixedColumns(),css=this.css,$grid=this.grid,gridColumns=$grid._visibleColumns(),gridColumnsLength=gridColumns.length,$tfoot=this._tfoot,$td,$tfootFixed,$footer=$grid._footer,footerRowIdFixed,$footerRowFixed,footerRowId=this._id("summaries","footer_row",methodName),$footerRow=$("<tr></tr>").attr("id",footerRowId).attr("data-role","summaryrow"),elem={id:footerRowId,type:methodName,order:order},footerRowCellMousein=function(){$(this).addClass(css.footerRowCellHover)},footerRowCellMouseout=function(){$(this).removeClass(css.footerRowCellHover)};if(hasFixed===true){footerRowIdFixed=this._id("summaries","footer_row",methodName,"fixed");$footerRowFixed=$("<tr></tr>").attr("id",footerRowIdFixed).attr("data-role","summaryrow");$tfootFixed=this.grid.fixedFootersTable().find("tfoot")}if($tfoot===null||$tfoot===undefined){if($footer===undefined||$footer===null||$footer.length===0){$grid._renderFooter();$footer=$grid._footer}if($footer===undefined||$footer===null||$footer.length===0){return}$footer.css("display","");if(this._isVirtualization()===true){$tfoot=this.grid.footersTable().find("tfoot")}else if(this._isFixedFooters()===true){$tfoot=$footer.find("tfoot")}else{$tfoot=$footer}this._tfoot=$tfoot}if($tfoot.attr("id")!==""&&$tfoot.attr("id")!==null&&$tfoot.attr("id")!==undefined){$tfoot=$("#"+$tfoot.attr("id"))}if(order===null){elem.order=this._summariesRows.length;this._summariesRows.push(elem);$footerRow.appendTo($tfoot);if(hasFixed){$footerRowFixed.appendTo($tfootFixed)}}else{srLength=this._summariesRows.length;if(srLength===0){this._summariesRows.push(elem);$footerRow.appendTo($tfoot);if(hasFixed){$footerRowFixed.appendTo($tfootFixed)}}else{if(this.options.compactRenderingMode===true||this.options.compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===true){$footerRow.appendTo($tfoot);if(hasFixed){$footerRowFixed.appendTo($tfootFixed)}this._summariesRows.push(elem)}else if(this.options.compactRenderingMode===false||this.options.compactRenderingMode==="auto"&&this._analyzeAutoCompactRenderingMode()===false){for(i=0;i<srLength;i++){srOrder=this._summariesRows[i].order;if(srOrder===undefined||srOrder===null){continue}if(order<=srOrder){$footerRow.insertBefore($("#"+this._id("summaries","footer_row",this._summariesRows[i].type)));if(hasFixed){$footerRowFixed.insertBefore($("#"+this._id("summaries","footer_row",this._summariesRows[i].type,"fixed")))}this._summariesRows.splice(i,0,elem);break}}if(i===srLength){this._summariesRows.push(elem);$footerRow.appendTo($tfoot);if(hasFixed){$footerRowFixed.appendTo($tfootFixed)}}}}}if(this._isVirtualization()&&this.grid.options.virtualizationMode==="fixed"){gridColumnsLength=this.grid._virtualColumnCount}for(j=0;j<gridColumnsLength;j++){$td=$("<td></td>").attr("tabIndex",this.grid.options.tabIndex).attr("aria-describedby",this.grid.id()+"_"+gridColumns[j].key).addClass(css.footerRowCell).attr("data-key",gridColumns[j].key);if(gridColumns[j].fixed===true){$td.appendTo($footerRowFixed);$("#"+footerRowIdFixed+" td.ui-state-default").hover(footerRowCellMousein,footerRowCellMouseout)}else{$td.appendTo($footerRow);$("#"+footerRowId+" td.ui-state-default").hover(footerRowCellMousein,footerRowCellMouseout)}if(j===gridColumnsLength-1&&$grid.options.height&&parseInt($grid.options.height,10)>0){$td.css("width",parseInt(gridColumns[j].width,10)+$grid._scrollbarWidth())}else{$td.css("width",gridColumns[j].width)}this._renderInnerCellMarkup($td,methodName,gridColumns[j].key)}if(hasFixed&&this.grid.hasFixedDataSkippedColumns()&&this.grid.fixingDirection()==="left"){this.grid._footerInit($footerRowFixed,null,true,css.footerRowCell)}else{this.grid._footerInit($footerRow,null,true,css.footerRowCell)}},_renderInnerCellMarkup:function($td,methodName,columnKey){var $textContainer,$iconContainer;$textContainer=$("<div></div>").attr("id",this._id("summaries","footer_row_text_container",methodName,columnKey)).addClass(this.css.footerRowTextContainer).appendTo($td).html(this.options.emptyCellText);$iconContainer=$("<div></div>").attr("id",this._id("summaries","footer_row_icon_container",methodName,columnKey)).addClass(this.css.footerRowIconContainer).insertBefore($textContainer);if($.ig.util.isIE7===true){$iconContainer.addClass(this.css.baseClassIE7)}if(this.options.showDropDownButton===false){$iconContainer.addClass(this.css.footerRowIconContainerEmpty);$textContainer.addClass(this.css.footerRowTextContainerEmpty)
}},_virtualHorizontalScroll:function(event,args){if(this._isRenderedSummariesRows===false){return}var start=args.startColIndex,end=args.endColIndex,i,j,$row,$children,$td,sr=this._summariesRows,srLength=sr.length,columnSetting,columnKey,cols=this.grid._visibleColumns(),self=this;end=start+this.grid._virtualColumnCount;if(srLength>0){$children=sr[0];$.each($children,function(index,element){$("#"+self._id("summaries","methods_dialog",$(element).attr("data-key"))).remove()})}for(i=0;i<srLength;i++){$row=$("#"+sr[i].id);$children=$row.children();$children.html("");for(j=start;j<=end;j++){$td=$row.find("td:nth-child("+(j-start+1)+")");$td.html("");if(cols[j]===null||cols[j]===undefined){continue}this._renderInnerCellMarkup($td,sr[i].type,cols[j].key)}}for(i=start;i<end;i++){if(cols[i]!==null&&cols[i]!==undefined){columnKey=cols[i].key;columnSetting=this._getColumnSettingByKey(columnKey);if(columnKey===undefined||columnKey===null){continue}this._renderFooterIconMarkup(sr[0].type,columnKey);this._renderDropDown(columnKey);if(columnSetting===null||columnSetting===undefined){continue}this._renderFooterColumnInfo(columnKey,this._data[columnKey])}}if(this.grid.hasFixedColumns()){this._syncFixedUnfixedRowHeights()}},_isFixedFooters:function(){return this.grid.options.fixedFooters===true&&this.grid.options.height!==null},_isVirtualization:function(){var gridOptions=this.grid.options;return gridOptions.virtualization===true||gridOptions.rowVirtualization===true&&gridOptions.height!==null||gridOptions.columnVirtualization===true&&gridOptions.width!==null},_id:function(){var i,res=this.grid.element[0].id,argumentsLength=arguments.length;if(argumentsLength===0){return null}for(i=0;i<argumentsLength;i++){res+="_"+arguments[i]}return res},_getColumnFixingInstance:function(){return this.grid.element.data("igGridColumnFixing")},_isAllowedMethodName:function(methodName){var defaultMethodName,isAllowed=false,len=this.defaultSummaryMethods.length,i;for(i=0;i<len;i++){defaultMethodName=this.defaultSummaryMethods[i].type;if(defaultMethodName===methodName||defaultMethodName===methodName.substr(0,defaultMethodName.length)){isAllowed=true;break}}return isAllowed},_footerInit:function(owner,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}var rows,i;rows=this.grid.footersTable().find("[data-role=summaryrow]");rows.find("[data-skip=true]").remove();for(i=0;i<rows.length;i++){this.grid._footerInit($(rows[i]),null,true,this.css.footerRowCell)}},_dataSummaries:function(){var ds=this.grid.dataSource;return ds.dataSummaries()},_injectGrid:function(gridInstance){this.grid=gridInstance;if(this.options.type===null){this.options.type=this.grid._inferOpType()}this._detachEvents();this._headerRenderedHandler=$.proxy(this._headerRendered,this);this._footerRenderedHandler=$.proxy(this._footerRendered,this);this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this._headerFooterInitHandler=$.proxy(this._footerInit,this);this._columnsCollectionModifiedHandler=$.proxy(this._columnsCollectionModified,this);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this.grid.element.bind("iggridfooterrendered",this._footerRenderedHandler);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this.grid.element.bind("iggridheaderextracellsmodified",this._headerFooterInitHandler);this.grid.element.bind("iggridcolumnscollectionmodified",this._columnsCollectionModifiedHandler);this._virtualHorizontalScrollHandler=$.proxy(this._virtualHorizontalScroll,this);this.grid.element.bind("iggridvirtualhorizontalscroll",this._virtualHorizontalScrollHandler);this._initColumnSettings();this._setDataSourceColumnSettingsOptions();if(this.grid.element.igGridFeatureChooser!==undefined){this.grid.element.igGridFeatureChooser()}else{throw new Error($.ig.GridSummaries.locale.featureChooserNotReferenced)}}});$.extend($.ui.igGridSummaries,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Multi Headers 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridMultiColumnHeaders",{css:{multiHeaderCell:"ui-iggrid-multiheader-cell"},options:{inherit:false},_createWidget:function(){$.Widget.prototype._createWidget.apply(this,arguments)},_renderingMultiColumnHeader:function(){this._renderHeaderColumns(this.grid._headerParent);this.grid._trigger(this.grid.events.headerRendered,null,{owner:this.grid,table:this.grid.headersTable()});this.grid._headerRenderCancel=false},_analyzeRowspanRows:function(oldCols,level){var i,col,groups=[],ml=this.grid._maxLevel-level,rowspan;for(i=0;i<oldCols.length;i++){rowspan=1;col=oldCols[i];if($.type(col.rowspan)==="string"){col.rowspan=parseInt(col.rowspan,10)}if(col.rowspan>0){rowspan=col.rowspan}if(col.group!==undefined&&col.group!==null){groups.push({group:col.group,level:level+rowspan})}else{if(col.level===0){if(col.rowspan===null||col.rowspan===undefined||isNaN(col.rowspan)){if(ml+1-col.level>0){col.rowspan=ml+1-col.level}}}}if(this._rows[ml]===undefined||this._rows[ml]===null){this._rows[ml]=[]}this._rows[ml].push(col)}for(i=0;i<groups.length;i++){this._analyzeRowspanRows(groups[i].group,groups[i].level)}},_renderRow:function(headerContainer,row,level){var col,i,$headerCell,$tr=$('<tr data-mch-level="'+level+'" role="row"></tr>').appendTo(headerContainer);for(i=0;i<row.length;i++){col=row[i];$headerCell=this._createHeaderColumnMarkup(col);$headerCell.appendTo($tr)}},_renderHeaderColumns:function($container){var $th,i,j,k,oldCols,parents,key,headersTable,parentCol,mchElement,cols=this.grid.options.columns,mchChildren,isToHide,colsLength=cols.length,initHiddenCols=this.grid._initialHiddenColumns,gridId=this.grid.id(),$thead;this._arrayTargetRowspan=[];this._totalColumnsLength=$container.find("colgroup col").length;$thead=$container.find("thead");if($thead.length>0){$container=$thead.empty().attr("role","rowgroup")}else{$container=$('<thead role="rowgroup"></thead>').appendTo($container)}this._tr={};oldCols=this.grid._oldCols;this._rows={};this._analyzeRowspanRows(oldCols,0);for(i=this.grid._maxLevel;i>=0;i--){if(this._rows[i]!==null&&this._rows[i]!==undefined){this._renderRow($container,this._rows[i],i)}}for(i=0;i<colsLength;i++){$th=this.grid.container().find("#"+gridId+"_"+cols[i].key).data("columnIndex",i);$th.data("data-mch-order",i);this.grid._headerCells.push($th)}if(initHiddenCols){headersTable=this.grid.headersTable().find("thead");for(i=0;i<initHiddenCols.length;i++){key=initHiddenCols[i].key;this.grid.container().find("#"+gridId+"_"+key).css("display","none");parents=this.grid._getParentsMultiHeader(key);for(j=0;j<parents.length;j++){parentCol=parents[j];if(parentCol.level>0){mchElement=this.grid._getMultiHeaderColumnById(parentCol.identifier);if(mchElement&&mchElement.children){mchChildren=mchElement.children;isToHide=true;if(mchElement.hidden!==true){for(k=0;k<mchChildren.length;k++){if(mchChildren[k].level===0){$th=this.grid.container().find("#"+gridId+"_"+mchChildren[k].key)}else{$th=headersTable.find("th[data-mch-id="+mchChildren[k].identifier+"]")}if(!$th.is(":visible")){isToHide=false;break}}}if(isToHide){headersTable.find("th[data-mch-id="+parentCol.identifier+"]").css("display","none")}}}}}}},_createHeaderColumnMarkup:function(col){var grid=this.grid,id,isMultiColumnHeader=true,headerClass=grid.css.headerClass,customClass=col.headerCssClass||"",$th=$("<th></th>"),$headerCell,childIds="",i,length;if(col.group){length=col.group.length;for(i=0;i<length;i++){childIds+=this.grid.element[0].id+"_"+col.group[i].key+(i===length-1?"":" ")}}$headerCell=$th.append('<span class="'+grid.css.headerTextClass+'">'+col.headerText+"</span>").attr({role:"columnheader","aria-label":col.headerText,tabIndex:grid.options.tabIndex}).addClass(headerClass).addClass(customClass);if(col.colspan>1){$th.attr("colspan",col.colspan)}if(col.rowspan>1){$headerCell.attr("rowspan",col.rowspan)}if(col.key){$headerCell.attr("id",this.grid.element[0].id+"_"+col.key)}if(col.level===0){id=col.key;isMultiColumnHeader=false;$headerCell.attr("data-isheadercell",true)}else{id=col.identifier;$headerCell.addClass(this.css.multiHeaderCell);$headerCell.attr("data-mch-id",col.identifier);if(childIds){$headerCell.attr("aria-owns",childIds)}}grid._trigger(grid.events.headerCellRendered,null,{owner:grid,th:$headerCell,columnKey:id,isMultiColumnHeader:isMultiColumnHeader});return $headerCell},getMultiColumnHeaders:function(){return this.grid._oldCols},destroy:function(){$.Widget.prototype.destroy.call(this);return this},_injectGrid:function(gridInstance){this.grid=gridInstance;if(this.grid.options.virtualizationMode!=="continuous"&&(this.grid.options.virtualization===true&&this.grid.options.width||this.grid.options.columnVirtualization===true)){throw new Error($.ig.igGridMultiColumnHeaders.locale.multiColumnHeadersNotSupportedWithColumnVirtualization)}}});$.extend($.ui.igGridMultiHeaders,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Tooltips 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.3.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.popover.js
 *	infragistics.ui.grid.framework.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){"use strict";$.widget("ui.igGridTooltips",{options:{visibility:"overflow",style:"tooltip",showDelay:500,hideDelay:300,columnSettings:[{columnKey:null,columnIndex:-1,allowTooltips:true,maxWidth:null}],fadeTimespan:150,cursorLeftOffset:10,cursorTopOffset:15,inherit:false},css:{tooltip:"ui-iggrid-tooltip",tooltipContent:"ui-iggrid-tooltip-content"},events:{tooltipShowing:"tooltipShowing",tooltipShown:"tooltipShown",tooltipHiding:"tooltipHiding",tooltipHidden:"tooltipHidden"},_createWidget:function(){this.visible=false;this._canFadeIn=true;this._canFadeOut=true;$.Widget.prototype._createWidget.apply(this,arguments)},destroy:function(){this.grid.element.unbind(".tooltip");if(this.tooltip&&this._registered){if(this.tooltip.data("users")===1){this.tooltip.remove()}else{this.tooltip.data("users",this.tooltip.data("users")-1);this.tooltip.children("[id$='_content']").unbind("pointerenter."+this.grid.id()).unbind("MSPointerEnter."+this.grid.id()).unbind("pointerleave."+this.grid.id()).unbind("MSPointerLeave."+this.grid.id()).unbind("mouseenter."+this.grid.id()).unbind("mouseleave."+this.grid.id())}}if(this.ruler&&this._registered){if(this.ruler.data("users")===1){this.ruler.remove()}else{this.ruler.data("users",this.ruler.data("users")-1)}}this._registered=false;$.Widget.prototype.destroy.call(this);return this},id:function(){return this.tooltip[0].id},_injectGrid:function(gridInstance,isRebind){if(isRebind===true){return}this.grid=gridInstance;this._createHandlers();this._unregisterGridEvents();this._registerGridEvents()},_createTooltip:function(){var existingTooltip=this.grid._rootContainer().children("[id$='_tooltips']"),tooltipContent,closeButton=$.ig.util.isTouch;if(existingTooltip.length>0){this.tooltip=existingTooltip;this.tooltip.data("users",this.tooltip.data("users")+1)}else{if(this.options.style==="tooltip"){this.tooltip=$("<div></div>").attr("id",this.grid.id()+"_tooltips").attr("role","tooltip").addClass("ui-tooltip").addClass("ui-widget").addClass("ui-corner-all").addClass("ui-widget-content").addClass(this.css.tooltip).css({position:"absolute",display:"none","white-space":"normal","word-wrap":"break-word"});$("<div></div>").attr("id",this.id()+"_content").addClass("ui-tooltip-content").addClass(this.css.tooltipContent).appendTo(this.tooltip)}else if(this.options.style==="popover"){this.tooltip=$("<div><div>").attr("id",this.grid.id()+"_tooltips").igPopover({animationDuration:this.options.fadeTimespan,maxHeight:"auto",headerTemplate:{closeButton:closeButton}})}this.tooltip.data("users",1)}if(this.options.style==="tooltip"){tooltipContent=this.tooltip.children("[id$='_content']");if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled){tooltipContent.bind("MSPointerEnter."+this.grid.id(),$.proxy(this._tooltipMouseEnter,this)).bind("pointerenter."+this.grid.id(),$.proxy(this._tooltipMouseEnter,this)).bind("MSPointerLeave."+this.grid.id(),$.proxy(this._tooltipMouseLeave,this)).bind("pointerleave."+this.grid.id(),$.proxy(this._tooltipMouseLeave,this))}else{tooltipContent.bind("mouseenter."+this.grid.id(),$.proxy(this._tooltipMouseEnter,this)).bind("mouseleave."+this.grid.id(),$.proxy(this._tooltipMouseLeave,this))}}this.tooltip.appendTo(this.grid._rootContainer())},_createRuler:function(){var existingRuler=this.grid._rootContainer().children("[id$='_ruler']");if(existingRuler.length>0){this.ruler=existingRuler;this.ruler.data("users",this.ruler.data("users")+1)}else{this.ruler=$("<div></div>").attr("id",this.id()+"_ruler").css("visibility","hidden").appendTo(this.grid._rootContainer());this.ruler.data("users",1)}},_displayOverflow:function(element){var ruler=this.ruler,cellTextHeight,dcell=element[0];ruler.text(element.text());ruler.css({"font-family":element.css("font-family"),"font-size":element.css("font-size"),"font-size-adjust":element.css("font-size-adjust"),"font-stretch":element.css("font-stretch"),"font-style":element.css("font-style"),"font-variant":element.css("font-variant"),"font-weight":element.css("font-weight"),"border-left":element.css("border-left"),"border-right":element.css("border-right"),"padding-left":element.css("padding-left"),"padding-top":element.css("padding-top"),"padding-right":element.css("padding-right"),"padding-bottom":element.css("padding-bottom"),overflow:element.css("overflow"),"white-space":element.css("white-space"),"word-break":element.css("word-break")});ruler.width(element.width());cellTextHeight=ruler.height();ruler.css({overflow:"visible","white-space":"normal","word-break":"break-all"});return dcell.offsetWidth<dcell.scrollWidth||dcell.scrollWidth>dcell.clientWidth||cellTextHeight<ruler.height()},_gridHeaderRendering:function(event,ui){if(ui.owner.id()!==this.grid.id()){return}this._createTooltip();this._createRuler();this._registered=true},_dataRendered:function(event,ui){var $tbody,$tbodyFixed;if(ui!==undefined){if($(ui.owner.element).attr("id")!==this.grid.id()){return}}if(!this.tooltip){this._createTooltip();this._createRuler();this._registered=true}$tbody=this.grid.element.children("tbody");this._registerMouseEvents($tbody);if(this.grid.hasFixedColumns()){$tbodyFixed=this.grid.fixedTable().find("tbody");this._registerMouseEvents($tbodyFixed)}if(this.grid.options.fixedHeaders===true){this._$thead=this.grid.headersTable().find("thead")}else{this._$thead=this.grid.container().find("#"+this.grid.id()+" thead")}},_rowsRendered:function(event,ui){var tbody;if(ui!==undefined){if($(ui.owner.element).attr("id")!==this.grid.id()){return}}tbody=this.grid.element.children("tbody");this._registerMouseEvents(tbody);if(this.grid.hasFixedColumns()){tbody=this.grid.fixedTable().find("tbody");this._registerMouseEvents(tbody)}},_registerMouseEvents:function(tbody){var binding;if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled){binding={"MSPointerLeave.tooltip":this._gridMouseLeaveHandler,"pointerleave.tooltip":this._gridMouseLeaveHandler,"MSPointerMove.tooltip":this._gridMouseMoveHandler,"pointermove.tooltip":this._gridMouseMoveHandler};tbody.unbind(binding).bind(binding)}else{binding={"mouseleave.tooltip":this._gridMouseLeaveHandler,"mousemove.tooltip":this._gridMouseMoveHandler};tbody.unbind(binding).bind(binding)}},_gridMouseLeave:function(){clearTimeout(this.timeoutShowing);clearTimeout(this.timeoutHiding);if(this.tooltip.css("display")!=="none"){this._hideTooltip(true)}this._currentlyHovered=null},_gridMouseMove:function(event){var element=$(event.target).closest("td,th"),elementData,hidePrevious=true,shouldShow,hasFixedCols=this.grid.hasFixedColumns(),isFixedElement=this.grid._isFixedElement(element);if(element.closest("table").attr("id")!==this.grid.id()&&!isFixedElement||hasFixedCols&&isFixedElement&&element.closest("table").attr("id")!==this.grid.id()+"_fixed"){return}this.mouseX=event.pageX!==undefined?event.pageX:event.originalEvent.pageX;this.mouseY=event.pageY!==undefined?event.pageY:event.originalEvent.pageY;if(element[0]===this._currentlyHovered||element.length===0){return}elementData=this._getElementValue(element);if(elementData===undefined){hidePrevious=true}if(element[0]===this._currentlyDisplayed&&this.visible===true){hidePrevious=false;clearTimeout(this.timeoutHiding);return}this._currentlyHovered=element[0];this._previouslyHoveredData=this._currentlyHoveredData;this._currentlyHoveredData=elementData;clearTimeout(this.timeoutShowing);shouldShow=this._shouldShowForTarget(element)&&elementData!==undefined&&elementData!==""&&$(event.target).attr("unselectable")===undefined;if(this.visible===true&&hidePrevious===true){this._hideTooltip(!shouldShow)}if(shouldShow===true){this._currentlyDisplayed=this._currentlyHovered;this._showTooltip()}},_tooltipMouseEnter:function(){if(this.timeoutHiding!==null&&this.timeoutHiding!==undefined){clearTimeout(this.timeoutHiding)}},_tooltipMouseLeave:function(){this._hideTooltip()},_getColumnFixingInstance:function(){if(!this._columnFixing&&this.grid.element.data("igGridColumnFixing")){this._columnFixing=this.grid.element.data("igGridColumnFixing")}return this._columnFixing},_getDataView:function(){return this.grid.dataSource.dataView()},_getRowIndex:function(element,row){return element.closest("tbody").children("tr:not([data-container='true'],[data-grouprow='true'])").index(row)},_getElementValue:function(element){var col,val,tlog,i,tid,row=element.closest("tr"),key,hasFixedCols=this.grid.hasFixedColumns(),hskip=0,cf,rec,sri=this.grid._startRowIndex||0;if(this.grid.options.virtualization||this.grid.options.columnVirtualization){hskip=this.grid._startColIndex||0}if(hasFixedCols){cf=this._getColumnFixingInstance();if(element.is("th")||element.attr("data-skip")){col=-1}else{col=element.index();key=cf._getKeyByVisibleIndex(col,this.grid._isFixedElement(element))}}else{if(this._$thead.length>0){col=element.index()-this._$thead.children(":first").children("th[data-skip='true']").length+hskip}else{col=element.index()-element.parent().find("td[data-parent='true'],td[data-skip='true'],th").length+hskip}}if(col<0){return val}if(!key){key=this.grid._visibleColumns()[col].key}this._pRowIdx=this._rowIdx;this._rowIdx=this._getRowIndex(element,row);if(this.grid.options.virtualization||this.grid.options.rowVirtualization){this._rowIdx+=sri}tlog=this.grid.dataSource.pendingTransactions();tid=parseInt(element.parent().attr("data-id"),10);for(i=tlog.length-1;i>=0;i--){if(tlog[i].type==="deleterow"){continue}if(tlog[i].type==="cell"){if(tlog[i].rowId===tid&&tlog[i].col===key){rec=$.extend(true,{},this.grid.dataSource.findRecordByKey(tlog[i].rowId));rec[key]=tlog[i].value;val=this.grid.dataSource.getCellValue(key,rec);break}}else{if(tlog[i].rowId===tid){val=this.grid.dataSource.getCellValue(key,tlog[i].row);break}}}if(val===undefined&&this._getDataView()[this._rowIdx]!==undefined){val=this.grid.dataSource.getCellValue(key,this._getDataView()[this._rowIdx])}if($.type(val)==="date"){if(this.grid.options.enableUTCDates===true){val=$.ig.formatter(val,"date","dateTime",true,this.grid.options.enableUTCDates)}}return val},_shouldShowForTarget:function(element){var shouldShow=true,dataIdx,hasFixedColumns=this.grid.hasFixedColumns(),col;switch(this.options.visibility){case"always":break;case"never":shouldShow=false;break;case"overflow":shouldShow=this._displayOverflow(element);break}if(shouldShow===false){return false}dataIdx=element.parent().children("td:not([data-parent],[data-skip='true'])").index(element);this._pColumnIdx=this._columnIdx;if(this.grid._isMultiColumnGrid){this._columnIdx=dataIdx}else{if(hasFixedColumns&&element.closest("[data-fixed-container]").length===1){this._columnIdx=this.grid.fixedHeadersTable().find("thead th[id]").not("[data-skip='true']").eq(dataIdx).data("columnIndex")}else{this._columnIdx=this._$thead.find("th[id]").not("[data-skip='true']").eq(dataIdx).data("columnIndex")}}if(this._columnIdx===undefined||this._columnIdx===null){this._columnIdx=dataIdx}if(this._columnIdx<0||this._columnIdx>=this.grid.options.columns.length){return false}this._pColumnKey=this._columnKey;if(hasFixedColumns){col=this.grid.getColumnByTD(element);if(col){this._columnKey=col.column.key}}else{if(this.grid._isMultiColumnGrid){this._columnKey=this.grid._visibleColumns()[dataIdx].key}else{this._columnKey=this.grid.options.columns[this._columnIdx].key}}return shouldShow&&this._shouldShowForColumn()},_shouldShowForColumn:function(){var i,colSettings=this.options.columnSettings;for(i=0;i<colSettings.length;i++){if(colSettings[i].columnKey===this._columnKey||colSettings[i].columnIndex===this._columnIdx){return colSettings[i].allowTooltips!==undefined?colSettings[i].allowTooltips:true}}return true},_hideTooltip:function(current){var self=this,args,fn;args={owner:this,tooltip:current===true?String(this._currentlyHoveredData):String(this._previouslyHoveredData),value:current===true?this._currentlyHoveredData:this._previouslyHoveredData,element:this._currentlyDisplayed,columnKey:current===true?this._columnKey:this._pColumnKey,index:current===true?this._rowIdx:this._pRowIdx,columnIndex:current===true?this._columnIdx:this._pColumnIdx};fn=function(){var noCancel=self._trigger(self.events.tooltipHiding,self,args);if(noCancel===true){self._hideTooltipNoDelay();self._trigger(self.events.tooltipHidden,self,args)}};if($.ig.util.isTouch){fn()}else{clearTimeout(this.timeoutHiding);this.timeoutHiding=setTimeout(fn,this.options.hideDelay)}},_showTooltip:function(){var self=this,args,fn;args={owner:this,tooltip:String(this._currentlyHoveredData),value:this._currentlyHoveredData,element:this._currentlyDisplayed,columnKey:this._columnKey,index:this._rowIdx,columnIndex:this._columnIdx};fn=function(){var noCancel=self._trigger(self.events.tooltipShowing,self,args);if(noCancel===true){self._showTooltipNoDelay(args.tooltip);self._trigger(self.events.tooltipShown,self,args)}};if($.ig.util.isTouch){fn()}else{this.timeoutShowing=setTimeout(fn,this.options.showDelay)}},_hideTooltipNoDelay:function(){if(this.options.style==="tooltip"){if(this._canFadeOut===true){this._canFadeOut=false;this.tooltip.fadeOut(this.options.fadeTimespan,$.proxy(this._fadeOutEnd,this))}}else if(this.options.style==="popover"){this.tooltip.igPopover("hide")}this.visible=false},_showTooltipNoDelay:function(value){var tooltip;if(this._currentlyDisplayed===null){return}clearTimeout(this.timeoutHiding);tooltip=$("#"+this.id());if(this.options.style==="tooltip"){this._updateTooltip(value);if(this._canFadeIn===true){this._canFadeIn=false;tooltip.fadeIn(this.options.fadeTimespan,$.proxy(this._fadeInEnd,this))}}else if(this.options.style==="popover"){tooltip.igPopover("show",$(this._currentlyDisplayed),value)}this.visible=true},_fadeOutEnd:function(){this._canFadeOut=true},_fadeInEnd:function(){this._canFadeIn=true},_updateTooltip:function(value){var tooltipContent=this.tooltip.children("[id$='_content']");tooltipContent.text(value);tooltipContent.parent().css("max-width",this._getMaxWidth(this._columnKey,this._columnIdx,this._currentlyDisplayed));this._positionTooltip(tooltipContent.parent())},_getMaxWidth:function(colKey,colIdx,td){var colSettings=this.options.columnSettings,i;for(i=0;i<colSettings.length;i++){if(colSettings[i].columnKey===colKey||colSettings[i].columnIndex===colIdx){if(colSettings[i].maxWidth!==null&&colSettings[i].maxWidth!==undefined){return colSettings[i].maxWidth}break}}return $(td).width()},_positionTooltip:function(tooltip){var win=$(window),left,top,toffset,tfullw=tooltip.outerWidth(),tfullh=tooltip.outerHeight();toffset=$.ig.util.getRelativeOffset(tooltip);left=this.mouseX-toffset.left+this.options.cursorLeftOffset;top=this.mouseY-toffset.top+this.options.cursorTopOffset;if(left+tfullw+win.scrollLeft()>win.width()){left=win.width()-toffset.left-tfullw+win.scrollLeft()}if(top+tfullh+toffset.top>win.height()+win.scrollTop()){top=win.height()-toffset.top-tfullh+win.scrollTop()}tooltip.css({top:top,left:left})},_fixedColumnsChanged:function(fObj){var $tbodyFixed;if(fObj.isToFix&&fObj.isInit){$tbodyFixed=this.grid.fixedTable().find("tbody");this._registerMouseEvents($tbodyFixed)}},_createHandlers:function(){this._rowsRenderedHandler=$.proxy(this._rowsRendered,this);this._gridMouseLeaveHandler=$.proxy(this._gridMouseLeave,this);this._gridMouseMoveHandler=$.proxy(this._gridMouseMove,this);this._gridHeaderRenderingHandler=$.proxy(this._gridHeaderRendering,this)},_registerGridEvents:function(){this.grid.element.bind("iggridrowsrendered.tooltip",this._rowsRenderedHandler);this.grid.element.bind("iggridheaderrendering.tooltip",this._gridHeaderRenderingHandler)},_unregisterGridEvents:function(){this.grid.element.unbind("iggridrendered.tooltip",this._dataRenderedHandler);this.grid.element.unbind("iggridheaderrendering.tooltip",this._gridHeaderRenderingHandler)}});$.extend($.ui.igGridTooltips,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid Multi Headers 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.dataSource.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){var _aNull=function(val){return val===null||val===undefined};$.widget("ui.igGridColumnFixing",{renderInFeatureChooser:true,events:{columnFixing:"columnFixing",columnFixed:"columnFixed",columnUnfixing:"columnUnfixing",columnUnfixed:"columnUnfixed",columnFixingRefused:"columnFixingRefused",columnUnfixingRefused:"columnUnfixingRefused"},css:{fixedContainer:"ui-iggrid-fixedcontainer",headerButtonIconContainer:"ui-iggrid-fixcolumn-headerbuttoncontainer",leftFixedContainer:"ui-iggrid-fixedcontainer-left",rightFixedContainer:"ui-iggrid-fixedcontainer-right",headerButtonIcon:"ui-icon ui-corner-all ui-icon-pin-w",headerButtonIconHover:"",headerButtonUnfixIcon:"ui-icon ui-corner-all ui-icon-pin-s",featureChooserIconClassFixed:"ui-icon ui-iggrid-icon-unfix",featureChooserIconClassUnfixed:"ui-icon ui-iggrid-icon-fix",unfixedTableLeft:"ui-iggrid-unfixed-table-left",unfixedTableRight:"ui-iggrid-unfixed-table-right"},internalErrors:{none:$.ig.ColumnFixing.locale.internalErrors.none,notValidIdentifier:$.ig.ColumnFixing.locale.internalErrors.notValidIdentifier,fixingRefused:$.ig.ColumnFixing.locale.internalErrors.fixingRefused,fixingRefusedMinVisibleAreaWidth:$.ig.ColumnFixing.locale.internalErrors.fixingRefusedMinVisibleAreaWidth,alreadyHidden:$.ig.ColumnFixing.locale.internalErrors.alreadyHidden,alreadyUnfixed:$.ig.ColumnFixing.locale.internalErrors.alreadyUnfixed,alreadyFixed:$.ig.ColumnFixing.locale.internalErrors.alreadyFixed,unfixingRefused:$.ig.ColumnFixing.locale.internalErrors.unfixingRefused,targetNotFound:$.ig.ColumnFixing.locale.internalErrors.targetNotFound},options:{headerFixButtonText:$.ig.ColumnFixing.locale.headerFixButtonText,headerUnfixButtonText:$.ig.ColumnFixing.locale.headerUnfixButtonText,showFixButtons:true,syncRowHeights:true,scrollDelta:40,fixingDirection:"left",columnSettings:[{columnKey:null,columnIndex:null,allowFixing:true,isFixed:false}],featureChooserTextFixedColumn:$.ig.ColumnFixing.locale.featureChooserTextFixedColumn,featureChooserTextUnfixedColumn:$.ig.ColumnFixing.locale.featureChooserTextUnfixedColumn,minimalVisibleAreaWidth:30,fixNondataColumns:true,populateDataRowsAttributes:true},scrollContainerCheckValue:2,_createWidget:function(){this._fcData={};this._tds={};this._containers={};this._colgroups={};this._isInitFC=false;this._isFunctionsOverriden=false;$.Widget.prototype._createWidget.apply(this,arguments)},_unfixColumnInternal:function(colKey,target,after){var noCancel,res={error:true},grid=this.grid,isGroupHeader=this.isGroupHeader(colKey);noCancel=this._trigger(this.events.columnUnfixing,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,owner:grid});if(noCancel){res=this.unfixColumn(colKey,target,after);if(res.result===false){this._trigger(this.events.columnUnfixingRefused,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,errorMessage:res.error,owner:grid})}else{this._trigger(this.events.columnUnfixed,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,owner:grid})}}return res},unfixColumn:function(colIdentifier,target,after){if($.type(arguments[1])==="boolean"){target=arguments[2];after=arguments[3]}var col,res,children,isGroupHeader,colKey,mch,grid=this.grid,cols,aObj;isGroupHeader=this.isGroupHeader(colIdentifier);res={error:this.internalErrors.none,result:true,col:null,isGroupHeader:isGroupHeader};if(!isGroupHeader){col=this._getColById(colIdentifier);res.col=col;if(!col){res.result=false;res.error=this.internalErrors.notValidIdentifier;return res}res.col=col;colKey=col.key;children=[col];res.id=colKey}else{colKey=colIdentifier;res.id=colKey;mch=grid._getMultiHeaderColumnById(colIdentifier);if(!mch){res.result=false;res.error=this.internalErrors.notValidIdentifier;return res}res.col=mch;children=mch.children}res.children=children;res=this._couldPerformUnfixing(res,target);if(!res.result){return res}if(!target){cols=grid._isMultiColumnGrid?grid._oldCols:grid.options.columns;$.each(cols,function(i,c){if(c.fixed!==true&&!!!c.hidden){target=c.key||c.identifier;return false}});after=false}this._performDomColumnMove(res,target,after,false);aObj=this._rearrangeColumns(colKey,target,after,false);grid._hasFixedColumns=!!grid._fixedColumns.length||grid.hasFixedDataSkippedColumns();this._refreshDOMOnUnfixing(res);grid._onFixedColumnsChanged({isToFix:false,id:colIdentifier,colWidth:res.colWidth,children:res.children,isGroupHeader:isGroupHeader,start:aObj.from.dIndex,length:aObj.from.children.length,at:aObj.at.dIndex});if(grid._fixedColumns.length===0&&this._getDataSkippedColumnsLength(true)&&!this.options.fixNondataColumns){this.unfixNonDataColumns()}return res},checkAndSyncHeights:function(){if(!this.grid.hasFixedColumns()){return}if(!this._containers||!this._containers.body){this._populateContainers()}var c=this._containers,hTbl=c.header||c.body,fTbl=c.footer||c.body;this._checkAndSyncHeightsForTables(hTbl.fixedTable,hTbl.unfixedTable,"thead");this._checkAndSyncHeightsForTables(c.body.fixedTable,c.body.unfixedTable,"tbody");this._checkAndSyncHeightsForTables(fTbl.fixedTable,fTbl.unfixedTable,"tfoot")},_checkAndSyncHeightsForTables:function($fTbl,$ufTbl,selector){selector=selector||"tbody";var h,fH,ufH,uftblH,$fTrs=$fTbl.children(selector).children("tr"),$ufTrs=$ufTbl.children(selector).children("tr"),$fLastTr=$fTrs.last(),$ufLastTr=$ufTrs.last();uftblH=$ufTbl[0].style.height;$fTbl.height("");$ufTbl.height("");if($fLastTr.length>0&&(Math.abs($fTbl.outerHeight()-$ufTbl.outerHeight())>1||Math.abs($fLastTr.offset().top-$ufLastTr.offset().top)>1)){this.syncRowsHeights($fTrs,$ufTrs);fH=$fTbl.height();ufH=$ufTbl.height();h=ufH;if(fH>ufH){h=fH}$fTbl.height(h);$ufTbl.height(h)}else if(uftblH){$ufTbl[0].style.height=uftblH;$fTbl[0].style.height=uftblH}},_syncTableHeights:function(){$("#"+this.grid.id()+"_fixed").height(this.grid.element.height())},_getKeyByVisibleIndex:function(index,isFixed){var col;isFixed=!!isFixed;index-=this._getDataSkippedColumnsLength(isFixed);col=this.grid._visibleColumns(isFixed)[index];return col?col.key:undefined},_setOption:function(key,value){if(value===this.options[key]){return}$.Widget.prototype._setOption.apply(this,arguments);if(key==="minimalVisibleAreaWidth"){this.grid._visibleAreaWidth(value)}},_gridSetOption:function(key,value){var w=value,grid=this.grid,fcw;if(!grid.hasFixedColumns()){return}if(key==="width"){if(w.indexOf&&w.indexOf("%")>0){throw new Error($.ig.ColumnFixing.locale.columnsWidthShouldBeSetInPixels)}w=parseInt(value,10);fcw=grid.fixedContainer().outerWidth();if(fcw===null){fcw=grid.fixedBodyContainer().outerWidth()}if(w-fcw<parseInt(this.options.minimalVisibleAreaWidth,10)){throw new Error($.ig.ColumnFixing.locale.setOptionGridWidthException)}}},isGroupHeader:function(colKey){if(this.grid._isMultiColumnGrid&&!this.grid.columnByKey(colKey)){return true}return false},_fixColumnInternal:function(colKey,target,after){var noCancel,res={error:true},grid=this.grid,isGroupHeader=this.isGroupHeader(colKey);noCancel=this._trigger(this.events.columnFixing,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,owner:grid});if(noCancel){res=this.fixColumn(colKey,target,after);if(res.error===this.internalErrors.fixingRefused||res.result===false){this._trigger(this.events.columnFixingRefused,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,errorMessage:res.error,owner:grid})}else{this._trigger(this.events.columnFixed,null,{columnIdentifier:colKey,isGroupHeader:isGroupHeader,owner:grid})}}return res},_isVirtualGrid:function(){var gridOptions=this.grid.options;return gridOptions.virtualization===true||gridOptions.rowVirtualization===true},_isContinuousVirtualization:function(){return this._isVirtualGrid()&&this.grid.options.virtualizationMode==="continuous"},_getColById:function(colId){if($.type(colId)==="string"){return this.grid.columnByKey(colId)}return this.grid.options.columns[colId]},_updateWidths:function(colWidth){var $fArea,$ufArea,grid=this.grid,v=this._isVirtualGrid(),$fCntnr=this._mainFixedCntnr,w;if(grid.options.fixedHeaders){$fArea=this._containers.header.fixedTable;$ufArea=this._containers.header.unfixedTable;this._updateTblWidths($fArea,$ufArea,colWidth)}$fArea=this._containers.body.fixedTable;$ufArea=grid.element;this._updateTblWidths($fArea,$ufArea,colWidth);if(grid.options.fixedFooters&&this._containers.footer){$fArea=this._containers.footer.fixedTable;$ufArea=this._containers.footer.unfixedTable;this._updateTblWidths($fArea,$ufArea,colWidth)}if(v){this._updateVirtualDOMWidth(colWidth);return}w=parseFloat($fCntnr[0].style.width||0);$fCntnr[0].style.width=w+colWidth+"px"},_calcTblWidth:function($tbl,delta){var styleWidth=$tbl[0].style.width,w;if($.type(styleWidth)==="string"&&styleWidth.indexOf("%")>-1){return styleWidth}w=parseInt(styleWidth,10)||0;if(w===0){$tbl.find(">colgroup>col").each(function(ind,col){w+=parseInt(col.style.width,10)||0})}return w+delta+"px"},_updateTblWidths:function($fixedTbl,$unfixedTbl,colWidth){var fW,ufW,fTbl=$fixedTbl[0],ufTbl=$unfixedTbl[0];ufW=this._calcTblWidth($unfixedTbl,-colWidth);fW=this._calcTblWidth($fixedTbl,colWidth);fTbl.style.width=fW;if(ufTbl.style.width||!this.grid._gridHasWidthInPercent()){ufTbl.style.width=ufW}if(this._isVirtualGrid()){$fixedTbl.closest("div")[0].style.width=fW}},_updateVirtualDOMWidth:function(colWidth){var grid=this.grid,w,$col,$cntnr,widthInPerc=grid._gridHasWidthInPercent(),$displCntnr=grid._vdisplaycontainer(),$virtTbl=grid._virtualcontainer(),$virtColgroup=$virtTbl.children("colgroup");$col=$virtColgroup.children("col[data-fixed-col]");w=parseInt($col.attr("width"),10)||0;$col.attr("width",w+colWidth+"px");if(!widthInPerc){$col=$virtColgroup.children("col:not([data-fixed-col])").first();w=parseInt($col.attr("width"),10)||0;$col.attr("width",w-colWidth+"px");if(grid.options.showHeader){$cntnr=$("#"+grid.id()+"_headers_v");$cntnr.width($cntnr.width()-colWidth)}if(grid.options.showFooter){$cntnr=grid._fixedfooters();$cntnr.width($cntnr.width()-colWidth)}$displCntnr.width($displCntnr.width()-colWidth)}},_recalcTableWidths:function(){var c=this._containers;if(c.header){c.header.unfixedTable.width("")}if(c.footer){c.footer.unfixedTable.width("")}this._updateWidths(0)},_swapElements:function(area){var swap=area.from;area.from=area.to;area.to=swap;return area},_analyzeFixingObjects:function(colObj,target){var grid=this.grid,tObj,movedCol={start:-1,length:colObj.children.length},targetCol={start:-1,length:1},vIndFrom,vIndTo;vIndFrom=this.grid.getVisibleIndexByKey(colObj.children[0].key,true);if($.type(target)==="string"){tObj=grid._analyzeColumnByKey(target)}if(_aNull(target)){vIndTo=-1}else{targetCol.length=tObj.children.length;vIndTo=grid.getVisibleIndexByKey(tObj.children[0].key,true)}movedCol.start=vIndFrom;targetCol.start=vIndTo;return{movedCol:movedCol,targetCol:targetCol}},_performDomColumnMove:function(col,target,after,isToFix){var grid=this.grid,oCols,aObj,nW,afc=this._analyzeFixingObjects(col,target),movedCol=afc.movedCol,targetCol=afc.targetCol;movedCol.width=col.colWidth;movedCol.id=col.id;if(grid._isMultiColumnGrid){oCols=jQuery.extend(true,[],grid._oldCols);aObj=grid._analyzeColumnMovingObjects(col.id,target,after,isToFix);grid._rearrangeArray(oCols,aObj.from.dMCHIndex,1,aObj.at.dMCHIndex);movedCol.oCols=oCols;if(movedCol.length>1){nW=0;movedCol.length=$.grep(aObj.from.children,function(col){var v=!col.hidden;nW+=v?parseFloat(col.width):0;return v}).length;movedCol.width=nW}}this._performDomColumnMoveByIndexes(movedCol,targetCol,after,isToFix)},_performDomColumnMoveByIndexes:function(movedCol,targetCol,after,isToFix){var grid=this.grid,area={},$fTbl,$ufTbl,w=isToFix?movedCol.width:-movedCol.width;this._updateWidths(w);$fTbl=grid.fixedHeadersTable();$ufTbl=grid.headersTable();area.from=$fTbl;area.to=$ufTbl;if(isToFix){area=this._swapElements(area)}if(grid.options.fixedHeaders===true){grid._moveCols({from:area.from.children("colgroup"),to:area.to.children("colgroup"),ignoreDataSkip:true},movedCol,targetCol,after)}if(grid._isMultiColumnGrid){if(!movedCol.nonData){this._fixUnfixMCHColumn(movedCol.id,{fixedThead:$fTbl.children("thead"),unfixedThead:$ufTbl.children("thead"),isToFix:isToFix},movedCol.oCols)}else{grid._moveColumnInBodyFooter({trsFrom:area.from.find("thead").children("tr[data-mch-level="+grid._maxLevel+"]"),trsTo:area.to.find("thead").children("tr[data-mch-level="+grid._maxLevel+"]"),ignoreDataSkip:true},movedCol,targetCol,after)}}grid._moveColumnInBodyFooter({trsFrom:area.from.find("thead").children("tr:not([data-mch-level])"),trsTo:area.to.find("thead").children("tr:not([data-mch-level])"),ignoreDataSkip:true},movedCol,targetCol,after);area.from=grid.fixedBodyContainer().children("table");area.to=grid.element;if(isToFix){area=this._swapElements(area)}grid._moveColumnInBodyFooter({trsFrom:area.from.children("tbody").children("tr"),trsTo:area.to.children("tbody").children("tr"),ignoreDataSkip:true},movedCol,targetCol,after);grid._moveCols({from:area.from.children("colgroup"),to:area.to.children("colgroup"),ignoreDataSkip:true},movedCol,targetCol,after);area.from=grid.fixedFootersTable();area.to=grid.footersTable();if(isToFix){area=this._swapElements(area)}if(grid.options.fixedFooters===true){grid._moveCols({from:area.from.children("colgroup"),to:area.to.children("colgroup"),ignoreDataSkip:true},movedCol,targetCol,after)}grid._moveColumnInBodyFooter({trsFrom:area.from.children("tfoot").children("tr"),trsTo:area.to.children("tfoot").children("tr"),ignoreDataSkip:true},movedCol,targetCol,after);this._updateHScrollbarWidth(w)},_getColumnWidth:function(col,$th){var w;if(col.oWidth!==undefined){w=parseInt(col.oWidth,10)}else if(col.width){w=parseInt(col.width,10)}if(!w){$th=$th||this._getTH(col.key);if($th.length===1){w=$th.outerWidth()}}return w},_updateGridWidth:function(){var grid=this.grid;grid._gridContentWidth=grid.element.width();if(!this._isVirtualGrid()){grid._gridInnerWidth=grid.scrollContainer().width();if(grid.options.height){grid._gridInnerWidth+=grid._scrollbarWidth()}}else{grid._gridInnerWidth=grid._vdisplaycontainer().width()+grid._scrollbarWidth()}},_refreshDOMOnUnfixing:function(colObj){var grid=this.grid,fDir=this.options.fixingDirection;this._populateContainers();if($.ig.util.isIE10){grid._hscrollbar().width("")}this._updateGridWidth();grid._columnMovingResets();grid._hscrollbarcontent().scrollLeft(0);if(!colObj.nonData){this._changeStyleHeaderButton(colObj.id,false,colObj.isGroupHeader)}if(this._isVirtualGrid()){grid._scrollContainer().scrollTop(0);this._updateHScrollbarWidth();grid._resetVirtualDom();if(this._isContinuousVirtualization()){grid._setScrollContainerScrollTop(0)}this._rerenderColgroups(true);if(fDir==="right"){this._adjustVirtWidthOnFixingRight(false)}}else{this._containers.body.unfixedContainer.scrollTop(0);if(grid.options.autofitLastColumn&&grid._autoadjustedColumn){this._rerenderColgroups(true)}}if(grid._fixedColumns.length===0&&(!this._getDataSkippedColumnsLength(true)||fDir==="right")){this._removeFixedContainer();if(grid.options.autofitLastColumn&&grid._autoadjustedColumn){this._updateGridWidth();this._rerenderColgroups(true)}}if(this.options.syncRowHeights){this.checkAndSyncHeights()}if(grid._gridHasWidthInPercent()){this._setMinWidthForGridContainer()}grid._updateVerticalScrollbarCellPadding()},_refreshDOMOnFixing:function(id,isInit){var grid=this.grid,fDir=this.options.fixingDirection;this._updateGridWidth();if(isInit){if(this._containers&&this._containers.body){if(fDir==="left"){this._containers.body.unfixedTable.addClass(this.css.unfixedTableLeft)}else{this._containers.body.unfixedTable.addClass(this.css.unfixedTableRight)}}}grid._columnMovingResets();if(!_aNull(id)){this._changeStyleHeaderButton(id,true)}this._containers.body.unfixedContainer.scrollTop(0);if(this._isVirtualGrid()){grid._scrollContainer().scrollTop(0);this._updateHScrollbarWidth();grid._resetVirtualDom();if(isInit){this._attachVirtualizationEvents()}if(this._isContinuousVirtualization()){this._containers.body.fixedContainer.scrollTop(this._containers.body.unfixedContainer.scrollTop())}if(!grid._outerHScrollbar){grid._hscrollbarcontent().css("overflow-y","hidden")}}if(grid.options.autofitLastColumn&&grid._autoadjustedColumn&&grid._autoadjustedColumn.key===id||fDir==="right"&&this._isVirtualGrid()){this._rerenderColgroups()}if(fDir==="right"&&this._isVirtualGrid()){this._adjustVirtWidthOnFixingRight(true)}if(this.options.syncRowHeights){this.checkAndSyncHeights()}if(grid._gridHasWidthInPercent()){this._setMinWidthForGridContainer()}this._checkAndRenderHScrlbarCntnr();grid._hscrollbarcontent().scrollLeft(0);grid._updateVerticalScrollbarCellPadding()},_setMinWidthForGridContainer:function(w){var $fc=this._mainFixedCntnr||this._containers.body.fixedContainer,$gc=this.grid.container();if(this.grid.hasFixedColumns()){w=w||parseFloat($fc[0].style.width)||$fc.outerWidth();w+=parseFloat(this.options.minimalVisibleAreaWidth);$gc.css("min-width",w+"px")}else{$gc.css("min-width","")}},_couldPerformUnfixing:function(colObj,target){var grid=this.grid,mchLevel,$th,tCol;if(!!colObj.col.fixed===false){colObj.result=false;colObj.error=this.internalErrors.alreadyUnfixed;return colObj}if(colObj.col.hidden){colObj.result=false;colObj.error=this.internalErrors.alreadyHidden;return colObj}if(!_aNull(target)){tCol=grid.columnByKey(target);if(!tCol){colObj.result=false;colObj.error=this.internalErrors.targetNotFound.replace("{key}",target);return colObj}if(tCol.fixed){colObj.result=false;colObj.error=this.internalErrors.unfixingRefused;return colObj}}$th=this._getTH(colObj.id);if(grid._isMultiColumnGrid){mchLevel=$th.closest("tr").attr("data-mch-level");if(mchLevel&&parseInt(mchLevel,10)!==grid._maxLevel){colObj.result=false;colObj.error=this.internalErrors.ActionNotAllowedForChildHeaderColumn;return colObj}}colObj.colWidth=this._getColumnWidth(colObj.col,$th);if(!this.checkUnfixingAllowed(colObj.children)){colObj.result=false;colObj.error=this.internalErrors.unfixingRefused;return colObj}return colObj},_couldPerformFixing:function(colObj,target){var grid=this.grid,gridWidth,mchLevel,widthFixedCntr,$th,colWidth,tCol;if(colObj.col.fixed){colObj.result=false;colObj.error=this.internalErrors.alreadyFixed;return colObj}if(colObj.col.hidden||!grid._initialized&&$.inArray(colObj.col,grid._initialHiddenColumns)>-1){colObj.result=false;colObj.error=this.internalErrors.alreadyHidden;return colObj}if(!_aNull(target)){tCol=grid.columnByKey(target);if(!tCol){colObj.result=false;colObj.error=this.internalErrors.targetNotFound.replace("{key}",target);return colObj}if(!tCol.fixed){colObj.result=false;colObj.error=this.internalErrors.fixingRefused;return colObj}}gridWidth=grid.container().outerWidth();$th=this._getTH(colObj.id);if(grid._isMultiColumnGrid){mchLevel=$th.closest("tr").attr("data-mch-level");if(mchLevel&&parseInt(mchLevel,10)!==grid._maxLevel){colObj.result=false;colObj.error=this.internalErrors.ActionNotAllowedForChildHeaderColumn;return colObj}}if(!this.checkFixingAllowed(colObj.children,colObj.isGroupHeader)){colObj.result=false;colObj.error=this.internalErrors.fixingRefused;return colObj}if(grid.hasFixedColumns()){widthFixedCntr=this._containers.body.fixedContainer.outerWidth()}if(isNaN(widthFixedCntr)){widthFixedCntr=0}colWidth=this._getColumnWidth(colObj.col,$th);colObj.colWidth=colWidth;if(colWidth+widthFixedCntr+grid._scrollbarWidth()>=gridWidth-parseInt(this.options.minimalVisibleAreaWidth,10)){colObj.result=false;colObj.error=this.internalErrors.fixingRefusedMinVisibleAreaWidth;return colObj}return colObj},checkFixingAllowed:function(columns){var i,visibleColumnsCount=0;for(i=0;i<columns.length;i++){if(!columns[i].hidden){visibleColumnsCount++}}if(this.grid._visibleColumns(false).length-visibleColumnsCount<1){return false}return this._isFixingUnfixingAllowed(columns,true)},checkUnfixingAllowed:function(columns){return this._isFixingUnfixingAllowed(columns,false)},_isFixingUnfixingAllowed:function(columns,isToFix){var i,columnsLength=columns.length,j,col,columnsInArea=[],oCols=this.grid.options.columns,oColsLength=oCols.length;for(i=0;i<oColsLength;i++){if(!isToFix&&oCols[i].fixed||isToFix&&!oCols[i].fixed){for(j=0;j<columnsLength;j++){col=columns[j];if(col.key===oCols[i].key){break}}if(j===columnsLength){columnsInArea.push(oCols[i])}}}if(columnsInArea.length===0){return true}for(i=0;i<columnsInArea.length;i++){if(!columnsInArea[i].hidden){return true}}return false},_rearrangeColumns:function(colKey,targetKey,after,isToFix){var grid=this.grid,targetColInfo,tInd,aObj=grid._analyzeColumnMovingObjects(colKey,targetKey,after,isToFix);grid._rearrangeArray(grid.options.columns,aObj.from.dIndex,aObj.from.children.length,aObj.at.dIndex);if(aObj.at.dMCHIndex>-1){grid._rearrangeArray(grid._oldCols,aObj.from.dMCHIndex,1,aObj.at.dMCHIndex)}this._setFixingStateByCol(aObj.from.colMCHObj||aObj.from.colObj,isToFix);if(isToFix){targetColInfo=!_aNull(targetKey)?grid._getColumnInfo(targetKey,grid._fixedColumns):null;tInd=!_aNull(targetColInfo)?targetColInfo.index:grid._fixedColumns.length;grid._fixedColumns.insertRange(tInd,aObj.from.children)}else{grid._fixedColumns.splice(grid._getColumnInfo(aObj.from.children[0].key,grid._fixedColumns).index,aObj.from.children.length)}grid._columnMovingResets();return aObj},fixColumn:function(colIdentifier,target,after){if($.type(arguments[1])==="boolean"){target=arguments[2];after=arguments[3]}var col,res,children,isGroupHeader,colKey,aObj,grid=this.grid,mch,fixedCols=grid._fixedColumns,isInit=fixedCols.length===0;isGroupHeader=this.isGroupHeader(colIdentifier);res={error:this.internalErrors.none,result:true,col:null,isInit:isInit,isGroupHeader:isGroupHeader};if(!isGroupHeader){col=this._getColById(colIdentifier);res.col=col;if(!col){res.result=false;res.error=this.internalErrors.notValidIdentifier;return res}res.col=col;colKey=col.key;children=[col];res.id=colKey}else{colKey=colIdentifier;res.id=colKey;mch=this.grid._getMultiHeaderColumnById(colIdentifier);if(!mch){res.result=false;res.error=this.internalErrors.notValidIdentifier;return res}res.col=mch;children=mch.children}res.children=children;res=this._couldPerformFixing(res,target);if(!res.result){return res}after=$.type(after)==="boolean"?after:false;if(isInit&&!this.element.data("fixingApplied")){this._renderMainFixedContainer();this.fixNonDataColumns()}if(!this._containers||!this._containers.body){this._populateContainers()}this._performDomColumnMove(res,target,after,true);aObj=this._rearrangeColumns(colKey,target,after,true);grid._hasFixedColumns=true;this._refreshDOMOnFixing(res.id,res.isInit);grid._onFixedColumnsChanged({isToFix:true,id:colIdentifier,colWidth:res.colWidth,children:res.children,isGroupHeader:isGroupHeader,isInit:isInit,start:aObj.from.dIndex,length:aObj.from.children.length,at:aObj.at.dIndex});return res},_attachVirtualizationEvents:function(){var grid=this.grid;grid.fixedBodyContainer().bind({mouseenter:function(){grid._isMouseOverVirtualTable=true},mouseleave:function(){grid._isMouseOverVirtualTable=false}})},fixNonDataColumns:function(){var grid=this.grid,cols=this._getDataSkippedCols(),w=this._getDataSkippedWidth(false,cols),len=cols.length;if(this.options.fixingDirection==="left"&&len){if(!$("#"+grid.id()+"_mainFixedContainer").length&&!this.element.data("fixingApplied")){this._renderMainFixedContainer()}grid._hasFixedDataSkippedColumns=true;this._performDomColumnMoveByIndexes({start:0,length:len,width:w,nonData:true},{start:-1,length:0},false,true);this._refreshDOMOnFixing(null,true);if(this.options.syncRowHeights){this.checkAndSyncHeights()}if(this._isVirtualGrid()){this.grid._hscrollbarcontent().css("overflow-y","hidden")}this._checkAndRenderHScrlbarCntnr();grid._hasFixedColumns=true;this.grid._onFixedColumnsChanged({isToFix:true,nonData:true,isInit:true,length:len})}},fixDataSkippedColumns:function(){this.fixNonDataColumns()},unfixNonDataColumns:function(){var w,cols=this._getDataSkippedCols(true),len=cols.length;if(this.options.fixingDirection==="left"&&len){w=this._getDataSkippedWidth(true,cols);this._performDomColumnMoveByIndexes({start:0,length:len,width:w,nonData:true},{start:0,length:0},false,false);this.grid._hasFixedColumns=!!this.grid._fixedColumns.length;this.grid._hasFixedDataSkippedColumns=false;this._refreshDOMOnUnfixing({nonData:true,width:w});this.grid._onFixedColumnsChanged({isToFix:false,nonData:true,length:len})}},unfixDataSkippedColumns:function(){this.unfixNonDataColumns()},_getDataSkippedWidth:function(isFixed,cols){var w=0;cols=cols||this._getDataSkippedCols(isFixed);cols.each(function(i,c){w+=parseFloat(c.style.width)});return w},_getDataSkippedCols:function(isFixed){if(!this._containers||!this._containers.body){this._populateContainers()}var $table=isFixed?this._containers.body.fixedTable:this._containers.body.unfixedTable;return $table.find("colgroup col[data-skip]")},_getDataSkippedColumnsLength:function(isFixed){return this._getDataSkippedCols(isFixed).length},unfixAllColumns:function(){if(!this.grid.hasFixedColumns()){return}var i,self=this,colsToUnfix=[];if(this.grid._isMultiColumnGrid){this.grid.fixedHeadersTable().children("thead").children("tr[data-mch-level]:nth-child(1)").children("th").each(function(index,th){var $th=$(th),id;id=$th.attr("data-mch-id");id=id||$th.attr("id").replace(self.grid.id()+"_","");colsToUnfix.push(id)})}else{colsToUnfix=$.map(this.grid._fixedColumns,function(c){return c.key})}if(colsToUnfix.length>0){for(i=colsToUnfix.length-1;i>=0;i--){this.unfixColumn(colsToUnfix[i])}}},_removeFixedContainer:function(){this.element.data("fixingApplied",false);var grid=this.grid,scrollContainer,v=this._isVirtualGrid();if(v){this._removeFixedContainerVirtualization()}if(!this._containers){this._populateContainers()}scrollContainer=this._containers.body.unfixedContainer;scrollContainer.unbind(".columnFixing");if(this._containers&&this._containers.body){this._containers.body.unfixedTable.removeClass(this.css.unfixedTableLeft).removeClass(this.css.unfixedTableRight);if(!v){this._containers.body.unfixedTable.css("height","")}}if(!_aNull(this._DOMMouseScroll)){scrollContainer.unbind({DOMMouseScroll:this._DOMMouseScroll});this._DOMMouseScroll=null}grid.fixedContainer().remove();if(this.options.fixingDirection==="right"&&!v){scrollContainer.css({"overflow-y":"auto"})}if(!grid._outerHScrollbar){grid._hscrollbar().css({width:"100%",left:0})}if(grid.options.width===null&&grid.container()[0].style.width===""){grid.container().css("width","")}if(grid.options.enableHoverStyles){this._dettachHoverEvents()}$("#"+grid.id()+"_floatCompensate").remove()},_removeFixedContainerVirtualization:function(){var $virtCntnr=this.grid._virtualcontainer();$virtCntnr.children("colgroup").children("col[data-fixed-col]").remove();$virtCntnr.children("tbody").children("tr").children("td[data-fixed-container]").remove()},_getRowsHtml:function($unfixedArea,type){var html="",attrs,i,j,len,tr,a,h,av,an,synch=this.options.syncRowHeights,trs=$unfixedArea.children("tr");this._heights=this._heights||{};this._heights[type]=[];len=trs.length;for(i=0;i<len;i++){tr=trs[i];attrs=tr.attributes;html+="<tr";for(j=0;j<attrs.length;j++){a=attrs[j];av=a.value;an=a.name;if(an==="id"||an==="ID"){av+="_fixed"}html+=" "+an+'="'+av+'"'}if(synch){h=tr.offsetHeight;this._heights[type].push({h:h,tr:tr});html+=' height="'+h+'px"'}html+="></tr>"}return html},_renderContainerInVirtGrid:function($tr,$table,type){var $cntnr,$td=$('<td data-fixed-container="'+type+'" style="border-width: 0px;"></td>'),cssClass=this.options.fixingDirection==="left"?this.css.leftFixedContainer:this.css.rightFixedContainer;if(this.options.fixingDirection==="left"){$td.prependTo($tr)}else{$tr.children("td:first").removeAttr("colspan");if(type==="body"){$td.insertBefore($tr.children("td:last"))}else{$td.attr("colspan",2);$td.appendTo($tr)}}$cntnr=this._renderContainer($td,$table,type);$cntnr.addClass(cssClass);this._containers[type].fixedContainer.width(0);this._containers[type].fixedTable.width(0);return $cntnr},_renderContainer:function($mainFixedCntr,$table,type){var fixedContainerId,$fixedContainer,$fixedTable,html;switch(type){case"header":fixedContainerId=this.grid.id()+"_fixedHeaderContainer";html="<thead></thead>";break;case"footer":fixedContainerId=this.grid.id()+"_fixedFooterContainer";html='<tfoot role = "rowgroup"></tfoot>';break;default:fixedContainerId=this.grid.id()+"_fixedBodyContainer";html="<tbody>"+this._getRowsHtml($table.children("tbody"),type)+"</tbody>";break}$fixedContainer=$('<div id="'+fixedContainerId+'" data-fixed-container="true"></div>').appendTo($mainFixedCntr);if(type==="body"){$fixedContainer.attr("data-scroll","true")}$fixedTable=$('<table id="'+$table.attr("id")+'_fixed"'+' class="'+$table.attr("class")+'" '+' style="table-layout:fixed;" '+" border=0 cellpadding=0 cellspacing=0><colgroup />"+html+"</table>");$fixedTable.appendTo($fixedContainer);this._containers[type]=this._containers[type]||{};this._containers[type].fixedContainer=$fixedContainer;this._containers[type].fixedTable=$fixedTable;this._containers[type].unfixedContainer=$table.closest("div");this._containers[type].unfixedTable=$table;$fixedContainer.css({overflow:"hidden",position:"relative"});if(type==="header"){this._containers.header.fixedContainer.addClass(this._containers.header.unfixedContainer.attr("class"))}return $fixedContainer},_syncScrollTop:function(direction){var fC=this._scrollContainers.fCntnr,ufC=this._scrollContainers.ufCntnr,scrollTop=fC.scrollTop();direction=direction||0;scrollTop+=-direction*this.options.scrollDelta;if(scrollTop<=0){scrollTop=0}fC.scrollTop(scrollTop);ufC.scrollTop(scrollTop)},_bindEvents:function(){var grid=this.grid,self=this,fc=this._scrollContainers.fCntnr,ufc=this._scrollContainers.ufCntnr;if(grid.options.enableHoverStyles){this._attachHoverEvents()}if(this._isContinuousVirtualization()){ufc.bind({scroll:function(){var top=$(this).scrollTop();fc.scrollTop(top)}})}if(this._isVirtualGrid()){return}this._onMouseWheelHandler=function(event){var evt,direction,w,d,st;evt=event.originalEvent;w=evt.wheelDelta;d=evt.detail;if(d){if(w){direction=w/d/40*d>0?1:-1}else{direction=-d/3}}else{direction=w/120}st=fc.scrollTop();self._syncScrollTop(direction);if(grid.options.height===null||st===fc.scrollTop()){return true}return false};this._DOMMouseScroll=function(event){var dir=-1,delta;delta=-event.originalEvent.detail/3;if(delta>0){dir=1}self._syncScrollTop(dir);if(grid.options.height===null){return true}event.preventDefault()};this._onKeyDown=function(event){var isUp=event.keyCode===$.ui.keyCode.UP,isDown=event.keyCode===$.ui.keyCode.DOWN;if(isUp){self._syncScrollTop(1)}else if(isDown){self._syncScrollTop(-1)}};if(grid.element.igScroll!==undefined&&($.ig.util.isTouch||window.PointerEvent||window.navigator.msPointerEnabled)){fc.igScroll({scrolled:function(){self._syncScrollTop(0)},stopped:function(){self._syncScrollTop(0)}});fc.css("-ms-touch-action","none")}if($.ig.util.isIE||this.options.fixingDirection==="right"){ufc.bind({"keydown.columnFixing":this._onKeyDown,"mousewheel.columnFixing":this._onMouseWheelHandler,"DOMMouseScroll.columnFixing":this._DOMMouseScroll})}ufc.bind({"scroll.columnFixing":function(){var top=$(this).scrollTop();fc.scrollTop(top)}});fc.bind({scroll:function(){var fTop=fc.scrollTop(),sTop=ufc.scrollTop();if(fTop!==sTop){ufc.scrollTop(fTop)}},mousewheel:this._onMouseWheelHandler,DOMMouseScroll:this._DOMMouseScroll});if(this.options.fixingDirection==="right"){fc.bind({keydown:this._onMouseWheelHandler})}},_renderMainFixedContainerInVirtGrid:function(){this._populateContainers();var grid=this.grid,$col,$pScrlbar,html,$colgroup,$hscrlbar=grid._vhorizontalcontainer(),$td,$vContainer=grid._virtualcontainer(),fixedBodyContainer,scrollContainer,scrollContainerHeight;$colgroup=$vContainer.children("colgroup:first");scrollContainer=this._containers.body.unfixedContainer;$col=$("<col />").attr("data-fixed-col",this.options.fixingDirection);if(this.options.fixingDirection==="left"){$col.prependTo($colgroup)}else{$col.insertBefore($colgroup.children("col:last"))
}fixedBodyContainer=this._renderContainerInVirtGrid(this._containers.body.unfixedContainer.closest("tr"),this._containers.body.unfixedTable,"body");fixedBodyContainer.addClass(grid.css.gridVirtualScrollDivClass).addClass(grid.css.gridScrollDivClass);if($.ig.util.isIE){fixedBodyContainer.children("table").height(scrollContainer.children("table").height())}scrollContainerHeight=scrollContainer.height();fixedBodyContainer.height(scrollContainerHeight);fixedBodyContainer.bind(grid._mouseClickEventHandlers);if(grid.options.showHeader){this._renderContainerInVirtGrid(this._containers.header.unfixedContainer.closest("tr"),this._containers.header.unfixedTable,"header");grid._renderFixedCaption();html=this._getRowsHtml(this._containers.header.unfixedTable.children("thead"),"header");this._containers.header.fixedTable.children("thead").html(html)}if(grid.options.showFooter&&this._containers.footer){this._renderContainerInVirtGrid(this._containers.footer.unfixedContainer.closest("tr"),this._containers.footer.unfixedTable,"footer");if(grid.options.fixedFooters){this._containers.footer.fixedContainer.bind(grid._mouseClickEventHandlers)}html=this._getRowsHtml(grid.footersTable().children("tfoot"),"footer");grid.fixedFootersTable().children("tfoot").html(html)}grid._fixedTable=fixedBodyContainer.children("table");if(!$hscrlbar.length){$hscrlbar=grid._hscrollbar()}$pScrlbar=$hscrlbar.parent();if($pScrlbar.is("td")){$td=$('<td data-fixed-container="scrollbar"></td>');if(this.options.fixingDirection==="left"){$td.insertBefore($hscrlbar.closest("td"))}else{$td.attr("colspan",2).insertAfter($hscrlbar.closest("td").removeAttr("colspan"))}}this._scrollContainers={fCntnr:fixedBodyContainer,ufCntnr:scrollContainer};this._bindEvents()},_renderMainFixedContainer:function(){this.element.data("fixingApplied",true);if(this._isVirtualGrid()){return this._renderMainFixedContainerInVirtGrid()}var grid=this.grid,gridId=grid.id(),html,fDir=this.options.fixingDirection,scrCntnrTbl,fixedBodyTable,fixedHeaderContainer,fixedFooterContainer,scrollContainer,$mainFixedContainer,fixedBodyContainer,mainFixedContainerId=grid.id()+"_mainFixedContainer",scrollContainerHeight;$mainFixedContainer=$('<div id="'+mainFixedContainerId+'" data-fixed-container="true"></div>');this._mainFixedCntnr=$mainFixedContainer;$mainFixedContainer.css({width:"0px",overflow:"hidden",position:"relative"});scrollContainer=grid.scrollContainer();if(scrollContainer.length){scrCntnrTbl=scrollContainer.children("table")}else{scrollContainer=grid.element;scrCntnrTbl=grid.element}$mainFixedContainer.addClass(this.css.fixedContainer);$mainFixedContainer.insertBefore(grid.options.fixedHeaders&&grid.options.showHeader?grid.headersTable().closest("div"):scrollContainer);if(fDir==="left"){$mainFixedContainer.css({"float":"left",left:0});$mainFixedContainer.addClass(this.css.leftFixedContainer)}else{$mainFixedContainer.css({"float":"right",right:0});$mainFixedContainer.addClass(this.css.rightFixedContainer)}$mainFixedContainer.attr("data-fixing-direction",fDir);$mainFixedContainer.bind(this.grid._mouseClickEventHandlers);fixedBodyContainer=this._renderContainer($mainFixedContainer,scrCntnrTbl,"body");fixedBodyContainer.attr("data-fixing-direction",fDir);if(grid.options.height!==null&&$.ig.util.isIE){fixedBodyContainer.find("table").height(scrCntnrTbl.height())}if(grid.options.height===null){scrollContainerHeight="100%"}else{scrollContainerHeight=scrollContainer.height();if(this.grid._hscrollbar().is(":visible")){scrollContainerHeight+=this.grid._hscrollbar().outerHeight()}}fixedBodyContainer.height(scrollContainerHeight);fixedBodyTable=fixedBodyContainer.find("table");if(grid.options.showHeader){if(grid.options.fixedHeaders&&grid.options.height!==null){fixedHeaderContainer=this._renderContainer($mainFixedContainer,grid.headersTable(),"header");fixedHeaderContainer.prependTo($mainFixedContainer);grid._renderFixedCaption()}else{if(grid.element.find("thead").next().is("tbody")){$("<thead />").insertBefore(fixedBodyContainer.find("tbody"))}else{if(grid.element.find("thead").prev().is("colgroup")){$("<thead />").insertAfter(fixedBodyContainer.find("colgroup"))}else{$("<thead />").insertAfter(fixedBodyContainer.find("tbody"))}}}}if(grid.options.showFooter){if(grid.options.fixedFooters&&grid.options.height!==null){fixedFooterContainer=this._renderContainer($mainFixedContainer,grid.footersTable(),"footer");this._containers.footer.fixedTable.css("whiteSpace",this._containers.footer.unfixedTable.css("whiteSpace"));fixedFooterContainer.appendTo($mainFixedContainer)}else{$('<tfoot role="rowgroup" />').insertAfter(fixedBodyContainer.find("tbody"))}}html=this._getRowsHtml(grid.headersTable().children("thead"),"header");grid.fixedHeadersTable().children("thead").html(html);html=this._getRowsHtml(grid.footersTable().children("tfoot"),"footer");grid.fixedFootersTable().children("tfoot").html(html);if(this.options.syncRowHeights){this._setRowHeights("header");this._setRowHeights("body");this._setRowHeights("footer")}grid._fixedTable=fixedBodyTable;if(fDir==="right"){fixedBodyContainer.css({"overflow-y":"auto"});scrollContainer.css({"overflow-y":"hidden"});this.grid._hscrollbarcontent().css({overflow:"","overflow-y":"hidden"})}this._scrollContainers={fCntnr:fixedBodyContainer,ufCntnr:scrollContainer};this._bindEvents();$('<div style="clear:both" id="'+gridId+'_floatCompensate"></div>').insertAfter(grid.container())},_setRowHeights:function(type){var i,heights=this._heights[type],heightsLength=heights.length;for(i=0;i<heightsLength;i++){heights[i].tr.style.height=heights[i].h+"px"}},_syncRowStyles:function(){var i,fRow,ufRow,container=this._containers.body,$unfixedTable=container.unfixedTable,$fixedTable=container.fixedTable,fixedRows=$fixedTable.children("tbody").children("tr"),unfixedRows=$unfixedTable.children("tbody").children("tr"),rLen=fixedRows.length;for(i=0;i<rLen;i++){fRow=fixedRows[i];ufRow=unfixedRows[i];fRow.setAttribute("style",ufRow.getAttribute("style"));fRow.setAttribute("class",ufRow.getAttribute("class"))}},_populateContainers:function(){var gridId=this.grid.id(),grid=this.grid,self=this,virtualization=this._isVirtualGrid(),$unfixedHeaders=this.grid.container().find("#"+gridId+"_headers"),$unfixedFooters=this.grid.container().find("#"+gridId+"_footer_container"),$fixedBodyContainer=this.grid.container().find("#"+gridId+"_fixedBodyContainer"),functionPopulateContainers,scrollContainer;if(virtualization){scrollContainer=this.grid._vdisplaycontainer()}else{scrollContainer=this.grid.scrollContainer()}if(scrollContainer.length===0){scrollContainer=this.grid.element}this._containers={};functionPopulateContainers=function($unfixedContainer,$fixedContainer,type){var $unfixedTable=$unfixedContainer.find("table"),$fixedTable=grid.container().find("#"+$unfixedTable.attr("id")+"_fixed");if($unfixedTable.length===0){$unfixedTable=$unfixedContainer;$fixedTable=grid.container().find("#"+$unfixedTable.attr("id")+"_fixed")}self._containers[type]={fixedContainer:$fixedContainer,unfixedContainer:$unfixedContainer,fixedTable:$fixedTable,unfixedTable:$unfixedTable}};if($unfixedHeaders.length>0){functionPopulateContainers($unfixedHeaders.parent("div"),grid.fixedHeaderContainer(),"header")}functionPopulateContainers(scrollContainer,$fixedBodyContainer,"body");if($unfixedFooters.length>0&&$unfixedFooters[0].nodeName!=="TFOOT"){functionPopulateContainers($unfixedFooters,grid.fixedFooterContainer(),"footer")}},_fixUnfixMCHColumn:function(colId,fixingParams,oCols){var i,grid=this.grid,col,fixedThead=fixingParams.fixedThead,unfixedThead=fixingParams.unfixedThead,isToFix=fixingParams.isToFix,area=isToFix?fixedThead:unfixedThead,mchInstance=grid.element.data("igGridMultiColumnHeaders");oCols=oCols||grid._oldCols;if(!mchInstance){return}for(i=0;i<oCols.length;i++){if(oCols[i].identifier===colId||oCols[i].key===colId){col=oCols[i];break}}if(i===oCols.length){return}mchInstance._rows={};mchInstance._analyzeRowspanRows(oCols,0);this._fixUnfixMCHColumnRecursive([col],mchInstance._rows,area,isToFix)},_fixUnfixMCHColumnRecursive:function(cols,rows,area,isToFix){var i,grid=this.grid,$th,id,domLevel,cells,$ths=$(),tCell,after,col,$targetTh,$tr;for(i=0;i<cols.length;i++){col=cols[i];if(col.level===0){id=col.key;$th=grid.container().find("#"+this.grid.id()+"_"+col.key)}else{id=col.identifier;$th=this._getTH(col.identifier)}if(_aNull(domLevel)){domLevel=parseInt($th.closest("tr").attr("data-mch-level"),10)}$th.detach();$ths=$ths.add($th)}cells=rows[domLevel];if(cells){$tr=area.find("tr[data-mch-level="+domLevel+"]");if(!$tr.find(">th:not([data-skip])").length||!cells.length){$ths.appendTo($tr)}else{for(i=0;i<cells.length;i++){if(cells[i].identifier===id||cells[i].key===id){if(i<cells.length-1){tCell=cells[i+1];if(!!tCell.fixed!==!!cells[i].fixed){after=false;break}}tCell=cells[i+1-cols.length];if(!!tCell.fixed!==!!cells[i].fixed){after=true}else{tCell=null}break}}if(tCell){$targetTh=this._getTH(_aNull(tCell.key)?tCell.identifier:tCell.key);if(after){$ths.insertAfter($targetTh)}else{$ths.insertBefore($targetTh)}}else{$ths.appendTo($tr)}}}for(i=0;i<cols.length;i++){if(!cols[i].group){continue}this._fixUnfixMCHColumnRecursive(cols[i].group,rows,area,isToFix);cols[i].fixed=isToFix}},_dettachHoverEvents:function(){this._populateContainers();var container=this._containers.body,$unfixedTable=container.unfixedTable,$fixedTable=container.fixedTable;$fixedTable.undelegate("tbody",".hoverColumnFixing");$unfixedTable.undelegate("tbody",".hoverColumnFixing")},_attachHoverEvents:function(){this._populateContainers();var container=this._containers.body,$unfixedTable=container.unfixedTable,$fixedTable=container.fixedTable;this._mouseOverHandler=$.proxy(this._mouseOver,this);this._mouseLeaveHandler=$.proxy(this._mouseLeave,this);$fixedTable.delegate("tbody",{"mousemove.hoverColumnFixing":this._mouseOverHandler,"mouseleave.hoverColumnFixing":this._mouseLeaveHandler});$unfixedTable.delegate("tbody",{"mousemove.hoverColumnFixing":this._mouseOverHandler,"mouseleave.hoverColumnFixing":this._mouseLeaveHandler})},_mouseOver:function(event){var css="ui-state-hover",$tr=$(event.target).closest("tr"),grid=this.grid;if(grid._isFixedElement($tr)){grid._mousemoveTr(grid.element.find("tbody tr:nth-child("+($tr.index()+1)+")")[0],event)}if(this._hoverTr){this._hoverTr.find("td,th").removeClass(css)}this._hoverTr=grid.fixedTable().find("tbody").children("tr:nth-child("+($tr.index()+1)+")");this._hoverTr.children("td,th").addClass(css)},_mouseLeave:function(event){var css="ui-state-hover",$tr=$(event.target).closest("tr"),grid=this.grid;if(grid._isFixedElement($tr)){grid._mouseleaveTr(grid.element.find("tbody").children("tr:nth-child("+($tr.index()+1)+")")[0],event)}if(this._hoverTr){this._hoverTr.children("td,th").removeClass(css)}},_checkAndRenderHScrlbarCntnr:function(){var grid=this.grid,scroller=grid._hscrollbarcontent(),hscrollbar=grid._hscrollbar(),fixedControllerScrollerId=grid.id()+"_fixedContainerScroller",$fixedScroller=grid.container().find("#"+fixedControllerScrollerId);if($fixedScroller.length===0&&(this._isContinuousVirtualization()||$.ig.util.hasHorizontalScroll(grid.scrollContainer())||scroller.length===1&&hscrollbar.is(":visible"))){$('<div style="height:'+(hscrollbar.height()||$.ig.util.getScrollHeight())+'px" id="'+fixedControllerScrollerId+'"></div>').appendTo(this._containers.body.fixedContainer)}else if($fixedScroller.length===1&&hscrollbar.length===1){if(hscrollbar.is(":visible")){$fixedScroller.show()}else{$fixedScroller.hide()}}},syncRowsHeights:function($trs,$anotherRows){var i,len=$trs.length,hToSync,h,heights=[];for(i=0;i<len;i++){h=$trs[i].offsetHeight;hToSync=$anotherRows[i].offsetHeight;hToSync=h>hToSync?h:hToSync;heights.push(hToSync)}for(i=0;i<len;i++){$trs[i].style.height=heights[i]+"px";$anotherRows[i].style.height=heights[i]+"px"}},_checkSyncTablesHeights:function(){if(!this._containers||!this._containers.body){this._populateContainers()}var h,fH,ufH,$fixedTable=this._containers.body.fixedTable,$unfixedTable=this._containers.body.unfixedTable,$fTRs=$fixedTable.children("tbody").children("tr"),$ufTRs=$unfixedTable.children("tbody").children("tr"),$lastTr=$ufTRs.last();if($lastTr.length>0&&(Math.abs($fixedTable.outerHeight()-$unfixedTable.outerHeight())>1||Math.abs($lastTr.offset().top-$fTRs.last().offset().top)>1)){this.syncRowsHeights($fTRs,$ufTRs);fH=$fixedTable.height();ufH=$unfixedTable.height();h=fH>ufH?fH:ufH;$fixedTable.height(h);$unfixedTable.height(h)}},_syncContainerHeights:function(){var $fixedTable,$unfixedTable,containers=this._containers;if(containers&&containers.body){$fixedTable=containers.body.fixedTable;$unfixedTable=containers.body.unfixedTable;if($fixedTable.height()!==$unfixedTable.height()){$fixedTable.height($unfixedTable.height())}}},_adjustVirtWidthOnFixingRight:function(isToFix){if(this.options.fixingDirection!=="right"){return}var grid=this.grid,w,$tblHeaders,$colgroup=grid._virtualcontainer().children("colgroup"),$colFixed=$colgroup.children("col[data-fixed-col]"),$colUnfixed=$colgroup.children("col:not(:last):not([data-fixed-col])");if($colUnfixed.length){w=$colUnfixed[0].width;this._containers.header.unfixedContainer.width(w);this._containers.footer.unfixedContainer.width(w)}if(grid.options.showHeader&&$colFixed.length){this._containers.header.fixedContainer.width(this._containers.header.fixedContainer.width()+grid._scrollbarWidth()+"px")}if(!isToFix&&!grid._fixedColumns.length){$tblHeaders=$("#"+grid.id()+"_headers_v");$tblHeaders.width($tblHeaders.width()+grid._scrollbarWidth()+"px");$tblHeaders.closest("td").attr("colspan",2)}grid._vhorizontalcontainer().css("overflow-y","hidden");this._updateHScrollbarTblWidthsInFixedVirtRight()},_updateFixedColgroupVirt:function(colWidthDelta){var w,$colFixed,$colUnfixed,$colgroup;$colgroup=this.grid._virtualcontainer().children("colgroup");$colFixed=$colgroup.children("col[data-fixed-col]");$colUnfixed=$colgroup.children("col:not(:last):not([data-fixed-col])");w=parseInt($colFixed.attr("width"),10);$colFixed.attr("width",w+colWidthDelta);w=parseInt($colUnfixed.attr("width"),10);$colUnfixed.attr("width",w-colWidthDelta)},getWidthOfFixedColumns:function(fCols,excludeNonDataColumns,includeHidden){var $fTable,w=0,i;if(!this._containers||!this._containers.body){this._populateContainers()}$fTable=this._containers.body.fixedTable;if(excludeNonDataColumns){$fTable.children("colgroup").children("col[data-skip]").each(function(){w+=parseInt($(this).css("width"),10)})}fCols=fCols||this.grid._fixedColumns;if(!fCols||!fCols.length){return w}for(i=0;i<fCols.length;i++){if(!includeHidden&&fCols[i].hidden){continue}w+=parseFloat(fCols[i].width)}return w},_updateHScrollbarWidthVirt:function(){var grid=this.grid,$hScrlbar,$hScrlbarInner,$hScrollerContainer=grid._vhorizontalcontainer(),fixedTableWidth=parseInt(this._containers.body.fixedTable[0].style.width,10),fdirLeft=this.options.fixingDirection==="left",gridWidth=parseInt(grid.options.width,10);if(grid._outerHScrollbar){$hScrlbar=grid._hscrollbar();$hScrlbar.css(this.options.fixingDirection==="left"?"margin-left":"margin-right",fixedTableWidth);$hScrlbarInner=grid._hscrollbarinner();$hScrlbarInner.css("width",this._containers.body.unfixedTable.outerWidth()+"px");if(grid._gridHasWidthInPercent()){grid._updateGridContentWidth();grid._updateVirtualHorizontalScrollbar()}return}if(this._isContinuousVirtualization()){if(fixedTableWidth===0){$hScrollerContainer.css({position:""})}else if(fdirLeft){$hScrollerContainer.css({position:"relative"})}if(!fdirLeft){gridWidth-=grid._scrollbarWidth();$hScrlbarInner=grid._getHScrollContainerInner()}$hScrollerContainer.width(gridWidth-fixedTableWidth+"px");grid._updateVirtualHorizontalScrollbar()}},_updateHScrollbarWidth:function(delta){if(this._isVirtualGrid()){return this._updateHScrollbarWidthVirt(delta)}var scrollContainer,grid=this.grid,$hScrollerContainer,scW,fdirLeft=this.options.fixingDirection==="left",oTableWidth=this._containers.body.unfixedTable.outerWidth();scrollContainer=this._containers.body.unfixedContainer;if(oTableWidth>0){$hScrollerContainer=grid._hscrollbar();if(scrollContainer.is(":visible")){scW=scrollContainer.width()}else{scW=parseInt(grid.options.width,10)-this.getWidthOfFixedColumns()}$hScrollerContainer.css({left:0});grid._hscrollbarinner().css({width:(grid._hasVerticalScrollbar&&grid.options.fixedHeaders&&fdirLeft?oTableWidth-grid._scrollbarWidth():oTableWidth)+"px",left:0})}},_headerRendered:function(sender,args){if(args.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(this.options.showFixButtons===false){return}var i,j,cs,columnKey,ths,children,isFixed=false,allowFixing=true,grid=this.grid,self=this,cols=grid.options.columns,colsLength=cols.length;if(grid._isMultiColumnGrid){ths=grid.headersTable().children("thead").children("tr[data-mch-level="+grid._maxLevel+"]").children("th");ths.each(function(){var $th=$(this);if($th.attr("data-mch-id")){columnKey=$th.attr("data-mch-id");allowFixing=true;cs=self._getColumnSettingByKey(columnKey);if(cs&&cs.allowFixing===false){return true}for(j=0;j<grid._oldCols.length;j++){if(grid._oldCols[j].identifier===columnKey){children=grid._oldCols[j].children;for(i=0;i<children.length;i++){cs=self._getColumnSettingByKey(children[i].key,i);if(cs&&cs.allowFixing===false){allowFixing=false;break}}break}}if(!allowFixing){return true}self._renderHeaderCellButton(columnKey,isFixed,true,$th)}else{if($th.attr("data-skip")){return true}columnKey=$th.attr("id").replace(grid.id()+"_","");cs=self._getColumnSettingByKey(columnKey);if(cs&&cs.allowFixing===false){return true}if(self._fcData[columnKey]!==true){self._renderHeaderCellButton(columnKey,isFixed,false,$th)}}})}else{for(i=0;i<colsLength;i++){columnKey=cols[i].key;cs=this._getColumnSettingByKey(columnKey,i);isFixed=false;if(cs!==null){if(cs.allowFixing===false){continue}if(cs.isFixed===true){isFixed=true}}if(this._fcData[columnKey]!==true){this._renderHeaderCellButton(columnKey,isFixed)}}}},_headerRendering:function(){var i;for(i=0;i<this.grid.options.features.length;i++){if(this.grid.options.features[i].name==="Hiding"){this._hiding=this.grid.element.data("igGridHiding");break}}},_columnsMoved:function(e,ui){var start=ui.start,len=ui.len,idx=ui.index;if(!ui.isFixed){return}this.grid._rearrangeArray(this.grid._fixedColumns,start,len,idx)},_getColumnSettingByKey:function(key,colIndex){var i,cs=this.options.columnSettings,csLength=cs.length,res=null;for(i=0;i<csLength;i++){if(cs[i].columnKey!==null&&cs[i].columnKey!==undefined){if(cs[i].columnKey===key){res=cs[i];break}}else if(cs[i].columnIndex!==null&&cs[i].columnIndex!==undefined){if(cs[i].columnIndex===colIndex){res=cs[i];break}}}return res},_id:function(){var i,res=this.grid.id(),argumentsLength=arguments.length;if(argumentsLength===0){return null}for(i=0;i<argumentsLength;i++){res+="_"+arguments[i]}return res},_renderHeaderCellButton:function(columnKey,isFixed,isGroupHeader,$th){var self=this,css=self.css,buttonId,gridId=this.grid.id(),$button,$divHeaderButtonContainer,$columnFixingHeaderIconContainer;if($th===undefined){$th=this.grid.container().find("#"+gridId+"_"+columnKey)}buttonId=this._id("header_cell","fixing",columnKey);if($th.length===0){return}this.grid._enableHeaderCellFeature($th);$columnFixingHeaderIconContainer=$th.find(".ui-iggrid-indicatorcontainer");if($columnFixingHeaderIconContainer.length===0){$columnFixingHeaderIconContainer=$('<div class="ui-iggrid-indicatorcontainer"></div>').appendTo($th)}$button=this.grid.container().find("#"+buttonId);if($button.length===0){$button=$("<a></a>").attr("href","#").attr("data-fixing-indicator","true").attr("id",buttonId);$divHeaderButtonContainer=$columnFixingHeaderIconContainer.find(".ui-iggrid-fixcolumn-headerbuttoncontainer");if($divHeaderButtonContainer.length===0){$divHeaderButtonContainer=$("<div></div>").addClass(css.headerButtonIconContainer).appendTo($columnFixingHeaderIconContainer)}$button.appendTo($divHeaderButtonContainer);$("<span></span>").appendTo($button);$button.bind({mousedown:function(){$(this).trigger("mouseout")},click:function(event){event.preventDefault();event.stopPropagation();if($button.attr("data-fixed")==="true"){self._unfixColumnInternal(columnKey)}else{self._fixColumnInternal(columnKey)}}})}this._changeStyleHeaderButton(columnKey,isFixed)},_getTH:function(id){return this.grid.container().find('th[data-mch-id="'+id+'"],th[id="'+this.grid.id()+"_"+id+'"]')},_changeStyleHeaderButton:function(columnKey,isFixed){var css=this.css,fc,attrVal="true",title=this.options.headerFixButtonText,$button=this.grid.container().find("#"+this._id("header_cell","fixing",columnKey)),$span;$span=$button.find("span");if(isFixed){$span.removeClass(css.headerButtonIcon);$span.addClass(css.headerButtonUnfixIcon);title=this.options.headerUnfixButtonText}else{attrVal="false";$span.removeClass(css.headerButtonUnfixIcon);$span.addClass(css.headerButtonIcon)}$button.attr("data-fixed",attrVal).attr("title",title);fc=this.grid.element.data("igGridFeatureChooser");if(fc){fc._setSelectedState("ColumnFixing",columnKey,isFixed,false)}},_dataRendering:function(event,ui){if(ui===undefined){return}if(this.grid.id()!==ui.owner.id()){return}if(this.grid.options.height===null&&this.grid.hasFixedColumns()&&$.ig.util.isIE&&$.ig.util.browserVersion>=9){$("#"+this.grid.id()+"_fixed").height("")}},_dataRendered:function(event,ui){if(ui===undefined||this.grid.id()!==ui.owner.id()){return}var grid=this.grid;if(grid.hasFixedColumns()&&this.options.syncRowHeights){this.checkAndSyncHeights();if(this._isVirtualGrid()&&grid._virtualcontainer().outerHeight()>parseInt(grid.options.height)){this.grid._initializeHeights()}}},_gridContainersRendered:function(){var i,j,cs=this.options.columnSettings,csLength=cs.length,columnKeys=[],hasColumnKey,hasColumnIndex,res,cols=this.grid.options.columns,col,countHidden=0,colsLength=cols.length;for(i=0;i<csLength;i++){if(cs[i].isFixed!==true){continue}hasColumnKey=cs[i].columnKey!==null&&cs[i].columnKey!==undefined;hasColumnIndex=cs[i].columnIndex!==null&&cs[i].columnIndex!==undefined;if(!hasColumnKey){if(!hasColumnIndex){continue}if(cs[i].columnIndex>=0&&cs[i].columnIndex<colsLength){columnKeys.push(cols[cs[i].columnIndex].key);if(cols[cs[i].columnIndex].hidden){countHidden++}}}else{columnKeys.push(cs[i].columnKey);col=this.grid.columnByKey(cs[i].columnKey);if(col&&col.hidden){countHidden++}}}if(countHidden===columnKeys.length&&countHidden>0){this._trigger(this.events.columnFixingRefused,null,{columnIdentifier:columnKeys,owner:this.grid});return}for(j=0;j<columnKeys.length;j++){res=this.fixColumn(columnKeys[j]);if(!res.result){throw new Error($.ig.util.stringFormat($.ig.ColumnFixing.locale.initialFixingNotApplied,columnKeys[j],res.error))}}if(this.options.fixNondataColumns){this.fixDataSkippedColumns()}if(this.grid.hasFixedColumns()){this._rerenderColgroups();if(this._isVirtualGrid()&&this.grid.hasFixedDataSkippedColumns()){this._recalcTableWidths()}}},_detachEvents:function(){if(this._headerRenderedHandler){this.grid.element.unbind("iggridheaderrendered",this._headerRenderedHandler)}if(this._headerCellRenderedHandler){this.grid.element.unbind("iggridheadercellrendered",this._headerCellRenderedHandler)}if(this._headerRenderingHandler){this.grid.element.unbind("iggridheaderrendering",this._headerRenderingHandler)}if(this._columnsMovedHandler){this.grid.element.unbind("iggrid_columnsmoved",this._columnsMovedHandler)}if(this._gridHeightChangingHandler){this.grid.element.unbind("iggrid_heightchanging",this._gridHeightChangingHandler)}if(this._dataRenderingHandler){this.grid.element.unbind("iggriddatarendering",this._dataRenderingHandler)}if(this._dataRenderedHandler){this.grid.element.unbind("iggriddatarendered",this._dataRenderedHandler)}if(this._virtualrecordsrenderHandler){this.grid.element.unbind("iggridvirtualrecordsrender",this._virtualrecordsrenderHandler)}if(this._gridContainerHeightHandler){this.grid.element.unbind("iggrid_heightchanged",this._gridContainerHeightHandler)}if(this._gridContainersRenderedHandler){this.grid.element.unbind("iggrid_gridcontainersrendered",this._gridContainersRenderedHandler)}},destroy:function(){var fc;if(this.grid._fixedColumns&&this.grid._fixedColumns.length>0){this.unfixAllColumns()}if(this.grid.hasFixedDataSkippedColumns()){this.unfixNonDataColumns()}this.grid._hasFixedDataSkippedColumns=false;this.element.data("fixingApplied",false);this.grid.headersTable().find("thead > tr > th").not("[data-skip=true]").each(function(){var th=$(this);th.find("a[data-fixing-indicator=true]").parent().remove()});this._detachEvents();if(this._gridRenderRowHandler!==undefined){this.grid._renderRow=this._gridRenderRowHandler}if(this._gridRenderRecordsForTableHandler){this.grid._renderRecordsForTable=this._gridRenderRecordsForTableHandler}if(this._gridRenderNewRowHandler){this.grid.renderNewRow=this._gridRenderNewRowHandler}if(this._gridDetachColumnHandler){this.grid._detachColumn=this._gridDetachColumnHandler}if(this._gridAttachColumnHandler){this.grid._attachColumn=this._gridAttachColumnHandler}if(this._gridRerenderColgroupsHandler){this.grid._rerenderColgroups=this._gridRerenderColgroupsHandler}if(this._gridRenderColgroupHandler){this.grid._renderColgroup=this._gridRenderColgroupHandler}if(this._gridUpdatePaddingHandler){this.grid._updateVScrollbarCellPaddingHelper=this._gridUpdatePaddingHandler}fc=this.grid.element.data("igGridFeatureChooser");if(fc&&this.renderInFeatureChooser){fc._removeFeature("ColumnFixing")}this._unregisterSetOptionCallback();$.Widget.prototype.destroy.call(this);return this},_headerCellRendered:function(event,ui){if(ui.owner.element.attr("id")!==this.grid.element.attr("id")){return}if(this._isInitFC!==true){this._initFC()}},_setFixedBodyCntnrHeight:function(scrollContainer,fixedBodyContainer){if(!this._containers||!this._containers.body){this._populateContainers()}var grid=this.grid,hScrlbar,scrollContainerHeight;fixedBodyContainer=fixedBodyContainer||this._containers.body.fixedContainer;scrollContainer=scrollContainer||this._containers.body.unfixedContainer;if(grid.options.height===null){scrollContainerHeight="100%"}else{scrollContainerHeight=scrollContainer.height();hScrlbar=grid._hscrollbar();if(hScrlbar.is(":visible")&&!(this._isVirtualGrid()&&grid.options.virtualizationMode==="fixed")){scrollContainerHeight+=hScrlbar.outerHeight()}}fixedBodyContainer.height(scrollContainerHeight)},_summariesHeightsAdjusting:function(){if(!this.grid._initialized){return}var $fTbl,$ufTbl,grid=this.grid;if(!this._containers||!this._containers.footer){this._populateContainers()}if(grid.options.showFooter&&grid.options.fixedFooters){$fTbl=this._containers.footer.fixedTable;$ufTbl=this._containers.footer.unfixedTable;this._syncHeightsForTables($fTbl,$ufTbl)}},_heightChanged:function(){var grid=this.grid;if(!grid.hasFixedColumns()){return}this._syncTableHeights();this._setFixedBodyCntnrHeight();this._checkAndRenderHScrlbarCntnr();if(this.options.syncRowHeights){this.checkAndSyncHeights()}},_gridHeightChanging:function(e,arg){if(!this._containers.body){return}if(this._isVirtualGrid()){return}var scrollContainerHeight,diff,pc=this.grid._prevContainerHeight,$fixedBodyContainer=this.grid.fixedBodyContainer();if($fixedBodyContainer.length===0){return}scrollContainerHeight=arg.ch-arg.h;if(this.grid._hscrollbar().is(":visible")){scrollContainerHeight+=this.grid._hscrollbar().outerHeight()}$fixedBodyContainer.height(scrollContainerHeight);diff=Math.abs(pc-this.grid.container().height());$fixedBodyContainer.height(scrollContainerHeight-diff)},_initFC:function(){var i,fc,isMCH=this.grid._isMultiColumnGrid,o=this.options,cols=this.grid.options.columns,colsLength=cols.length,cs,columnKey;this._isInitFC=true;fc=this.grid.element.data("igGridFeatureChooser");if(fc!==null&&fc!==undefined&&this.renderInFeatureChooser&&o.showFixButtons){if(isMCH){cols=this.grid._oldCols;colsLength=cols.length}for(i=0;i<colsLength;i++){columnKey=cols[i].key;this._fcData[columnKey]=false;if(isMCH&&cols[i].level!==0){continue}cs=this._getColumnSettingByKey(columnKey,i);if(cs&&cs.allowFixing===false){continue}if(fc._shouldRenderInFeatureChooser(columnKey)===true){fc._renderInFeatureChooser(columnKey,{name:"ColumnFixing",text:o.featureChooserTextUnfixedColumn,textHide:o.featureChooserTextFixedColumn,iconClass:this.css.featureChooserIconClassFixed,iconClassOff:this.css.featureChooserIconClassUnfixed,isSelected:cs&&cs.isFixed===true,method:$.proxy(this._togglefromfc,this),updateOnClickAll:false,order:3,groupName:"toggle",groupOrder:1,type:"toggle",state:"hide"});this._fcData[columnKey]=true}}}},_togglefromfc:function(event,columnKey){var i,cols=this.grid.options.columns,colsLength=cols.length,col,ret;for(i=0;i<colsLength;i++){col=cols[i];if(col.key===columnKey){if(col.fixed===true){ret=this._unfixColumnInternal(columnKey)}else{ret=this._fixColumnInternal(columnKey)}break}}return ret.error===undefined},_columnMap:function(){var i,j,isMCH=this.grid._isMultiColumnGrid,cs,columnKey,elem,result=[],cols=this.grid.options.columns,colsLength=cols.length;if(this.options.showFixButtons===false){return false}for(i=0;i<colsLength;i++){columnKey=cols[i].key;elem={columnKey:columnKey,enabled:true};cs=this._getColumnSettingByKey(columnKey,i);if(cs&&cs.allowFixing===false){elem.enabled=false}else if(isMCH){for(j=0;j<this.grid._oldCols.length;j++){if(this.grid._oldCols[j].key===columnKey){break}}if(j===this.grid._oldCols.length){elem.enabled=false}}result.push(elem)}return result},_cleanupTBody:function(){if(this.grid.hasFixedColumns()){if(!this._containers||!this._containers.body){this._populateContainers()}this._containers.body.fixedTable.children("tbody").empty()}},_renderRow:function(rec,tr,rowId){if(!this.grid.hasFixedColumns()){return this._gridRenderRowHandler(rec,tr,rowId)}var i,col,content,$fixedRow,$unfixedRow,fixedCells,unfixedCells,counterFixed=0,counterUnfixed=0,$td,$tr=$(tr),grid=this.grid,cols=grid.options.columns,colsLength=cols.length,isFixedRow=this.grid._isFixedElement($tr);if(isFixedRow){$fixedRow=$tr;$unfixedRow=grid.element.find("tbody tr:nth-child("+($tr.index()+1)+")")}else{$unfixedRow=$tr;$fixedRow=this.grid.fixedTable().find("tbody tr:nth-child("+($tr.index()+1)+")")}fixedCells=$fixedRow.find(">td:not([data-skip])");unfixedCells=$unfixedRow.find(">td:not([data-skip])");for(i=0;i<colsLength;i++){col=cols[i];if(col.hidden===true){continue}if(col.fixed===true){$td=fixedCells.eq(counterFixed++)}else{$td=unfixedCells.eq(counterUnfixed++)}if(col.template&&col.template.length){content=grid._renderTemplatedCell(rec,col);if(content.indexOf("<td")===0){$td.html($(content).html())}else{$td.html(content)}}else{$td.html(String(grid._renderCell(rec[col.key],col,rec)))}}return tr},_renderRecordsForTable:function(start,end){var $fTable;if(this.grid.hasFixedColumns()){$fTable=this._containers.body.fixedTable;if($fTable.length){this._gridRenderRecordsForTableHandler.call(this.grid,start,end,$fTable,$fTable.children("tbody"),true)}}this._gridRenderRecordsForTableHandler.apply(this.grid,arguments);if($fTable&&this.options.syncRowHeights&&this._applySyncRowHeights!==false){this._syncHeightsForTables($fTable,this.grid.element)}},_renderNewRow:function(rec){var grid=this.grid,tbody=this.grid.element.children("tbody"),index=tbody.children('[data-container!="true"]').length,virt=grid.options.virtualization===true||grid.options.rowVirtualization===true;this._gridRenderNewRowHandler.apply(this.grid,arguments);if(!virt){if(grid.hasFixedColumns()){MSApp.execUnsafeLocalFunction(function(){grid.fixedTable().children("tbody").append(grid._renderRecord(rec,index,true))})}}},_updateVScrollbarCellPaddingHelper:function(paddingIncrement,skipHeaderFooters){if(!this.grid.hasFixedColumns()){this._gridUpdatePaddingHandler(paddingIncrement,skipHeaderFooters);return}var grid=this.grid,gridOpts=grid.options,fTable,hTable,container,hasFixedHeaders=gridOpts.showHeader&&gridOpts.fixedHeaders===true&&gridOpts.height!==null,hasFixedFooters=gridOpts.showFooter&&gridOpts.fixedFooters===true&&gridOpts.height!==null;
if(hasFixedHeaders&&!skipHeaderFooters){hTable=grid.headersTable();grid._removeHeaderCellPadding(grid.fixedHeadersTable(),true)}if(hasFixedFooters&&!skipHeaderFooters){fTable=grid.footersTable();grid._removeCellPadding(grid.fixedFootersTable(),"tfoot","td",true)}grid._removeCellPadding(grid.fixedBodyContainer(),"tbody","td",true);container=this.element;if(hasFixedHeaders&&!skipHeaderFooters){grid._increaseLastHeaderCellVScrollbarPadding(hTable,paddingIncrement)}if(hasFixedFooters&&!skipHeaderFooters){grid._increaseLastCellVScrollbarPadding(fTable,"tfoot","td",paddingIncrement)}grid._increaseLastCellVScrollbarPadding(container,"tbody","td",paddingIncrement)},_syncHeightsForTables:function($fixedTable,$unfixedTable,resetHeights){var h,fH,ufH;resetHeights=resetHeights||$unfixedTable.length&&$unfixedTable[0].style.height!=="";$fixedTable.css("height","");$unfixedTable.css("height","");if(this.options.syncRowHeights){this.syncRowsHeights($fixedTable.children("tbody").children("tr"),$unfixedTable.children("tbody").children("tr"))}if(resetHeights){fH=$fixedTable.height();ufH=$unfixedTable.height();h=fH>ufH?fH:ufH;$fixedTable.height(h);$unfixedTable.height(h)}},_detachColumn:function(col){if(!this.grid.hasFixedColumns()){return this._gridDetachColumnHandler(col)}var pos,fixed,headerCells,grid=this.grid,$tbl,footerCells;fixed=col.fixed;col.hidden=false;grid._visibleColumnsArray=undefined;pos=grid.getVisibleIndexByKey(col.key);col.hidden=true;grid._visibleColumnsArray=undefined;grid._initializeDetachedContainers();if(grid._isMultiColumnGrid){grid._hideMultiHeaderCells(grid._headerCells,col.key)}$tbl=fixed?grid.fixedHeadersTable():grid.headersTable();headerCells=grid._isMultiColumnGrid?$tbl.children("thead").children("tr:not([data-mch-level])").not("[data-skip=true]"):$tbl.children("thead").children("tr").not("[data-skip=true]");grid._detachCells(headerCells,function(row){return row.filter(":not([data-new-row],[data-add-row])").children("th, td").not("[data-skip=true]")},pos,grid._detachedHeaderCells,col.key);$tbl=fixed?grid.fixedFootersTable():grid.footersTable();footerCells=$tbl.children("tfoot").children("tr");grid._detachCells(footerCells,function(row){return row.children("td").not("[data-skip=true]")},pos,grid._detachedFooterCells,col.key)},_attachColumn:function(col){if(!this.grid.hasFixedColumns()){this._gridAttachColumnHandler(col);return}var headerCells,footerCells,fixed=col.fixed,$tbl,grid=this.grid,pos=grid.getVisibleIndexByKey(col.key);grid._initializeDetachedContainers();if(grid._isMultiColumnGrid){grid._showMultiHeaderCells(col.key)}$tbl=fixed?grid.fixedHeadersTable():grid.headersTable();headerCells=grid._isMultiColumnGrid?$tbl.children("thead").children("tr:not([data-mch-level])").not("[data-skip=true]"):$tbl.children("thead").children("tr").not("[data-skip=true]");grid._attachCells(headerCells,function(row){return row.children("th, td").not("[data-skip=true]")},pos,grid._detachedHeaderCells,col.key);$tbl=fixed?grid.fixedFootersTable():grid.footersTable();footerCells=$tbl.children("tfoot").children("tr");grid._attachCells(footerCells,function(row){return row.children("td").not("[data-skip=true]")},pos,grid._detachedFooterCells,col.key)},_rerenderColgroups:function(applyAutofitLastColumn){var grid=this.grid,c=this._containers,fc=grid.hasFixedColumns();if(fc){if(this._isVirtualGrid()){c.body.fixedTable.children("colgroup").remove();c.header.fixedTable.children("colgroup").remove();c.footer.fixedTable.children("colgroup").remove()}else{grid.fixedContainer().find("colgroup").remove()}}this._gridRerenderColgroupsHandler.apply(this.grid,arguments);if(applyAutofitLastColumn||fc){if(grid.options.autofitLastColumn&&grid._autoadjustedColumn){grid._adjustLastColumnWidth(true)}}},_renderColgroup:function(table,isHeader,isFooter,autofitLastColumn){var fc=this.grid.hasFixedColumns();if(fc){this._gridRenderColgroupHandler(document.getElementById(table.id+"_fixed"),isHeader,isFooter,false,{fixed:true})}this._gridRenderColgroupHandler(table,isHeader,isFooter,autofitLastColumn)},_resizeEl:function($e,delta){var w=this._calcTblWidth($e,delta);$e[0].style.width=w;return w},_containerResized:function(isFixed,deltaWidth){if(!this.grid.hasFixedColumns()){return}var grid=this.grid,w,v=this._isVirtualGrid();if(!this._containers||!this._containers.body){this._populateContainers()}if(isFixed){deltaWidth=-deltaWidth||0;w=this._resizeEl(this._containers.body.fixedTable,deltaWidth);if(grid.options.fixedHeaders&&grid.options.showHeader){w=this._resizeEl(this._containers.header.fixedTable,deltaWidth)}if(grid.options.fixedFooters&&grid.options.showFooter){w=this._resizeEl(this._containers.footer.fixedTable,deltaWidth)}if(v){this._resizeEl(this._containers.body.fixedContainer,deltaWidth);if(grid.options.fixedHeaders&&grid.options.showHeader){w=this._resizeEl(this._containers.header.fixedContainer,deltaWidth)}if(grid.options.fixedFooters&&grid.options.showFooter){w=this._resizeEl(this._containers.footer.fixedContainer,deltaWidth)}this._updateVirtualDOMWidth(deltaWidth)}else{this._mainFixedCntnr[0].style.width=w}this._updateHScrollbarWidth();this._updateGridWidth();grid._updateHScrollbarVisibility()}if(grid._gridHasWidthInPercent()){this._setMinWidthForGridContainer()}if(this.options.syncRowHeights){this.checkAndSyncHeights()}},_checkGridSupportedFeatures:function(){if(this.grid.options._isHierarchicalGrid){throw new Error($.ig.ColumnFixing.locale.hierarchicalGridNotSupported)}var i,featureName,gridOptions=this.grid.options,cols=gridOptions.columns,dW=gridOptions.defaultColumnWidth,features=gridOptions.features,featuresLength=features.length;if(dW){if($.type(dW)==="string"&&dW.indexOf("%")>0){throw new Error($.ig.ColumnFixing.locale.defaultColumnWidthInPercentageNotSupported)}}else{$.each(cols,function(ind,col){var w=col.width;if(!w||$.type(w)==="string"&&w.indexOf("%")>0){throw new Error($.ig.ColumnFixing.locale.columnsWidthShouldBeSetInPixels.replace("{key}",col.key))}})}$.each(cols,function(ind,col){if(col.unbound){throw new Error($.ig.ColumnFixing.locale.unboundColumnsNotSupported)}});if(gridOptions.columnVirtualization===true){throw new Error($.ig.ColumnFixing.locale.columnVirtualizationNotSupported)}if(gridOptions.width===null||gridOptions.width===""){throw new Error($.ig.ColumnFixing.locale.noGridWidthNotSupported)}if($.type(gridOptions.height)==="string"&&gridOptions.height.indexOf("%")>0){throw new Error($.ig.ColumnFixing.locale.gridHeightInPercentageNotSupported)}if(gridOptions.virtualization&&gridOptions.virtualizationMode!=="continuous"){throw new Error($.ig.ColumnFixing.locale.virtualizationNotSupported)}if(featuresLength===1){return}for(i=0;i<featuresLength;i++){featureName=features[i].name;if(!featureName){continue}featureName=featureName.toLowerCase();switch(featureName){case"groupby":throw new Error($.ig.ColumnFixing.locale.groupByNotSupported);case"responsive":throw new Error($.ig.ColumnFixing.locale.responsiveNotSupported)}}},_updateWidthsOnHiding:function(width,fixed){var $bodyTbl,$headerTbl,$footerTbl,funcUpdateTbl,$bodyContainer,$headerContainer,$footerContainer;this._populateContainers();$bodyTbl=fixed?this._containers.body.fixedTable:this._containers.body.unfixedTable;$bodyContainer=fixed?this._containers.body.fixedContainer:this._containers.body.unfixedContainer;if(this._containers.header){$headerTbl=fixed?this._containers.header.fixedTable:this._containers.header.unfixedTable;$headerContainer=fixed?this._containers.header.fixedContainer:this._containers.header.unfixedContainer}if(this._containers.footer){$footerTbl=fixed?this._containers.footer.fixedTable:this._containers.footer.unfixedTable;$footerContainer=fixed?this._containers.footer.fixedContainer:this._containers.footer.unfixedContainer}funcUpdateTbl=function(nW,$tbl){if(!$tbl||!$tbl.length){return}var w=$tbl[0].style.width;if($.type(w)==="string"&&(w.indexOf("%")!==-1||w==="")){return}w=parseInt($tbl[0].style.width,10);if(isNaN(w)){w=$tbl.outerWidth()}w+=nW;$tbl[0].style.width=w+"px"};funcUpdateTbl(width,$bodyTbl);funcUpdateTbl(width,$headerTbl);funcUpdateTbl(width,$footerTbl);if(fixed&&this._mainFixedCntnr){this._mainFixedCntnr.css("width",parseFloat(this._mainFixedCntnr[0].style.width)+width+"px")}if(this._isVirtualGrid()){if(fixed){this._updateFixedColgroupVirt(width);if(!this.grid._gridHasWidthInPercent()){funcUpdateTbl(-width,this._containers.body.unfixedContainer);if(this.grid.options.showHeader){funcUpdateTbl(-width,this._containers.header.unfixedContainer)}if(this.grid.options.showFooter){funcUpdateTbl(-width,this._containers.footer.unfixedContainer)}}this._updateHScrollbarWidthVirt()}funcUpdateTbl(width,$bodyContainer);funcUpdateTbl(width,$headerContainer);funcUpdateTbl(width,$footerContainer)}},_hidingFinishing:function(args){if(!this.grid.hasFixedColumns()){return}var i,grid=this.grid,cols=args.columns,w,col;for(i=0;i<cols.length;i++){col=cols[i];if(col.fixed){w=parseInt(col.width,10);this._updateWidthsOnHiding(args.hidden?-w:w,true)}}this._populateContainers();grid._columnMovingResets()},_hidingFinished:function(args){if(!this.grid.hasFixedColumns()){return}var $trs,virt=this._isVirtualGrid(),c=this._containers;this._populateContainers();if(virt){this._recalcTableWidths();if(this.options.fixingDirection==="right"){this._adjustVirtWidthOnFixingRight(false)}}if(this.options.syncRowHeights){if(!args.hidden){$trs=c.body.fixedTable.children("tbody").find(">tr");$trs=$trs.add(c.body.unfixedTable.children("tbody").find(">tr"));$trs.each(function(ind,tr){tr.style.height=""})}if(virt&&!this._isContinuousVirtualization()){if(this.options.syncRowHeights){this.syncRowsHeights(this.grid.fixedTable().children("tbody").children("tr"),this.grid.element.children("tbody").children("tr"))}}else{this._syncHeightsForTables(this.grid.fixedTable(),this.grid.element)}if(this.grid.options.showFooter){if(c.footer){this.syncRowsHeights(c.footer.fixedTable.children("tfoot").children("tr"),c.footer.unfixedTable.children("tfoot").children("tr"))}}}if(this.grid._gridHasWidthInPercent()){this._setMinWidthForGridContainer()}this._applySyncRowHeights=true},_syncRowsOnAddEdit:function(rowId){if(!this.options.syncRowHeights||!this.grid.hasFixedColumns()){return}var h,c=this._containers,$fRow=this.grid.rowById(rowId,true),$ufRow=this.grid.rowById(rowId);if(!$fRow||!$ufRow){return}if(!c||!c.body){this._populateContainers()}h=c.body.fixedTable.height();c.body.fixedTable.height("");c.body.unfixedTable.height("");$fRow.height("");$ufRow.height("");this.syncRowsHeights($fRow,$ufRow);c.body.fixedTable.height(h);c.body.unfixedTable.height(h);this.checkAndSyncHeights()},_internalRowDeleted:function(){if(!this.options.syncRowHeights||!this.grid.hasFixedColumns()){return}var c=this._containers;if(!c||!c.body){this._populateContainers()}if(!this._isVirtualGrid()){c.body.fixedTable.height("");c.body.unfixedTable.height("")}this.checkAndSyncHeights()},_internalRowAdded:function(args){this._syncRowsOnAddEdit(args.row.attr("data-id"))},_internalCellUpdated:function(args){this._syncRowsOnAddEdit(args.rowID)},_internalRowUpdated:function(args){this._syncRowsOnAddEdit(args.rowID)},_virtualrecordsrender:function(){var grid=this.grid,fnRemoveHeigths,h,$fixedTable,$unfixedTable,fc,ufc,$fRows,$ufRows,cvirt=this._isContinuousVirtualization();if(!grid.hasFixedColumns()||!this.options.syncRowHeights){return}$fixedTable=this._containers.body.fixedTable;$unfixedTable=this._containers.body.unfixedTable;h=$unfixedTable[0].style.height;$fixedTable.height("");$unfixedTable.height("");if(cvirt){this._checkSyncTablesHeights();if(!$.ig.util.isIE){fc=this._scrollContainers.fCntnr;ufc=this._scrollContainers.ufCntnr;fc.scrollTop(ufc.scrollTop())}return}fnRemoveHeigths=function($rows){var i,len=$rows.length;for(i=0;i<len;i++){$rows[i].style.height=""}};$ufRows=$unfixedTable.children("tbody").children("tr");$fRows=$fixedTable.children("tbody").children("tr");fnRemoveHeigths($ufRows);fnRemoveHeigths($fRows);this.syncRowsHeights($ufRows,$fRows);$fixedTable.height(h);$unfixedTable.height(h)},_setFixingStateByCol:function(col,isFixed){var i,len;col.fixed=isFixed;if(col.group){len=col.group.length;for(i=0;i<len;i++){this._setFixingStateByCol(col.group[i],isFixed)}}},_unregisterSetOptionCallback:function(){var callbacks=this.grid._setOptionCallbacks,i,len=callbacks.length;for(i=0;i<len;i++){if(callbacks[i].type==="ColumnFixing"){$.ig.removeFromArray(callbacks,i);break}}},_registerSetOptionCallback:function(){var callbacks=this.grid._setOptionCallbacks,i,len=callbacks.length;for(i=0;i<len;i++){if(callbacks[i].type==="ColumnFixing"){break}}if(i===len){callbacks.push({type:"ColumnFixing",func:$.proxy(this._gridSetOption,this)})}},_updateHScrollbarTblWidthsInFixedVirtRight:function(){var $hScrlBar,$hScrlBarInner;$hScrlBarInner=this.grid._getHScrollContainerInner();$hScrlBar=$hScrlBarInner.parent();$hScrlBar.width(this._containers.body.unfixedContainer.width());$hScrlBarInner.width(this._containers.body.unfixedTable.width());$hScrlBar.css("overflow-y","hidden");if(this._containers.header){this._containers.header.unfixedTable.css("width","");this._containers.header.unfixedTable.css("width",this._calcTblWidth(this._containers.header.unfixedTable,0))}if(this._containers.footer){this._containers.footer.unfixedTable.css("width","");this._containers.footer.unfixedTable.css("width",this._calcTblWidth(this._containers.footer.unfixedTable,0))}this._updateGridWidth();this.grid._updateHScrollbarVisibility()},_gridRendered:function(){if(this.options.fixingDirection==="right"&&this._isVirtualGrid()&&this.grid.hasFixedColumns()){this._updateHScrollbarTblWidthsInFixedVirtRight()}},_injectGrid:function(gridInstance,isRebind){this.grid=gridInstance;if(isRebind===true){return}this.grid._fixedColumns=this.grid._fixedColumns||[];this.grid._fixingDirection=this.options.fixingDirection;this._checkGridSupportedFeatures();this._registerSetOptionCallback();this._detachEvents();this._headerCellRenderedHandler=$.proxy(this._headerCellRendered,this);this.grid.element.bind("iggridheadercellrendered",this._headerCellRenderedHandler);this._headerRenderedHandler=$.proxy(this._headerRendered,this);this.grid.element.bind("iggridheaderrendered",this._headerRenderedHandler);this._headerRenderingHandler=$.proxy(this._headerRendering,this);this.grid.element.bind("iggridheaderrendering",this._headerRenderingHandler);this._columnsMovedHandler=$.proxy(this._columnsMoved,this);this.grid.element.bind("iggrid_columnsmoved",this._columnsMovedHandler);if(this._isVirtualGrid()&&this.options.syncRowHeights){this._virtualrecordsrenderHandler=$.proxy(this._virtualrecordsrender,this);this.grid.element.bind("iggridvirtualrecordsrender",this._virtualrecordsrenderHandler)}this._gridContainerHeightHandler=$.proxy(this._heightChanged,this);this.grid.element.bind("iggrid_heightchanged",this._gridContainerHeightHandler);this._gridHeightChangingHandler=$.proxy(this._gridHeightChanging,this);this.grid.element.bind("iggrid_heightchanging",this._gridHeightChangingHandler);this._gridContainersRenderedHandler=$.proxy(this._gridContainersRendered,this);this.grid.element.bind("iggrid_gridcontainersrendered",this._gridContainersRenderedHandler);if(this.grid._columns===undefined||this.grid._columns===null){this.grid._columns=this.grid.options.columns.clone()}if(this.grid._fixedColumns===undefined){this.grid._fixedColumns=[]}if(this.grid.options.height===null&&$.ig.util.isIE&&$.ig.util.browserVersion>=9){this._dataRenderingHandler=$.proxy(this._dataRendering,this);this.grid.element.bind("iggriddatarendering",this._dataRenderingHandler)}this._dataRenderedHandler=$.proxy(this._dataRendered,this);this.grid.element.bind("iggriddatarendered",this._dataRenderedHandler);if(!this._isFunctionsOverriden){this.grid._visibleAreaWidth(this.options.minimalVisibleAreaWidth);this._gridRenderRowHandler=$.proxy(this.grid._renderRow,this.grid);this._renderRowHandler=$.proxy(this._renderRow,this);this.grid._renderRow=this._renderRowHandler;this._gridRenderRecordsForTableHandler=$.proxy(this.grid._renderRecordsForTable,this.grid);this._renderRecordsForTableHandler=$.proxy(this._renderRecordsForTable,this);this.grid._renderRecordsForTable=this._renderRecordsForTableHandler;this._gridRenderNewRowHandler=$.proxy(this.grid.renderNewRow,this.grid);this._renderNewRowHandler=$.proxy(this._renderNewRow,this);this.grid.renderNewRow=this._renderNewRowHandler;this._gridDetachColumnHandler=$.proxy(this.grid._detachColumn,this.grid);this._detachColumnHandler=$.proxy(this._detachColumn,this);this.grid._detachColumn=this._detachColumnHandler;this._gridAttachColumnHandler=$.proxy(this.grid._attachColumn,this.grid);this._attachColumnHandler=$.proxy(this._attachColumn,this);this.grid._attachColumn=this._attachColumnHandler;this._gridRerenderColgroupsHandler=$.proxy(this.grid._rerenderColgroups,this.grid);this._rerenderColgroupsHndlr=$.proxy(this._rerenderColgroups,this);this.grid._rerenderColgroups=this._rerenderColgroupsHndlr;this._gridRenderColgroupHandler=$.proxy(this.grid._renderColgroup,this.grid);this._renderColgroupHandler=$.proxy(this._renderColgroup,this);this.grid._renderColgroup=this._renderColgroupHandler;this._gridUpdatePaddingHandler=$.proxy(this.grid._updateVScrollbarCellPaddingHelper,this.grid);this._updateVScrollbarCellPaddingHelperHandler=$.proxy(this._updateVScrollbarCellPaddingHelper,this);this.grid._updateVScrollbarCellPaddingHelper=this._updateVScrollbarCellPaddingHelperHandler;this._isFunctionsOverriden=true}}});$.extend($.ui.igGridColumnFixing,{version:"16.1.20161.1009"})})(jQuery);/*!@license
* Infragistics.Web.ClientUI Grid Editing 16.1.20161.1009
*
* Copyright (c) 2011-2016 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on:
* jquery-1.9.1.js
* jquery.ui-1.9.0.js
* infragistics.ui.grid.framework.js
* infragistics.ui.grid.shared.js
* infragistics.ui.editors.js
* infragistics.ui.validator.js
* infragistics.ui.combo.js
* infragistics.ui.rating.js
* infragistics.ui.shared.js
* infragistics.dataSource.js
* infragistics.util.js
*/
(function($){"use strict";$.widget("ui.igGridUpdating",{options:{columnSettings:[{columnKey:null,editorType:null,editorProvider:null,editorOptions:null,required:null,readOnly:null,validation:null,defaultValue:null}],editMode:"row",enableDeleteRow:true,enableAddRow:true,validation:false,doneLabel:null,doneTooltip:null,cancelLabel:null,cancelTooltip:null,addRowLabel:null,addRowTooltip:null,deleteRowLabel:null,deleteRowTooltip:null,showDoneCancelButtons:true,enableDataDirtyException:true,startEditTriggers:"click,F2,enter",horizontalMoveOnEnter:false,excelNavigationMode:false,saveChangesSuccessHandler:null,saveChangesErrorHandler:null,swipeDistance:"100px",wrapAround:true,rowEditDialogOptions:{captionLabel:null,containment:"owner",width:"370px",height:"350px",animationDuration:200,showReadonlyEditors:true,showEditorsForHiddenColumns:false,namesColumnWidth:"150px",editorsColumnWidth:null,showDoneCancelButtons:true,dialogTemplate:null,dialogTemplateSelector:null,editorsTemplate:null,editorsTemplateSelector:null},inherit:false},events:{editRowStarting:"editRowStarting",editRowStarted:"editRowStarted",editRowEnding:"editRowEnding",editRowEnded:"editRowEnded",editCellStarting:"editCellStarting",editCellStarted:"editCellStarted",editCellEnding:"editCellEnding",editCellEnded:"editCellEnded",rowAdding:"rowAdding",rowAdded:"rowAdded",rowDeleting:"rowDeleting",rowDeleted:"rowDeleted",dataDirty:"dataDirty",generatePrimaryKeyValue:"generatePrimaryKeyValue",rowEditDialogBeforeOpen:"rowEditDialogBeforeOpen",rowEditDialogAfterOpen:"rowEditDialogAfterOpen",rowEditDialogBeforeClose:"rowEditDialogBeforeClose",rowEditDialogAfterClose:"rowEditDialogAfterClose",rowEditDialogContentsRendered:"rowEditDialogContentsRendered"},css:{buttonContainer:"ui-iggrid-buttoncontainer ui-widget-content ui-corner-all",button:"ui-iggrid-button ui-state-default ui-corner-all",doneButton:"ui-iggrid-donebutton ui-priority-primary ui-corner-all",cancelButton:"ui-iggrid-cancelbutton ui-corner-all",deleteButton:"ui-iggrid-deletebutton ui-state-default ui-corner-all",buttonHover:"ui-iggrid-buttonhover ui-state-hover",buttonDisabled:"ui-iggrid-buttondisabled ui-state-disabled",buttonActive:"ui-iggrid-buttonactive ui-state-active",doneIcon:"ui-iggrid-doneicon ui-icon ui-icon-check",cancelIcon:"ui-iggrid-cancelicon ui-icon ui-icon-cancel",buttonIconOnly:"ui-iggrid-button-icon-only",editingCell:"ui-iggrid-editingcell",addRow:"ui-iggrid-addrow ui-widget-header",addRowHover:"ui-iggrid-addrowhover ui-state-hover",addRowActive:"ui-iggrid-addrowactive ui-state-active",addRowIcon:"ui-iggrid-addrowicon ui-icon ui-icon-circle-plus",deleteIcon:"ui-iggrid-deleteicon ui-icon ui-icon-circle-close",editor:"ui-iggrid-editor",rowEditDialogHeaderCaption:"ui-dialog-titlebar ui-iggrid-filterdialogcaption ui-widget-header ui-corner-all ui-helper-reset ui-helper-clearfix",rowEditDialogHeaderCaptionTitle:"ui-dialog-title",rowEditDialogCloseButton:"ui-icon ui-icon-close",rowEditDialog:"ui-dialog ui-draggable ui-resizable ui-iggrid-dialog ui-widget ui-widget-content ui-corner-all",blockArea:"ui-widget-overlay ui-iggrid-blockarea",rowEditDialogButtonsContainer:"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix",rowEditDialogTable:"ui-iggrid-filtertable ui-helper-reset"},setCellValue:function(rowId,colKey,value){var provider;if(rowId===null||rowId===undefined||$.type(colKey)!=="string"){return}if(value===undefined){throw new Error($.ig.GridUpdating.locale.undefinedCellValue)}if(!this._recOrPropFound(rowId,colKey)){throw new Error($.ig.GridUpdating.locale.recordOrPropertyNotFoundException)}if(this.isEditing()&&this._editingForRowId===rowId){if(this._originalValues.hasOwnProperty(colKey)){provider=this._providerForKey(colKey).igEditorFilter("option","provider");provider.setValue(value);this._editorTextChanged();return}else{this.endEdit(false,false)}}this._updateCell(rowId,colKey,value)},updateRow:function(rowId,values){var key,provider,shouldUpdate=false;if(rowId===null||rowId===undefined||$.type(values)!=="object"){return}if(!this._recOrPropFound(rowId)){throw new Error($.ig.GridUpdating.locale.recordOrPropertyNotFoundException)}if(this.isEditing()&&this._editingForRowId===rowId){for(key in values){if(values.hasOwnProperty(key)&&this._originalValues.hasOwnProperty(key)){provider=this._providerForKey(key).igEditorFilter("option","provider");provider.setValue(values[key])}else{this.endEdit(false,false);shouldUpdate=true;break}}this._editorTextChanged()}else{shouldUpdate=true}if(shouldUpdate){this._updateRow(rowId,values,null,null)}},addRow:function(values){var settings=this.options.columnSettings,i=settings?settings.length:0,defVals={},key,val;while(i-->0){key=settings[i].columnKey;val=settings[i].defaultValue;if(val!==undefined&&key!==undefined&&key!==null){defVals[key]=val}}this._addRow(null,$.extend(defVals,values),defVals,true)},deleteRow:function(rowId){if(rowId===null||rowId===undefined){return}if(!this._recOrPropFound(rowId)){throw new Error($.ig.GridUpdating.locale.recordOrPropertyNotFoundException)}if(this.isEditing()&&this._editingForRowId===rowId){this.endEdit(false)}this._deleteRow(null,rowId,true)},startEdit:function(rowId,column,raiseEvents){var columnIndex,columnKey,mode=this.options.editMode,visibleColumns=this.grid._visibleColumns(),cell,row;if(this.isEditing()){throw new Error($.ig.GridUpdating.locale.editingInProgress)}if($.type(column)==="string"){columnKey=column;columnIndex=this._getVisibleIndexForKey(columnKey)}else if($.type(column)==="number"&&column>=0&&column<visibleColumns.length){columnKey=visibleColumns[column].key;columnIndex=column}if(!columnKey||columnIndex===undefined||columnIndex===null){if(mode==="cell"){throw new Error($.ig.Grid.locale.columnNotFound.replace("{key}",columnKey))}columnKey=visibleColumns[0].key;columnIndex=0}if(mode==="cell"&&visibleColumns[columnIndex].readOnly){return false}switch(mode){case"dialog":return this._startEditDialog(null,!raiseEvents,rowId,false,columnKey,cell);case"row":row=this.grid.rowById(rowId);if(!row||!row.length){throw new Error($.ig.GridUpdating.locale.rowOrColumnSpecifiedOutOfView)}return this._startEditForRow(null,!raiseEvents,rowId,columnKey,row);case"cell":cell=this.grid.cellById(rowId,columnKey);if(!cell||!cell.length){throw new Error($.ig.GridUpdating.locale.rowOrColumnSpecifiedOutOfView)}return this._startEditForCell(null,!raiseEvents,rowId,columnKey,cell,true,false)}},startAddRowEdit:function(raiseEvents){if(this.isEditing()){throw new Error($.ig.GridUpdating.locale.editingInProgress)}if(!this.options.enableAddRow){return false}if(this.options.editMode==="dialog"){return this._startEditDialog(null,!raiseEvents,null,true,this.grid._visibleColumns()[0].key,null)}return this._startEditForRow(null,!raiseEvents,null,null,this.grid.headersTable().children("thead").children("[data-add-row]").children(":not([data-skip='true'])").first())},endEdit:function(update,raiseEvents){var dialog;if(!this.isEditing()){return}if(this.options.editMode==="dialog"){dialog=$("#"+this.grid.id()+"_updating_dialog_container");if(dialog&&dialog.data("igGridModalDialog")){this._dialogClosingFromUI=!!raiseEvents;dialog.igGridModalDialog("closeModalDialog",update)}}else{return this._endEdit(null,!!update,!raiseEvents)}},findInvalid:function(){var key,all=this._editors,provider;for(key in all){if(all.hasOwnProperty(key)&&all[key]){provider=all[key].data("igEditorFilter").options.provider;provider.refreshValue();if(!all[key].data("igEditorFilter").options.provider.validate()){return key}}}return null},isEditing:function(){return!!this._originalValues},editorForKey:function(key){var provider;if(!this._editors||!this._editors[key]){return null}provider=this._editors[key];return provider.igEditorFilter("option","provider").editor.element},editorForCell:function(cell,create){var columnKey=this._getColumnKeyForCell(cell);if(!this._editors){this._editors={}}if(!this._editors[columnKey]&&create){this._editors[columnKey]=this._createEditor(cell,columnKey)}return this.editorForKey(columnKey)},destroy:function(){if(this.options.enableAddRow){this._removeAddRow()}if(this.options.enableDeleteRow){this._removeDeleteButton()}if(this.options.showDoneCancelButtons&&this.options.editMode==="row"){this._removeDoneCancelButtons()}this._destroyAllEditors();this._unbindAllEvents();delete this._stopEditingHandler;delete this._gridHandlers;delete this._handlers;delete this._buttonHandlers;delete this._addNewRowHandlers;delete this._validationHandlers;delete this._dialogHandlers;delete this._editorCallbacks;$.Widget.prototype.destroy.call(this);return this},_setOption:function(key,value){var opts=this.options;if(opts[key]===value){return this}if(key==="editMode"){if(this.grid._isMultiRowGrid()&&value!=="dialog"){throw new Error($.ig.GridUpdating.locale.multiRowGridNotSupportedWithCurrentEditMode)}this.endEdit(false,false);this._dialogInvalid=true;this._destroyAllEditors()}$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"rowEditDialogOptions":this._dialogInvalid=true;opts.rowEditDialogOptions=$.extend(opts.rowEditDialogOptions,value);break;case"enableDeleteRow":if(value===true){this._renderDeleteButton()}else{this._removeDeleteButton()}break;case"enableAddRow":if(value===true&&this.grid.options.showHeader){this._updateAddNewRow()}else{this._removeAddRow()}this._rebindEditTriggers();break;case"startEditTriggers":this._analyzeEditTriggers();this._rebindEditTriggers();break;case"columnSettings":this.endEdit(false,false);this._destroyAllEditors();this._processReadOnly();this.grid._renderData();break}if(key==="saveChangesSuccessHandler"){this._addDSSuccessHandler()}else if(key==="saveChangesErrorHandler"){this._addDSErrorHandler()}return this},_gridDataRendering:function(evt,ui){var ds,l,noCancel;if(ui&&ui.owner.id()!==this.grid.id()){return}ds=this.grid.dataSource;l=ds.data()?ds.data().length:0;if(!this.grid.options.showHeader){this._processReadOnly()}if(this.isEditing()){if(!this.endEdit(this.grid.options.autoCommit,true)){this.endEdit(false,true)}}this._pkVal=Math.max(this._pkVal||1,l+1);if(ds.pendingTransactions().length){if(this.options.enableDataDirtyException){noCancel=this._trigger(this.events.dataDirty,null,{owner:this});if(noCancel){throw new Error($.ig.GridUpdating.locale.dataDirtyException)}}}if(l&&!this.grid.options.primaryKey){throw new Error($.ig.Grid.locale.noPrimaryKeyDefined)}},_gridRendered:function(){this._rebindEditTriggers()},_rowsRendered:function(evt,ui){if(ui&&ui.owner&&ui.owner.id()!==this.grid.id()){return}this._paintModifiedCells()},_virtPreRender:function(evt,ui){if(ui&&ui.owner&&ui.owner.id()!==this.grid.id()){return}if(this.isEditing()&&!this._vscrolled){if(!this._endEdit(evt,true,false,true)){this._endEdit(evt,false,false,true)}}delete this._vscrolled},_virtPostRender:function(evt,ui){if(ui&&ui.owner&&ui.owner.id()!==this.grid.id()){return}this.hideDeleteButton();this._paintModifiedCells()},_headerRendered:function(evt,ui){if(ui.owner.id()!==this.grid.id()){return}this._updateAddNewRow()},_fixedColumnsChanged:function(){this._stopEditing();this._editorsContainerInvalid=true;if(this.options.enableAddRow){this._updateAddNewRow()}if(this.options.enableDeleteRow){this._removeDeleteButton();this._renderDeleteButton()}if(this.options.showDoneCancelButtons&&this.options.editMode==="row"){this._removeDoneCancelButtons()}},_groupedColumnsChanged:function(){if(this.options.enableAddRow){this._updateAddNewRow()}},_hidingFinishing:function(){if(this.isEditing()){if(!this.endEdit(true,true)){this.endEdit(false,true)}}},_columnsModified:function(evt,ui){if(ui.owner.id()!==this.grid.id()){return}this._editorsContainerInvalid=true;if(this.options.enableAddRow){this._updateAddNewRow()}this._paintModifiedCells()},_scroll:function(){if(this.isEditing()){if(this._editingForRowId===null){this._positionDoneCancelButtons(this.grid.headersTable().find("tr[data-new-row]"))}else if(this._editingForRowId!==undefined){this._positionDoneCancelButtons(this.grid.rowById(this._editingForRowId))}this._hideValidatorMessages()}},_mouseDown:function(evt){var target=$(evt.target).closest("td"),targetContainer=target.closest(".ui-iggrid"),originalTarget=evt.originalEvent.target instanceof jQuery?evt.originalEvent.target[0]:evt.originalEvent.target,targetGrid=target.closest(this.grid._isMultiRowGrid()?".ui-iggrid-table-mrl":".ui-iggrid-table"),re=new RegExp("^"+this.grid.id()+"(_fixed)?$"),selection=this.grid.element.data("igGridSelection");if(evt.originalEvent&&evt.originalEvent.type==="touchstart"){this._cevt=originalTarget}else{if(this._cevt===originalTarget){this._cevt=null;return}}if(targetContainer.length&&targetContainer[0]===this.grid.container()[0]){if(this.isEditing()){if(!target.hasClass(this.css.editingCell)&&(this.options.editMode==="cell"||this._getRowId(target.closest("tr"))!==this._editingForRowId)){this._endEdit(evt,true,false)}}if(this.grid.headersTable().children("thead").has(target).length||this.grid.fixedHeadersTable().children("thead").has(target).length){return}if(targetGrid.length&&targetGrid.attr("id").match(re)){if(selection&&!target.hasClass("ui-iggrid-selectedcell")){this._wait=true}else{delete this._wait}}}},_clickTrigger:function(evt){var target=$(evt.target),targetCell=target.closest("td"),targetGrid=targetCell.closest(".ui-iggrid");if(targetGrid.length&&targetGrid[0]===this.grid.container()[0]&&!target.is("a")){if(this._wait){delete this._wait;if(evt.type!=="dblclick"){return}}this._startEditForElement(evt,targetCell)}},_keyDown:function(evt){var target=$(evt.target),targetGrid=target.closest(".ui-iggrid"),sel,row;if(!targetGrid.length||targetGrid[0]!==this.grid.container()[0]){return}if(target.is("td,tr")){if(evt.keyCode===$.ui.keyCode.ENTER&&this._editTriggers.enter||evt.keyCode===113&&this._editTriggers.f2){if(this.options.editMode==="cell"&&target.is("tr")){target=this._getEditableCellsForRow(target).first()}this._startEditForElement(evt,target)}else if(evt.keyCode===$.ui.keyCode.DELETE&&this.options.enableDeleteRow&&!this.isEditing()){sel=this.grid.element.data("igGridSelection");if(sel&&sel.options.mode==="row"&&sel.options.multipleSelection){this._deleteMultipleRows(evt)}else{row=target.closest("tr");if(this._isEditableRow(row)){this._deleteRow(evt,this._getRowId(row),false)}}}}},_touchStart:function(evt){this._firstTouchX=evt.originalEvent.touches&&evt.originalEvent.touches[0]?evt.originalEvent.touches[0].pageX:evt.originalEvent.clientX;this._firstTouchRow=evt.originalEvent.touches?$(evt.originalEvent.touches[0].target).closest("tr"):$(evt.originalEvent.target).closest("tr");this._storedScrollLeft=this.grid.scrollContainer().scrollLeft()||0;this._storedScrollWidth=this.grid.scrollContainer().width()||0},_touchEnd:function(evt){var changedTouchX=evt.originalEvent.changedTouches&&evt.originalEvent.changedTouches[0]?evt.originalEvent.changedTouches[0].pageX:evt.originalEvent.clientX;this._storedScrollLeft-=this.grid.scrollContainer().scrollLeft()||0;this._storedScrollWidth-=this.grid.scrollContainer().width()||0;if(this.options.enableDeleteRow&&Math.abs(changedTouchX-this._firstTouchX)>parseInt(this.options.swipeDistance,10)&&this._firstTouchRow&&this._storedScrollLeft===0&&this._storedScrollWidth===0){this.showDeleteButtonFor(this._firstTouchRow)}delete this._firstTouchX;delete this._firstTouchRow;delete this._storedScrollLeft;delete this._storedScrollWidth;delete this._firstTouchRow},_pointerDown:function(evt){var oe=evt.originalEvent;if(oe.pointerType!=="touch"){return}this._firstTouchX=oe.pageX;this._firstTouchRow=$(oe.target).closest("tr");this._storedScrollLeft=this.grid.scrollContainer().scrollLeft()||0;this._storedScrollWidth=this.grid.scrollContainer().width()||0},_pointerUp:function(evt){var oe=evt.originalEvent,changedTouchX;if(oe.pointerType!=="touch"){return}changedTouchX=oe.pageX;this._storedScrollLeft-=this.grid.scrollContainer().scrollLeft()||0;this._storedScrollWidth-=this.grid.scrollContainer().width()||0;if(this.options.enableDeleteRow&&Math.abs(changedTouchX-this._firstTouchX)>parseInt(this.options.swipeDistance,10)&&this._firstTouchRow&&this._storedScrollLeft===0&&this._storedScrollWidth===0){this.showDeleteButtonFor(this._firstTouchRow)}delete this._firstTouchX;delete this._firstTouchRow;delete this._storedScrollLeft;delete this._storedScrollWidth;delete this._firstTouchRow},_addRowFocus:function(evt){$(evt.target).closest("tr").addClass(this.css.addRowActive)},_addRowBlur:function(evt){$(evt.target).closest("tr").removeClass(this.css.addRowActive)},_rowMouseEnter:function(evt){var row=$(evt.target).closest("tr");if(!this.isEditing()&&this._isEditableRow(row)){this.showDeleteButtonFor(row)}else{this.hideDeleteButton()}},_rowPointerEnter:function(evt){if(evt.originalEvent.pointerType==="mouse"){this._rowMouseEnter(evt)}},_containerMouseLeave:function(){this.hideDeleteButton()},_buttonMouseEnter:function(evt){var button=$(evt.target).closest(".ui-iggrid-button,.ui-iggrid-deletebutton");if(!button.hasClass("ui-state-disabled")){button.addClass(this.css.buttonHover)}},_buttonMouseLeave:function(evt){var button=$(evt.target).closest(".ui-iggrid-button,.ui-iggrid-deletebutton");button.removeClass(this.css.buttonHover)},_buttonFocus:function(evt){var button=$(evt.target).closest(".ui-iggrid-button,.ui-iggrid-deletebutton");if(!button.hasClass("ui-state-disabled")){button.addClass(this.css.buttonActive)}},_buttonBlur:function(evt){$(evt.target).removeClass(this.css.buttonActive)},_doneButtonClick:function(evt){var target=$(evt.target).closest(".ui-iggrid-button");if(!target.length||target.hasClass(this.css.buttonDisabled)){return}this._endEdit(evt,true)},_doneButtonKeyUp:function(evt){var target=$(evt.target).closest(".ui-iggrid-button");if(!target.length||target.hasClass(this.css.buttonDisabled)||evt.keyCode!==$.ui.keyCode.ENTER){return}this._endEdit(evt,true)},_cancelButtonKeyUp:function(evt){if(evt.keyCode===$.ui.keyCode.ENTER){this._stopEditing()}},_deleteButtonClick:function(evt){var rowId=$(evt.target).closest(".ui-iggrid-deletebutton").data("button-for");if(this._deleteRow(evt,rowId,false)){this.hideDeleteButton()}},_touchDeleteButtonClick:function(evt){var rowId=this._editingForRowId,target=$(evt.target).closest(".ui-iggrid-button");if(this.isEditing()&&!target.hasClass(this.css.buttonDisabled)){this._endEdit(evt,false,false);this._deleteRow(evt,rowId,false)}},_touchDeleteButtonKeyUp:function(evt){var rowId,target=$(evt.target).closest(".ui-iggrid-button");if(evt.keyCode===$.ui.keyCode.ENTER){rowId=this._editingForRowId;if(this.isEditing()&&!target.hasClass(this.css.buttonDisabled)){this._endEdit(evt,false,false);this._deleteRow(evt,rowId,false)}}},_dialogCloseClick:function(){var dialog=$("#"+this.grid.id()+"_updating_dialog_container");if(dialog&&dialog.data("igGridModalDialog")){this._dialogClosingFromUI=true;dialog.igGridModalDialog("closeModalDialog",false)}},_dialogDone:function(evt,ui){ui.toClose=true;this._dialogClosingFromUI=true},_dialogCancel:function(evt,ui){ui.toClose=true;this._dialogClosingFromUI=true},_dialogClosing:function(evt,ui){var dialog=ui.modalDialog;if(this._dialogClosingFromUI){this._trigger(this.events.rowEditDialogBeforeClose,evt,{owner:this,dialogElement:dialog})}return this._endEditDialog(evt,ui.accepted,ui.owner.getContent(),!this._dialogClosingFromUI)},_dialogClosed:function(evt,ui){if(this._dialogClosingFromUI){this._trigger(this.events.rowEditDialogAfterClose,evt,{owner:this,dialogElement:ui.modalDialog})}},_dialogOpening:function(evt,ui){var dialog=ui.modalDialog,opts=this.options.rowEditDialogOptions,rowId=this.grid._fixPKValue(dialog.attr("data-for-rowid")),isAdding=dialog.attr("data-isadding")==="true",content=dialog.igGridModalDialog("getContent"),templateParent,she=opts.showEditorsForHiddenColumns,cols=$.extend([],this.grid.options.columns),values=isAdding?this._getDefaultValues():this._getLatestValues(rowId),cache=content.find("[data-render-tmpl]").children(),invalid=!!this._editorsContainerInvalid;if(cache.length){if(!invalid){cache.detach()}else{this._clearEditorsFromContainer(cache);cache.remove()}}this._renderDialogContent(content,values);this._initDialogEditors(content,cols,values);templateParent=content.find("[data-render-tmpl]");if(templateParent.length&&!templateParent.children().length){if(!invalid){cache.appendTo(templateParent)}else{this._renderDialogTemplate(templateParent,cols,!she);delete this._editorsContainerInvalid}}this._initDialogEditors(content,cols,values);if(isAdding&&!this._anyEditorInvalid()){this._enableDoneButton()}else{this._disableDoneButton()}$.extend(this._originalValues,values,this._originalValues);this._trigger(this.events.rowEditDialogAfterOpen,evt,{owner:this,dialogElement:dialog});this._trigger(this.events.editRowStarted,evt,{owner:this,rowAdding:isAdding,rowID:rowId})},_editorErrorShowing:function(evt,ui){var colKey=this._getEditorKey(ui.owner.element);if(this._errorShownFor&&this._errorShownFor!==colKey){return false}},_editorErrorShown:function(evt,ui){var colKey=this._getEditorKey(ui.owner.element);this._errorShownFor=colKey;this._disableDoneButton()},_editorErrorHidden:function(){delete this._errorShownFor;this._enableDoneButton()},_editorTextChanged:function(){if(this._fromExitEditing){delete this._fromExitEditing;return}if(!this.findInvalid()){this._enableDoneButton()}else{this._disableDoneButton()}},_editorKeyDown:function(evt,ui,columnKey){var keyCode=evt.keyCode,rowId,editor=this._editors[columnKey],providerWrapper=editor.data("igEditorFilter"),provider,row=ui.owner.element.closest("tr"),isAdd=row.hasClass("ui-iggrid-addrow")||row.attr("data-new-row");if(!row.length){return}if(providerWrapper){provider=providerWrapper.options.provider}if(keyCode===$.ui.keyCode.ESCAPE){if(this._revertValueForEditor(provider,columnKey)){evt.stopPropagation();return}}if(this.options.editMode==="dialog"){return}rowId=isAdd?null:this._getRowId(row);this._navigateElement(evt,keyCode,row,rowId,columnKey,isAdd)},_stopEditing:function(){if(this.isEditing()){this._endEdit(null,false)}},_paintModifiedCells:function(){var transactions=this.grid.pendingTransactions(),tran,i;for(i=0;i<transactions.length;i++){tran=transactions[i];this._updateUIForTransaction(tran)}},_removeAddRow:function(){this.grid.fixedHeadersTable().children("thead").children("tr[data-add-row='true'],tr[data-new-row='true']").remove();this.grid.headersTable().children("thead").children("tr[data-add-row='true'],tr[data-new-row='true']").remove()},_updateAddNewRow:function(){if(this.grid.hasFixedColumns()){this._updateAddNewRowForTable(true)}this._updateAddNewRowForTable(false)},_updateAddNewRowForTable:function(fixed){var numOfCols,thead,i,j,addRow,newRow,vcols,ihc,layout;if(fixed){thead=this.grid.fixedHeadersTable().children("thead")}else{thead=this.grid.headersTable().children("thead")}this._renderAddNewRow(thead);vcols=$.extend([],this.grid._visibleColumns(fixed));ihc=this.grid._initialHiddenColumns;if(ihc&&ihc.length){for(i=0;i<ihc.length;i++){for(j=0;j<vcols.length;j++){if(ihc[i].key===vcols[j].key){$.ig.removeFromArray(vcols,j,j);break}}}}numOfCols=this.grid._isMultiRowGrid()?this.grid._recordHorizontalSize():vcols.length;addRow=thead.children("tr[data-add-row='true']");addRow.children("td:last").attr("colspan",numOfCols);layout=this.grid._isMultiRowGrid()?this.grid._multiRowLayoutRenderingHelper(fixed):this._generateDummyLayout(vcols);for(i=0;i<layout.length;i++){newRow=thead.children("tr[data-new-row='true']").eq(i).empty();for(j=0;j<layout[i].length;j++){$("<td></td>").attr("aria-readonly",!!layout[i][j].col.readOnly).attr("aria-describedby",this.grid.id()+"_"+layout[i][j].col.key).attr("colspan",layout[i][j].cs||1).attr("rowspan",layout[i][j].rs||1).appendTo(newRow)}}newRow=thead.children("tr[data-new-row='true']");if(fixed&&this.grid.fixingDirection()==="left"||!fixed&&(this.grid.fixingDirection()!=="left"||!this.grid.hasFixedColumns())){addRow.find("th[data-skip='true'],td[data-skip='true']").remove();newRow.find("th[data-skip='true'],td[data-skip='true']").remove();this.grid._headerInit(addRow,null,true);this.grid._headerInit(newRow,null,true)}},_toggleAddRow:function(){var newRow=this.grid.headersTable().find("tr[data-new-row]"),addRow=this.grid.headersTable().find("tr[data-add-row]"),height;if(this.grid.hasFixedColumns()){newRow=newRow.add(this.grid.fixedHeadersTable().find("tr[data-new-row]"));addRow=addRow.add(this.grid.fixedHeadersTable().find("tr[data-add-row]"))}if(newRow.eq(0).is(":visible")){newRow.hide();addRow.show()}else{height=addRow.height();addRow.hide();newRow.show();newRow.css("height",height)}},_providerForKey:function(key){if(!this._editors){return null}return this._editors[key]||null},_startEditForElement:function(evt,target){var mode=this.options.editMode,td=target.is("td")?target:null,tr=target.is("tr")?target:target.parent(),isAdding=tr.hasClass("ui-iggrid-addrow"),rowId=isAdding?null:this._getRowId(tr),editEnded=true,col;if(mode==="dialog"){if(!td){td=tr.children("td:not([data-skip='true'],[data-parent='true'])").first()}if(!this._isDataCell(td)||!this._isEditableRow(tr)){return false}this._startEditDialog(evt,false,rowId,isAdding,null,td)}else if(mode==="row"||tr.hasClass("ui-iggrid-addrow")){if(!td){td=tr.children("td:not([data-skip='true'],[data-parent='true'])").first()}if(!this._isDataCell(td)||!this._isEditableRow(tr)){return false}if(this.isEditing()){if(this._editingForRowId===rowId){return false}editEnded=this._endEdit(evt,true,false)}return!editEnded?false:this._startEditForRow(evt,false,rowId,null,td)}else if(mode==="cell"){if(!this._isEditableCell(td)){return false}if(this.isEditing()){col=this._getColumnKeyForCell(td);if(rowId===this._editingForRowId&&col&&this._originalValues.hasOwnProperty(col)){return false}editEnded=this._endEdit(evt,true,false)}return!editEnded?false:this._startEditForCell(evt,false,rowId,col,td,true,isAdding)}return false},_startEditDialog:function(evt,suppress,rowId,adding,columnKey,element){var dialog=this._renderRowEditDialog(!!this._dialogInvalid);if(!suppress&&!this._trigger(this.events.editRowStarting,evt,{owner:this,rowAdding:adding,rowID:rowId})){return false}dialog.attr({"data-for-rowid":rowId,"data-isadding":adding});if(!suppress){this._trigger(this.events.rowEditDialogBeforeOpen,evt,{owner:this,dialogElement:dialog})}this._disableDoneButton();if(element&&element.is("td")&&!columnKey){columnKey=this._getColumnKeyForCell(element)}this._columnToFocus=this._chooseColumnToFocus(adding,columnKey);dialog.igGridModalDialog("openModalDialog");return true},_startEditForRow:function(evt,suppress,rowId,columnKey,element){var rowElement,args,editModeStarted=false,colElements,pair,columnToFocus=null,i,allValues,cellValue,isAdding;if(element.is("tr")){rowElement=element}else if(element.is("td")){rowElement=element.parent()}else{rowElement=this.grid.rowById(rowId)}isAdding=rowElement.hasClass("ui-iggrid-addrow");args={owner:this,rowAdding:isAdding,rowID:rowId};if(!suppress&&!this._trigger(this.events.editRowStarting,evt,args)){return}if(isAdding){rowElement=this._combineRowElements(rowElement);if(!rowElement.attr("data-new-row")){rowElement=rowElement.siblings("[data-new-row]");this._toggleAddRow()}}if(element&&element.is("td")&&!columnKey){columnKey=this._getColumnKeyForCell(element)}columnToFocus=this._chooseColumnToFocus(isAdding,columnKey);colElements=this._getEditableElementsForRow(rowElement);allValues=isAdding?this._getDefaultValues():this._getLatestValues(rowId);for(i=0;i<colElements.length;i++){pair=colElements[i];cellValue=allValues[pair.colKey]===undefined?null:allValues[pair.colKey];editModeStarted=this._startEditForCell(evt,suppress,rowId,pair.colKey,pair.element,pair.colKey===columnToFocus,isAdding,cellValue)||editModeStarted}if(editModeStarted){if(this.options.showDoneCancelButtons){this._showDoneCancelButtons();this._positionDoneCancelButtons(rowElement);if(isAdding&&!this._anyEditorInvalid()){this._enableDoneButton()}else{this._disableDoneButton()}if(this._renderTouchUI){this._updateTouchButtons(isAdding)}}if(!suppress){this._trigger(this.events.editRowStarted,evt,args)}this._editingForRowId=isAdding?null:rowId;$.extend(this._originalValues,allValues,this._originalValues);this._selectionToggle(rowElement)}else{rowElement.children().removeClass(this.css.editingCell);return false}return true},_startEditForCell:function(evt,suppress,rowId,columnKey,element,focus,isAdding,value){var providerWrapper,provider,validator,args,editor,newValue,width,height;columnKey=columnKey||this._getColumnKeyForCell(element);rowId=rowId===null?this._getRowId(element.closest("tr")):rowId;if(element){element.addClass(this.css.editingCell);editor=this.editorForCell(element,true);providerWrapper=this._providerForKey(columnKey);if(providerWrapper){provider=providerWrapper.igEditorFilter("option","provider")}else{return false}height=element.outerHeight();width=element.outerWidth();width=this._isLastScrollableCell(element)?width-this.grid._scrollbarWidth():width}if(value===undefined){value=this._getLatestValues(rowId,columnKey);value=value===undefined?null:value}args={owner:this,rowID:rowId,columnIndex:this.grid.getVisibleIndexByKey(columnKey),columnKey:columnKey,editor:editor,value:value,rowAdding:isAdding};if(!suppress&&!this._trigger(this.events.editCellStarting,evt,args)){if(editor){provider.setValue(null)}element.removeClass(this.css.editingCell);return false}if(editor){providerWrapper.css("z-index",1);providerWrapper.prependTo(element);provider.setSize(Math.max(8,width),Math.max(10,height));validator=provider.validator();newValue=args.value;provider.setValue(newValue)}this._originalValues=this._originalValues||{};this._originalValues[columnKey]=editor&&newValue===value?provider.getValue():value;this._trigger(this.events.editCellStarted,evt,args);if(focus&&editor){this._activateEditor(providerWrapper)}this.hideDeleteButton();this._editingForRowId=rowId;if(this.options.editMode==="cell"&&!isAdding){this._selectionToggle(element)}return true},_endEditDialog:function(evt,shouldUpdate,dialogContent,suppress){var newValues={},prevValues=this._originalValues,update,colElements,hasInvalid,add=dialogContent.parent().attr("data-isadding")==="true",noCancel,isChanged,rowId=this.grid._fixPKValue(dialogContent.parent().attr("data-for-rowid"));colElements=this._getEditedColumnElementsForDialog(dialogContent);if(shouldUpdate){hasInvalid=this._handleInvalid(colElements);if(hasInvalid){return false}newValues=this._getNewValuesForRow(colElements);isChanged=this._compareValues(prevValues,newValues);if(add){newValues=$.extend({},prevValues,newValues)}}update={update:shouldUpdate&&(isChanged||add!==undefined)};if(!suppress){noCancel=this._fireEndingEvents(evt,prevValues,newValues,colElements,rowId,add,update);if(!noCancel){return false}}delete this._originalValues;delete this._editingForRowId;if(update.update&&(this._compareValues(prevValues,newValues)||add)){if(add){this._addRow(evt,newValues,prevValues,suppress,rowId)}else{this._updateRow(prevValues[this.grid.options.primaryKey],newValues,null,null)}}if(!suppress){this._fireEndedEvents(evt,prevValues,newValues,colElements,rowId,add,update)}this._hideValidatorMessages();return true},_endEdit:function(evt,shouldUpdate,suppress,dontToggle){var cell,row,rowId,colKey,colElements,hasInvalid,add,prevValues=this._originalValues,newValues={},isChanged,noCancel=true,update,val,at;cell=this.grid.container().find("."+this.css.editingCell).first();row=cell.closest("tr");at=row.data("parent-id");rowId=this._getRowId(row);add=row.data("new-row");colElements=this._getEditedColumnElementsForRow(row);if(shouldUpdate){hasInvalid=this._handleInvalid(colElements);if(hasInvalid){return false}newValues=this._getNewValuesForRow(colElements);isChanged=this._compareValues(prevValues,newValues);if(add){newValues=$.extend({},prevValues,newValues)}}update={update:shouldUpdate&&(isChanged||add!==undefined)};if(!suppress){noCancel=this._fireEndingEvents(evt,prevValues,newValues,colElements,rowId,add,update);if(!noCancel){return false}}this._closeEditingForRow(colElements);delete this._originalValues;
delete this._editingForRowId;if(add){this._toggleAddRow()}if(update.update&&(this._compareValues(prevValues,newValues)||add)){if(add){this._addRow(evt,newValues,prevValues,suppress,at)}else if(this.options.editMode==="cell"){colKey=colElements[0].colKey;cell=colElements[0].element;val=newValues[colKey];this._updateCell(rowId,colKey,val,cell)}else{this._updateRow(rowId,newValues,prevValues,row)}}if(!suppress){this._fireEndedEvents(evt,prevValues,newValues,colElements,rowId,add,update)}this._hideDoneCancelButtons();this._selectionToggle(null,dontToggle);delete this._fromExitEditing;return true},_handleInvalid:function(colElements){var i,key,editor,provider,providerWrapper;for(i=0;i<colElements.length;i++){key=colElements[i].colKey;editor=this._providerForKey(key);providerWrapper=editor.data("igEditorFilter");providerWrapper.options.provider.refreshValue();this._fromExitEditing=true;providerWrapper.exitEditMode();provider=providerWrapper.options.provider;if(editor&&editor.length&&editor.is(":visible")&&(providerWrapper.hasInvalidMessage()||!provider.requestValidate()||!provider.isValid())){this._activateEditor(editor);this._disableDoneButton();return true}}return false},_fireEndingEvents:function(evt,prevValues,newValues,colElements,rowId,add,update){var i,colKey,editor,rArg,cArg,mode=this.options.editMode,noCancel;if(mode!=="cell"){rArg={owner:this,oldValues:prevValues,values:update.update?newValues:prevValues,rowID:rowId,update:update.update,rowAdding:add};noCancel=this._trigger(this.events.editRowEnding,evt,rArg);if(update.update){update.update=rArg.update}if(!noCancel){return false}}if(mode!=="dialog"){for(i=0;i<colElements.length;i++){colKey=colElements[i].colKey;editor=this.editorForKey(colKey);cArg={owner:this,rowID:rowId,columnIndex:this.grid.getVisibleIndexByKey(colKey),columnKey:colKey,editor:editor,value:newValues.hasOwnProperty(colKey)?newValues[colKey]:prevValues[colKey],oldValue:prevValues[colKey],update:update.update&&newValues[colKey]!==prevValues[colKey],rowAdding:add};noCancel=this._trigger(this.events.editCellEnding,evt,cArg);if(!noCancel&&mode==="cell"){return false}if(update.update){newValues[colKey]=cArg.value;if(mode==="cell"&&!add){update.update=cArg.update}else{if(!cArg.update){newValues[colKey]=prevValues[colKey]}}}}}return true},_fireEndedEvents:function(evt,prevValues,newValues,colElements,rowId,add,update){var i,colKey,editor,rArg,cArg,mode=this.options.editMode;if(mode!=="dialog"){for(i=0;i<colElements.length;i++){colKey=colElements[i].colKey;editor=this.editorForKey(colKey);cArg={owner:this,rowID:rowId,columnIndex:this.grid.getVisibleIndexByKey(colKey),columnKey:colKey,editor:editor,value:newValues.hasOwnProperty(colKey)?newValues[colKey]:prevValues[colKey],oldValue:prevValues[colKey],update:update.update&&newValues[colKey]!==prevValues[colKey],rowAdding:add};this._trigger(this.events.editCellEnded,evt,cArg)}}if(mode!=="cell"){rArg={owner:this,oldValues:prevValues,values:update.update?newValues:prevValues,rowID:rowId,update:update.update,rowAdding:add};this._trigger(this.events.editRowEnded,evt,rArg)}},_getNewValuesForRow:function(colElements){var i,key,editor,provider,providerWrapper,newValues={};for(i=0;i<colElements.length;i++){key=colElements[i].colKey;editor=this._providerForKey(key);providerWrapper=editor.data("igEditorFilter");provider=providerWrapper.options.provider;newValues[key]=provider.getValue()}return newValues},_compareValues:function(prevValues,newValues){var key,noChange=true;for(key in newValues){if(newValues.hasOwnProperty(key)){if($.type(newValues[key])==="date"&&$.type(prevValues[key])==="date"){noChange=noChange&&newValues[key].getTime()===prevValues[key].getTime()}else{noChange=noChange&&newValues[key]===prevValues[key]}}}return!noChange},_closeEditingForRow:function(colElements){var i,colKey,editor,provider,providerWrapper;for(i=0;i<colElements.length;i++){colKey=colElements[i].colKey;editor=this._providerForKey(colKey);providerWrapper=editor.data("igEditorFilter");provider=providerWrapper.options.provider;providerWrapper.remove();colElements[i].element.closest("td").removeClass(this.css.editingCell)}},_createEditor:function(cell,columnKey,element){var vh=this._validationHandlers,colSetting=this._getColSettingsForCol(columnKey),column=this.grid.columnByKey(columnKey),provider=colSetting?colSetting.editorProvider:null,editorOptions,validatorOptions,required,editorMargins,wrapper,elem,format=column.format;editorMargins=!element?this._getEditorMargins(cell):null;if(colSetting){editorOptions=colSetting.editorOptions||{};validatorOptions=editorOptions.validatorOptions;required=colSetting.required;if(!validatorOptions&&(colSetting.validation||required)){validatorOptions={}}if(required){validatorOptions.required=true;editorOptions.required=true}}if(!validatorOptions&&this.options.validation){validatorOptions={};if(!editorOptions){editorOptions={}}}if(validatorOptions){if(!this.grid.element.igValidator){throw new Error($.ig.GridUpdating.locale.igValidatorException)}if(colSetting){colSetting.editorOptions=editorOptions}editorOptions.validatorOptions=validatorOptions;validatorOptions.notificationOptions=validatorOptions.notificationOptions||{};if(!element){validatorOptions.notificationOptions.mode="popover";validatorOptions.notificationOptions.containment=this.grid.container();validatorOptions.notificationOptions.appendTo=this.grid.container()}if(validatorOptions.notificationOptions.mode==="popover"&&element){validatorOptions.notificationOptions.containment=$(element.context);validatorOptions.notificationOptions.appendTo=$(element.context)}}if(!provider){provider=this._getProviderForKey(column,colSetting)}elem=provider.createEditor(this._editorCallbacks,columnKey,colSetting?colSetting.editorOptions||null:null,this._getNextTabIndex(),format,element);provider.attachErrorEvents(vh.errorShowing,vh.errorShown,vh.errorHidden);if(!element){elem.addClass(this.css.editor).css({marginLeft:editorMargins.x+"px",marginTop:editorMargins.y+"px"});elem.css("position","absolute")}wrapper=elem.igEditorFilter({provider:provider});return wrapper},_getProviderForKey:function(column,setting){var provider,dataType=column.dataType,format=column.format,editorType=setting?setting.editorType:null,value,ds;if(editorType==="checkbox"||dataType==="bool"){provider=new $.ig.EditorProviderBoolean;if(format==="checkbox"||!format&&this.grid.options.renderCheckboxes||editorType==="checkbox"){provider.renderFormat="checkbox"}else{provider.renderFormat="dropdown"}}else if(editorType==="combo"&&dataType==="object"){provider=new $.ig.EditorProviderObjectCombo}else if(editorType==="combo"&&dataType!=="object"){provider=new $.ig.EditorProviderCombo}else if(editorType==="rating"){provider=new $.ig.EditorProviderRating}else if(editorType==="mask"){provider=new $.ig.EditorProviderMask}else if((editorType||format)==="currency"){provider=new $.ig.EditorProviderCurrency}else if((editorType||format)==="percent"){provider=new $.ig.EditorProviderPercent}else if(editorType==="numeric"||dataType==="number"){provider=new $.ig.EditorProviderNumeric}else if(editorType==="text"||dataType==="string"){provider=new $.ig.EditorProviderText}else if(editorType==="datepicker"){provider=new $.ig.EditorProviderDatePicker}else if((editorType||dataType)==="date"){provider=new $.ig.EditorProviderDate}else{ds=this.grid.dataSource;if(ds&&ds.data()&&ds.data().length){value=ds.data()[0][column.key];switch($.type(value)){case"number":return new $.ig.EditorProviderNumeric;case"string":return new $.ig.EditorProviderText;case"date":return new $.ig.EditorProviderDate;case"boolean":provider=new $.ig.EditorProviderBoolean;if(format==="checkbox"||!format&&this.grid.options.renderCheckboxes){provider.renderFormat="checkbox"}else{provider.renderFormat="dropdown"}return provider}}throw new Error($.ig.GridUpdating.locale.editorTypeCannotBeDetermined+column.key)}return provider},_getEditorKey:function(element){var id=element.attr("id"),colKey,idx;if(id&&id.length){idx=id.indexOf("_editorfor_");colKey=idx>0?id.substring(idx+10):null}if(!colKey){colKey=this._getColumnKeyForCell(element.closest("td"))}return colKey},_getEditorMargins:function(cell){if(!cell||!cell.length){return{x:0,y:0}}if(!this._editorMargins){var btw=parseInt(cell.css("borderTopWidth"),10);var paddingTop=parseInt(cell.css("paddingTop"),10);var blw=parseInt(cell.css("borderLeftWidth"),10);var paddingLeft=parseInt(cell.css("paddingLeft"),10);this._editorMargins={x:-1*(paddingLeft+blw),y:-1*(paddingTop+btw)}}return this._editorMargins},_getColSettingsForCol:function(colKey){var i,settings=this.options.columnSettings;if(!settings){return null}for(i=0;i<settings.length;i++){if(settings[i].columnKey===colKey){return settings[i]}}},_destroyAllEditors:function(){var key;for(key in this._editors){if(this._editors.hasOwnProperty(key)){if(this._editors[key].data("igEditorFilter")){this._editors[key].igEditorFilter("destroy");this._editors[key].remove()}}}delete this._editors},_navigateElement:function(evt,keyCode,row,rowId,columnKey,isAdd){if(keyCode===$.ui.keyCode.TAB||this.options.horizontalMoveOnEnter&&keyCode===$.ui.keyCode.ENTER){if(evt.shiftKey){return this._navigateLeft(evt,row,rowId,columnKey,isAdd)}return this._navigateRight(evt,row,rowId,columnKey,isAdd)}if(keyCode===$.ui.keyCode.ENTER){if(isAdd){return this._endEdit(evt,true,false)}if(evt.shiftKey){return this._navigateUp(evt,rowId,columnKey)}return this._navigateDown(evt,rowId,columnKey)}if(keyCode===$.ui.keyCode.ESCAPE){return this._stopEditing()}if(this.options.excelNavigationMode){switch(keyCode){case $.ui.keyCode.LEFT:return this._navigateLeft(evt,row,rowId,columnKey,isAdd);case $.ui.keyCode.RIGHT:return this._navigateRight(evt,row,rowId,columnKey,isAdd);case $.ui.keyCode.DOWN:if(!isAdd){return this._navigateDown(evt,rowId,columnKey)}break;case $.ui.keyCode.UP:if(!isAdd){return this._navigateUp(evt,rowId,columnKey)}break}}},_navigateLeft:function(evt,row,rowId,columnKey,isAdd){if(!isAdd&&this.options.editMode==="cell"){return this._navigateLeftForCell(evt,rowId,columnKey)}return this._navigateLeftForRow(evt,row,rowId,columnKey,isAdd)},_navigateLeftForRow:function(evt,row,rowId,columnKey,isAdd){var i,prevRow,prevCell,pairs=this._getEditedColumnElementsForRow(row),db,wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;for(i=0;i<pairs.length;i++){if(pairs[i].colKey===columnKey){break}}if(i===0){if(this.options.showDoneCancelButtons){db=$("#"+this.grid.id()+"_updating_done");if(db.hasClass(this.css.buttonDisabled)){db.siblings().first().focus()}else{db.focus()}return}if(!this._endEdit(evt,true,false)||isAdd){return}row=this.grid.rowById(rowId);prevRow=this._nextEditableDataRow(row,"prev");if(!prevRow.length&&wrap){prevRow=this._lastEditableDataRow()}if(!prevRow.length){return}prevCell=this._getEditableCellsForRow(prevRow).last();this._startEditForRow(evt,false,this._getRowId(prevRow),this._getColumnKeyForCell(prevCell),prevCell);evt.preventDefault()}else if(this.grid.columnByKey(pairs[i].colKey).fixed!==this.grid.columnByKey(columnKey).fixed){this._activateEditor(this._providerForKey(pairs[i-1].colKey))}else{this._scrollTo(pairs[i-1].element)}},_navigateLeftForCell:function(evt,rowId,columnKey){var i,cols=this.grid._visibleColumns(),nextCell,curRow,wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;if(!this._endEdit(evt,true,false,true)){return}curRow=this.grid.rowById(rowId);for(i=0;i<cols.length;i++){if(cols[i].key===columnKey){break}}while(curRow.length){rowId=this._getRowId(curRow);while(--i>=0){if(!cols[i].readOnly){nextCell=this.grid.cellById(rowId,cols[i].key);this._startEditForCell(evt,false,rowId,cols[i].key,nextCell,true,false);evt.preventDefault();return}}curRow=this._nextEditableDataRow(curRow,"prev");if(!curRow.length&&wrap){curRow=this._lastEditableDataRow()}i=cols.length}},_navigateRight:function(evt,row,rowId,columnKey,isAdd){if(!isAdd&&this.options.editMode==="cell"){return this._navigateRightForCell(evt,rowId,columnKey)}return this._navigateRightForRow(evt,row,rowId,columnKey,isAdd)},_navigateRightForCell:function(evt,rowId,columnKey){var i,cols=this.grid._visibleColumns(),nextCell,curRow,wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;if(!this._endEdit(evt,true,false,true)){return}curRow=this.grid.rowById(rowId);for(i=0;i<cols.length;i++){if(cols[i].key===columnKey){break}}while(curRow.length){rowId=this._getRowId(curRow);while(++i<cols.length){if(!cols[i].readOnly){nextCell=this.grid.cellById(rowId,cols[i].key);this._startEditForCell(evt,false,rowId,cols[i].key,nextCell,true,false);evt.preventDefault();return}}curRow=this._nextEditableDataRow(curRow,"next");if(!curRow.length&&wrap){curRow=this._firstEditableDataRow()}i=-1}},_navigateRightForRow:function(evt,row,rowId,columnKey,isAdd){var i,nextRow,nextCell,pairs=this._getEditedColumnElementsForRow(row),wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;for(i=0;i<pairs.length;i++){if(pairs[i].colKey===columnKey){break}}if(i===pairs.length-1){if(this.options.showDoneCancelButtons){return}if(!this._endEdit(evt,true,false)||isAdd){return}row=this.grid.rowById(rowId);nextRow=this._nextEditableDataRow(row,"next");if(!nextRow.length&&wrap){nextRow=this._firstEditableDataRow()}if(!nextRow.length){return}nextCell=this._getEditableCellsForRow(nextRow).first();this._startEditForRow(evt,false,this._getRowId(nextRow),this._getColumnKeyForCell(nextCell),nextCell);evt.preventDefault()}else if(this.grid.columnByKey(pairs[i].colKey).fixed!==this.grid.columnByKey(columnKey).fixed){this._activateEditor(this._providerForKey(pairs[i+1].colKey))}else{this._scrollTo(pairs[i+1].element)}},_navigateUp:function(evt,rowId,columnKey,element){var nextCell,curRow=element?element.closest("tr"):this.grid.rowById(rowId),wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;if(!this._endEdit(evt,true,false,true)){return}curRow=this._nextEditableDataRow(curRow,"prev");if(!curRow.length&&wrap){curRow=this._lastEditableDataRow()}if(curRow.length){rowId=this._getRowId(curRow);nextCell=this.grid.cellById(rowId,columnKey);if(this.options.editMode==="row"){this._startEditForRow(evt,false,rowId,columnKey,nextCell)}else{this._startEditForCell(evt,false,rowId,columnKey,nextCell,true,false)}evt.originalEvent.stopPropagation();evt.originalEvent.preventDefault()}},_navigateDown:function(evt,rowId,columnKey,element){var nextCell,curRow=element?element.closest("tr"):this.grid.rowById(rowId),wrap=this.options.wrapAround&&!this.grid.options.virtualization&&!this.grid.options.rowVirtualization;if(!this._endEdit(evt,true,false,true)){return}curRow=this._nextEditableDataRow(curRow,"next");if(!curRow.length&&wrap){curRow=this._firstEditableDataRow()}if(curRow.length){rowId=this._getRowId(curRow);nextCell=this.grid.cellById(rowId,columnKey);if(this.options.editMode==="row"){this._startEditForRow(evt,false,rowId,columnKey,nextCell)}else{this._startEditForCell(evt,false,rowId,columnKey,nextCell,true,false)}evt.originalEvent.stopPropagation();evt.originalEvent.preventDefault()}},_nextEditableDataRow:function(row,command){var go=this.grid.options,vVirt=go.virtualization||go.rowVirtualization,cIdx,query=":not([data-container],[data-grouprow],.ui-iggrid-deletedrecord):visible:first";if(vVirt){if(go.virtualizationMode==="fixed"){cIdx=row.index();if(cIdx>=this.grid._virtualRowCount-1&&command==="next"){this._scrollVmanual(true);return this._lastEditableDataRow()}if(cIdx<=0&&command==="prev"){this._scrollVmanual(false);return this._firstEditableDataRow()}}}row=row[command+"All"](query);if(vVirt&&go.virtualizationMode==="continuous"){this._setScroll(command==="next"?$.ui.keyCode.DOWN:$.ui.keyCode.UP,row)}return row},_firstEditableDataRow:function(){return this.element.children("tbody").children("tr:not([data-grouprow],.ui-iggrid-deletedrecord):visible:first")},_lastEditableDataRow:function(){return this.element.children("tbody").children("tr:not([data-container],.ui-iggrid-deletedrecord):visible:last")},_updateUnboundValuesForRow:function(row){if(!this.grid._hasUnboundColumns){return}var i,uc=this.grid._unboundColumns,col,f,rec;if(!uc||!uc.length){return}if($.type(row)==="object"){rec=row}for(i=0;i<uc.length;i++){col=uc[i];if(col&&col.editModeUnboundValues!=="manual"&&col.formula){if(col.formula){f=this.grid._getUnboundColumnFormula(col);if(f){if(!rec){rec=this.grid.findRecordByKey(row)}if(!rec){return}rec[col.key]=f.apply(col,[rec,this.grid.element])}}}}},_isEditableRow:function(row){return row&&row.is("tr")&&!row.hasClass(this.grid.css.deletedRecord)&&!row.attr("data-grouprow")&&(row.attr("data-id")!==undefined||row.attr("data-add-row")!==undefined)},_isEditableCell:function(cell){return this._isDataCell(cell)&&cell.attr("aria-readonly")!=="true"&&this._isEditableRow(cell.parent())},_isDataCell:function(cell){return cell&&cell.is("td")&&!cell.attr("data-skip")&&!cell.attr("data-parent")},_isLastScrollableCell:function(cell){return cell&&cell.is(":last-child")&&(parseInt(cell.css("padding-right"),10)>12||this.grid._hscrollbar().is(":visible")&&this.grid._hasVerticalScrollbar)&&this.grid.scrollContainer()&&this.grid.scrollContainer().has(cell).length},_selectionToggle:function(element,dontToggle){var sel=this.grid.element.data("igGridSelection");if(!sel){return}sel._suspend=!sel._suspend;if(element||dontToggle){this._actElement=element}else{this._actElement.focus()}},_showDoneCancelButtons:function(){var container=this._findElementInScrollContainer(".ui-iggrid-buttoncontainer:first");if(!container.length){container=this._renderDoneCancelButtons()}container.show()},_hideDoneCancelButtons:function(){var container=this._findElementInScrollContainer(".ui-iggrid-buttoncontainer:first");if(container.length){container.hide()}},_positionDoneCancelButtons:function(row){var container=this._findElementInScrollContainer(".ui-iggrid-buttoncontainer:first"),sbw=this.grid._hasVerticalScrollbar===true?this.grid._scrollbarWidth():0,left,top,sc,contHeight,scHeight,rowPos,go=this.grid.options,v,hasHeight=go.height!==null&&go.height!==undefined,scrContainer;row=this._combineRowElements(row);sc=container.parent();left=sc.outerWidth()-container.outerWidth()-sbw+sc.scrollLeft();if(!sc.has(row).length&&sc[0]!==this.grid.container()[0]){top=sc.scrollTop()}else{contHeight=container.outerHeight();scHeight=sc.outerHeight();rowPos=row.position();top=rowPos.top+row.outerHeight();if(top+contHeight>scHeight){top=rowPos.top-contHeight}if(!hasHeight){v=go.virtualization||go.rowVirtualization||go.columnVirtualization;scrContainer=v?this.grid._vdisplaycontainer():this.grid.scrollContainer();if(scrContainer.length){top+=scrContainer.position().top}}top+=sc.scrollTop()}container.css({top:top,left:left})},_disableDoneButton:function(){if(this.options.editMode==="dialog"){$("#"+this.grid.id()+"_updating_dialog_container").igGridModalDialog("option","buttonApplyDisabled",true)}else{$("#"+this.grid.id()+"_updating_done").addClass(this.css.buttonDisabled).removeClass(this.css.buttonActive).attr("tabIndex",-1)}},_enableDoneButton:function(){if(this.options.editMode==="dialog"){$("#"+this.grid.id()+"_updating_dialog_container").igGridModalDialog("option","buttonApplyDisabled",false)}else{$("#"+this.grid.id()+"_updating_done").removeClass(this.css.buttonDisabled).attr("tabIndex",this._getNextTabIndex()+1)}},_updateTouchButtons:function(isAdding){var button=$("#"+this.grid.id()+"_updating_delete_touch");if(button.length){if(isAdding||!this.options.enableDeleteRow){button.addClass(this.css.buttonDisabled)}else{button.removeClass(this.css.buttonDisabled)}}},showDeleteButtonFor:function(row){var db=$("#"+this.grid.id()+"_updating_deletehover"),go=this.grid.options,v,hasHeight=go.height!==null&&go.height!==undefined,sbw=this.grid.hasVerticalScrollbar()===true?this.grid._scrollbarWidth():0,left,top,sc,offset=0,scrContainer,totalHeight,rowGrp=row.siblings("[data-id='"+row.attr("data-id")+"']").add(row);if(db.length){db.show();sc=db.parent();if(!hasHeight){v=go.virtualization||go.rowVirtualization||go.columnVirtualization;scrContainer=v?this.grid._vdisplaycontainer():this.grid.scrollContainer();if(scrContainer.length){offset=scrContainer.position().top}}totalHeight=rowGrp.last().position().top+rowGrp.last().outerHeight()-rowGrp.first().position().top;left=sc.outerWidth()-db.outerWidth()-sbw+sc.scrollLeft()-5;top=rowGrp.first().position().top+totalHeight/2-db.outerHeight()/2+sc.scrollTop()+offset;db.css({top:top,left:left});db.data("button-for",this._getRowId(row))}},hideDeleteButton:function(){var db=$("#"+this.grid.id()+"_updating_deletehover");if(db.length){db.hide()}},_getNextTabIndex:function(){var gti=this.grid.options.tabIndex;return gti+1},_getRowId:function(element){return this.grid._fixPKValue(element.attr("data-id"))},_getEditableElementsForRow:function(row){var result=[],i,cells=this._getEditableCellsForRow(row),editableCols=$.grep(this.grid._visibleColumns(),function(col){return!col.readOnly}),vcc=this.grid.hasFixedColumns()?this.grid._visibleColumns().length:this.grid._virtualColumnCount||this.grid._visibleColumns().length,vci=this.grid._startColIndex||0;for(i=0;i<editableCols.length;i++){result.push({colKey:editableCols[i].key,element:i>=vci&&i<vci+vcc?cells.eq(i-vci):null})}return result},_getEditedColumnElementsForRow:function(row){var result=[],cells,i;cells=this._getEditableCellsForRow(row).filter("."+this.css.editingCell);for(i=0;i<cells.length;i++){result.push({colKey:this._getColumnKeyForCell(cells.eq(i)),element:cells.eq(i)})}return result},_getEditedColumnElementsForDialog:function(content){var result=[],cols=this.grid.options.columns,i,key,element;for(i=0;i<cols.length;i++){key=cols[i].key;element=content.find("[data-editor-for-"+key.toLowerCase()+"]");if(element.length===1){result.push({colKey:key,element:element})}}return result},_getEditableCellsForRow:function(row){return this._combineRowElements(row).children("td[aria-readonly='false']:not([data-skip='true'],[data-parent])")},_combineRowElements:function(row){var frow,urow,fixingDir=this.grid.fixingDirection(),type=row.attr("data-new-row")?"[data-new-row]":"[data-add-row]";if(this.grid.hasFixedColumns()){if(this.grid._isFixedElement(row)){frow=row;urow=row.parent().is("thead")?this.grid.headersTable().children("thead").children("tr"+type):this._getRowByIndex(this._getIndexForRow(row),false)}else{urow=row;frow=row.parent().is("thead")?this.grid.fixedHeadersTable().children("thead").children("tr"+type):this._getRowByIndex(this._getIndexForRow(row),true)}return fixingDir==="left"?$([frow[0],urow[0]]):$([urow[0],frow[0]])}return row},_getVisibleIndexForKey:function(columnKey){var vc=this.grid._visibleColumns(),i;for(i=0;i<vc.length;i++){if(vc[i].key===columnKey){return i}}return null},_getRowByIndex:function(index,fixed){var tbody=fixed?this.grid.fixedBodyContainer().find("tbody"):this.grid.element.find("tbody");return tbody.children("tr:not([data-container])").eq(index-(this.grid._startRowIndex||0))},_getIndexForRow:function(row){return row.closest("tbody").children("tr:not([data-container])").index(row)+(this.grid._startRowIndex||0)},_getColumnKeyForCell:function(cell){var col=this.grid.getColumnByTD(cell);return col?col.column.key:null},_analyzeEditTriggers:function(){var trg=this.options.startEditTriggers,key;this._editTriggers={click:false,dblclick:false,f2:false,enter:false};for(key in this._editTriggers){if(this._editTriggers.hasOwnProperty(key)){if($.type(trg)==="array"){this._editTriggers[key]=$.inArray(key,trg)}else{this._editTriggers[key]=trg.toLowerCase().indexOf(key)>=0}}}},_rebindEditTriggers:function(){var selector="#"+this.grid.id()+">tbody>tr>td,#"+this.grid.id()+"_fixed>tbody>tr>td",hId,scr;if(this.options.enableAddRow&&this.grid.options.showHeader){hId=this.grid.headersTable().attr("id");selector+=",#"+hId+">thead>tr.ui-iggrid-addrow,#"+hId+"_fixed>thead>tr.ui-iggrid-addrow"}this.grid.container().off(".triggers");this.grid.container().on({"mousedown.triggers":this._handlers.mouseDown,"touchstart.triggers":this._handlers.mouseDown},selector);if(this._editTriggers.dblclick){this.grid.container().on({"dblclick.triggers":this._handlers.clickTrigger},selector)}else if(this._editTriggers.click){this.grid.container().on({"click.triggers":this._handlers.clickTrigger},selector)}this.grid.container().on({"keydown.triggers":this._handlers.keyDown},selector.replace(/>td/g,""));if(this.options.enableDeleteRow){this._renderDeleteButton()}scr=this._addElementToScrollContainer($());if(scr&&scr.length&&scr[0]!==this.grid.container()[0]){scr.unbind("scroll",this._handlers.scroll).bind("scroll",this._handlers.scroll)}},_getLatestValues:function(id,columnKey){var original,record,transactions,i,notNew=false;original=this.grid.dataSource.findRecordByKey(id);record=jQuery.extend(true,{},original);transactions=this.grid.dataSource.pendingTransactions();for(i=transactions.length-1;i>=0;i--){if(transactions[i].rowId===id){switch(transactions[i].type){case"row":case"newrow":case"insertnode":jQuery.extend(true,record,transactions[i].row);break;case"cell":record[transactions[i].col]=transactions[i].value;break;case"deleterow":record=null;break}notNew=true}}if(original||notNew){return $.type(columnKey)==="string"?record[columnKey]:record}throw new Error($.ig.GridUpdating.locale.recordOrPropertyNotFoundException)},_getDefaultValues:function(columnKey){var defVals=this._defaultValues,allValues,settings=this.options.columnSettings,i,gpkArgs;if(!defVals){defVals={};for(i=0;i<settings.length;i++){if(settings[i].defaultValue!==undefined&&$.type(settings[i].columnKey)==="string"){defVals[settings[i].columnKey]=settings[i].defaultValue}}this._defaultValues=defVals}allValues=jQuery.extend(true,{},defVals);if((!columnKey||columnKey===this.grid.options.primaryKey)&&!defVals.hasOwnProperty(columnKey)){gpkArgs={owner:this};if(this._getPKType()==="string"){gpkArgs.value=String(this._pkVal)}else{gpkArgs.value=this._pkVal}this._trigger(this.events.generatePrimaryKeyValue,null,gpkArgs);allValues[this.grid.options.primaryKey]=gpkArgs.value}return columnKey?allValues[columnKey]:allValues},_getPKType:function(){var pk=this.grid.options.primaryKey,pkType,pkColumn,data=this.grid.dataSource._data;if(!this._pkt){if(!pk){throw new Error($.ig.GridUpdating.locale.noPrimaryKeyException)}pkColumn=this.grid.columnByKey(pk);if(pkColumn&&pkColumn.dataType){pkType=pkColumn.dataType}else{pkType=data&&data.length>0&&data[0][pk]!==null&&data[0][pk]!==undefined?$.type(data[0][pk]):null}this._pkt=pkType}return this._pkt},_updateUIForTransaction:function(t,element){var go=this.grid.options,autoCommit=go.autoCommit,v=go.virtualization||go.rowVirtualization||go.columnVirtualization,fv=go.virtualizationMode==="fixed",row,vals,pk,grp,idx,nextRow;switch(t.type){case"newrow":if(this.grid.element.children("tbody").children("tr."+this.grid.css.modifiedRecord+"[data-id='"+t.rowId+"']").length){return}grp=this.grid.element.children("tbody").children("tr.ui-iggrid-groupedrow").length>0;this._updateUnboundValuesForRow(t.row);if(v&&!autoCommit){break}if(grp){this.grid.element.data("igGridGroupBy")._renderNewRow(t.row,t.rowId)}else{this.grid.renderNewRow(t.row,t.rowId)}this.grid._updateGridContentWidth();row=this.grid.rowById(t.rowId);if(!autoCommit&&row.length){this._combineRowElements(row).addClass(this.grid.css.modifiedRecord)}break;case"cell":pk=autoCommit&&t.col===go.primaryKey?t.value:t.rowId;row=element?element.parent():this.grid.rowById(pk);vals=this._getLatestValues(pk);vals[t.col]=t.value;this._updateUnboundValuesForRow(vals);if(!row||!row.length){break}this.grid._renderRow(vals,row);if(!autoCommit){this._combineRowElements(row).addClass(this.grid.css.modifiedRecord)}else{this._combineRowElements(row).attr("data-id",pk).data("id",pk)}break;case"row":pk=autoCommit&&t.row.hasOwnProperty(go.primaryKey)?t.row[go.primaryKey]:t.rowId;row=element||this.grid.rowById(pk);vals=$.extend({},this._getLatestValues(pk),t.row);this._updateUnboundValuesForRow(vals);if(!row||!row.length){break}this.grid._renderRow(vals,row);if(!autoCommit){this._combineRowElements(row).addClass(this.grid.css.modifiedRecord)}else{this._combineRowElements(row).attr("data-id",pk).data("id",pk)}break;case"deleterow":row=element||this.grid.rowById(t.rowId);if(autoCommit&&v){this._deleteRowVirtualization(row,fv);break}if(!row||!row.length){break}if(autoCommit){idx=row.index();row=this._combineRowElements(row);nextRow=row.next("tr[data-container='true']");if(nextRow.length===1){nextRow.remove()}row.remove();this.grid._reapplyZebraStyle(idx);this.grid._updateGridContentWidth();this._notifyRowDeleted(t.rowId,row)}else{this._combineRowElements(row).addClass(this.grid.css.deletedRecord)}break}return row},_processReadOnly:function(){var i,col,colSettings=this.options.columnSettings;if(colSettings){for(i=0;i<colSettings.length;i++){if(colSettings[i].readOnly){col=this.grid.columnByKey(colSettings[i].columnKey);if(col){col.readOnly=true}}}}},_isMultiLineText:function(key){var cs=this._getColSettingsForCol(key);if(cs&&cs.editorOptions){return cs.editorOptions.textMode==="multiline"}return false},_anyEditorInvalid:function(){var key,all=this._editors,provider;for(key in all){if(all.hasOwnProperty(key)&&all[key]){provider=all[key].data("igEditorFilter").options.provider;provider.refreshValue();if(!all[key].data("igEditorFilter").options.provider.isValid()){return true}}}return false},_revertValueForEditor:function(provider,columnKey){var oval,nval,ac,hf;provider.refreshValue();nval=provider.getValue();oval=this._originalValues[columnKey];hf=$.type(provider.editor.field)==="function";if(hf){ac=provider.editor.field().attr("autocomplete");provider.editor.field().attr("autocomplete","off")}if($.type(nval)==="date"&&$.type(oval)==="date"){if(nval.getTime()!==oval.getTime()){provider.setValue(new Date(oval.getTime()),true);if(hf){if(ac){provider.editor.field().removeAttr("autocomplete")}else{provider.editor.field().attr("autocomplete",ac)}}return true}}else if(oval!==nval){provider.setValue(oval,true);if(hf){if(ac){provider.editor.field().removeAttr("autocomplete")}else{provider.editor.field().attr("autocomplete",ac)}}return true}if(hf){if(ac){provider.editor.field().removeAttr("autocomplete")}else{provider.editor.field().attr("autocomplete",ac)}}return false},_hideValidatorMessages:function(){var key,e=this._editors,wrapper,validator;for(key in e){if(e.hasOwnProperty(key)){wrapper=this._providerForKey(key).data("igEditorFilter");if(wrapper&&wrapper.hasInvalidMessage()){validator=wrapper.options.provider.validator();if(validator){validator.hide()}}}}},_chooseColumnToFocus:function(isAdding,initialKey){var defaultIndex,i,columnToFocus,visibleCols=this.grid._visibleColumns(),vcc=this.grid._virtualColumnCount||visibleCols.length,vci=this.grid._startColIndex||0;defaultIndex=isAdding?0:this._getVisibleIndexForKey(initialKey);defaultIndex=Math.min(Math.max(vci,defaultIndex),vci+vcc-1);if(!initialKey){defaultIndex--}if(initialKey&&!this.grid.columnByKey(initialKey).readOnly){columnToFocus=initialKey}else{i=defaultIndex+1<visibleCols.length?defaultIndex+1:vci;while(visibleCols[i].key!==initialKey){if(!visibleCols[i].readOnly){columnToFocus=visibleCols[i].key;break}if(++i===vci+vcc){i=vci}}}return columnToFocus},_addDSSuccessHandler:function(){var fS,grid=this.grid;if(this._addChangesSuccessHandler!==null&&this._addChangesSuccessHandler!==undefined){grid.dataSource._removeChangesSuccessHandler(this._addChangesSuccessHandler)}fS=this.options.saveChangesSuccessHandler;if(fS){if($.type(fS)==="string"&&window[fS]&&$.type(window[fS])==="function"){fS=window[fS]}}if($.type(fS)!=="function"){fS=null}this._addChangesSuccessHandler=function(data){if(grid.rows().parent().find("."+grid.css.deletedRecord).length){grid._renderData()}grid.rows().removeClass(grid.css.modifiedRecord);if(fS){fS(data)}};grid.dataSource._addChangesSuccessHandler(this._addChangesSuccessHandler)
},_addDSErrorHandler:function(){var fE;if(this._addChangesErrorHandler!==null&&this._addChangesErrorHandler!==undefined){this.grid.dataSource._removeChangesErrorHandler(this._addChangesErrorHandler)}if(this.options.saveChangesErrorHandler){fE=this.options.saveChangesErrorHandler;if($.type(fE)==="string"&&window[fE]&&$.type(window[fE])==="function"){fE=window[fE]}if($.type(fE)==="function"){this._addChangesErrorHandler=function(jqXHR,textStatus,errorThrown){fE(jqXHR,textStatus,errorThrown)};this.grid.dataSource._addChangesErrorHandler(this._addChangesErrorHandler)}}},_deleteRowVirtualization:function(row,fixed){var svst;if(fixed){if(this.grid._startRowIndex+this.grid._virtualRowCount===this.grid._totalRowCount){this.grid._startRowIndex=Math.max(0,this.grid._startRowIndex-1)}this.grid._totalRowCount--;if(this.grid._virtualRowCount>this.grid._totalRowCount){this.grid._buildVirtualDom()}else{this.grid._renderVirtualRecords();this.grid._setScrollContainerHeight(this.grid._totalRowCount*parseInt(this.grid.options.avgRowHeight,10))}}else{svst=this.grid._persistVirtualScrollTop;this.grid._persistVirtualScrollTop=true;this.grid._saveFirstVisibleTRIndex();this.grid._renderVirtualRecords();this.grid._persistVirtualScrollTop=svst}},_childrenWithAddRowEnabled:function(opts,inheritedRule){var i,j,cl,clr;if(opts.columnLayouts){for(i=0;i<opts.columnLayouts.length;i++){cl=opts.columnLayouts[i];if(inheritedRule!==null&&inheritedRule!==undefined){clr=inheritedRule}else{clr=$.ui.igGridUpdating.prototype.options.enableAddRow}if(cl.features&&cl.features.length>0){for(j=0;j<cl.features.length;j++){if(cl.features[j].name==="Updating"){return cl.features[j].enableAddRow===null||cl.features[j].enableAddRow===undefined?clr:cl.features[j].enableAddRow}}}else{return inheritedRule===true}}}return false},_recOrPropFound:function(rowId,colKey){var pendingTransactions=this.grid.dataSource.pendingTransactions(),rec,i=pendingTransactions.length,found;rec=this.grid.dataSource.findRecordByKey(rowId);found=!!rec;if(colKey){found=found&&rec.hasOwnProperty(colKey)}if(!found){while(--i>=0){if(pendingTransactions[i].rowId===rowId){return colKey?pendingTransactions[i].row.hasOwnProperty(colKey):true}}return false}return true},_activateEditor:function(editor){var cell=editor.closest("td");if(cell.length&&this.options.editMode!=="dialog"){this._scrollTo(cell)}editor.igEditorFilter("setFocus");setTimeout(function(){if(editor.data("igEditorFilter")){editor.igEditorFilter("setFocus")}},5)},_scrollTo:function(cell){var scrollContainer=this.grid.scrollContainer(),cellPosition,ct,cl;if(scrollContainer.length&&scrollContainer.has(cell)){cellPosition=cell.position();ct=cellPosition.top+scrollContainer.scrollTop();cl=cellPosition.left+scrollContainer.scrollLeft();if(cellPosition.left<0){scrollContainer.scrollLeft(cl)}else if(cl+cell.outerWidth()>scrollContainer.scrollLeft()+scrollContainer.outerWidth()){scrollContainer.scrollLeft(cl+cell.outerWidth()-scrollContainer.outerWidth())}if(cellPosition.top<0){scrollContainer.scrollTop(ct)}else if(ct+cell.outerHeight()>scrollContainer.scrollTop()+scrollContainer.outerHeight()){scrollContainer.scrollTop(ct+cell.outerHeight()-scrollContainer.outerHeight())}}},_setScroll:function(code,nextActiveElement){var scrollVDir=code===$.ui.keyCode.DOWN||code===$.ui.keyCode.RIGHT?"down":"up";this._setScrollTop(this.grid.element.parent(),nextActiveElement.closest("tr"),scrollVDir,nextActiveElement.closest("tr").index()+(this.grid._startRowIndex||0))},_setScrollTop:function(parent,child,direction,index){var parentOffset=parent.offset(),childOffset=child.offset(),childh,isDown,isUp,v,c;if(!child||child.length===0){return}v=this.grid.options.virtualization||this.grid.options.rowVirtualization;c=v&&this.grid.options.virtualizationMode==="continuous";childh=v&&!c?parseInt(this.grid.options.avgRowHeight,10):child.outerHeight();if(!v||c){isDown=childOffset.top+childh+this.grid._scrollbarWidth()>parentOffset.top+$(parent).outerHeight();isUp=childOffset.top-childh/2<=parentOffset.top||c&&index<0}if(index===0&&(!v||c)){parent[0].scrollTop=0}else if(direction==="down"){if(isDown){if(c){this.grid._onVirtualVerticalScroll({},childh,direction)}}}else{if(isUp){if(c){this.grid._onVirtualVerticalScroll({},childh,direction)}}}},_scrollVmanual:function(down){var sc=$("#"+this.grid.element[0].id+"_scrollContainer"),h=parseInt(this.grid.options.avgRowHeight,10);this.grid._ignoreScroll=true;if(down){sc.scrollTop(sc.scrollTop()+h)}else{sc.scrollTop(sc.scrollTop()-h)}this.grid._onVirtualVerticalScroll();this.grid._ignoreScroll=false;this._vscrolled=true},_deleteRow:function(evt,rowId,suppress){var arg,t,autoCommit=this.grid.options.autoCommit,row=this.grid.rowById(rowId);if(row.hasClass(this.grid.css.deletedRecord)){return}arg={owner:this,element:row,rowID:rowId};if(!suppress){if(!this._trigger(this.events.rowDeleting,evt,arg)){return false}}t=this.grid.dataSource.deleteRow(rowId,autoCommit);row=this._updateUIForTransaction(t,row);if(!suppress){this._trigger(this.events.rowDeleted,evt,arg)}return true},_deleteMultipleRows:function(evt){var selectedRows=this.grid.element.igGridSelection("selectedRows"),i;for(i=0;i<selectedRows.length;i++){if(selectedRows[i]&&selectedRows[i].hasOwnProperty("id")&&!selectedRows[i].element.hasClass(this.grid.css.deletedRecord)){this._deleteRow(evt,selectedRows[i].id,false)}}},_updateRow:function(rowId,updateObj,origObj,row){var t,autoCommit=this.grid.options.autoCommit;origObj=origObj||this._getLatestValues(rowId);row=row||this.grid.rowById(rowId);t=this.grid.dataSource.updateRow(rowId,$.extend({},origObj,updateObj),autoCommit);this._updateUIForTransaction(t,row);this._notifyRowUpdated(rowId,row)},_updateCell:function(rowId,colKey,value,cell){var t,autoCommit=this.grid.options.autoCommit;t=this.grid.dataSource.setCellValue(rowId,colKey,value,autoCommit);this._updateUIForTransaction(t,cell);this._notifyCellUpdated(rowId,cell)},_addRow:function(evt,addObj,defVals,suppress){var arg,key,t,row;addObj=$.extend({},defVals,addObj);arg={owner:this,values:addObj,oldValues:defVals};if(!suppress){if(!this._trigger(this.events.rowAdding,evt,arg)){return false}}key=addObj[this.grid.options.primaryKey];t=this.grid.dataSource.addRow(key,addObj,this.grid.options.autoCommit);row=this._updateUIForTransaction(t);this._notifyRowAdded(row);if($.type(this._pkVal)==="number"){this._pkVal++}if(!suppress){this._trigger(this.events.rowAdded,evt,arg)}},_notifyRowAdded:function(row){var rs=this.grid.element.data("igGridRowSelectors"),pa=this.grid.element.data("igGridPaging"),su=this.grid.element.data("igGridSummaries");if(rs&&typeof rs._rowAdded==="function"){rs._rowAdded(row)}if(pa&&typeof pa._rowAdded==="function"){pa._rowAdded(row)}if(su&&typeof su._rowAdded==="function"){su._rowAdded(row)}this.grid._fireInternalEvent("_internalRowAdded",{row:row})},_notifyRowDeleted:function(rowId,element){var se=this.grid.element.data("igGridSelection"),pa=this.grid.element.data("igGridPaging"),su=this.grid.element.data("igGridSummaries");if(se&&typeof se._rowDeleted==="function"){se._rowDeleted(rowId,element)}if(su&&typeof su._rowDeleted==="function"){su._rowDeleted(rowId,element)}if(pa&&typeof pa._rowDeleted==="function"){pa._rowDeleted(rowId,element)}this.grid._fireInternalEvent("_internalRowDeleted",{rowID:rowId,row:element})},_notifyCellUpdated:function(rowId,cell){this.grid._fireInternalEvent("_internalCellUpdated",{rowID:rowId,cell:cell})},_notifyRowUpdated:function(rowId,row){this.grid._fireInternalEvent("_internalRowUpdated",{rowID:rowId,row:row})},_renderRowEditDialog:function(rerender){var opts=this.options.rowEditDialogOptions,container,containment,captionsContainer,closeButton,dialogSelector="#"+this.grid.id()+"_updating_dialog_container",titleLabel=opts.captionLabel!==null?opts.captionLabel:$.ig.GridUpdating.locale.rowEditDialogCaptionLabel,doneButtonLabel=this.options.doneLabel!==null?this.options.doneLabel:$.ig.GridUpdating.locale.doneLabel,doneButtonTitle=this.options.doneTooltip!==null?this.options.doneTooltip:$.ig.GridUpdating.locale.doneTooltip,cancelButtonLabel=this.options.cancelLabel!==null?this.options.cancelLabel:$.ig.GridUpdating.locale.cancelLabel,cancelButtonTitle=this.options.cancelTooltip!==null?this.options.cancelTooltip:$.ig.GridUpdating.locale.cancelTooltip;container=$(dialogSelector);if(container.length){if(!rerender){return container}container.igGridModalDialog("destroy");container.remove();this._destroyAllEditors()}if(opts.containment==="owner"){containment=this.grid._rootContainer()}else{containment="window"}container=$("<div></div>").appendTo(this.grid._rootContainer()).attr("id",dialogSelector.substring(1));container.igGridModalDialog({containment:containment,renderFooterButtons:opts.showDoneCancelButtons,modalDialogCaptionText:titleLabel,modalDialogWidth:opts.width,modalDialogHeight:opts.height,buttonApplyText:doneButtonLabel,buttonApplyTitle:doneButtonTitle,buttonCancelText:cancelButtonLabel,buttonCancelTitle:cancelButtonTitle,animationDuration:opts.animationDuration,buttonApplyDisabled:true,gridContainer:this.grid._rootContainer(),closeModalDialogOnEnter:true,modalDialogOpening:this._dialogHandlers.dialogOpening,modalDialogClosing:this._dialogHandlers.dialogClosing,modalDialogClosed:this._dialogHandlers.dialogClosed,buttonOKClick:this._dialogHandlers.dialogDone,buttonCancelClick:this._dialogHandlers.dialogCancel,tabIndex:this._getNextTabIndex()});captionsContainer=container.igGridModalDialog("getCaptionButtonContainer");closeButton=$("<button></button>").attr("id",this.grid.id()+"_updating_dialog_closeButton").attr("tabindex",this._getNextTabIndex()).appendTo(captionsContainer);closeButton.igButton({onlyIcons:true,icons:{primary:this.css.rowEditDialogCloseButton},width:"20px",height:"20px",click:this._dialogHandlers.dialogCloseClick});this._dialogInvalid=false;this._editorsContainerInvalid=true;this._trigger(this.events.rowEditDialogContentsRendered,null,{owner:this,dialogElement:container});return container},_renderDialogContent:function(content,values){var opts=this.options.rowEditDialogOptions,colgroup,tmpl;this._clearEditorsFromContainer(content);content.empty();if(opts.dialogTemplateSelector){tmpl=$(opts.dialogTemplateSelector);content.append($(this._jsr?tmpl.render(values):$.ig.tmpl(tmpl.html().fullTrim(),values)))}else if(opts.dialogTemplate){tmpl=opts.dialogTemplate;content.append($(this._jsr?$.render[this.grid.id()+"_rowEditDialogTemplate"](values):$.ig.tmpl(tmpl,values)))}else{content.html(this._defaultDialogTemplate);content.find("table").addClass(this.css.rowEditDialogTable);colgroup=content.find("colgroup");colgroup.children(":first").css("width",opts.namesColumnWidth);colgroup.children(":last").css("width",opts.editorsColumnWidth);colgroup.parent().css("width","100%")}},_renderDialogTemplate:function(tmplParent,cols,onlyVisible){var opts=this.options.rowEditDialogOptions,tmpl,i,tr,e;cols=onlyVisible?$.grep(cols,function(col){return!col.hidden}):cols;if(!opts.showReadonlyEditors){cols=$.grep(cols,function(col){return!col.readOnly})}if(opts.editorsTemplateSelector){tmpl=$(opts.editorsTemplateSelector);tmplParent.append($(this._jsr?tmpl.render(cols):$.ig.tmpl(tmpl.html().fullTrim(),cols)))}else if(opts.editorsTemplate){tmpl=opts.editorsTemplate;tmplParent.append($(this._jsr?$.render[this.grid.id()+"_rowEditDialogEditorsTemplate"](cols):$.ig.tmpl(tmpl,cols)))}else{for(i=0;i<cols.length;i++){tr=$("<tr></tr>");$("<td>"+(cols[i].headerText||cols[i].key)+"</td>").appendTo(tr);$("<td></td>").appendTo(tr);e=this._isMultiLineText(cols[i].key)?$("<textarea></textarea>"):$("<input />");e.attr("data-editor-for-"+cols[i].key,"").appendTo(tr.children(":last"));tr.appendTo(tmplParent)}}},_initDialogEditors:function(content,cols,values){var i=0,provider,providerWrapper,ro,key,element,val,settings;this._editors=this._editors||{};while(i<cols.length){key=cols[i].key;ro=!!cols[i].readOnly;val=values[key]===undefined?null:values[key];element=content.find("[data-editor-for-"+key.toLowerCase()+"]");if(element.length===1){providerWrapper=this._providerForKey(key);if(providerWrapper&&providerWrapper.has(element).length){provider=providerWrapper.igEditorFilter("option","provider");provider.setValue(val)}else{if(ro){settings=this._getColSettingsForCol(key);if(!settings){this.options.columnSettings.push({columnKey:key,editorOptions:{readOnly:true}})}else{$.extend(true,settings,{editorOptions:{readOnly:true}})}}providerWrapper=this._createEditor(null,key,element);this._editors[key]=providerWrapper;provider=providerWrapper.igEditorFilter("option","provider");provider.setValue(val)}if(this._columnToFocus===key){providerWrapper.igEditorFilter("setFocus",50)}this._originalValues=this._originalValues||{};this._originalValues[key]=provider.getValue();$.ig.removeFromArray(cols,i,i)}else{i++}}},_clearEditorsFromContainer:function(content){var cols=this.grid.options.columns,i=-1,key,element,providerWrapper;while(++i<cols.length){key=cols[i].key;element=content.find("[data-editor-for-"+key.toLowerCase()+"]");if(element.length){providerWrapper=this._providerForKey(key).data("igEditorFilter");if(providerWrapper){this._providerForKey(key).igEditorFilter("destroy");delete this._editors[key]}}}},_renderDoneCancelButtons:function(){var buttonContainer,buttonsParent,doneButton,cancelButton,deleteButton,doneButtonLabel=this.options.doneLabel!==null?this.options.doneLabel:$.ig.GridUpdating.locale.doneLabel,doneButtonTitle=this.options.doneTooltip!==null?this.options.doneTooltip:$.ig.GridUpdating.locale.doneTooltip,cancelButtonLabel=this.options.cancelLabel!==null?this.options.cancelLabel:$.ig.GridUpdating.locale.cancelLabel,cancelButtonTitle=this.options.cancelTooltip!==null?this.options.cancelTooltip:$.ig.GridUpdating.locale.cancelTooltip,doneSelector,cancelSelector,deleteSelector;buttonContainer=$("<div></div>").css("position","absolute").attr("unselectable","on").addClass(this.css.buttonContainer);buttonsParent=this._addElementToScrollContainer(buttonContainer);doneButton=$("<span></span").attr("id",this.grid.id()+"_updating_done").addClass(this.css.button).addClass(this.css.doneButton).attr({unselectable:"on",tabIndex:this._getNextTabIndex()+1,title:doneButtonTitle}).css({display:"inline-block",position:"relative"}).appendTo(buttonContainer);$("<span></span>").css("display","inline-block").addClass(this.css.doneIcon).attr("unselectable","on").appendTo(doneButton);if(doneButtonLabel&&doneButton.length){$("<span></span>").css("display","inline-block").attr("unselectable","on").html(doneButtonLabel).appendTo(doneButton)}else{doneButton.addClass(this.css.buttonIconOnly)}cancelButton=$("<span></span>").attr("id",this.grid.id()+"_updating_cancel").addClass(this.css.button).addClass(this.css.cancelButton).attr({unselectable:"on",tabIndex:this._getNextTabIndex()+1,title:cancelButtonTitle}).css({display:"inline-block",position:"relative"}).appendTo(buttonContainer);$("<span></span>").css("display","inline-block").addClass(this.css.cancelIcon).attr("unselectable","on").appendTo(cancelButton);if(cancelButtonLabel&&cancelButtonLabel.length){$("<span></span>").css("display","inline-block").attr("unselectable","on").html(cancelButtonLabel).appendTo(cancelButton)}else{cancelButton.addClass(this.css.buttonIconOnly)}if(this._renderTouchUI&&this.options.enableDeleteRow){deleteButton=$("<span />").attr("id",this.grid.id()+"_updating_delete_touch").addClass(this.css.button).addClass(this.css.doneButton).attr({unselectable:"on",tabIndex:this._getNextTabIndex()+1,title:this.options.deleteRowTooltip!==null?this.options.deleteRowTooltip:$.ig.GridUpdating.locale.deleteRowTooltip}).prependTo(buttonContainer);$("<span />").css({display:"inline-block",left:0}).addClass(this.css.deleteIcon).attr("unselectable","on").appendTo(deleteButton);$("<span />").css("display","inline-block").attr("unselectable","on").html(this.options.deleteRowLabel!==null?this.options.deleteRowLabel:$.ig.GridUpdating.locale.deleteRowLabel).appendTo(deleteButton);deleteButton.css({"float":"left",position:"relative"});doneButton.css("float","right");cancelButton.css("float","right");buttonContainer.css("width",buttonsParent.outerWidth());deleteSelector="#"+deleteButton.attr("id")}doneSelector="#"+doneButton.attr("id");cancelSelector="#"+cancelButton.attr("id");this.grid.container().on({"mouseenter.donecancel":this._buttonHandlers.mouseEnter,"mouseleave.donecancel":this._buttonHandlers.mouseLeave,"focus.donecancel":this._buttonHandlers.focus,"blur.donecancel":this._buttonHandlers.blur},doneSelector+","+cancelSelector+(deleteSelector?","+deleteSelector:""));this.grid.container().on({"click.donecancel":this._buttonHandlers.doneClick,"keyup.donecancel":this._buttonHandlers.doneKeyUp},doneSelector);this.grid.container().on({"click.donecancel":this._buttonHandlers.cancelClick,"keyup.donecancel":this._buttonHandlers.cancelKeyUp},cancelSelector);if(deleteSelector){this.grid.container().on({"click.donecancel":this._buttonHandlers.touchDeleteClick,"keyup.donecancel":this._buttonHandlers.touchDeleteKeyUp},deleteSelector)}return buttonContainer},_removeDoneCancelButtons:function(){var container=this._findElementInScrollContainer(".ui-iggrid-buttoncontainer:first");this.grid.container().off(".donecancel");container.remove()},_renderDeleteButton:function(){var deleteButton,deleteParent,ubodySelector="#"+this.grid.id()+">tbody",fbodySelector="#"+this.grid.id()+"_fixed>tbody",deleteSelector="#"+this.grid.id()+"_updating_deletehover",deleteButtonTitle=this.options.deleteRowTooltip!==null?this.options.deleteRowTooltip:$.ig.GridUpdating.locale.deleteRowTooltip,pe=window.navigator.msPointerEnabled||window.navigator.pointerEnabled;deleteButton=$(deleteSelector);if(deleteButton.length){return}deleteButton=$("<span></span>").attr("id",deleteSelector.substring(1)).css("position","absolute").addClass(this.css.deleteButton).attr({unselectable:"on",title:deleteButtonTitle});deleteButton.hide();$("<span></span>").css("display","inline-block").addClass(this.css.deleteIcon).attr("unselectable","on").appendTo(deleteButton);deleteParent=this._addElementToScrollContainer(deleteButton);this.grid.container().on({"mouseenter.deletebutton":this._buttonHandlers.mouseEnter,"mouseleave.deletebutton":this._buttonHandlers.mouseLeave,"click.deletebutton":this._buttonHandlers.deleteClick,"keyup.deletebutton":this._buttonHandlers.deleteClick},deleteSelector);if(pe){this.grid.container().on({"pointerover.deletebutton":this._handlers.pointerEnter,"mspointerover.deletebutton":this._handlers.pointerEnter},ubodySelector+">tr,"+fbodySelector+">tr")}else{this.grid.container().on({"mouseenter.deletebutton":this._handlers.mouseEnter},ubodySelector+">tr,"+fbodySelector+">tr")}this.grid.container().on({"mspointerdown.deletebutton":this._handlers.pointerDown,"pointerdown.deletebutton":this._handlers.pointerDown,"mspointerup.deletebutton":this._handlers.pointerUp,"pointerup.deletebutton":this._handlers.pointerUp,"touchstart.deletebutton":this._handlers.touchStart,"touchend.deletebutton":this._handlers.touchEnd},ubodySelector+">tr,"+fbodySelector+">tr");if(deleteParent[0]===this.grid.container()[0]){this.grid.container().bind("mouseleave.deletebutton",this._handlers.mouseLeave)}else{this.grid.container().on({"mouseleave.deletebutton":this._handlers.mouseLeave},"#"+deleteParent.attr("id"))}},_removeDeleteButton:function(){$("#"+this.grid.id()+"_updating_deletehover").remove();this.grid.container().off(".deletebutton");this.grid.container().unbind(".deletebutton")},_renderAddNewRow:function(thead){var addRowLabel=this.options.addRowLabel!==null?this.options.addRowLabel:$.ig.GridUpdating.locale.addRowLabel,addRowTitle=this.options.addRowTooltip!==null?this.options.addRowTooltip:$.ig.GridUpdating.locale.addRowTooltip,addTr,newTr,mainTd,i,recVerticalSize;addTr=thead.children("tr[data-add-row='true']");if(!addTr.length){addTr=$("<tr></tr>").addClass(this.css.addRow).attr({"data-add-row":true,tabIndex:this.grid.options.tabIndex}).appendTo(thead)}addTr.empty();mainTd=$("<td></td>").attr("title",addRowTitle).addClass(this.css.addRow).appendTo(addTr);$("<span></span>").css("display","inline-block").addClass(this.css.addRowIcon).appendTo(mainTd);$("<span></span>").text(addRowLabel).css("outline",0).attr("tabIndex",0).appendTo(mainTd);newTr=thead.children("tr[data-new-row='true']");if(!newTr.length){recVerticalSize=this.grid._recordVerticalSize();for(i=0;i<recVerticalSize;i++){$("<tr></tr>").attr("data-new-row","true").attr("data-role","newrow").appendTo(thead).hide()}}},_generateDummyLayout:function(cols){var i,layout=[[]];for(i=0;i<cols.length;i++){layout[0].push({col:cols[i],rs:1,cs:1})}return layout},_addElementToScrollContainer:function(element){var go=this.grid.options,container,hasHeight=go.height!==null&&go.height!==undefined;if(!hasHeight){container=this.grid.container();element.appendTo(container)}else if(this.grid.hasFixedColumns()&&this.grid.fixingDirection()==="right"){container=this.grid.fixedBodyContainer();element.prependTo(container)}else{if(go.virtualization||go.rowVirtualization||go.columnVirtualization){container=this.grid._vdisplaycontainer()}else{container=this.grid.scrollContainer()}element.prependTo(container)}return container},_findElementInScrollContainer:function(selector){var go=this.grid.options,container,hasHeight=go.height!==null&&go.height!==undefined;if(!hasHeight){container=this.grid.container()}else if(this.grid.hasFixedColumns()&&this.grid.fixingDirection()==="right"){container=this.grid.fixedBodyContainer()}else{if(go.virtualization||go.rowVirtualization||go.columnVirtualization){container=this.grid._vdisplaycontainer()}else{container=this.grid.scrollContainer()}}return container.children(selector)},_createHandlers:function(){this._stopEditingHandler=this._stopEditingHandler||$.proxy(this._stopEditing,this);this._gridHandlers=this._gridHandlers||{stopEditing:this._stopEditingHandler,gridDataRendering:$.proxy(this._gridDataRendering,this),rowsRendered:$.proxy(this._rowsRendered,this),headerRendering:$.proxy(this._processReadOnly,this),headerRendered:$.proxy(this._headerRendered,this),rendered:$.proxy(this._headerRendered,this),virtualFrameChanging:$.proxy(this._virtPreRender,this),virtualFrameChanged:$.proxy(this._virtPostRender,this),columnsCollectionModified:$.proxy(this._columnsModified,this)};this._handlers=this._handlers||{mouseDown:$.proxy(this._mouseDown,this),clickTrigger:$.proxy(this._clickTrigger,this),keyDown:$.proxy(this._keyDown,this),focus:$.proxy(this._focus,this),blur:$.proxy(this._blur,this),touchStart:$.proxy(this._touchStart,this),touchEnd:$.proxy(this._touchEnd,this),pointerDown:$.proxy(this._pointerDown,this),pointerUp:$.proxy(this._pointerUp,this),mouseEnter:$.proxy(this._rowMouseEnter,this),pointerEnter:$.proxy(this._rowPointerEnter,this),mouseLeave:$.proxy(this._containerMouseLeave,this),scroll:$.proxy(this._scroll,this)};this._buttonHandlers=this._buttonHandlers||{mouseEnter:$.proxy(this._buttonMouseEnter,this),mouseLeave:$.proxy(this._buttonMouseLeave,this),focus:$.proxy(this._buttonFocus,this),blur:$.proxy(this._buttonBlur,this),doneClick:$.proxy(this._doneButtonClick,this),doneKeyUp:$.proxy(this._doneButtonKeyUp,this),cancelClick:this._stopEditingHandler,cancelKeyUp:$.proxy(this._cancelButtonKeyUp,this),deleteClick:$.proxy(this._deleteButtonClick,this),touchDeleteClick:$.proxy(this._touchDeleteButtonClick,this),touchDeleteKeyUp:$.proxy(this._touchDeleteButtonKeyUp,this)};this._addNewRowHandlers=this._addNewRowHandlers||{focus:$.proxy(this._addRowFocus,this),blur:$.proxy(this._addRowBlur,this)};this._validationHandlers=this._validationHandlers||{errorShowing:$.proxy(this._editorErrorShowing,this),errorShown:$.proxy(this._editorErrorShown,this),errorHidden:$.proxy(this._editorErrorHidden,this)};this._dialogHandlers=this._dialogHandlers||{dialogCloseClick:$.proxy(this._dialogCloseClick,this),dialogOpening:$.proxy(this._dialogOpening,this),dialogClosing:$.proxy(this._dialogClosing,this),dialogClosed:$.proxy(this._dialogClosed,this),dialogDone:$.proxy(this._dialogDone,this),dialogCancel:$.proxy(this._dialogCancel,this)};this._editorCallbacks=this._editorCallbacks||{keyDown:$.proxy(this._editorKeyDown,this),textChanged:$.proxy(this._editorTextChanged,this)}},_unbindAllEvents:function(){this.grid.element.off({iggriduidirty:this._gridHandlers.stopEditing,iggridresizingcolumnresizing:this._gridHandlers.stopEditing,ighierarchicalgridrowexpanded:this._gridHandlers.stopEditing,iggridrendered:this._gridHandlers.gridRendered,iggriddatarendering:this._gridHandlers.gridDataRendering,iggridrowsrendered:this._gridHandlers.rowsRendered,iggridvirtualrendering:this._gridHandlers.virtualFrameChanging,iggridvirtualrecordsrender:this._gridHandlers.virtualFrameChanged,iggridcolumnscollectionmodified:this._gridHandlers.columnsCollectionModified,iggridheaderrendering:this._gridHandlers.headerRendering});if(this.options.enableAddRow){this.grid.element.off({iggridheaderrenderedinternal:this._gridHandlers.headerRendered,iggridrendered:this._gridHandlers.rendered})}this.grid.container().off({click:this._handlers.click})},_bindGridEvents:function(){this.grid.element.on({iggriduidirty:this._gridHandlers.stopEditing,iggridresizingcolumnresizing:this._gridHandlers.stopEditing,ighierarchicalgridrowexpanded:this._gridHandlers.stopEditing,iggriddatarendering:this._gridHandlers.gridDataRendering,iggridrowsrendered:this._gridHandlers.rowsRendered,iggridvirtualrendering:this._gridHandlers.virtualFrameChanging,iggridvirtualrecordsrender:this._gridHandlers.virtualFrameChanged,iggridcolumnscollectionmodified:this._gridHandlers.columnsCollectionModified,iggridheaderrendering:this._gridHandlers.headerRendering});if(this.options.enableAddRow){this.grid.element.on({iggridheaderrenderedinternal:this._gridHandlers.headerRendered,iggridrendered:this._gridHandlers.rendered})}},_injectGrid:function(gridInstance,isRebind){var hg,cl;this.grid=gridInstance;this._addDSSuccessHandler();this._addDSErrorHandler();if(isRebind){return}this._dialogInvalid=true;this._defaultDialogTemplate="<table><colgroup><col></col><col></col></colgroup><tbody data-render-tmpl></tbody></table>";this._editors=this._editors||{};if(this.options.excelNavigationMode&&this.options.editMode!=="cell"&&this.options.editMode!=="row"){throw new Error($.ig.GridUpdating.locale.excelNavigationNotSupportedWithCurrentEditMode)}if(this.grid._isMultiRowGrid()&&this.options.editMode!=="dialog"){throw new Error($.ig.GridUpdating.locale.multiRowGridNotSupportedWithCurrentEditMode)}this._createHandlers();this._bindGridEvents();this._analyzeEditTriggers();if(this.grid.options._isHierarchicalGrid&&this.grid._originalOptions){if(this.options.inherit){this.grid._shouldAlwaysRenderChildIndicator=this._childrenWithAddRowEnabled(this.grid.options,this.options.enableAddRow)}else{this.grid._shouldAlwaysRenderChildIndicator=this._childrenWithAddRowEnabled(this.grid.options)}if(!this.grid.dataSource.settings.schema.layouts){hg=this.grid.element.closest(".ui-iggrid-root").data("igHierarchicalGrid");cl=[];hg._parseLayouts(cl,"",this.grid._originalOptions);this.grid.dataSource.settings.schema.layouts=cl}}this._renderTouchUI=$.ig.util.isTouch;if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled){this.grid.element.css("-ms-touch-action","none");this.grid.element.css("touch-action","none")}if(String(this.grid.options.templatingEngine).toLowerCase()==="jsrender"){this._jsr=true;if(this.options.rowEditDialogOptions.dialogTemplate&&typeof this.options.rowEditDialogOptions.dialogTemplate==="string"){$.templates(this.grid.id()+"_rowEditDialogTemplate",this.options.rowEditDialogOptions.dialogTemplate)}if(this.options.rowEditDialogOptions.editorsTemplate&&typeof this.options.rowEditDialogOptions.editorsTemplate==="string"){$.templates(this.grid.id()+"_rowEditDialogEditorsTemplate",this.options.rowEditDialogOptions.editorsTemplate)}}}});$.extend($.ui.igGridUpdating,{version:"16.1.20161.1009"})})(jQuery);/*!@license
 * Infragistics.Web.ClientUI Grid AppendRowsOnDemand 16.1.20161.1009
 *
 * Copyright (c) 2011-2016 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *	jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	infragistics.ui.grid.framework.js
 *	infragistics.ui.shared.js
 *	infragistics.util.js
 */
if(typeof jQuery!=="function"){throw new Error("jQuery is undefined")}(function($){$.widget("ui.igGridAppendRowsOnDemand",{options:{type:null,chunkSize:25,recordCountKey:null,chunkSizeUrlKey:null,chunkIndexUrlKey:null,defaultChunkIndex:0,currentChunkIndex:0,loadTrigger:"auto",loadMoreDataButtonText:$.ig.GridAppendRowsOnDemand.locale.loadMoreDataButtonText},events:{rowsRequesting:"rowsRequesting",rowsRequested:"rowsRequested"},_loadingIndicator:null,_persistLocalSorting:true,_persistLocalFiltering:true,_recalcLocalSummaries:true,_keepCurrentChunkIndex:true,_callDataRendered:true,_initialProbeForChunkIndex:true,_injectGrid:function(gridInstance){this.grid=gridInstance;this._checkNotSupportedScenarios();this.options.currentChunkIndex=this.options.defaultChunkIndex;if(this.options.type===null){this.options.type=this.grid._inferOpType()}this.grid.dataSource.settings.paging.type=this.options.type||"remote";this._defaultChunkSize=parseInt(this.options.chunkSize,10)*(this.options.defaultChunkIndex+1);this.grid.dataSource.settings.paging.pageSize=this._defaultChunkSize;if(this.options.chunkSizeUrlKey!==null&&this.options.chunkIndexUrlKey){this.grid.dataSource.settings.paging.pageSizeUrlKey=this.options.chunkSizeUrlKey;this.grid.dataSource.settings.paging.pageIndexUrlKey=this.options.chunkIndexUrlKey}if(this.options.recordCountKey!==null){this.grid.dataSource.settings.responseTotalRecCountKey=this.options.recordCountKey}this.grid.dataSource.settings.paging.enabled=true;if(this.options.loadTrigger==="auto"){this._verticalScrollHandler=$.proxy(this._probeForNextChunk,this)}this._appendRecordsHandler=$.proxy(this._appendRecords,this);this._columnSortingHandler=$.proxy(this._columnSorting,this);this._syncCurrentChunkIndexHandler=$.proxy(this._syncCurrentChunkIndex,this);this.grid.element.bind("iggridsortinginternalcolumnsorting",this._columnSortingHandler);this.grid.element.bind("iggriduisoftdirty iggriduidirty",this._syncCurrentChunkIndexHandler)},_dataRendered:function(){var buttonId,container;if(!this._callDataRendered){return}this._keepCurrentChunkIndex=false;this.grid.scrollContainer().css("background-color","white");this.grid.dataSource.settings.paging.pageSize=this.options.chunkSize;this._originalDataSourceCallback=this.grid.dataSource.settings.callback;this._initLoadingIndicator();if(this.options.loadTrigger==="auto"){this.grid.scrollContainer().unbind("scroll",this._verticalScrollHandler);this.grid.scrollContainer().bind("scroll",this._verticalScrollHandler);if(this._initialProbeForChunkIndex||this.options.type==="local"){this._probeForNextChunk()}}this._requestPending=false;this._triggerEvents=true;if(this.options.loadTrigger==="button"){if(!this._buttonRow){buttonId=this.grid.id()+"_loadMoreButton";container=this.grid.options.height?this.grid.scrollContainer():this.grid.container();this._buttonRow=container.append("<div class='ui-iggrid-loadmorebutton'><input type='button' id='"+buttonId+"'></input></div>");$("#"+buttonId).igButton({labelText:this.options.loadMoreDataButtonText,click:$.proxy(this._nextChunk,this),width:"100%"})}}if(this._loadingIndicator){this._hideLoading()}},_checkNotSupportedScenarios:function(){if(this.options.loadTrigger==="auto"&&!this.grid.options.height){throw new Error($.ig.GridAppendRowsOnDemand.locale.appendRowsOnDemandRequiresHeight)}if(this.grid.options.virtualization||this.grid.options.rowVirtualization||this.grid.options.columnVirtualization){throw new Error($.ig.GridAppendRowsOnDemand.locale.virtualizationNotSupported)}var i,featureName,features=this.grid.options.features,featuresLength=features.length;if(featuresLength===1){return}for(i=0;i<featuresLength;i++){featureName=features[i].name;if(!featureName){continue}featureName=featureName.toLowerCase();switch(featureName){case"groupby":throw new Error($.ig.GridAppendRowsOnDemand.locale.groupByNotSupported);case"paging":throw new Error($.ig.GridAppendRowsOnDemand.locale.pagingNotSupported);case"cellmerging":throw new Error($.ig.GridAppendRowsOnDemand.locale.cellMergingNotSupported)}}},_setOption:function(key){$.Widget.prototype._setOption.apply(this,arguments);if(key==="defaultChunkIndex"){throw new Error($.ig.Grid.locale.optionChangeNotSupported.replace("{optionName}",key))}if(key==="currentChunkIndex"||key==="chunkSize"){this._keepCurrentChunkIndex=true;this.grid.dataSource.settings.paging.pageSize=(this.options.currentChunkIndex+1)*this.options.chunkSize;this.grid.dataSource.dataBind()}},_initLoadingIndicator:function(){this._loadingIndicator=this.grid.container().igLoading().data("igLoading").indicator()},_nextChunk:function(){var noCancel=true;if(this.options.currentChunkIndex>=this.grid.dataSource.pageCount()-1){return}if(this._triggerEvents){noCancel=this._trigger(this.events.rowsRequesting,null,{owner:this,chunkIndex:this.options.currentChunkIndex+1,chunkSize:this.options.chunkSize})}if(noCancel){this._showLoading();this.grid.dataSource.settings.paging.pageSize=this.options.chunkSize;this.grid.dataSource.settings.paging.pageIndex=this.options.currentChunkIndex;this.grid.dataSource.settings.paging.appendPage=true;this._originalDataSourceCallback=this.grid.dataSource.settings.callback;this.grid.dataSource.settings.callback=this._appendRecordsHandler;this._requestPending=true;this.grid.dataSource.nextPage()}},_showLoading:function(){this._loadingIndicator.show()},_hideLoading:function(){this._loadingIndicator.hide()},destroy:function(){var buttonId=this.grid.id()+"_loadMoreButton",container=this.grid.options.height?this.grid.scrollContainer():this.grid.container(),button=container.find("div.ui-iggrid-loadmorebutton");$("#"+buttonId).igButton("destroy");if(button){button.remove()}this.grid.element.unbind("iggridsortinginternalcolumnsorting",this._columnSortingHandler);this.grid.element.unbind("iggriduisoftdirty iggriduidirty",this._syncCurrentChunkIndexHandler);this.grid.scrollContainer().unbind("scroll",this._verticalScrollHandler);$.Widget.prototype.destroy.call(this);return this},_appendRecords:function(success,errmsg){var i,currentPage=[],noCancelError,sorting=this.grid.element.data("igGridSorting"),filtering=this.grid.element.data("igGridFiltering"),summaries=this.grid.element.data("igGridSummaries");if(success===true){currentPage=this.grid.dataSource.dataView().slice(this.grid.dataSource.settings.paging.pageIndex*this.grid.dataSource.settings.paging.pageSize)}this._requestPending=false;this.grid.dataSource.settings.paging.pageIndex=0;this.grid.dataSource.settings.paging.appendPage=false;this.grid.dataSource.settings.callback=this._originalDataSourceCallback;for(i=0;i<currentPage.length;i++){this.grid.renderNewRow(currentPage[i])}if(sorting){this._keepCurrentChunkIndex=true;if(this.options.type==="remote"&&this.grid.dataSource.settings.sorting.type==="local"){if(!this._persistLocalSorting){this.grid.dataSource.settings.sorting.expressions=[]}else{if(this.grid.dataSource.settings.sorting.expressions.length>0){this._callDataRendered=false;sorting.sortMultiple();this._callDataRendered=true}}}else{sorting._dataRendered()}this._keepCurrentChunkIndex=false}if(filtering){this._keepCurrentChunkIndex=true;if(this.options.type==="remote"&&this.grid.dataSource.settings.filtering.type==="local"){if(!this._persistLocalFiltering){this.grid.dataSource.settings.filtering.expressions=[]}this._callDataRendered=false;filtering.filter(this.grid.dataSource.settings.filtering.expressions,true);this._callDataRendered=true}this._keepCurrentChunkIndex=false}if(summaries){if(this.options.type==="remote"&&this.grid.dataSource.settings.summaries.type==="local"){if(this._recalcLocalSummaries){summaries.calculateSummaries()}}}this._hideLoading();if(success===false){noCancelError=this._trigger(this.grid.events.requestError,null,{owner:this,message:errmsg});if(noCancelError){throw new Error(errmsg)}}this.options.currentChunkIndex++;this._keepCurrentChunkIndex=false;if(this._triggerEvents){this._trigger(this.events.rowsRequested,null,{owner:this,chunkIndex:this.options.currentChunkIndex,chunkSize:this.options.chunkSize,rows:currentPage})}this._triggerEvents=true;if(this._initialProbeForChunkIndex||this.options.type==="local"){this._probeForNextChunk()}},_probeForNextChunk:function(){if(this.options.loadTrigger!=="auto"){return}var delta=(this.grid.scrollContainer().scrollTop()+this.grid.scrollContainer().height())/$(this.grid.element).height();if(delta>=1&&!this._requestPending){this._nextChunk()}else{this._initialProbeForChunkIndex=false}},_columnSorting:function(){this.grid.dataSource.settings.paging.pageSize=this.options.chunkSize*(this.options.currentChunkIndex+1);this._keepCurrentChunkIndex=true},_syncCurrentChunkIndex:function(){if(this.options.type==="remote"&&this.grid.dataSource.settings.filtering.type==="local"){return}if(!this._keepCurrentChunkIndex){if(this.grid.dataSource.settings.paging.pageIndex!==this.options.currentChunkIndex){this.options.currentChunkIndex=this.grid.dataSource.settings.paging.pageIndex}this._keepCurrentChunkIndex=true}},nextChunk:function(){this._triggerEvents=false;this._nextChunk()}});$.extend($.ui.igGridAppendRowsOnDemand,{version:"16.1.20161.1009"})})(jQuery);